/*!
MolView 2.1.1 - 2014-07-04
Copyright (c) 2014, Herman Bergwerf
ALL RIGHTS RESERVED
Included files (can be found under http://molview.org/{path})
src/js/lib/JSmol.min.js
src/js/lib/jquery-1.11.0.min.js
src/js/lib/jquery.hotkeys.js
src/js/lib/Detector.js
src/js/lib/jMouseWheel.js
src/js/lib/Polyfill.js
src/js/m2s/prototype.js
src/js/m2s/util/common.js
src/js/m2s/util/vec2.js
src/js/m2s/util/set.js
src/js/m2s/util/map.js
src/js/m2s/util/pool.js
src/js/m2s/chem/element.js
src/js/m2s/chem/struct.js
src/js/m2s/chem/molfile.js
src/js/m2s/chem/sgroup.js
src/js/m2s/chem/struct_valence.js
src/js/m2s/chem/dfs.js
src/js/m2s/chem/cis_trans.js
src/js/m2s/chem/stereocenters.js
src/js/m2s/chem/smiles.js
src/js/m2s/chem/inchi.js
src/js/moledit/Constants.js
src/js/moledit/Objects.js
src/js/moledit/Chemical.js
src/js/moledit/ChemicalView.js
src/js/moledit/ChemicalView_core.js
src/js/moledit/ChemicalView_events.js
src/js/moledit/Utility.js
src/js/lib/Three49custom.js
src/js/lib/GLmol.js
src/js/lib/ChemDoodleWeb.js
src/js/lib/Blob.js
src/js/lib/FileSaver.js
src/js/lib/PeriodicTable.js
src/js/Utility.js
src/js/Variables.js
src/js/History.js
src/js/Progress.js
src/js/Messages.js
src/js/Sketcher.js
src/js/Model.js
src/js/Request.js
src/js/Loader.js
src/js/Actions.js
src/js/Share.js
src/js/Link.js
src/js/ChemicalData.js
src/js/MolView.js
*/
function hexToRGB(a){return{r:parseInt(a.substring(1,3),16),g:parseInt(a.substring(3,5),16),b:parseInt(a.substring(5,7),16)}}function rgbCompToHex(a){a=a.toFixed(),a=Math.max(Math.min(a,255),0);var b=a.toString(16);return b.length<2&&(b="0"+b),b}function rgbToHex(a){return"#"+rgbCompToHex(a.r)+rgbCompToHex(a.g)+rgbCompToHex(a.b)}function rgbRescale(a,b){var c=.21*a.r+.72*a.g+.07*a.b;return b>=c?a:{r:(a.r*b/c).toFixed()-0,g:(a.g*b/c).toFixed()-0,b:(a.b*b/c).toFixed()-0}}function clone_object(a){var b;if(a instanceof Array){b=new Array(a.length);for(var c=0;c<a.length;c++)b[c]=a[c]&&"object"==typeof a[c]?clone_object(a[c]):a[c]}else{b=new Object;for(var c in a)"clone"!=c&&"count"!=c&&(b[c]=a[c]&&"object"==typeof a[c]?clone_object(a[c]):a[c])}return b}function count_properties(){var a=0;for(var b in this)this.hasOwnProperty(b)&&a++;return a}function WMatrix(){this.mvm=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function Chemical(){this.atoms=[],this.bonds=[],this.minx=0,this.maxx=1.2*6,this.miny=0,this.maxy=1.2*6,this.rings=[]}function bondKey(a){return Math.min(a.fr,a.to).toString()+"x"+Math.max(a.fr,a.to).toString()}function cmp_rng(a,b){for(var c=0;c<a.length;c++)if(a[c]!=b[c])return a[c]-b[c];return 0}function cmp_pri_lex(a,b){for(var c=0;c<a.p.length&&c<b.p.length;){if(a.p[c]!=b.p[c])return a.p[c]-b.p[c];c++}return a.p.length-b.p.length}function num_uniq_cip(a){var b,c;if(0==a.length)return 0;for(c=1,b=0;b<a.length-1;b++)0!=cmp_pri_lex(a[b],a[b+1])&&c++;return c}function vector(a,b){return{x:b.x-a.x,y:b.y-a.y,z:b.z-a.z}}function vectorLength(a){return Math.sqrt(a.x*a.x+a.y*a.y+a.z*a.z)}function vectorSetLength(a,b){var c=b/vectorLength(a);return{x:a.x*c,y:a.y*c,z:a.z*c}}function vecpy(a,b){a.x=b.x,a.y=b.y,a.z=b.z}function veadd(a,b){return{x:a.x+b.x,y:a.y+b.y,z:a.z+b.z}}function vesub(a,b){return{x:a.x-b.x,y:a.y-b.y,z:a.z-b.z}}function vemul(a,b){return{x:a.y*b.z-a.z*b.y,y:a.z*b.x-a.x*b.z,z:a.x*b.y-a.y*b.x}}function vemulZSign(a,b){var c=a.x*b.y-a.y*b.x;return 0>c?-1:1}function scmul(a,b){return a.x*b.x+a.y*b.y+a.z*b.z}function vemulby(a,b){return{x:a.x*b,y:a.y*b,z:a.z*b}}function xyz(a){return{x:a.x,y:a.y,z:a.z}}function testPolyInclusion(a,b){for(var c=b.length,d=!1,e=0,f=c-1,g=0;c>g;g++)b[e].y<=a.y?a.y<b[f].y&&(a.x-b[e].x)*(b[f].y-b[e].y)<(b[f].x-b[e].x)*(a.y-b[e].y)&&(d=!d):a.y>=b[f].y&&(a.x-b[e].x)*(b[f].y-b[e].y)>(b[f].x-b[e].x)*(a.y-b[e].y)&&(d=!d),f=e,e++;return d}function angleBetween(a,b){return TO_DEG*Math.acos(scmul(a,b)/(vectorLength(a)*vectorLength(b)))}function ChemicalView(a,b){this.mobile=isMobile(),this.android=navigator.userAgent.match(/Android/i),this.iOS=navigator.userAgent.match(/iPhone|iPad|iPod/i),this.touch=isTouchDevice(),this.scaleFactor=this.mobile?1.5:1,this.hoverStyle={width:2,color:"#f50",join:"square",cap:"square"},this.drawSelectedBonds=!1,this.onChanged=void 0;var c=this;this.parent=jQuery(a),this.selectType=MODE_RECT_SEL,this.toolButtons=[],this.activeTool={id:"me-single",toolType:"bond",ty:1},this.atomDislayMask=0;var d=function(){c.toolButtonClicked(this)};$("#moledit .button.mode:not(.custom)").on("mousedown",function(){$("#moledit .button:not(.custom)").not(this).removeClass("selected"),$(this).toggleClass("selected")}),$("#me-rect, #me-lasso").on("mousedown",function(){$("#me-rect, #me-lasso").removeClass("selected"),$(this).toggleClass("selected")}),this.addToolBond(1,"me-single",d),this.addToolBond(2,"me-double",d),this.addToolBond(3,"me-triple",d),this.addToolBond(4,"me-updown",d),this.addTool("frag-0","me-frag-0",d),this.addTool("frag-1","me-frag-1",d),this.addTool("frag-2","me-frag-2",d),this.addTool("frag-3","me-frag-3",d),this.addTool("frag-4","me-frag-4",d),this.addTool("frag-5","me-frag-5",d),this.addTool("chain","me-chain",d),this.addTool("charge-add","me-charge-add",d),this.addTool("charge-sub","me-charge-sub",d),this.addTool("new","me-new",function(){c.clearMol()}),this.addTool("eraser","me-eraser",d),this.addTool("move","me-move",d),this.addTool("undo","me-undo",function(){c.undo()}),this.addTool("redo","me-redo",function(){c.redo()}),this.addTool("rect","me-rect",function(){c.selectType=MODE_RECT_SEL}),this.addTool("lasso","me-lasso",function(){c.selectType=MODE_LASSO_SEL}),this.addTool("deselect","me-deselect",function(){c.deselectAll(),c.drawMol()}),this.addTool("center","me-center",function(){c.updateZoom=!0,c.drawMol()}),this.addToolAtom("H","me-atom-h",d),this.addToolAtom("C","me-atom-c",d),this.addToolAtom("N","me-atom-n",d),this.addToolAtom("O","me-atom-o",d),this.addToolAtom("S","me-atom-s",d),this.addToolAtom("P","me-atom-p",d),this.canvas=b,this.canvas.style.backgroundColor="#ffffff",this.canvas.width=this.parent.width()*this.scaleFactor,this.canvas.height=this.parent.height()*this.scaleFactor,jQuery(this.canvas).css({width:this.parent.width(),height:this.parent.height()}),this.canvas.onselectstart=function(a){return a.preventDefault(),!1},this.undoStack=[],this.redoStack=[],this.chem=new Chemical,this.chemIsReady=!0,this.ctx=null,this.dragAtoms=[],this.lastPos=null,this.lastPosArr=[],this.endPos=null,this.lassoPath=[],this.h_atom=-1,this.h_bond=-1,this.rotateAroundPoint=null,this.connectToAtom=-1,this.button=-1,this.updateZoom=!0,this.mode=0,this.blockMouse=0,this.touch&&(this.canvas.addEventListener("touchstart",function(a){c.blockMouse++,c.onMouseDown(a,!0)},!1),window.addEventListener("touchmove",function(a){c.onMouseMove(a,!0)},!0),window.addEventListener("touchend",function(a){c.onMouseUp(a)},!1),window.addEventListener("touchcancel",function(a){c.onMouseUp(a)},!1)),this.canvas.addEventListener("mousedown",function(a){c.blockMouse>0?c.blockMouse--:c.onMouseDown(a,!1)},!1),window.addEventListener("mousemove",function(a){c.onMouseMove(a,!1)},!1),window.addEventListener("mouseup",function(a){c.onMouseUp(a)},!1),jQuery(document).on("keydown",function(a){0===jQuery("input:focus").length&&c.onKeyPress(a)}),jQuery(document).bind("keydown","ctrl+z",function(){c.undo()}),jQuery(document).bind("keydown","ctrl+shift+z",function(){c.redo()}),jQuery(document).bind("keydown","ctrl+y",function(){c.redo()}),this.zoomSpeed=.08,this.minKFC=5,this.parent.jMouseWheel(function(a){a.preventDefault();var b=1+a.deltaY/3*this.zoomSpeed,c=this.canvas.width/2,d=this.canvas.height/2,e=c-this.dx,f=d-this.dy;this.kfc*=b,this.kfc<this.minKFC&&(b=this.minKFC/(this.kfc/b),this.kfc=this.minKFC),this.dx=c-e*b,this.dy=d-f*b,this.updateZoom=!1,this.drawMol()}.bind(this)),this.kfc=40,this.dx=this.dy=0}function isMobile(){var a=!1;return function(b){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(b)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(b.substr(0,4)))&&(a=!0)}(navigator.userAgent||navigator.vendor||window.opera),a}function isTouchDevice(){return!!("ontouchstart"in window)||!!("onmsgesturechange"in window)&&!!window.navigator.maxTouchPoints}function unicodeSuperscript(a){return a.replace(/[0-9+−]/g,function(a){return unicodesupermap[a]})}function ucfirst(a){return a.charAt(0).toUpperCase()+a.slice(1)}function humanize(a){return a.replace(/(\b[A-Z]+\b)/g,function(a){return a.toLowerCase()})}function chemFormulaFormat(a){return a?a.replace(/-/g,"").replace(/\s/g,"").replace(/[\d,.][\d,.]*/g,"<sub>$&</sub>"):void 0}function isTouchDevice(){return!!("ontouchstart"in window)||!!("onmsgesturechange"in window)&&!!window.navigator.maxTouchPoints}function isMobile(){var a=!1;return function(b){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(b)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(b.substr(0,4)))&&(a=!0)}(navigator.userAgent||navigator.vendor||window.opera),a}function isIE(){var a=window.navigator.userAgent,b=a.indexOf("MSIE "),c=a.indexOf("Trident/");if(b>0)return parseInt(a.substring(b+5,a.indexOf(".",b)),10);if(c>0){var d=a.indexOf("rv:");return parseInt(a.substring(d+3,a.indexOf(".",d)),10)}return-1}function getQuery(){if(""===location.search)return{};var a=location.search.slice(1).split("&"),b={};return a.forEach(function(a){a=a.split(/=(.+)?/),b[a[0]]=decodeURIComponent(a[1]||"")}),b}function specialEncodeURIComponent(a){return a.replace(/&/g,"%26").replace(/#/g,"%23")}function launchFullscreen(a){a.requestFullscreen?a.requestFullscreen():a.mozRequestFullScreen?a.mozRequestFullScreen():a.webkitRequestFullscreen?a.webkitRequestFullscreen():a.msRequestFullscreen&&a.msRequestFullscreen()}function exitFullscreen(){document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen()}function dataURItoBlob(a){try{for(var b=atob(a.split(",")[1]),c=a.split(",")[0].split(":")[1].split(";")[0],d=new ArrayBuffer(b.length),e=new Uint8Array(d),f=0;f<b.length;f++)e[f]=b.charCodeAt(f);var g=new DataView(d),h=new Blob([g],{type:c});return h}catch(i){return null}}function openDataURL(a){var b=dataURItoBlob(a),c=window.URL||window.webkitURL||void 0;window.open(null!=b&&void 0!=c?c.createObjectURL(b):a)}function AJAX(a){return $.ajax(a)}function getISOLanguageCode(a){return-1!=a.indexOf(";")&&(a=a.substr(0,a.indexOf(";"))),-1!=a.indexOf("-")&&(a=a.substr(0,a.indexOf("-"))),-1!=a.indexOf("_")&&(a=a.substr(0,a.indexOf("_"))),a}!function(a,b){"object"==typeof module&&"object"==typeof module.exports?module.exports=a.document?b(a,!0):function(a){if(!a.document)throw Error("jQuery requires a window with a document");return b(a)}:b(a)}("undefined"!=typeof window?window:this,function(a,b){function c(a){var b=a.length,c=$.type(a);return"function"===c||$.isWindow(a)?!1:1===a.nodeType&&b?!0:"array"===c||0===b||"number"==typeof b&&b>0&&b-1 in a}function d(a,b,c){if($.isFunction(b))return $.grep(a,function(a,d){return!!b.call(a,d,a)!==c});if(b.nodeType)return $.grep(a,function(a){return a===b!==c});if("string"==typeof b){if(xc.test(b))return $.filter(b,a,c);b=$.filter(b,a)}return $.grep(a,function(a){return 0<=$.inArray(a,b)!==c})}function e(a,b){do a=a[b];while(a&&1!==a.nodeType);return a}function f(){zc.addEventListener?(zc.removeEventListener("DOMContentLoaded",g,!1),a.removeEventListener("load",g,!1)):(zc.detachEvent("onreadystatechange",g),a.detachEvent("onload",g))}function g(){(zc.addEventListener||"load"===event.type||"complete"===zc.readyState)&&(f(),$.ready())}function h(a,b,c){if(void 0===c&&1===a.nodeType)if(c="data-"+b.replace(Lc,"-$1").toLowerCase(),c=a.getAttribute(c),"string"==typeof c){try{c="true"===c?!0:"false"===c?!1:"null"===c?null:+c+""===c?+c:Kc.test(c)?$.parseJSON(c):c}catch(d){}$.data(a,b,c)}else c=void 0;return c}function i(a){for(var b in a)if(("data"!==b||!$.isEmptyObject(a[b]))&&"toJSON"!==b)return!1;return!0}function j(a,b,c,d){if($.acceptData(a)){var e=$.expando,f=a.nodeType,g=f?$.cache:a,h=f?a[e]:a[e]&&e;if(h&&g[h]&&(d||g[h].data)||void 0!==c||"string"!=typeof b)return h||(h=f?a[e]=Q.pop()||$.guid++:e),g[h]||(g[h]=f?{}:{toJSON:$.noop}),("object"==typeof b||"function"==typeof b)&&(d?g[h]=$.extend(g[h],b):g[h].data=$.extend(g[h].data,b)),a=g[h],d||(a.data||(a.data={}),a=a.data),void 0!==c&&(a[$.camelCase(b)]=c),"string"==typeof b?(c=a[b],null==c&&(c=a[$.camelCase(b)])):c=a,c}}function k(a,b,c){if($.acceptData(a)){var d,e,f=a.nodeType,g=f?$.cache:a,h=f?a[$.expando]:$.expando;if(g[h]){if(b&&(d=c?g[h]:g[h].data)){$.isArray(b)?b=b.concat($.map(b,$.camelCase)):b in d?b=[b]:(b=$.camelCase(b),b=b in d?[b]:b.split(" "));for(e=b.length;e--;)delete d[b[e]];if(c?!i(d):!$.isEmptyObject(d))return}if(!c&&(delete g[h].data,!i(g[h])))return;f?$.cleanData([a],!0):Z.deleteExpando||g!=g.window?delete g[h]:g[h]=null}}}function l(){return!0}function m(){return!1}function n(){try{return zc.activeElement}catch(a){}}function o(a){var b=bd.split("|");if(a=a.createDocumentFragment(),a.createElement)for(;b.length;)a.createElement(b.pop());return a}function p(a,b){var c,d,e=0,f=typeof a.getElementsByTagName!==Hc?a.getElementsByTagName(b||"*"):typeof a.querySelectorAll!==Hc?a.querySelectorAll(b||"*"):void 0;if(!f)for(f=[],c=a.childNodes||a;null!=(d=c[e]);e++)!b||$.nodeName(d,b)?f.push(d):$.merge(f,p(d,b));return void 0===b||b&&$.nodeName(a,b)?$.merge([a],f):f}function q(a){Qc.test(a.type)&&(a.defaultChecked=a.checked)}function r(a,b){return $.nodeName(a,"table")&&$.nodeName(11!==b.nodeType?b:b.firstChild,"tr")?a.getElementsByTagName("tbody")[0]||a.appendChild(a.ownerDocument.createElement("tbody")):a}function s(a){return a.type=(null!==$.find.attr(a,"type"))+"/"+a.type,a}function t(a){var b=md.exec(a.type);return b?a.type=b[1]:a.removeAttribute("type"),a}function u(a,b){for(var c,d=0;null!=(c=a[d]);d++)$._data(c,"globalEval",!b||$._data(b[d],"globalEval"))}function v(a,b){if(1===b.nodeType&&$.hasData(a)){var c,d,e;d=$._data(a);var f=$._data(b,d),g=d.events;if(g)for(c in delete f.handle,f.events={},g)for(d=0,e=g[c].length;e>d;d++)$.event.add(b,c,g[c][d]);f.data&&(f.data=$.extend({},f.data))}}function w(b,c){var d=$(c.createElement(b)).appendTo(c.body),e=a.getDefaultComputedStyle?a.getDefaultComputedStyle(d[0]).display:$.css(d[0],"display");return d.detach(),e}function x(a){var b=zc,c=td[a];return c||(c=w(a,b),"none"!==c&&c||(qd=(qd||$("<iframe frameborder='0' width='0' height='0'/>")).appendTo(b.documentElement),b=(qd[0].contentWindow||qd[0].contentDocument).document,b.write(),b.close(),c=w(a,b),qd.detach()),td[a]=c),c}function y(a,b){return{get:function(){var c=a();if(null!=c){if(!c)return(this.get=b).apply(this,arguments);delete this.get}}}}function z(a,b){if(b in a)return b;for(var c=b.charAt(0).toUpperCase()+b.slice(1),d=b,e=Qd.length;e--;)if(b=Qd[e]+c,b in a)return b;return d}function A(a,b){for(var c,d,e,f=[],g=0,h=a.length;h>g;g++)d=a[g],d.style&&(f[g]=$._data(d,"olddisplay"),c=d.style.display,b?(!f[g]&&"none"===c&&(d.style.display=""),""===d.style.display&&Oc(d)&&(f[g]=$._data(d,"olddisplay",x(d.nodeName)))):!f[g]&&(e=Oc(d),c&&"none"!==c||!e)&&$._data(d,"olddisplay",e?c:$.css(d,"display")));for(g=0;h>g;g++)d=a[g],!d.style||b&&"none"!==d.style.display&&""!==d.style.display||(d.style.display=b?f[g]||"":"none");return a}function B(a,b,c){return(a=Md.exec(b))?Math.max(0,a[1]-(c||0))+(a[2]||"px"):b}function C(a,b,c,d,e){b=c===(d?"border":"content")?4:"width"===b?1:0;for(var f=0;4>b;b+=2)"margin"===c&&(f+=$.css(a,c+Nc[b],!0,e)),d?("content"===c&&(f-=$.css(a,"padding"+Nc[b],!0,e)),"margin"!==c&&(f-=$.css(a,"border"+Nc[b]+"Width",!0,e))):(f+=$.css(a,"padding"+Nc[b],!0,e),"padding"!==c&&(f+=$.css(a,"border"+Nc[b]+"Width",!0,e)));return f}function D(a,b,c){var d=!0,e="width"===b?a.offsetWidth:a.offsetHeight,f=vd(a),g=Z.boxSizing()&&"border-box"===$.css(a,"boxSizing",!1,f);if(0>=e||null==e){if(e=wd(a,b,f),(0>e||null==e)&&(e=a.style[b]),yd.test(e))return e;d=g&&(Z.boxSizingReliable()||e===a.style[b]),e=parseFloat(e)||0}return e+C(a,b,c||(g?"border":"content"),d,f)+"px"}function E(a,b,c,d,e){return new E.prototype.init(a,b,c,d,e)}function F(){return setTimeout(function(){Rd=void 0}),Rd=$.now()}function G(a,b){var c,d={height:a},e=0;for(b=b?1:0;4>e;e+=2-b)c=Nc[e],d["margin"+c]=d["padding"+c]=a;return b&&(d.opacity=d.width=a),d}function H(a,b,c){for(var d,e=(Xd[b]||[]).concat(Xd["*"]),f=0,g=e.length;g>f;f++)if(d=e[f].call(c,b,a))return d}function I(a,b,c){var d,e,f=0,g=Wd.length,h=$.Deferred().always(function(){delete i.elem}),i=function(){if(e)return!1;for(var b=Rd||F(),b=Math.max(0,j.startTime+j.duration-b),c=1-(b/j.duration||0),d=0,f=j.tweens.length;f>d;d++)j.tweens[d].run(c);return h.notifyWith(a,[j,c,b]),1>c&&f?b:(h.resolveWith(a,[j]),!1)},j=h.promise({elem:a,props:$.extend({},b),opts:$.extend(!0,{specialEasing:{}},c),originalProperties:b,originalOptions:c,startTime:Rd||F(),duration:c.duration,tweens:[],createTween:function(b,c){var d=$.Tween(a,j.opts,b,c,j.opts.specialEasing[b]||j.opts.easing);return j.tweens.push(d),d},stop:function(b){var c=0,d=b?j.tweens.length:0;if(e)return this;for(e=!0;d>c;c++)j.tweens[c].run(1);return b?h.resolveWith(a,[j,b]):h.rejectWith(a,[j,b]),this}});b=j.props,c=j.opts.specialEasing;var k,l,m,n;for(d in b)if(k=$.camelCase(d),l=c[k],m=b[d],$.isArray(m)&&(l=m[1],m=b[d]=m[0]),d!==k&&(b[k]=m,delete b[d]),(n=$.cssHooks[k])&&"expand"in n)for(d in m=n.expand(m),delete b[k],m)d in b||(b[d]=m[d],c[d]=l);else c[k]=l;for(;g>f;f++)if(d=Wd[f].call(j,a,b,j.opts))return d;return $.map(b,H,j),$.isFunction(j.opts.start)&&j.opts.start.call(a,j),$.fx.timer($.extend(i,{elem:a,anim:j,queue:j.opts.queue})),j.progress(j.opts.progress).done(j.opts.done,j.opts.complete).fail(j.opts.fail).always(j.opts.always)}function J(a){return function(b,c){"string"!=typeof b&&(c=b,b="*");var d,e=0,f=b.toLowerCase().match(Dc)||[];if($.isFunction(c))for(;d=f[e++];)"+"===d.charAt(0)?(d=d.slice(1)||"*",(a[d]=a[d]||[]).unshift(c)):(a[d]=a[d]||[]).push(c)}}function K(a,b,c,d){function e(h){var i;return f[h]=!0,$.each(a[h]||[],function(a,h){var j=h(b,c,d);return"string"!=typeof j||g||f[j]?g?!(i=j):void 0:(b.dataTypes.unshift(j),e(j),!1)}),i}var f={},g=a===xe;return e(b.dataTypes[0])||!f["*"]&&e("*")}function L(a,b){var c,d,e=$.ajaxSettings.flatOptions||{};for(d in b)void 0!==b[d]&&((e[d]?a:c||(c={}))[d]=b[d]);return c&&$.extend(!0,a,c),a}function M(a,b,c,d){var e;if($.isArray(b))$.each(b,function(b,e){c||Be.test(a)?d(a,e):M(a+"["+("object"==typeof e?b:"")+"]",e,c,d)});else if(c||"object"!==$.type(b))d(a,b);else for(e in b)M(a+"["+e+"]",b[e],c,d)}function N(b){try{return b?new a.ActiveXObject("Microsoft.XMLHTTP"):new a.XMLHttpRequest}catch(c){}}function O(){try{return new a.XMLHttpRequest}catch(b){}}function P(a){return $.isWindow(a)?a:9===a.nodeType?a.defaultView||a.parentWindow:!1}var Q=[],R=Q.slice,S=Q.concat,T=Q.push,U=Q.indexOf,V={},W=V.toString,X=V.hasOwnProperty,Y="".trim,Z={},$=function(a,b){return new $.fn.init(a,b)},_=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,ab=/^-ms-/,bb=/-([\da-z])/gi,cb=function(a,b){return b.toUpperCase()};$.fn=$.prototype={jquery:"1.11.0",constructor:$,selector:"",length:0,toArray:function(){return R.call(this)},get:function(a){return null!=a?0>a?this[a+this.length]:this[a]:R.call(this)},pushStack:function(a){return a=$.merge(this.constructor(),a),a.prevObject=this,a.context=this.context,a},each:function(a,b){return $.each(this,a,b)},map:function(a){return this.pushStack($.map(this,function(b,c){return a.call(b,c,b)}))},slice:function(){return this.pushStack(R.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(a){var b=this.length;return a=+a+(0>a?b:0),this.pushStack(a>=0&&b>a?[this[a]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:T,sort:Q.sort,splice:Q.splice},$.extend=$.fn.extend=function(){var a,b,c,d,e,f=arguments[0]||{},g=1,h=arguments.length,i=!1;for("boolean"==typeof f&&(i=f,f=arguments[g]||{},g++),"object"!=typeof f&&!$.isFunction(f)&&(f={}),g===h&&(f=this,g--);h>g;g++)if(null!=(e=arguments[g]))for(d in e)a=f[d],c=e[d],f!==c&&(i&&c&&($.isPlainObject(c)||(b=$.isArray(c)))?(b?(b=!1,a=a&&$.isArray(a)?a:[]):a=a&&$.isPlainObject(a)?a:{},f[d]=$.extend(i,a,c)):void 0!==c&&(f[d]=c));return f},$.extend({expando:"jQuery"+("1.11.0"+Math.random()).replace(/\D/g,""),isReady:!0,error:function(a){throw Error(a)},noop:function(){},isFunction:function(a){return"function"===$.type(a)},isArray:Array.isArray||function(a){return"array"===$.type(a)},isWindow:function(a){return null!=a&&a==a.window},isNumeric:function(a){return 0<=a-parseFloat(a)},isEmptyObject:function(a){for(var b in a)return!1;return!0},isPlainObject:function(a){var b;if(!a||"object"!==$.type(a)||a.nodeType||$.isWindow(a))return!1;try{if(a.constructor&&!X.call(a,"constructor")&&!X.call(a.constructor.prototype,"isPrototypeOf"))return!1}catch(c){return!1}if(Z.ownLast)for(b in a)return X.call(a,b);for(b in a);return void 0===b||X.call(a,b)},type:function(a){return null==a?a+"":"object"==typeof a||"function"==typeof a?V[W.call(a)]||"object":typeof a},globalEval:function(b){b&&$.trim(b)&&(a.execScript||function(b){a.eval.call(a,b)})(b)},camelCase:function(a){return a.replace(ab,"ms-").replace(bb,cb)},nodeName:function(a,b){return a.nodeName&&a.nodeName.toLowerCase()===b.toLowerCase()},each:function(a,b,d){var e,f=0,g=a.length;if(e=c(a),d){if(e)for(;g>f&&(e=b.apply(a[f],d),!(!1===e));f++);else for(f in a)if(e=b.apply(a[f],d),!1===e)break}else if(e)for(;g>f&&(e=b.call(a[f],f,a[f]),!(!1===e));f++);else for(f in a)if(e=b.call(a[f],f,a[f]),!1===e)break;return a},trim:Y&&!Y.call("﻿ ")?function(a){return null==a?"":Y.call(a)}:function(a){return null==a?"":(a+"").replace(_,"")},makeArray:function(a,b){var d=b||[];return null!=a&&(c(Object(a))?$.merge(d,"string"==typeof a?[a]:a):T.call(d,a)),d},inArray:function(a,b,c){var d;if(b){if(U)return U.call(b,a,c);for(d=b.length,c=c?0>c?Math.max(0,d+c):c:0;d>c;c++)if(c in b&&b[c]===a)return c}return-1},merge:function(a,b){for(var c=+b.length,d=0,e=a.length;c>d;)a[e++]=b[d++];if(c!==c)for(;void 0!==b[d];)a[e++]=b[d++];return a.length=e,a},grep:function(a,b,c){for(var d=[],e=0,f=a.length,g=!c;f>e;e++)c=!b(a[e],e),c!==g&&d.push(a[e]);return d},map:function(a,b,d){var e,f=0,g=a.length,h=[];if(c(a))for(;g>f;f++)e=b(a[f],f,d),null!=e&&h.push(e);else for(f in a)e=b(a[f],f,d),null!=e&&h.push(e);return S.apply([],h)},guid:1,proxy:function(a,b){var c,d;return"string"==typeof b&&(d=a[b],b=a,a=d),$.isFunction(a)?(c=R.call(arguments,2),d=function(){return a.apply(b||this,c.concat(R.call(arguments)))},d.guid=a.guid=a.guid||$.guid++,d):void 0},now:function(){return+new Date},support:Z}),$.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(a,b){V["[object "+b+"]"]=b.toLowerCase()});var db,eb,fb,gb,hb,ib,jb,kb,lb,mb,nb,ob,pb,qb,rb,sb,tb,ub=a,vb=function(a,b,c,d){var e,f,g,h,i;if((b?b.ownerDocument||b:Ob)!==nb&&mb(b),b=b||nb,c=c||[],!a||"string"!=typeof a)return c;if(1!==(h=b.nodeType)&&9!==h)return[];if(pb&&!d){if(e=pc.exec(a))if(g=e[1]){if(9===h){if(!(f=b.getElementById(g))||!f.parentNode)return c;if(f.id===g)return c.push(f),c}else if(b.ownerDocument&&(f=b.ownerDocument.getElementById(g))&&tb(b,f)&&f.id===g)return c.push(f),c}else{if(e[2])return _b.apply(c,b.getElementsByTagName(a)),c;if((g=e[3])&&eb.getElementsByClassName&&b.getElementsByClassName)return _b.apply(c,b.getElementsByClassName(g)),c}if(eb.qsa&&(!qb||!qb.test(a))){if(f=e=Nb,g=b,i=9===h&&a,1===h&&"object"!==b.nodeName.toLowerCase()){for(h=Gb(a),(e=b.getAttribute("id"))?f=e.replace(rc,"\\$&"):b.setAttribute("id",f),f="[id='"+f+"'] ",g=h.length;g--;)h[g]=f+Hb(h[g]);g=qc.test(a)&&Eb(b.parentNode)||b,i=h.join(",")}if(i)try{return _b.apply(c,g.querySelectorAll(i)),c}catch(j){}finally{e||b.removeAttribute("id")}}}var k;a:{if(a=a.replace(fc,"$1"),f=Gb(a),!d&&1===f.length){if(e=f[0]=f[0].slice(0),2<e.length&&"ID"===(k=e[0]).type&&eb.getById&&9===b.nodeType&&pb&&fb.relative[e[1].type]){if(b=(fb.find.ID(k.matches[0].replace(sc,tc),b)||[])[0],!b){k=c;break a}a=a.slice(e.shift().value.length)}for(h=lc.needsContext.test(a)?0:e.length;h--&&(k=e[h],!fb.relative[g=k.type]);)if((g=fb.find[g])&&(d=g(k.matches[0].replace(sc,tc),qc.test(e[0].type)&&Eb(b.parentNode)||b))){if(e.splice(h,1),a=d.length&&Hb(e),!a){_b.apply(c,d),k=c;break a}break}}ib(a,f)(d,b,!pb,c,qc.test(a)&&Eb(b.parentNode)||b),k=c}return k},wb=function(){function a(c,d){return b.push(c+" ")>fb.cacheLength&&delete a[b.shift()],a[c+" "]=d}var b=[];return a},xb=function(a){return a[Nb]=!0,a},yb=function(a){var b=nb.createElement("div");try{return!!a(b)}catch(c){return!1}finally{b.parentNode&&b.parentNode.removeChild(b)}},zb=function(a,b){for(var c=a.split("|"),d=a.length;d--;)fb.attrHandle[c[d]]=b},Ab=function(a,b){var c=b&&a,d=c&&1===a.nodeType&&1===b.nodeType&&(~b.sourceIndex||Wb)-(~a.sourceIndex||Wb);if(d)return d;if(c)for(;c=c.nextSibling;)if(c===b)return-1;return a?1:-1},Bb=function(a){return function(b){return"input"===b.nodeName.toLowerCase()&&b.type===a}},Cb=function(a){return function(b){var c=b.nodeName.toLowerCase();return("input"===c||"button"===c)&&b.type===a}},Db=function(a){return xb(function(b){return b=+b,xb(function(c,d){for(var e,f=a([],c.length,b),g=f.length;g--;)c[e=f[g]]&&(c[e]=!(d[e]=c[e]))})})},Eb=function(a){return a&&typeof a.getElementsByTagName!==Vb&&a},Fb=function(){},Gb=function(a,b){var c,d,e,f,g,h,i;if(g=Sb[a+" "])return b?0:g.slice(0);for(g=a,h=[],i=fb.preFilter;g;){(!c||(d=gc.exec(g)))&&(d&&(g=g.slice(d[0].length)||g),h.push(e=[])),c=!1,(d=hc.exec(g))&&(c=d.shift(),e.push({value:c,type:d[0].replace(fc," ")}),g=g.slice(c.length));for(f in fb.filter)!(d=lc[f].exec(g))||i[f]&&!(d=i[f](d))||(c=d.shift(),e.push({value:c,type:f,matches:d}),g=g.slice(c.length));if(!c)break}return b?g.length:g?vb.error(a):Sb(a,h).slice(0)},Hb=function(a){for(var b=0,c=a.length,d="";c>b;b++)d+=a[b].value;return d},Ib=function(a,b,c){var d=b.dir,e=c&&"parentNode"===d,f=Qb++;return b.first?function(b,c,f){for(;b=b[d];)if(1===b.nodeType||e)return a(b,c,f)}:function(b,c,g){var h,i,j=[Pb,f];if(g){for(;b=b[d];)if((1===b.nodeType||e)&&a(b,c,g))return!0}else for(;b=b[d];)if(1===b.nodeType||e){if(i=b[Nb]||(b[Nb]={}),(h=i[d])&&h[0]===Pb&&h[1]===f)return j[2]=h[2];if(i[d]=j,j[2]=a(b,c,g))return!0}}},Jb=function(a){return 1<a.length?function(b,c,d){for(var e=a.length;e--;)if(!a[e](b,c,d))return!1;return!0}:a[0]},Kb=function(a,b,c,d,e){for(var f,g=[],h=0,i=a.length,j=null!=b;i>h;h++)(f=a[h])&&(!c||c(f,d,e))&&(g.push(f),j&&b.push(h));return g},Lb=function(a,b,c,d,e,f){return d&&!d[Nb]&&(d=Lb(d)),e&&!e[Nb]&&(e=Lb(e,f)),xb(function(f,g,h,i){var j,k,l,m=[],n=[],o=g.length;if(!(l=f)){l=b||"*";for(var p=h.nodeType?[h]:h,q=[],r=0,s=p.length;s>r;r++)vb(l,p[r],q);l=q}if(l=!a||!f&&b?l:Kb(l,m,a,h,i),p=c?e||(f?a:o||d)?[]:g:l,c&&c(l,p,h,i),d)for(j=Kb(p,n),d(j,[],h,i),h=j.length;h--;)(k=j[h])&&(p[n[h]]=!(l[n[h]]=k));if(f){if(e||a){if(e){for(j=[],h=p.length;h--;)(k=p[h])&&j.push(l[h]=k);e(null,p=[],j,i)}for(h=p.length;h--;)(k=p[h])&&-1<(j=e?bc.call(f,k):m[h])&&(f[j]=!(g[j]=k))}}else p=Kb(p===g?p.splice(o,p.length):p),e?e(null,g,p,i):_b.apply(g,p)})},Mb=function(a){var b,c,d,e=a.length,f=fb.relative[a[0].type];c=f||fb.relative[" "];for(var g=f?1:0,h=Ib(function(a){return a===b},c,!0),i=Ib(function(a){return-1<bc.call(b,a)},c,!0),j=[function(a,c,d){return!f&&(d||c!==jb)||((b=c).nodeType?h(a,c,d):i(a,c,d))}];e>g;g++)if(c=fb.relative[a[g].type])j=[Ib(Jb(j),c)];else{if(c=fb.filter[a[g].type].apply(null,a[g].matches),c[Nb]){for(d=++g;e>d&&!fb.relative[a[d].type];d++);return Lb(g>1&&Jb(j),g>1&&Hb(a.slice(0,g-1).concat({value:" "===a[g-2].type?"*":""})).replace(fc,"$1"),c,d>g&&Mb(a.slice(g,d)),e>d&&Mb(a=a.slice(d)),e>d&&Hb(a))}j.push(c)}return Jb(j)},Nb="sizzle"+-new Date,Ob=ub.document,Pb=0,Qb=0,Rb=wb(),Sb=wb(),Tb=wb(),Ub=function(a,b){return a===b&&(lb=!0),0},Vb="undefined",Wb=-2147483648,Xb={}.hasOwnProperty,Yb=[],Zb=Yb.pop,$b=Yb.push,_b=Yb.push,ac=Yb.slice,bc=Yb.indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(this[b]===a)return b;return-1},cc="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+".replace("w","w#"),dc="\\[[\\x20\\t\\r\\n\\f]*((?:\\\\.|[\\w-]|[^\\x00-\\xa0])+)[\\x20\\t\\r\\n\\f]*(?:([*^$|!~]?=)[\\x20\\t\\r\\n\\f]*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+cc+")|)|)[\\x20\\t\\r\\n\\f]*\\]",ec=":((?:\\\\.|[\\w-]|[^\\x00-\\xa0])+)(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+dc.replace(3,8)+")*)|.*)\\)|)",fc=RegExp("^[\\x20\\t\\r\\n\\f]+|((?:^|[^\\\\])(?:\\\\.)*)[\\x20\\t\\r\\n\\f]+$","g"),gc=/^[\x20\t\r\n\f]*,[\x20\t\r\n\f]*/,hc=/^[\x20\t\r\n\f]*([>+~]|[\x20\t\r\n\f])[\x20\t\r\n\f]*/,ic=RegExp("=[\\x20\\t\\r\\n\\f]*([^\\]'\"]*?)[\\x20\\t\\r\\n\\f]*\\]","g"),jc=RegExp(ec),kc=RegExp("^"+cc+"$"),lc={ID:/^#((?:\\.|[\w-]|[^\x00-\xa0])+)/,CLASS:/^\.((?:\\.|[\w-]|[^\x00-\xa0])+)/,TAG:RegExp("^("+"(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+".replace("w","w*")+")"),ATTR:RegExp("^"+dc),PSEUDO:RegExp("^"+ec),CHILD:RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\([\\x20\\t\\r\\n\\f]*(even|odd|(([+-]|)(\\d*)n|)[\\x20\\t\\r\\n\\f]*(?:([+-]|)[\\x20\\t\\r\\n\\f]*(\\d+)|))[\\x20\\t\\r\\n\\f]*\\)|)","i"),bool:RegExp("^(?:checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped)$","i"),needsContext:RegExp("^[\\x20\\t\\r\\n\\f]*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\([\\x20\\t\\r\\n\\f]*((?:-\\d)?\\d*)[\\x20\\t\\r\\n\\f]*\\)|)(?=[^-]|$)","i")},mc=/^(?:input|select|textarea|button)$/i,nc=/^h\d$/i,oc=/^[^{]+\{\s*\[native \w/,pc=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,qc=/[+~]/,rc=/'|\\/g,sc=RegExp("\\\\([\\da-f]{1,6}[\\x20\\t\\r\\n\\f]?|([\\x20\\t\\r\\n\\f])|.)","ig"),tc=function(a,b,c){return a="0x"+b-65536,a!==a||c?b:0>a?String.fromCharCode(a+65536):String.fromCharCode(a>>10|55296,1023&a|56320)
};try{_b.apply(Yb=ac.call(Ob.childNodes),Ob.childNodes),Yb[Ob.childNodes.length].nodeType}catch(uc){_b={apply:Yb.length?function(a,b){$b.apply(a,ac.call(b))}:function(a,b){for(var c=a.length,d=0;a[c++]=b[d++];);a.length=c-1}}}eb=vb.support={},hb=vb.isXML=function(a){return(a=a&&(a.ownerDocument||a).documentElement)?"HTML"!==a.nodeName:!1},mb=vb.setDocument=function(a){var b=a?a.ownerDocument||a:Ob;return a=b.defaultView,b!==nb&&9===b.nodeType&&b.documentElement?(nb=b,ob=b.documentElement,pb=!hb(b),a&&a!==a.top&&(a.addEventListener?a.addEventListener("unload",function(){mb()},!1):a.attachEvent&&a.attachEvent("onunload",function(){mb()})),eb.attributes=yb(function(a){return a.className="i",!a.getAttribute("className")}),eb.getElementsByTagName=yb(function(a){return a.appendChild(b.createComment("")),!a.getElementsByTagName("*").length}),eb.getElementsByClassName=oc.test(b.getElementsByClassName)&&yb(function(a){return a.innerHTML="<div class='a'></div><div class='a i'></div>",a.firstChild.className="i",2===a.getElementsByClassName("i").length}),eb.getById=yb(function(a){return ob.appendChild(a).id=Nb,!b.getElementsByName||!b.getElementsByName(Nb).length}),eb.getById?(fb.find.ID=function(a,b){if(typeof b.getElementById!==Vb&&pb){var c=b.getElementById(a);return c&&c.parentNode?[c]:[]}},fb.filter.ID=function(a){var b=a.replace(sc,tc);return function(a){return a.getAttribute("id")===b}}):(delete fb.find.ID,fb.filter.ID=function(a){var b=a.replace(sc,tc);return function(a){return(a=typeof a.getAttributeNode!==Vb&&a.getAttributeNode("id"))&&a.value===b}}),fb.find.TAG=eb.getElementsByTagName?function(a,b){return typeof b.getElementsByTagName!==Vb?b.getElementsByTagName(a):void 0}:function(a,b){var c,d=[],e=0,f=b.getElementsByTagName(a);if("*"===a){for(;c=f[e++];)1===c.nodeType&&d.push(c);return d}return f},fb.find.CLASS=eb.getElementsByClassName&&function(a,b){return typeof b.getElementsByClassName!==Vb&&pb?b.getElementsByClassName(a):void 0},rb=[],qb=[],(eb.qsa=oc.test(b.querySelectorAll))&&(yb(function(a){a.innerHTML="<select t=''><option selected=''></option></select>",a.querySelectorAll("[t^='']").length&&qb.push("[*^$]=[\\x20\\t\\r\\n\\f]*(?:''|\"\")"),a.querySelectorAll("[selected]").length||qb.push("\\[[\\x20\\t\\r\\n\\f]*(?:value|checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped)"),a.querySelectorAll(":checked").length||qb.push(":checked")}),yb(function(a){var c=b.createElement("input");c.setAttribute("type","hidden"),a.appendChild(c).setAttribute("name","D"),a.querySelectorAll("[name=d]").length&&qb.push("name[\\x20\\t\\r\\n\\f]*[*^$|!~]?="),a.querySelectorAll(":enabled").length||qb.push(":enabled",":disabled"),a.querySelectorAll("*,:x"),qb.push(",.*:")})),(eb.matchesSelector=oc.test(sb=ob.webkitMatchesSelector||ob.mozMatchesSelector||ob.oMatchesSelector||ob.msMatchesSelector))&&yb(function(a){eb.disconnectedMatch=sb.call(a,"div"),sb.call(a,"[s!='']:x"),rb.push("!=",ec)}),qb=qb.length&&RegExp(qb.join("|")),rb=rb.length&&RegExp(rb.join("|")),tb=(a=oc.test(ob.compareDocumentPosition))||oc.test(ob.contains)?function(a,b){var c=9===a.nodeType?a.documentElement:a,d=b&&b.parentNode;return a===d||!(!d||1!==d.nodeType||!(c.contains?c.contains(d):a.compareDocumentPosition&&16&a.compareDocumentPosition(d)))}:function(a,b){if(b)for(;b=b.parentNode;)if(b===a)return!0;return!1},Ub=a?function(a,c){if(a===c)return lb=!0,0;var d=!a.compareDocumentPosition-!c.compareDocumentPosition;return d?d:(d=(a.ownerDocument||a)===(c.ownerDocument||c)?a.compareDocumentPosition(c):1,1&d||!eb.sortDetached&&c.compareDocumentPosition(a)===d?a===b||a.ownerDocument===Ob&&tb(Ob,a)?-1:c===b||c.ownerDocument===Ob&&tb(Ob,c)?1:kb?bc.call(kb,a)-bc.call(kb,c):0:4&d?-1:1)}:function(a,c){if(a===c)return lb=!0,0;var d,e=0;d=a.parentNode;var f=c.parentNode,g=[a],h=[c];if(!d||!f)return a===b?-1:c===b?1:d?-1:f?1:kb?bc.call(kb,a)-bc.call(kb,c):0;if(d===f)return Ab(a,c);for(d=a;d=d.parentNode;)g.unshift(d);for(d=c;d=d.parentNode;)h.unshift(d);for(;g[e]===h[e];)e++;return e?Ab(g[e],h[e]):g[e]===Ob?-1:h[e]===Ob?1:0},b):nb},vb.matches=function(a,b){return vb(a,null,null,b)},vb.matchesSelector=function(a,b){if((a.ownerDocument||a)!==nb&&mb(a),b=b.replace(ic,"='$1']"),!(!eb.matchesSelector||!pb||rb&&rb.test(b)||qb&&qb.test(b)))try{var c=sb.call(a,b);if(c||eb.disconnectedMatch||a.document&&11!==a.document.nodeType)return c}catch(d){}return 0<vb(b,nb,null,[a]).length},vb.contains=function(a,b){return(a.ownerDocument||a)!==nb&&mb(a),tb(a,b)},vb.attr=function(a,b){(a.ownerDocument||a)!==nb&&mb(a);var c=fb.attrHandle[b.toLowerCase()],c=c&&Xb.call(fb.attrHandle,b.toLowerCase())?c(a,b,!pb):void 0;return void 0!==c?c:eb.attributes||!pb?a.getAttribute(b):(c=a.getAttributeNode(b))&&c.specified?c.value:null},vb.error=function(a){throw Error("Syntax error, unrecognized expression: "+a)},vb.uniqueSort=function(a){var b,c=[],d=0,e=0;if(lb=!eb.detectDuplicates,kb=!eb.sortStable&&a.slice(0),a.sort(Ub),lb){for(;b=a[e++];)b===a[e]&&(d=c.push(e));for(;d--;)a.splice(c[d],1)}return kb=null,a},gb=vb.getText=function(a){var b,c="",d=0;if(b=a.nodeType){if(1===b||9===b||11===b){if("string"==typeof a.textContent)return a.textContent;for(a=a.firstChild;a;a=a.nextSibling)c+=gb(a)}else if(3===b||4===b)return a.nodeValue}else for(;b=a[d++];)c+=gb(b);return c},fb=vb.selectors={cacheLength:50,createPseudo:xb,match:lc,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(a){return a[1]=a[1].replace(sc,tc),a[3]=(a[4]||a[5]||"").replace(sc,tc),"~="===a[2]&&(a[3]=" "+a[3]+" "),a.slice(0,4)},CHILD:function(a){return a[1]=a[1].toLowerCase(),"nth"===a[1].slice(0,3)?(a[3]||vb.error(a[0]),a[4]=+(a[4]?a[5]+(a[6]||1):2*("even"===a[3]||"odd"===a[3])),a[5]=+(a[7]+a[8]||"odd"===a[3])):a[3]&&vb.error(a[0]),a},PSEUDO:function(a){var b,c=!a[5]&&a[2];return lc.CHILD.test(a[0])?null:(a[3]&&void 0!==a[4]?a[2]=a[4]:c&&jc.test(c)&&(b=Gb(c,!0))&&(b=c.indexOf(")",c.length-b)-c.length)&&(a[0]=a[0].slice(0,b),a[2]=c.slice(0,b)),a.slice(0,3))}},filter:{TAG:function(a){var b=a.replace(sc,tc).toLowerCase();return"*"===a?function(){return!0}:function(a){return a.nodeName&&a.nodeName.toLowerCase()===b}},CLASS:function(a){var b=Rb[a+" "];return b||(b=RegExp("(^|[\\x20\\t\\r\\n\\f])"+a+"([\\x20\\t\\r\\n\\f]|$)"))&&Rb(a,function(a){return b.test("string"==typeof a.className&&a.className||typeof a.getAttribute!==Vb&&a.getAttribute("class")||"")})},ATTR:function(a,b,c){return function(d){return d=vb.attr(d,a),null==d?"!="===b:b?(d+="","="===b?d===c:"!="===b?d!==c:"^="===b?c&&0===d.indexOf(c):"*="===b?c&&-1<d.indexOf(c):"$="===b?c&&d.slice(-c.length)===c:"~="===b?-1<(" "+d+" ").indexOf(c):"|="===b?d===c||d.slice(0,c.length+1)===c+"-":!1):!0}},CHILD:function(a,b,c,d,e){var f="nth"!==a.slice(0,3),g="last"!==a.slice(-4),h="of-type"===b;return 1===d&&0===e?function(a){return!!a.parentNode}:function(b,c,i){var j,k,l,m,n;c=f!==g?"nextSibling":"previousSibling";var o=b.parentNode,p=h&&b.nodeName.toLowerCase();if(i=!i&&!h,o){if(f){for(;c;){for(k=b;k=k[c];)if(h?k.nodeName.toLowerCase()===p:1===k.nodeType)return!1;n=c="only"===a&&!n&&"nextSibling"}return!0}if(n=[g?o.firstChild:o.lastChild],g&&i){for(i=o[Nb]||(o[Nb]={}),j=i[a]||[],m=j[0]===Pb&&j[1],l=j[0]===Pb&&j[2],k=m&&o.childNodes[m];k=++m&&k&&k[c]||(l=m=0)||n.pop();)if(1===k.nodeType&&++l&&k===b){i[a]=[Pb,m,l];break}}else if(i&&(j=(b[Nb]||(b[Nb]={}))[a])&&j[0]===Pb)l=j[1];else for(;(k=++m&&k&&k[c]||(l=m=0)||n.pop())&&((h?k.nodeName.toLowerCase()!==p:1!==k.nodeType)||!++l||(i&&((k[Nb]||(k[Nb]={}))[a]=[Pb,l]),k!==b)););return l-=e,l===d||0===l%d&&l/d>=0}}},PSEUDO:function(a,b){var c,d=fb.pseudos[a]||fb.setFilters[a.toLowerCase()]||vb.error("unsupported pseudo: "+a);return d[Nb]?d(b):1<d.length?(c=[a,a,"",b],fb.setFilters.hasOwnProperty(a.toLowerCase())?xb(function(a,c){for(var e,f=d(a,b),g=f.length;g--;)e=bc.call(a,f[g]),a[e]=!(c[e]=f[g])}):function(a){return d(a,0,c)}):d}},pseudos:{not:xb(function(a){var b=[],c=[],d=ib(a.replace(fc,"$1"));return d[Nb]?xb(function(a,b,c,e){e=d(a,null,e,[]);for(var f=a.length;f--;)(c=e[f])&&(a[f]=!(b[f]=c))}):function(a,e,f){return b[0]=a,d(b,null,f,c),!c.pop()}}),has:xb(function(a){return function(b){return 0<vb(a,b).length}}),contains:xb(function(a){return function(b){return-1<(b.textContent||b.innerText||gb(b)).indexOf(a)}}),lang:xb(function(a){return kc.test(a||"")||vb.error("unsupported lang: "+a),a=a.replace(sc,tc).toLowerCase(),function(b){var c;do if(c=pb?b.lang:b.getAttribute("xml:lang")||b.getAttribute("lang"))return c=c.toLowerCase(),c===a||0===c.indexOf(a+"-");while((b=b.parentNode)&&1===b.nodeType);return!1}}),target:function(a){var b=ub.location&&ub.location.hash;return b&&b.slice(1)===a.id},root:function(a){return a===ob},focus:function(a){return!(a!==nb.activeElement||nb.hasFocus&&!nb.hasFocus()||!a.type&&!a.href&&!~a.tabIndex)},enabled:function(a){return!1===a.disabled},disabled:function(a){return!0===a.disabled},checked:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&!!a.checked||"option"===b&&!!a.selected},selected:function(a){return a.parentNode&&a.parentNode.selectedIndex,!0===a.selected},empty:function(a){for(a=a.firstChild;a;a=a.nextSibling)if(6>a.nodeType)return!1;return!0},parent:function(a){return!fb.pseudos.empty(a)},header:function(a){return nc.test(a.nodeName)},input:function(a){return mc.test(a.nodeName)},button:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&"button"===a.type||"button"===b},text:function(a){var b;return"input"===a.nodeName.toLowerCase()&&"text"===a.type&&(null==(b=a.getAttribute("type"))||"text"===b.toLowerCase())},first:Db(function(){return[0]}),last:Db(function(a,b){return[b-1]}),eq:Db(function(a,b,c){return[0>c?c+b:c]}),even:Db(function(a,b){for(var c=0;b>c;c+=2)a.push(c);return a}),odd:Db(function(a,b){for(var c=1;b>c;c+=2)a.push(c);return a}),lt:Db(function(a,b,c){for(b=0>c?c+b:c;0<=--b;)a.push(b);return a}),gt:Db(function(a,b,c){for(c=0>c?c+b:c;++c<b;)a.push(c);return a})}},fb.pseudos.nth=fb.pseudos.eq;for(db in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})fb.pseudos[db]=Bb(db);for(db in{submit:!0,reset:!0})fb.pseudos[db]=Cb(db);Fb.prototype=fb.filters=fb.pseudos,fb.setFilters=new Fb,ib=vb.compile=function(a,b){var c,d=[],e=[],f=Tb[a+" "];if(!f){for(b||(b=Gb(a)),c=b.length;c--;)f=Mb(b[c]),f[Nb]?d.push(f):e.push(f);var g=0<d.length,h=0<e.length;c=function(a,b,c,f,i){var j,k,l,m=0,n="0",o=a&&[],p=[],q=jb,r=a||h&&fb.find.TAG("*",i),s=Pb+=null==q?1:Math.random()||.1,t=r.length;for(i&&(jb=b!==nb&&b);n!==t&&null!=(j=r[n]);n++){if(h&&j){for(k=0;l=e[k++];)if(l(j,b,c)){f.push(j);break}i&&(Pb=s)}g&&((j=!l&&j)&&m--,a&&o.push(j))}if(m+=n,g&&n!==m){for(k=0;l=d[k++];)l(o,p,b,c);if(a){if(m>0)for(;n--;)!o[n]&&!p[n]&&(p[n]=Zb.call(f));p=Kb(p)}_b.apply(f,p),i&&!a&&0<p.length&&1<m+d.length&&vb.uniqueSort(f)}return i&&(Pb=s,jb=q),o},c=g?xb(c):c,f=Tb(a,c)}return f},eb.sortStable=Nb.split("").sort(Ub).join("")===Nb,eb.detectDuplicates=!!lb,mb(),eb.sortDetached=yb(function(a){return 1&a.compareDocumentPosition(nb.createElement("div"))}),yb(function(a){return a.innerHTML="<a href='#'></a>","#"===a.firstChild.getAttribute("href")})||zb("type|href|height|width",function(a,b,c){return c?void 0:a.getAttribute(b,"type"===b.toLowerCase()?1:2)}),(!eb.attributes||!yb(function(a){return a.innerHTML="<input/>",a.firstChild.setAttribute("value",""),""===a.firstChild.getAttribute("value")}))&&zb("value",function(a,b,c){return c||"input"!==a.nodeName.toLowerCase()?void 0:a.defaultValue}),yb(function(a){return null==a.getAttribute("disabled")})||zb("checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",function(a,b,c){var d;return c?void 0:!0===a[b]?b.toLowerCase():(d=a.getAttributeNode(b))&&d.specified?d.value:null}),$.find=vb,$.expr=vb.selectors,$.expr[":"]=$.expr.pseudos,$.unique=vb.uniqueSort,$.text=vb.getText,$.isXMLDoc=vb.isXML,$.contains=vb.contains;var vc=$.expr.match.needsContext,wc=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,xc=/^.[^:#\[\.,]*$/;$.filter=function(a,b,c){var d=b[0];return c&&(a=":not("+a+")"),1===b.length&&1===d.nodeType?$.find.matchesSelector(d,a)?[d]:[]:$.find.matches(a,$.grep(b,function(a){return 1===a.nodeType}))},$.fn.extend({find:function(a){var b,c=[],d=this,e=d.length;if("string"!=typeof a)return this.pushStack($(a).filter(function(){for(b=0;e>b;b++)if($.contains(d[b],this))return!0}));for(b=0;e>b;b++)$.find(a,d[b],c);return c=this.pushStack(e>1?$.unique(c):c),c.selector=this.selector?this.selector+" "+a:a,c},filter:function(a){return this.pushStack(d(this,a||[],!1))},not:function(a){return this.pushStack(d(this,a||[],!0))},is:function(a){return!!d(this,"string"==typeof a&&vc.test(a)?$(a):a||[],!1).length}});var yc,zc=a.document,Ac=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/;($.fn.init=function(a,b){var c,d;if(!a)return this;if("string"==typeof a){if((c="<"===a.charAt(0)&&">"===a.charAt(a.length-1)&&3<=a.length?[null,a,null]:Ac.exec(a))&&(c[1]||!b)){if(c[1]){if(b=b instanceof $?b[0]:b,$.merge(this,$.parseHTML(c[1],b&&b.nodeType?b.ownerDocument||b:zc,!0)),wc.test(c[1])&&$.isPlainObject(b))for(c in b)$.isFunction(this[c])?this[c](b[c]):this.attr(c,b[c])}else{if((d=zc.getElementById(c[2]))&&d.parentNode){if(d.id!==c[2])return yc.find(a);this.length=1,this[0]=d}this.context=zc,this.selector=a}return this}return!b||b.jquery?(b||yc).find(a):this.constructor(b).find(a)}return a.nodeType?(this.context=this[0]=a,this.length=1,this):$.isFunction(a)?"undefined"!=typeof yc.ready?yc.ready(a):a($):(void 0!==a.selector&&(this.selector=a.selector,this.context=a.context),$.makeArray(a,this))}).prototype=$.fn,yc=$(zc);var Bc=/^(?:parents|prev(?:Until|All))/,Cc={children:!0,contents:!0,next:!0,prev:!0};$.extend({dir:function(a,b,c){var d=[];for(a=a[b];a&&9!==a.nodeType&&(void 0===c||1!==a.nodeType||!$(a).is(c));)1===a.nodeType&&d.push(a),a=a[b];return d},sibling:function(a,b){for(var c=[];a;a=a.nextSibling)1===a.nodeType&&a!==b&&c.push(a);return c}}),$.fn.extend({has:function(a){var b,c=$(a,this),d=c.length;return this.filter(function(){for(b=0;d>b;b++)if($.contains(this,c[b]))return!0})},closest:function(a,b){for(var c,d=0,e=this.length,f=[],g=vc.test(a)||"string"!=typeof a?$(a,b||this.context):0;e>d;d++)for(c=this[d];c&&c!==b;c=c.parentNode)if(11>c.nodeType&&(g?-1<g.index(c):1===c.nodeType&&$.find.matchesSelector(c,a))){f.push(c);break}return this.pushStack(1<f.length?$.unique(f):f)},index:function(a){return a?"string"==typeof a?$.inArray(this[0],$(a)):$.inArray(a.jquery?a[0]:a,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(a,b){return this.pushStack($.unique($.merge(this.get(),$(a,b))))},addBack:function(a){return this.add(null==a?this.prevObject:this.prevObject.filter(a))}}),$.each({parent:function(a){return(a=a.parentNode)&&11!==a.nodeType?a:null},parents:function(a){return $.dir(a,"parentNode")},parentsUntil:function(a,b,c){return $.dir(a,"parentNode",c)},next:function(a){return e(a,"nextSibling")},prev:function(a){return e(a,"previousSibling")},nextAll:function(a){return $.dir(a,"nextSibling")},prevAll:function(a){return $.dir(a,"previousSibling")},nextUntil:function(a,b,c){return $.dir(a,"nextSibling",c)},prevUntil:function(a,b,c){return $.dir(a,"previousSibling",c)},siblings:function(a){return $.sibling((a.parentNode||{}).firstChild,a)},children:function(a){return $.sibling(a.firstChild)},contents:function(a){return $.nodeName(a,"iframe")?a.contentDocument||a.contentWindow.document:$.merge([],a.childNodes)}},function(a,b){$.fn[a]=function(c,d){var e=$.map(this,b,c);return"Until"!==a.slice(-5)&&(d=c),d&&"string"==typeof d&&(e=$.filter(d,e)),1<this.length&&(Cc[a]||(e=$.unique(e)),Bc.test(a)&&(e=e.reverse())),this.pushStack(e)}});var Dc=/\S+/g,Ec={};$.Callbacks=function(a){var b;if("string"==typeof a){if(!(b=Ec[a])){b=a;var c=Ec[b]={};$.each(b.match(Dc)||[],function(a,b){c[b]=!0}),b=c}}else b=$.extend({},a);a=b;var d,e,f,g,h,i,j=[],k=!a.once&&[],l=function(b){for(e=a.memory&&b,f=!0,h=i||0,i=0,g=j.length,d=!0;j&&g>h;h++)if(!1===j[h].apply(b[0],b[1])&&a.stopOnFalse){e=!1;break}d=!1,j&&(k?k.length&&l(k.shift()):e?j=[]:m.disable())},m={add:function(){if(j){var b=j.length;!function c(b){$.each(b,function(b,d){var e=$.type(d);"function"===e?(!a.unique||!m.has(d))&&j.push(d):d&&d.length&&"string"!==e&&c(d)})}(arguments),d?g=j.length:e&&(i=b,l(e))}return this},remove:function(){return j&&$.each(arguments,function(a,b){for(var c;-1<(c=$.inArray(b,j,c));)j.splice(c,1),d&&(g>=c&&g--,h>=c&&h--)}),this},has:function(a){return a?-1<$.inArray(a,j):!(!j||!j.length)},empty:function(){return j=[],g=0,this},disable:function(){return j=k=e=void 0,this},disabled:function(){return!j},lock:function(){return k=void 0,e||m.disable(),this},locked:function(){return!k},fireWith:function(a,b){return!j||f&&!k||(b=b||[],b=[a,b.slice?b.slice():b],d?k.push(b):l(b)),this},fire:function(){return m.fireWith(this,arguments),this},fired:function(){return!!f}};return m},$.extend({Deferred:function(a){var b=[["resolve","done",$.Callbacks("once memory"),"resolved"],["reject","fail",$.Callbacks("once memory"),"rejected"],["notify","progress",$.Callbacks("memory")]],c="pending",d={state:function(){return c},always:function(){return e.done(arguments).fail(arguments),this},then:function(){var a=arguments;return $.Deferred(function(c){$.each(b,function(b,f){var g=$.isFunction(a[b])&&a[b];e[f[1]](function(){var a=g&&g.apply(this,arguments);a&&$.isFunction(a.promise)?a.promise().done(c.resolve).fail(c.reject).progress(c.notify):c[f[0]+"With"](this===d?c.promise():this,g?[a]:arguments)})}),a=null}).promise()},promise:function(a){return null!=a?$.extend(a,d):d}},e={};return d.pipe=d.then,$.each(b,function(a,f){var g=f[2],h=f[3];d[f[1]]=g.add,h&&g.add(function(){c=h},b[1^a][2].disable,b[2][2].lock),e[f[0]]=function(){return e[f[0]+"With"](this===e?d:this,arguments),this},e[f[0]+"With"]=g.fireWith}),d.promise(e),a&&a.call(e,e),e},when:function(a){var b,c,d,e=0,f=R.call(arguments),g=f.length,h=1!==g||a&&$.isFunction(a.promise)?g:0,i=1===h?a:$.Deferred(),j=function(a,c,d){return function(e){c[a]=this,d[a]=1<arguments.length?R.call(arguments):e,d===b?i.notifyWith(c,d):--h||i.resolveWith(c,d)}};if(g>1)for(b=Array(g),c=Array(g),d=Array(g);g>e;e++)f[e]&&$.isFunction(f[e].promise)?f[e].promise().done(j(e,d,f)).fail(i.reject).progress(j(e,c,b)):--h;return h||i.resolveWith(d,f),i.promise()}});var Fc;$.fn.ready=function(a){return $.ready.promise().done(a),this},$.extend({isReady:!1,readyWait:1,holdReady:function(a){a?$.readyWait++:$.ready(!0)},ready:function(a){if(!(!0===a?--$.readyWait:$.isReady)){if(!zc.body)return setTimeout($.ready);$.isReady=!0,!0!==a&&0<--$.readyWait||(Fc.resolveWith(zc,[$]),$.fn.trigger&&$(zc).trigger("ready").off("ready"))}}}),$.ready.promise=function(b){if(!Fc)if(Fc=$.Deferred(),"complete"===zc.readyState)setTimeout($.ready);else if(zc.addEventListener)zc.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1);else{zc.attachEvent("onreadystatechange",g),a.attachEvent("onload",g);var c=!1;try{c=null==a.frameElement&&zc.documentElement}catch(d){}c&&c.doScroll&&function e(){if(!$.isReady){try{c.doScroll("left")}catch(a){return setTimeout(e,50)}f(),$.ready()}}()}return Fc.promise(b)};var Gc,Hc="undefined";for(Gc in $(Z))break;Z.ownLast="0"!==Gc,Z.inlineBlockNeedsLayout=!1,$(function(){var a,b,c=zc.getElementsByTagName("body")[0];c&&(a=zc.createElement("div"),a.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px",b=zc.createElement("div"),c.appendChild(a).appendChild(b),typeof b.style.zoom!==Hc&&(b.style.cssText="border:0;margin:0;width:1px;padding:1px;display:inline;zoom:1",Z.inlineBlockNeedsLayout=3===b.offsetWidth)&&(c.style.zoom=1),c.removeChild(a))});var Ic=zc.createElement("div");if(null==Z.deleteExpando){Z.deleteExpando=!0;try{delete Ic.test}catch(Jc){Z.deleteExpando=!1}}$.acceptData=function(a){var b=$.noData[(a.nodeName+" ").toLowerCase()],c=+a.nodeType||1;return 1!==c&&9!==c?!1:!b||!0!==b&&a.getAttribute("classid")===b};var Kc=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,Lc=/([A-Z])/g;$.extend({cache:{},noData:{"applet ":!0,"embed ":!0,"object ":"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"},hasData:function(a){return a=a.nodeType?$.cache[a[$.expando]]:a[$.expando],!!a&&!i(a)},data:function(a,b,c){return j(a,b,c)},removeData:function(a,b){return k(a,b)},_data:function(a,b,c){return j(a,b,c,!0)},_removeData:function(a,b){return k(a,b,!0)}}),$.fn.extend({data:function(a,b){var c,d,e,f=this[0],g=f&&f.attributes;if(void 0===a){if(this.length&&(e=$.data(f),1===f.nodeType&&!$._data(f,"parsedAttrs"))){for(c=g.length;c--;)d=g[c].name,0===d.indexOf("data-")&&(d=$.camelCase(d.slice(5)),h(f,d,e[d]));$._data(f,"parsedAttrs",!0)}return e}return"object"==typeof a?this.each(function(){$.data(this,a)}):1<arguments.length?this.each(function(){$.data(this,a,b)}):f?h(f,a,$.data(f,a)):void 0},removeData:function(a){return this.each(function(){$.removeData(this,a)})}}),$.extend({queue:function(a,b,c){var d;return a?(b=(b||"fx")+"queue",d=$._data(a,b),c&&(!d||$.isArray(c)?d=$._data(a,b,$.makeArray(c)):d.push(c)),d||[]):void 0},dequeue:function(a,b){b=b||"fx";var c=$.queue(a,b),d=c.length,e=c.shift(),f=$._queueHooks(a,b),g=function(){$.dequeue(a,b)};"inprogress"===e&&(e=c.shift(),d--),e&&("fx"===b&&c.unshift("inprogress"),delete f.stop,e.call(a,g,f)),!d&&f&&f.empty.fire()},_queueHooks:function(a,b){var c=b+"queueHooks";return $._data(a,c)||$._data(a,c,{empty:$.Callbacks("once memory").add(function(){$._removeData(a,b+"queue"),$._removeData(a,c)})})}}),$.fn.extend({queue:function(a,b){var c=2;return"string"!=typeof a&&(b=a,a="fx",c--),arguments.length<c?$.queue(this[0],a):void 0===b?this:this.each(function(){var c=$.queue(this,a,b);$._queueHooks(this,a),"fx"===a&&"inprogress"!==c[0]&&$.dequeue(this,a)})},dequeue:function(a){return this.each(function(){$.dequeue(this,a)})},clearQueue:function(a){return this.queue(a||"fx",[])},promise:function(a,b){var c,d=1,e=$.Deferred(),f=this,g=this.length,h=function(){--d||e.resolveWith(f,[f])};for("string"!=typeof a&&(b=a,a=void 0),a=a||"fx";g--;)(c=$._data(f[g],a+"queueHooks"))&&c.empty&&(d++,c.empty.add(h));return h(),e.promise(b)}});var Mc=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,Nc=["Top","Right","Bottom","Left"],Oc=function(a,b){return a=b||a,"none"===$.css(a,"display")||!$.contains(a.ownerDocument,a)},Pc=$.access=function(a,b,c,d,e,f,g){var h=0,i=a.length,j=null==c;if("object"===$.type(c))for(h in e=!0,c)$.access(a,b,h,c[h],!0,f,g);else if(void 0!==d&&(e=!0,$.isFunction(d)||(g=!0),j&&(g?(b.call(a,d),b=null):(j=b,b=function(a,b,c){return j.call($(a),c)})),b))for(;i>h;h++)b(a[h],c,g?d:d.call(a[h],h,b(a[h],c)));return e?a:j?b.call(a):i?b(a[0],c):f},Qc=/^(?:checkbox|radio)$/i,Rc=zc.createDocumentFragment(),Sc=zc.createElement("div"),Tc=zc.createElement("input");if(Sc.setAttribute("className","t"),Sc.innerHTML="  <link/><table></table><a href='/a'>a</a>",Z.leadingWhitespace=3===Sc.firstChild.nodeType,Z.tbody=!Sc.getElementsByTagName("tbody").length,Z.htmlSerialize=!!Sc.getElementsByTagName("link").length,Z.html5Clone="<:nav></:nav>"!==zc.createElement("nav").cloneNode(!0).outerHTML,Tc.type="checkbox",Tc.checked=!0,Rc.appendChild(Tc),Z.appendChecked=Tc.checked,Sc.innerHTML="<textarea>x</textarea>",Z.noCloneChecked=!!Sc.cloneNode(!0).lastChild.defaultValue,Rc.appendChild(Sc),Sc.innerHTML="<input type='radio' checked='checked' name='t'/>",Z.checkClone=Sc.cloneNode(!0).cloneNode(!0).lastChild.checked,Z.noCloneEvent=!0,Sc.attachEvent&&(Sc.attachEvent("onclick",function(){Z.noCloneEvent=!1}),Sc.cloneNode(!0).click()),null==Z.deleteExpando){Z.deleteExpando=!0;try{delete Sc.test}catch(Uc){Z.deleteExpando=!1}}var Vc,Wc,Rc=Sc=Tc=null,Xc=zc.createElement("div");for(Vc in{submit:!0,change:!0,focusin:!0})Wc="on"+Vc,(Z[Vc+"Bubbles"]=Wc in a)||(Xc.setAttribute(Wc,"t"),Z[Vc+"Bubbles"]=!1===Xc.attributes[Wc].expando);var Yc=/^(?:input|select|textarea)$/i,Zc=/^key/,$c=/^(?:mouse|contextmenu)|click/,_c=/^(?:focusinfocus|focusoutblur)$/,ad=/^([^.]*)(?:\.(.+)|)$/;$.event={global:{},add:function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n;if(h=$._data(a)){for(c.handler&&(i=c,c=i.handler,e=i.selector),c.guid||(c.guid=$.guid++),(g=h.events)||(g=h.events={}),(j=h.handle)||(j=h.handle=function(a){return typeof $===Hc||a&&$.event.triggered===a.type?void 0:$.event.dispatch.apply(j.elem,arguments)},j.elem=a),b=(b||"").match(Dc)||[""],h=b.length;h--;)f=ad.exec(b[h])||[],m=k=f[1],n=(f[2]||"").split(".").sort(),m&&(f=$.event.special[m]||{},m=(e?f.delegateType:f.bindType)||m,f=$.event.special[m]||{},k=$.extend({type:m,origType:k,data:d,handler:c,guid:c.guid,selector:e,needsContext:e&&$.expr.match.needsContext.test(e),namespace:n.join(".")},i),(l=g[m])||(l=g[m]=[],l.delegateCount=0,f.setup&&!1!==f.setup.call(a,d,n,j)||(a.addEventListener?a.addEventListener(m,j,!1):a.attachEvent&&a.attachEvent("on"+m,j))),f.add&&(f.add.call(a,k),k.handler.guid||(k.handler.guid=c.guid)),e?l.splice(l.delegateCount++,0,k):l.push(k),$.event.global[m]=!0);a=null}},remove:function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q=$.hasData(a)&&$._data(a);if(q&&(k=q.events)){for(b=(b||"").match(Dc)||[""],j=b.length;j--;)if(h=ad.exec(b[j])||[],n=p=h[1],o=(h[2]||"").split(".").sort(),n){for(l=$.event.special[n]||{},n=(d?l.delegateType:l.bindType)||n,m=k[n]||[],h=h[2]&&RegExp("(^|\\.)"+o.join("\\.(?:.*\\.|)")+"(\\.|$)"),i=f=m.length;f--;)g=m[f],!e&&p!==g.origType||c&&c.guid!==g.guid||h&&!h.test(g.namespace)||d&&d!==g.selector&&("**"!==d||!g.selector)||(m.splice(f,1),g.selector&&m.delegateCount--,l.remove&&l.remove.call(a,g));i&&!m.length&&((!l.teardown||!1===l.teardown.call(a,o,q.handle))&&$.removeEvent(a,n,q.handle),delete k[n])}else for(n in k)$.event.remove(a,n+b[j],c,d,!0);$.isEmptyObject(k)&&(delete q.handle,$._removeData(a,"events"))}},trigger:function(b,c,d,e){var f,g,h,i,j,k,l=[d||zc],m=X.call(b,"type")?b.type:b;if(j=X.call(b,"namespace")?b.namespace.split("."):[],h=f=d=d||zc,3!==d.nodeType&&8!==d.nodeType&&!_c.test(m+$.event.triggered)&&(0<=m.indexOf(".")&&(j=m.split("."),m=j.shift(),j.sort()),g=0>m.indexOf(":")&&"on"+m,b=b[$.expando]?b:new $.Event(m,"object"==typeof b&&b),b.isTrigger=e?2:3,b.namespace=j.join("."),b.namespace_re=b.namespace?RegExp("(^|\\.)"+j.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,b.result=void 0,b.target||(b.target=d),c=null==c?[b]:$.makeArray(c,[b]),j=$.event.special[m]||{},e||!(j.trigger&&!1===j.trigger.apply(d,c)))){if(!e&&!j.noBubble&&!$.isWindow(d)){for(i=j.delegateType||m,_c.test(i+m)||(h=h.parentNode);h;h=h.parentNode)l.push(h),f=h;f===(d.ownerDocument||zc)&&l.push(f.defaultView||f.parentWindow||a)}for(k=0;(h=l[k++])&&!b.isPropagationStopped();)b.type=k>1?i:j.bindType||m,(f=($._data(h,"events")||{})[b.type]&&$._data(h,"handle"))&&f.apply(h,c),(f=g&&h[g])&&f.apply&&$.acceptData(h)&&(b.result=f.apply(h,c),!1===b.result&&b.preventDefault());if(b.type=m,!e&&!b.isDefaultPrevented()&&(!j._default||!1===j._default.apply(l.pop(),c))&&$.acceptData(d)&&g&&d[m]&&!$.isWindow(d)){(f=d[g])&&(d[g]=null),$.event.triggered=m;try{d[m]()}catch(n){}$.event.triggered=void 0,f&&(d[g]=f)}return b.result}},dispatch:function(a){a=$.event.fix(a);var b,c,d,e,f=[],g=R.call(arguments);b=($._data(this,"events")||{})[a.type]||[];var h=$.event.special[a.type]||{};if(g[0]=a,a.delegateTarget=this,!h.preDispatch||!1!==h.preDispatch.call(this,a)){for(f=$.event.handlers.call(this,a,b),b=0;(d=f[b++])&&!a.isPropagationStopped();)for(a.currentTarget=d.elem,e=0;(c=d.handlers[e++])&&!a.isImmediatePropagationStopped();)(!a.namespace_re||a.namespace_re.test(c.namespace))&&(a.handleObj=c,a.data=c.data,c=(($.event.special[c.origType]||{}).handle||c.handler).apply(d.elem,g),void 0!==c&&!1===(a.result=c)&&(a.preventDefault(),a.stopPropagation()));return h.postDispatch&&h.postDispatch.call(this,a),a.result}},handlers:function(a,b){var c,d,e,f,g=[],h=b.delegateCount,i=a.target;if(h&&i.nodeType&&(!a.button||"click"!==a.type))for(;i!=this;i=i.parentNode||this)if(1===i.nodeType&&(!0!==i.disabled||"click"!==a.type)){for(e=[],f=0;h>f;f++)d=b[f],c=d.selector+" ",void 0===e[c]&&(e[c]=d.needsContext?0<=$(c,this).index(i):$.find(c,this,null,[i]).length),e[c]&&e.push(d);e.length&&g.push({elem:i,handlers:e})}return h<b.length&&g.push({elem:this,handlers:b.slice(h)}),g},fix:function(a){if(a[$.expando])return a;var b,c,d;b=a.type;var e=a,f=this.fixHooks[b];for(f||(this.fixHooks[b]=f=$c.test(b)?this.mouseHooks:Zc.test(b)?this.keyHooks:{}),d=f.props?this.props.concat(f.props):this.props,a=new $.Event(e),b=d.length;b--;)c=d[b],a[c]=e[c];return a.target||(a.target=e.srcElement||zc),3===a.target.nodeType&&(a.target=a.target.parentNode),a.metaKey=!!a.metaKey,f.filter?f.filter(a,e):a},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:["char","charCode","key","keyCode"],filter:function(a,b){return null==a.which&&(a.which=null!=b.charCode?b.charCode:b.keyCode),a}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(a,b){var c,d,e=b.button,f=b.fromElement;return null==a.pageX&&null!=b.clientX&&(c=a.target.ownerDocument||zc,d=c.documentElement,c=c.body,a.pageX=b.clientX+(d&&d.scrollLeft||c&&c.scrollLeft||0)-(d&&d.clientLeft||c&&c.clientLeft||0),a.pageY=b.clientY+(d&&d.scrollTop||c&&c.scrollTop||0)-(d&&d.clientTop||c&&c.clientTop||0)),!a.relatedTarget&&f&&(a.relatedTarget=f===a.target?b.toElement:f),!a.which&&void 0!==e&&(a.which=1&e?1:2&e?3:4&e?2:0),a}},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==n()&&this.focus)try{return this.focus(),!1}catch(a){}},delegateType:"focusin"},blur:{trigger:function(){return this===n()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return $.nodeName(this,"input")&&"checkbox"===this.type&&this.click?(this.click(),!1):void 0},_default:function(a){return $.nodeName(a.target,"a")}},beforeunload:{postDispatch:function(a){void 0!==a.result&&(a.originalEvent.returnValue=a.result)}}},simulate:function(a,b,c,d){a=$.extend(new $.Event,c,{type:a,isSimulated:!0,originalEvent:{}}),d?$.event.trigger(a,null,b):$.event.dispatch.call(b,a),a.isDefaultPrevented()&&c.preventDefault()}},$.removeEvent=zc.removeEventListener?function(a,b,c){a.removeEventListener&&a.removeEventListener(b,c,!1)}:function(a,b,c){b="on"+b,a.detachEvent&&(typeof a[b]===Hc&&(a[b]=null),a.detachEvent(b,c))},$.Event=function(a,b){return this instanceof $.Event?(a&&a.type?(this.originalEvent=a,this.type=a.type,this.isDefaultPrevented=a.defaultPrevented||void 0===a.defaultPrevented&&(!1===a.returnValue||a.getPreventDefault&&a.getPreventDefault())?l:m):this.type=a,b&&$.extend(this,b),this.timeStamp=a&&a.timeStamp||$.now(),void(this[$.expando]=!0)):new $.Event(a,b)},$.Event.prototype={isDefaultPrevented:m,isPropagationStopped:m,isImmediatePropagationStopped:m,preventDefault:function(){var a=this.originalEvent;this.isDefaultPrevented=l,a&&(a.preventDefault?a.preventDefault():a.returnValue=!1)},stopPropagation:function(){var a=this.originalEvent;this.isPropagationStopped=l,a&&(a.stopPropagation&&a.stopPropagation(),a.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=l,this.stopPropagation()}},$.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(a,b){$.event.special[a]={delegateType:b,bindType:b,handle:function(a){var c,d=a.relatedTarget,e=a.handleObj;return(!d||d!==this&&!$.contains(this,d))&&(a.type=e.origType,c=e.handler.apply(this,arguments),a.type=b),c}}}),Z.submitBubbles||($.event.special.submit={setup:function(){return $.nodeName(this,"form")?!1:void $.event.add(this,"click._submit keypress._submit",function(a){a=a.target,(a=$.nodeName(a,"input")||$.nodeName(a,"button")?a.form:void 0)&&!$._data(a,"submitBubbles")&&($.event.add(a,"submit._submit",function(a){a._submit_bubble=!0}),$._data(a,"submitBubbles",!0))
})},postDispatch:function(a){a._submit_bubble&&(delete a._submit_bubble,this.parentNode&&!a.isTrigger&&$.event.simulate("submit",this.parentNode,a,!0))},teardown:function(){return $.nodeName(this,"form")?!1:void $.event.remove(this,"._submit")}}),Z.changeBubbles||($.event.special.change={setup:function(){return Yc.test(this.nodeName)?(("checkbox"===this.type||"radio"===this.type)&&($.event.add(this,"propertychange._change",function(a){"checked"===a.originalEvent.propertyName&&(this._just_changed=!0)}),$.event.add(this,"click._change",function(a){this._just_changed&&!a.isTrigger&&(this._just_changed=!1),$.event.simulate("change",this,a,!0)})),!1):void $.event.add(this,"beforeactivate._change",function(a){a=a.target,Yc.test(a.nodeName)&&!$._data(a,"changeBubbles")&&($.event.add(a,"change._change",function(a){this.parentNode&&!a.isSimulated&&!a.isTrigger&&$.event.simulate("change",this.parentNode,a,!0)}),$._data(a,"changeBubbles",!0))})},handle:function(a){var b=a.target;return this!==b||a.isSimulated||a.isTrigger||"radio"!==b.type&&"checkbox"!==b.type?a.handleObj.handler.apply(this,arguments):void 0},teardown:function(){return $.event.remove(this,"._change"),!Yc.test(this.nodeName)}}),Z.focusinBubbles||$.each({focus:"focusin",blur:"focusout"},function(a,b){var c=function(a){$.event.simulate(b,a.target,$.event.fix(a),!0)};$.event.special[b]={setup:function(){var d=this.ownerDocument||this,e=$._data(d,b);e||d.addEventListener(a,c,!0),$._data(d,b,(e||0)+1)},teardown:function(){var d=this.ownerDocument||this,e=$._data(d,b)-1;e?$._data(d,b,e):(d.removeEventListener(a,c,!0),$._removeData(d,b))}}}),$.fn.extend({on:function(a,b,c,d,e){var f,g;if("object"==typeof a){"string"!=typeof b&&(c=c||b,b=void 0);for(f in a)this.on(f,b,c,a[f],e);return this}if(null==c&&null==d?(d=b,c=b=void 0):null==d&&("string"==typeof b?(d=c,c=void 0):(d=c,c=b,b=void 0)),!1===d)d=m;else if(!d)return this;return 1===e&&(g=d,d=function(a){return $().off(a),g.apply(this,arguments)},d.guid=g.guid||(g.guid=$.guid++)),this.each(function(){$.event.add(this,a,d,c,b)})},one:function(a,b,c,d){return this.on(a,b,c,d,1)},off:function(a,b,c){var d;if(a&&a.preventDefault&&a.handleObj)return d=a.handleObj,$(a.delegateTarget).off(d.namespace?d.origType+"."+d.namespace:d.origType,d.selector,d.handler),this;if("object"==typeof a){for(d in a)this.off(d,b,a[d]);return this}return(!1===b||"function"==typeof b)&&(c=b,b=void 0),!1===c&&(c=m),this.each(function(){$.event.remove(this,a,c,b)})},trigger:function(a,b){return this.each(function(){$.event.trigger(a,b,this)})},triggerHandler:function(a,b){var c=this[0];return c?$.event.trigger(a,b,c,!0):void 0}});var bd="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",cd=/ jQuery\d+="(?:null|\d+)"/g,dd=RegExp("<(?:"+bd+")[\\s/>]","i"),ed=/^\s+/,fd=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,gd=/<([\w:]+)/,hd=/<tbody/i,id=/<|&#?\w+;/,jd=/<(?:script|style|link)/i,kd=/checked\s*(?:[^=]|=\s*.checked.)/i,ld=/^$|\/(?:java|ecma)script/i,md=/^true\/(.*)/,nd=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,od={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:Z.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},pd=o(zc).appendChild(zc.createElement("div"));od.optgroup=od.option,od.tbody=od.tfoot=od.colgroup=od.caption=od.thead,od.th=od.td,$.extend({clone:function(a,b,c){var d,e,f,g,h,i=$.contains(a.ownerDocument,a);if(Z.html5Clone||$.isXMLDoc(a)||!dd.test("<"+a.nodeName+">")?f=a.cloneNode(!0):(pd.innerHTML=a.outerHTML,pd.removeChild(f=pd.firstChild)),!(Z.noCloneEvent&&Z.noCloneChecked||1!==a.nodeType&&11!==a.nodeType||$.isXMLDoc(a)))for(d=p(f),h=p(a),g=0;null!=(e=h[g]);++g)if(d[g]){var j=d[g],k=void 0,l=void 0,m=void 0;if(1===j.nodeType){if(k=j.nodeName.toLowerCase(),!Z.noCloneEvent&&j[$.expando]){m=$._data(j);for(l in m.events)$.removeEvent(j,l,m.handle);j.removeAttribute($.expando)}"script"===k&&j.text!==e.text?(s(j).text=e.text,t(j)):"object"===k?(j.parentNode&&(j.outerHTML=e.outerHTML),Z.html5Clone&&e.innerHTML&&!$.trim(j.innerHTML)&&(j.innerHTML=e.innerHTML)):"input"===k&&Qc.test(e.type)?(j.defaultChecked=j.checked=e.checked,j.value!==e.value&&(j.value=e.value)):"option"===k?j.defaultSelected=j.selected=e.defaultSelected:("input"===k||"textarea"===k)&&(j.defaultValue=e.defaultValue)}}if(b)if(c)for(h=h||p(a),d=d||p(f),g=0;null!=(e=h[g]);g++)v(e,d[g]);else v(a,f);return d=p(f,"script"),0<d.length&&u(d,!i&&p(a,"script")),f},buildFragment:function(a,b,c,d){for(var e,f,g,h,i,j,k=a.length,l=o(b),m=[],n=0;k>n;n++)if((f=a[n])||0===f)if("object"===$.type(f))$.merge(m,f.nodeType?[f]:f);else if(id.test(f)){for(g=g||l.appendChild(b.createElement("div")),h=(gd.exec(f)||["",""])[1].toLowerCase(),j=od[h]||od._default,g.innerHTML=j[1]+f.replace(fd,"<$1></$2>")+j[2],e=j[0];e--;)g=g.lastChild;if(!Z.leadingWhitespace&&ed.test(f)&&m.push(b.createTextNode(ed.exec(f)[0])),!Z.tbody)for(e=(f="table"!==h||hd.test(f)?"<table>"!==j[1]||hd.test(f)?0:g:g.firstChild)&&f.childNodes.length;e--;)$.nodeName(i=f.childNodes[e],"tbody")&&!i.childNodes.length&&f.removeChild(i);for($.merge(m,g.childNodes),g.textContent="";g.firstChild;)g.removeChild(g.firstChild);g=l.lastChild}else m.push(b.createTextNode(f));for(g&&l.removeChild(g),Z.appendChecked||$.grep(p(m,"input"),q),n=0;f=m[n++];)if((!d||-1===$.inArray(f,d))&&(a=$.contains(f.ownerDocument,f),g=p(l.appendChild(f),"script"),a&&u(g),c))for(e=0;f=g[e++];)ld.test(f.type||"")&&c.push(f);return l},cleanData:function(a,b){for(var c,d,e,f,g=0,h=$.expando,i=$.cache,j=Z.deleteExpando,k=$.event.special;null!=(c=a[g]);g++)if((b||$.acceptData(c))&&(f=(e=c[h])&&i[e])){if(f.events)for(d in f.events)k[d]?$.event.remove(c,d):$.removeEvent(c,d,f.handle);i[e]&&(delete i[e],j?delete c[h]:typeof c.removeAttribute!==Hc?c.removeAttribute(h):c[h]=null,Q.push(e))}}}),$.fn.extend({text:function(a){return Pc(this,function(a){return void 0===a?$.text(this):this.empty().append((this[0]&&this[0].ownerDocument||zc).createTextNode(a))},null,a,arguments.length)},append:function(){return this.domManip(arguments,function(a){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&r(this,a).appendChild(a)})},prepend:function(){return this.domManip(arguments,function(a){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var b=r(this,a);b.insertBefore(a,b.firstChild)}})},before:function(){return this.domManip(arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this)})},after:function(){return this.domManip(arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this.nextSibling)})},remove:function(a,b){for(var c,d=a?$.filter(a,this):this,e=0;null!=(c=d[e]);e++)!b&&1===c.nodeType&&$.cleanData(p(c)),c.parentNode&&(b&&$.contains(c.ownerDocument,c)&&u(p(c,"script")),c.parentNode.removeChild(c));return this},empty:function(){for(var a,b=0;null!=(a=this[b]);b++){for(1===a.nodeType&&$.cleanData(p(a,!1));a.firstChild;)a.removeChild(a.firstChild);a.options&&$.nodeName(a,"select")&&(a.options.length=0)}return this},clone:function(a,b){return a=null==a?!1:a,b=null==b?a:b,this.map(function(){return $.clone(this,a,b)})},html:function(a){return Pc(this,function(a){var b=this[0]||{},c=0,d=this.length;if(void 0===a)return 1===b.nodeType?b.innerHTML.replace(cd,""):void 0;if(!("string"!=typeof a||jd.test(a)||!Z.htmlSerialize&&dd.test(a)||!Z.leadingWhitespace&&ed.test(a)||od[(gd.exec(a)||["",""])[1].toLowerCase()])){a=a.replace(fd,"<$1></$2>");try{for(;d>c;c++)b=this[c]||{},1===b.nodeType&&($.cleanData(p(b,!1)),b.innerHTML=a);b=0}catch(e){}}b&&this.empty().append(a)},null,a,arguments.length)},replaceWith:function(){var a=arguments[0];return this.domManip(arguments,function(b){a=this.parentNode,$.cleanData(p(this)),a&&a.replaceChild(b,this)}),a&&(a.length||a.nodeType)?this:this.remove()},detach:function(a){return this.remove(a,!0)},domManip:function(a,b){a=S.apply([],a);var c,d,e,f,g=0,h=this.length,i=this,j=h-1,k=a[0],l=$.isFunction(k);if(l||h>1&&"string"==typeof k&&!Z.checkClone&&kd.test(k))return this.each(function(c){var d=i.eq(c);l&&(a[0]=k.call(this,c,d.html())),d.domManip(a,b)});if(h&&(f=$.buildFragment(a,this[0].ownerDocument,!1,this),c=f.firstChild,1===f.childNodes.length&&(f=c),c)){for(e=$.map(p(f,"script"),s),d=e.length;h>g;g++)c=f,g!==j&&(c=$.clone(c,!0,!0),d&&$.merge(e,p(c,"script"))),b.call(this[g],c,g);if(d)for(f=e[e.length-1].ownerDocument,$.map(e,t),g=0;d>g;g++)c=e[g],ld.test(c.type||"")&&!$._data(c,"globalEval")&&$.contains(f,c)&&(c.src?$._evalUrl&&$._evalUrl(c.src):$.globalEval((c.text||c.textContent||c.innerHTML||"").replace(nd,"")));f=c=null}return this}}),$.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(a,b){$.fn[a]=function(a){for(var c=0,d=[],e=$(a),f=e.length-1;f>=c;c++)a=c===f?this:this.clone(!0),$(e[c])[b](a),T.apply(d,a.get());return this.pushStack(d)}});var qd,rd,sd,td={},ud=zc.createElement("div");ud.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",rd=ud.getElementsByTagName("a")[0],rd.style.cssText="float:left;opacity:.5",Z.opacity=/^0.5/.test(rd.style.opacity),Z.cssFloat=!!rd.style.cssFloat,ud.style.backgroundClip="content-box",ud.cloneNode(!0).style.backgroundClip="",Z.clearCloneStyle="content-box"===ud.style.backgroundClip,rd=ud=null,Z.shrinkWrapBlocks=function(){var a,b,c;if(null==sd){if(a=zc.getElementsByTagName("body")[0],!a)return;b=zc.createElement("div"),c=zc.createElement("div"),a.appendChild(b).appendChild(c),sd=!1,typeof c.style.zoom!==Hc&&(c.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;padding:0;margin:0;border:0;width:1px;padding:1px;zoom:1",c.innerHTML="<div></div>",c.firstChild.style.width="5px",sd=3!==c.offsetWidth),a.removeChild(b)}return sd};var vd,wd,xd=/^margin/,yd=RegExp("^("+Mc+")(?!px)[a-z%]+$","i"),zd=/^(top|right|bottom|left)$/;a.getComputedStyle?(vd=function(a){return a.ownerDocument.defaultView.getComputedStyle(a,null)},wd=function(a,b,c){var d,e,f=a.style;return e=(c=c||vd(a))?c.getPropertyValue(b)||c[b]:void 0,c&&(""===e&&!$.contains(a.ownerDocument,a)&&(e=$.style(a,b)),yd.test(e)&&xd.test(b)&&(a=f.width,b=f.minWidth,d=f.maxWidth,f.minWidth=f.maxWidth=f.width=e,e=c.width,f.width=a,f.minWidth=b,f.maxWidth=d)),void 0===e?e:e+""}):zc.documentElement.currentStyle&&(vd=function(a){return a.currentStyle},wd=function(a,b,c){var d,e,f,g=a.style;return f=(c=c||vd(a))?c[b]:void 0,null==f&&g&&g[b]&&(f=g[b]),yd.test(f)&&!zd.test(b)&&(c=g.left,(e=(d=a.runtimeStyle)&&d.left)&&(d.left=a.currentStyle.left),g.left="fontSize"===b?"1em":f,f=g.pixelLeft+"px",g.left=c,e&&(d.left=e)),void 0===f?f:f+""||"auto"});var Ad,Bd,Cd,Dd,Ed,Fd,Gd=function(){var b,c,d=zc.getElementsByTagName("body")[0];d&&(b=zc.createElement("div"),c=zc.createElement("div"),b.style.cssText=Id,d.appendChild(b).appendChild(c),c.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;position:absolute;display:block;padding:1px;border:1px;width:4px;margin-top:1%;top:1%",$.swap(d,null!=d.style.zoom?{zoom:1}:{},function(){Cd=4===c.offsetWidth}),Dd=!0,Ed=!1,Fd=!0,a.getComputedStyle&&(Ed="1%"!==(a.getComputedStyle(c,null)||{}).top,Dd="4px"===(a.getComputedStyle(c,null)||{width:"4px"}).width),d.removeChild(b),c=d=null)},Hd=zc.createElement("div"),Id="border:0;width:0;height:0;position:absolute;top:0;left:-9999px";Hd.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",Ad=Hd.getElementsByTagName("a")[0],Ad.style.cssText="float:left;opacity:.5",Z.opacity=/^0.5/.test(Ad.style.opacity),Z.cssFloat=!!Ad.style.cssFloat,Hd.style.backgroundClip="content-box",Hd.cloneNode(!0).style.backgroundClip="",Z.clearCloneStyle="content-box"===Hd.style.backgroundClip,Ad=Hd=null,$.extend(Z,{reliableHiddenOffsets:function(){if(null!=Bd)return Bd;var a,b,c;b=zc.createElement("div");var d=zc.getElementsByTagName("body")[0];return d?(b.setAttribute("className","t"),b.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",a=zc.createElement("div"),a.style.cssText=Id,d.appendChild(a).appendChild(b),b.innerHTML="<table><tr><td></td><td>t</td></tr></table>",b=b.getElementsByTagName("td"),b[0].style.cssText="padding:0;margin:0;border:0;display:none",c=0===b[0].offsetHeight,b[0].style.display="",b[1].style.display="none",Bd=c&&0===b[0].offsetHeight,d.removeChild(a),Bd):void 0},boxSizing:function(){return null==Cd&&Gd(),Cd},boxSizingReliable:function(){return null==Dd&&Gd(),Dd},pixelPosition:function(){return null==Ed&&Gd(),Ed},reliableMarginRight:function(){var b,c,d,e;if(null==Fd&&a.getComputedStyle){if(b=zc.getElementsByTagName("body")[0],!b)return;c=zc.createElement("div"),d=zc.createElement("div"),c.style.cssText=Id,b.appendChild(c).appendChild(d),e=d.appendChild(zc.createElement("div")),e.style.cssText=d.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;padding:0;margin:0;border:0",e.style.marginRight=e.style.width="0",d.style.width="1px",Fd=!parseFloat((a.getComputedStyle(e,null)||{}).marginRight),b.removeChild(c)}return Fd}}),$.swap=function(a,b,c,d){var e,f={};for(e in b)f[e]=a.style[e],a.style[e]=b[e];c=c.apply(a,d||[]);for(e in b)a.style[e]=f[e];return c};var Jd=/alpha\([^)]*\)/i,Kd=/opacity\s*=\s*([^)]*)/,Ld=/^(none|table(?!-c[ea]).+)/,Md=RegExp("^("+Mc+")(.*)$","i"),Nd=RegExp("^([+-])=("+Mc+")","i"),Od={position:"absolute",visibility:"hidden",display:"block"},Pd={letterSpacing:0,fontWeight:400},Qd=["Webkit","O","Moz","ms"];$.extend({cssHooks:{opacity:{get:function(a,b){if(b){var c=wd(a,"opacity");return""===c?"1":c}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":Z.cssFloat?"cssFloat":"styleFloat"},style:function(a,b,c,d){if(a&&3!==a.nodeType&&8!==a.nodeType&&a.style){var e,f,g,h=$.camelCase(b),i=a.style;if(b=$.cssProps[h]||($.cssProps[h]=z(i,h)),g=$.cssHooks[b]||$.cssHooks[h],void 0===c)return g&&"get"in g&&void 0!==(e=g.get(a,!1,d))?e:i[b];if(f=typeof c,"string"===f&&(e=Nd.exec(c))&&(c=(e[1]+1)*e[2]+parseFloat($.css(a,b)),f="number"),null!=c&&c===c&&("number"===f&&!$.cssNumber[h]&&(c+="px"),!Z.clearCloneStyle&&""===c&&0===b.indexOf("background")&&(i[b]="inherit"),!(g&&"set"in g&&void 0===(c=g.set(a,c,d)))))try{i[b]="",i[b]=c}catch(j){}}},css:function(a,b,c,d){var e,f;return f=$.camelCase(b),b=$.cssProps[f]||($.cssProps[f]=z(a.style,f)),(f=$.cssHooks[b]||$.cssHooks[f])&&"get"in f&&(e=f.get(a,!0,c)),void 0===e&&(e=wd(a,b,d)),"normal"===e&&b in Pd&&(e=Pd[b]),""===c||c?(a=parseFloat(e),!0===c||$.isNumeric(a)?a||0:e):e}}),$.each(["height","width"],function(a,b){$.cssHooks[b]={get:function(a,c,d){return c?0===a.offsetWidth&&Ld.test($.css(a,"display"))?$.swap(a,Od,function(){return D(a,b,d)}):D(a,b,d):void 0},set:function(a,c,d){var e=d&&vd(a);return B(a,c,d?C(a,b,d,Z.boxSizing()&&"border-box"===$.css(a,"boxSizing",!1,e),e):0)}}}),Z.opacity||($.cssHooks.opacity={get:function(a,b){return Kd.test((b&&a.currentStyle?a.currentStyle.filter:a.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":b?"1":""},set:function(a,b){var c=a.style,d=a.currentStyle,e=$.isNumeric(b)?"alpha(opacity="+100*b+")":"",f=d&&d.filter||c.filter||"";c.zoom=1,(b>=1||""===b)&&""===$.trim(f.replace(Jd,""))&&c.removeAttribute&&(c.removeAttribute("filter"),""===b||d&&!d.filter)||(c.filter=Jd.test(f)?f.replace(Jd,e):f+" "+e)}}),$.cssHooks.marginRight=y(Z.reliableMarginRight,function(a,b){return b?$.swap(a,{display:"inline-block"},wd,[a,"marginRight"]):void 0}),$.each({margin:"",padding:"",border:"Width"},function(a,b){$.cssHooks[a+b]={expand:function(c){var d=0,e={};for(c="string"==typeof c?c.split(" "):[c];4>d;d++)e[a+Nc[d]+b]=c[d]||c[d-2]||c[0];return e}},xd.test(a)||($.cssHooks[a+b].set=B)}),$.fn.extend({css:function(a,b){return Pc(this,function(a,b,c){var d,e={},f=0;if($.isArray(b)){for(c=vd(a),d=b.length;d>f;f++)e[b[f]]=$.css(a,b[f],!1,c);return e}return void 0!==c?$.style(a,b,c):$.css(a,b)},a,b,1<arguments.length)},show:function(){return A(this,!0)},hide:function(){return A(this)},toggle:function(a){return"boolean"==typeof a?a?this.show():this.hide():this.each(function(){Oc(this)?$(this).show():$(this).hide()})}}),$.Tween=E,E.prototype={constructor:E,init:function(a,b,c,d,e,f){this.elem=a,this.prop=c,this.easing=e||"swing",this.options=b,this.start=this.now=this.cur(),this.end=d,this.unit=f||($.cssNumber[c]?"":"px")},cur:function(){var a=E.propHooks[this.prop];return a&&a.get?a.get(this):E.propHooks._default.get(this)},run:function(a){var b,c=E.propHooks[this.prop];return this.pos=b=this.options.duration?$.easing[this.easing](a,this.options.duration*a,0,1,this.options.duration):a,this.now=(this.end-this.start)*b+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),c&&c.set?c.set(this):E.propHooks._default.set(this),this}},E.prototype.init.prototype=E.prototype,E.propHooks={_default:{get:function(a){return null==a.elem[a.prop]||a.elem.style&&null!=a.elem.style[a.prop]?(a=$.css(a.elem,a.prop,""),a&&"auto"!==a?a:0):a.elem[a.prop]},set:function(a){$.fx.step[a.prop]?$.fx.step[a.prop](a):a.elem.style&&(null!=a.elem.style[$.cssProps[a.prop]]||$.cssHooks[a.prop])?$.style(a.elem,a.prop,a.now+a.unit):a.elem[a.prop]=a.now}}},E.propHooks.scrollTop=E.propHooks.scrollLeft={set:function(a){a.elem.nodeType&&a.elem.parentNode&&(a.elem[a.prop]=a.now)}},$.easing={linear:function(a){return a},swing:function(a){return.5-Math.cos(a*Math.PI)/2}},$.fx=E.prototype.init,$.fx.step={};var Rd,Sd,Td=/^(?:toggle|show|hide)$/,Ud=RegExp("^(?:([+-])=|)("+Mc+")([a-z%]*)$","i"),Vd=/queueHooks$/,Wd=[function(a,b,c){var d,e,f,g,h,i,j=this,k={},l=a.style,m=a.nodeType&&Oc(a),n=$._data(a,"fxshow");c.queue||(g=$._queueHooks(a,"fx"),null==g.unqueued&&(g.unqueued=0,h=g.empty.fire,g.empty.fire=function(){g.unqueued||h()}),g.unqueued++,j.always(function(){j.always(function(){g.unqueued--,$.queue(a,"fx").length||g.empty.fire()})})),1===a.nodeType&&("height"in b||"width"in b)&&(c.overflow=[l.overflow,l.overflowX,l.overflowY],e=$.css(a,"display"),i=x(a.nodeName),"none"===e&&(e=i),"inline"===e&&"none"===$.css(a,"float")&&(Z.inlineBlockNeedsLayout&&"inline"!==i?l.zoom=1:l.display="inline-block")),c.overflow&&(l.overflow="hidden",Z.shrinkWrapBlocks()||j.always(function(){l.overflow=c.overflow[0],l.overflowX=c.overflow[1],l.overflowY=c.overflow[2]}));for(d in b)if(e=b[d],Td.exec(e)){if(delete b[d],f=f||"toggle"===e,e===(m?"hide":"show")){if("show"!==e||!n||void 0===n[d])continue;m=!0}k[d]=n&&n[d]||$.style(a,d)}if(!$.isEmptyObject(k))for(d in n?"hidden"in n&&(m=n.hidden):n=$._data(a,"fxshow",{}),f&&(n.hidden=!m),m?$(a).show():j.done(function(){$(a).hide()}),j.done(function(){var b;$._removeData(a,"fxshow");for(b in k)$.style(a,b,k[b])}),k)b=H(m?n[d]:0,d,j),d in n||(n[d]=b.start,m&&(b.end=b.start,b.start="width"===d||"height"===d?1:0))}],Xd={"*":[function(a,b){var c=this.createTween(a,b),d=c.cur(),e=Ud.exec(b),f=e&&e[3]||($.cssNumber[a]?"":"px"),g=($.cssNumber[a]||"px"!==f&&+d)&&Ud.exec($.css(c.elem,a)),h=1,i=20;if(g&&g[3]!==f){f=f||g[3],e=e||[],g=+d||1;do h=h||".5",g/=h,$.style(c.elem,a,g+f);while(h!==(h=c.cur()/d)&&1!==h&&--i)}return e&&(g=c.start=+g||+d||0,c.unit=f,c.end=e[1]?g+(e[1]+1)*e[2]:+e[2]),c}]};$.Animation=$.extend(I,{tweener:function(a,b){$.isFunction(a)?(b=a,a=["*"]):a=a.split(" ");for(var c,d=0,e=a.length;e>d;d++)c=a[d],Xd[c]=Xd[c]||[],Xd[c].unshift(b)},prefilter:function(a,b){b?Wd.unshift(a):Wd.push(a)}}),$.speed=function(a,b,c){var d=a&&"object"==typeof a?$.extend({},a):{complete:c||!c&&b||$.isFunction(a)&&a,duration:a,easing:c&&b||b&&!$.isFunction(b)&&b};return d.duration=$.fx.off?0:"number"==typeof d.duration?d.duration:d.duration in $.fx.speeds?$.fx.speeds[d.duration]:$.fx.speeds._default,(null==d.queue||!0===d.queue)&&(d.queue="fx"),d.old=d.complete,d.complete=function(){$.isFunction(d.old)&&d.old.call(this),d.queue&&$.dequeue(this,d.queue)},d},$.fn.extend({fadeTo:function(a,b,c,d){return this.filter(Oc).css("opacity",0).show().end().animate({opacity:b},a,c,d)},animate:function(a,b,c,d){var e=$.isEmptyObject(a),f=$.speed(b,c,d);return b=function(){var b=I(this,$.extend({},a),f);(e||$._data(this,"finish"))&&b.stop(!0)},b.finish=b,e||!1===f.queue?this.each(b):this.queue(f.queue,b)},stop:function(a,b,c){var d=function(a){var b=a.stop;delete a.stop,b(c)};return"string"!=typeof a&&(c=b,b=a,a=void 0),b&&!1!==a&&this.queue(a||"fx",[]),this.each(function(){var b=!0,e=null!=a&&a+"queueHooks",f=$.timers,g=$._data(this);if(e)g[e]&&g[e].stop&&d(g[e]);else for(e in g)g[e]&&g[e].stop&&Vd.test(e)&&d(g[e]);for(e=f.length;e--;)f[e].elem!==this||null!=a&&f[e].queue!==a||(f[e].anim.stop(c),b=!1,f.splice(e,1));(b||!c)&&$.dequeue(this,a)})},finish:function(a){return!1!==a&&(a=a||"fx"),this.each(function(){var b,c=$._data(this),d=c[a+"queue"];b=c[a+"queueHooks"];var e=$.timers,f=d?d.length:0;for(c.finish=!0,$.queue(this,a,[]),b&&b.stop&&b.stop.call(this,!0),b=e.length;b--;)e[b].elem===this&&e[b].queue===a&&(e[b].anim.stop(!0),e.splice(b,1));for(b=0;f>b;b++)d[b]&&d[b].finish&&d[b].finish.call(this);delete c.finish})}}),$.each(["toggle","show","hide"],function(a,b){var c=$.fn[b];$.fn[b]=function(a,d,e){return null==a||"boolean"==typeof a?c.apply(this,arguments):this.animate(G(b,!0),a,d,e)}}),$.each({slideDown:G("show"),slideUp:G("hide"),slideToggle:G("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(a,b){$.fn[a]=function(a,c,d){return this.animate(b,a,c,d)}}),$.timers=[],$.fx.tick=function(){var a,b=$.timers,c=0;for(Rd=$.now();c<b.length;c++)a=b[c],!a()&&b[c]===a&&b.splice(c--,1);b.length||$.fx.stop(),Rd=void 0},$.fx.timer=function(a){$.timers.push(a),a()?$.fx.start():$.timers.pop()},$.fx.interval=13,$.fx.start=function(){Sd||(Sd=setInterval($.fx.tick,$.fx.interval))},$.fx.stop=function(){clearInterval(Sd),Sd=null},$.fx.speeds={slow:600,fast:200,_default:400},$.fn.delay=function(a,b){return a=$.fx?$.fx.speeds[a]||a:a,this.queue(b||"fx",function(b,c){var d=setTimeout(b,a);c.stop=function(){clearTimeout(d)}})};var Yd,Zd,$d,_d,ae=zc.createElement("div");ae.setAttribute("className","t"),ae.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",Yd=ae.getElementsByTagName("a")[0],$d=zc.createElement("select"),_d=$d.appendChild(zc.createElement("option")),Zd=ae.getElementsByTagName("input")[0],Yd.style.cssText="top:1px",Z.getSetAttribute="t"!==ae.className,Z.style=/top/.test(Yd.getAttribute("style")),Z.hrefNormalized="/a"===Yd.getAttribute("href"),Z.checkOn=!!Zd.value,Z.optSelected=_d.selected,Z.enctype=!!zc.createElement("form").enctype,$d.disabled=!0,Z.optDisabled=!_d.disabled,Zd=zc.createElement("input"),Zd.setAttribute("value",""),Z.input=""===Zd.getAttribute("value"),Zd.value="t",Zd.setAttribute("type","radio"),Z.radioValue="t"===Zd.value;var be=/\r/g;$.fn.extend({val:function(a){var b,c,d,e=this[0];return arguments.length?(d=$.isFunction(a),this.each(function(c){1!==this.nodeType||(c=d?a.call(this,c,$(this).val()):a,null==c?c="":"number"==typeof c?c+="":$.isArray(c)&&(c=$.map(c,function(a){return null==a?"":a+""})),b=$.valHooks[this.type]||$.valHooks[this.nodeName.toLowerCase()],b&&"set"in b&&void 0!==b.set(this,c,"value"))||(this.value=c)})):e?(b=$.valHooks[e.type]||$.valHooks[e.nodeName.toLowerCase()])&&"get"in b&&void 0!==(c=b.get(e,"value"))?c:(c=e.value,"string"==typeof c?c.replace(be,""):null==c?"":c):void 0}}),$.extend({valHooks:{option:{get:function(a){var b=$.find.attr(a,"value");return null!=b?b:$.text(a)}},select:{get:function(a){for(var b,c=a.options,d=a.selectedIndex,e=(a="select-one"===a.type||0>d)?null:[],f=a?d+1:c.length,g=0>d?f:a?d:0;f>g;g++)if(b=c[g],!(!b.selected&&g!==d||(Z.optDisabled?b.disabled:null!==b.getAttribute("disabled"))||b.parentNode.disabled&&$.nodeName(b.parentNode,"optgroup"))){if(b=$(b).val(),a)return b;e.push(b)}return e},set:function(a,b){for(var c,d,e=a.options,f=$.makeArray(b),g=e.length;g--;)if(d=e[g],0<=$.inArray($.valHooks.option.get(d),f))try{d.selected=c=!0}catch(h){d.scrollHeight}else d.selected=!1;return c||(a.selectedIndex=-1),e}}}}),$.each(["radio","checkbox"],function(){$.valHooks[this]={set:function(a,b){return $.isArray(b)?a.checked=0<=$.inArray($(a).val(),b):void 0}},Z.checkOn||($.valHooks[this].get=function(a){return null===a.getAttribute("value")?"on":a.value})});var ce,de,ee=$.expr.attrHandle,fe=/^(?:checked|selected)$/i,ge=Z.getSetAttribute,he=Z.input;$.fn.extend({attr:function(a,b){return Pc(this,$.attr,a,b,1<arguments.length)},removeAttr:function(a){return this.each(function(){$.removeAttr(this,a)})}}),$.extend({attr:function(a,b,c){var d,e,f=a.nodeType;if(a&&3!==f&&8!==f&&2!==f){if(typeof a.getAttribute===Hc)return $.prop(a,b,c);if(1===f&&$.isXMLDoc(a)||(b=b.toLowerCase(),d=$.attrHooks[b]||($.expr.match.bool.test(b)?de:ce)),void 0===c)return d&&"get"in d&&null!==(e=d.get(a,b))?e:(e=$.find.attr(a,b),null==e?void 0:e);if(null!==c)return d&&"set"in d&&void 0!==(e=d.set(a,c,b))?e:(a.setAttribute(b,c+""),c);$.removeAttr(a,b)}},removeAttr:function(a,b){var c,d,e=0,f=b&&b.match(Dc);if(f&&1===a.nodeType)for(;c=f[e++];)d=$.propFix[c]||c,$.expr.match.bool.test(c)?he&&ge||!fe.test(c)?a[d]=!1:a[$.camelCase("default-"+c)]=a[d]=!1:$.attr(a,c,""),a.removeAttribute(ge?c:d)},attrHooks:{type:{set:function(a,b){if(!Z.radioValue&&"radio"===b&&$.nodeName(a,"input")){var c=a.value;return a.setAttribute("type",b),c&&(a.value=c),b}}}}}),de={set:function(a,b,c){return!1===b?$.removeAttr(a,c):he&&ge||!fe.test(c)?a.setAttribute(!ge&&$.propFix[c]||c,c):a[$.camelCase("default-"+c)]=a[c]=!0,c}},$.each($.expr.match.bool.source.match(/\w+/g),function(a,b){var c=ee[b]||$.find.attr;ee[b]=he&&ge||!fe.test(b)?function(a,b,d){var e,f;return d||(f=ee[b],ee[b]=e,e=null!=c(a,b,d)?b.toLowerCase():null,ee[b]=f),e}:function(a,b,c){return c?void 0:a[$.camelCase("default-"+b)]?b.toLowerCase():null}}),he&&ge||($.attrHooks.value={set:function(a,b,c){return $.nodeName(a,"input")?void(a.defaultValue=b):ce&&ce.set(a,b,c)}}),ge||(ce={set:function(a,b,c){var d=a.getAttributeNode(c);return d||a.setAttributeNode(d=a.ownerDocument.createAttribute(c)),d.value=b+="","value"===c||b===a.getAttribute(c)?b:void 0}},ee.id=ee.name=ee.coords=function(a,b,c){var d;return c?void 0:(d=a.getAttributeNode(b))&&""!==d.value?d.value:null},$.valHooks.button={get:function(a,b){var c=a.getAttributeNode(b);return c&&c.specified?c.value:void 0},set:ce.set},$.attrHooks.contenteditable={set:function(a,b,c){ce.set(a,""===b?!1:b,c)}},$.each(["width","height"],function(a,b){$.attrHooks[b]={set:function(a,c){return""===c?(a.setAttribute(b,"auto"),c):void 0}}})),Z.style||($.attrHooks.style={get:function(a){return a.style.cssText||void 0},set:function(a,b){return a.style.cssText=b+""}});var ie=/^(?:input|select|textarea|button|object)$/i,je=/^(?:a|area)$/i;$.fn.extend({prop:function(a,b){return Pc(this,$.prop,a,b,1<arguments.length)},removeProp:function(a){return a=$.propFix[a]||a,this.each(function(){try{this[a]=void 0,delete this[a]}catch(b){}})}}),$.extend({propFix:{"for":"htmlFor","class":"className"},prop:function(a,b,c){var d,e,f;return f=a.nodeType,a&&3!==f&&8!==f&&2!==f?((f=1!==f||!$.isXMLDoc(a))&&(b=$.propFix[b]||b,e=$.propHooks[b]),void 0!==c?e&&"set"in e&&void 0!==(d=e.set(a,c,b))?d:a[b]=c:e&&"get"in e&&null!==(d=e.get(a,b))?d:a[b]):void 0},propHooks:{tabIndex:{get:function(a){var b=$.find.attr(a,"tabindex");return b?parseInt(b,10):ie.test(a.nodeName)||je.test(a.nodeName)&&a.href?0:-1}}}}),Z.hrefNormalized||$.each(["href","src"],function(a,b){$.propHooks[b]={get:function(a){return a.getAttribute(b,4)}}}),Z.optSelected||($.propHooks.selected={get:function(a){return(a=a.parentNode)&&(a.selectedIndex,a.parentNode&&a.parentNode.selectedIndex),null}}),$.each("tabIndex readOnly maxLength cellSpacing cellPadding rowSpan colSpan useMap frameBorder contentEditable".split(" "),function(){$.propFix[this.toLowerCase()]=this}),Z.enctype||($.propFix.enctype="encoding");var ke=/[\t\r\n\f]/g;$.fn.extend({addClass:function(a){var b,c,d,e,f,g=0,h=this.length;if(b="string"==typeof a&&a,$.isFunction(a))return this.each(function(b){$(this).addClass(a.call(this,b,this.className))});if(b)for(b=(a||"").match(Dc)||[];h>g;g++)if(c=this[g],d=1===c.nodeType&&(c.className?(" "+c.className+" ").replace(ke," "):" ")){for(f=0;e=b[f++];)0>d.indexOf(" "+e+" ")&&(d+=e+" ");d=$.trim(d),c.className!==d&&(c.className=d)}return this},removeClass:function(a){var b,c,d,e,f,g=0,h=this.length;if(b=0===arguments.length||"string"==typeof a&&a,$.isFunction(a))return this.each(function(b){$(this).removeClass(a.call(this,b,this.className))});if(b)for(b=(a||"").match(Dc)||[];h>g;g++)if(c=this[g],d=1===c.nodeType&&(c.className?(" "+c.className+" ").replace(ke," "):"")){for(f=0;e=b[f++];)for(;0<=d.indexOf(" "+e+" ");)d=d.replace(" "+e+" "," ");d=a?$.trim(d):"",c.className!==d&&(c.className=d)}return this},toggleClass:function(a,b){var c=typeof a;return"boolean"==typeof b&&"string"===c?b?this.addClass(a):this.removeClass(a):this.each($.isFunction(a)?function(c){$(this).toggleClass(a.call(this,c,this.className,b),b)}:function(){if("string"===c)for(var b,d=0,e=$(this),f=a.match(Dc)||[];b=f[d++];)e.hasClass(b)?e.removeClass(b):e.addClass(b);else(c===Hc||"boolean"===c)&&(this.className&&$._data(this,"__className__",this.className),this.className=this.className||!1===a?"":$._data(this,"__className__")||"")})},hasClass:function(a){a=" "+a+" ";for(var b=0,c=this.length;c>b;b++)if(1===this[b].nodeType&&0<=(" "+this[b].className+" ").replace(ke," ").indexOf(a))return!0;return!1}}),$.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(a,b){$.fn[b]=function(a,c){return 0<arguments.length?this.on(b,null,a,c):this.trigger(b)}}),$.fn.extend({hover:function(a,b){return this.mouseenter(a).mouseleave(b||a)},bind:function(a,b,c){return this.on(a,null,b,c)},unbind:function(a,b){return this.off(a,null,b)},delegate:function(a,b,c,d){return this.on(b,a,c,d)},undelegate:function(a,b,c){return 1===arguments.length?this.off(a,"**"):this.off(b,a||"**",c)}});var le=$.now(),me=/\?/,ne=/(,)|(\[|{)|(}|])|"(?:[^"\\\r\n]|\\["\\\/bfnrt]|\\u[\da-fA-F]{4})*"\s*:?|true|false|null|-?(?!0\d)\d+(?:\.\d+|)(?:[eE][+-]?\d+|)/g;$.parseJSON=function(b){if(a.JSON&&a.JSON.parse)return a.JSON.parse(b+"");var c,d=null,e=$.trim(b+"");return e&&!$.trim(e.replace(ne,function(a,b,e,f){return c&&b&&(d=0),0===d?a:(c=e||b,d+=!f-!e,"")}))?Function("return "+e)():$.error("Invalid JSON: "+b)},$.parseXML=function(b){var c,d;if(!b||"string"!=typeof b)return null;try{a.DOMParser?(d=new DOMParser,c=d.parseFromString(b,"text/xml")):(c=new ActiveXObject("Microsoft.XMLDOM"),c.async="false",c.loadXML(b))}catch(e){c=void 0}return(!c||!c.documentElement||c.getElementsByTagName("parsererror").length)&&$.error("Invalid XML: "+b),c};var oe,pe,qe=/#.*$/,re=/([?&])_=[^&]*/,se=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,te=/^(?:GET|HEAD)$/,ue=/^\/\//,ve=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,we={},xe={},ye="*/".concat("*");try{pe=location.href}catch(ze){pe=zc.createElement("a"),pe.href="",pe=pe.href}oe=ve.exec(pe.toLowerCase())||[],$.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:pe,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(oe[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":ye,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":$.parseJSON,"text xml":$.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(a,b){return b?L(L(a,$.ajaxSettings),b):L($.ajaxSettings,a)
},ajaxPrefilter:J(we),ajaxTransport:J(xe),ajax:function(a,b){function c(a,b,c,d){var e,k,r,s;if(s=b,2!==t){if(t=2,h&&clearTimeout(h),j=void 0,g=d||"",v.readyState=a>0?4:0,d=a>=200&&300>a||304===a,c){r=l;for(var u,w,x,y,z=v,A=r.contents,B=r.dataTypes;"*"===B[0];)B.shift(),void 0===w&&(w=r.mimeType||z.getResponseHeader("Content-Type"));if(w)for(y in A)if(A[y]&&A[y].test(w)){B.unshift(y);break}if(B[0]in c)x=B[0];else{for(y in c){if(!B[0]||r.converters[y+" "+B[0]]){x=y;break}u||(u=y)}x=x||u}x?(x!==B[0]&&B.unshift(x),r=c[x]):r=void 0}a:{c=l,u=r,w=v,x=d;var C,D,E,z={},A=c.dataTypes.slice();if(A[1])for(D in c.converters)z[D.toLowerCase()]=c.converters[D];for(y=A.shift();y;)if(c.responseFields[y]&&(w[c.responseFields[y]]=u),!E&&x&&c.dataFilter&&(u=c.dataFilter(u,c.dataType)),E=y,y=A.shift())if("*"===y)y=E;else if("*"!==E&&E!==y){if(D=z[E+" "+y]||z["* "+y],!D)for(C in z)if(r=C.split(" "),r[1]===y&&(D=z[E+" "+r[0]]||z["* "+r[0]])){!0===D?D=z[C]:!0!==z[C]&&(y=r[0],A.unshift(r[1]));break}if(!0!==D)if(D&&c["throws"])u=D(u);else try{u=D(u)}catch(F){r={state:"parsererror",error:D?F:"No conversion from "+E+" to "+y};break a}}r={state:"success",data:u}}d?(l.ifModified&&((s=v.getResponseHeader("Last-Modified"))&&($.lastModified[f]=s),(s=v.getResponseHeader("etag"))&&($.etag[f]=s)),204===a||"HEAD"===l.type?s="nocontent":304===a?s="notmodified":(s=r.state,e=r.data,k=r.error,d=!k)):(k=s,(a||!s)&&(s="error",0>a&&(a=0))),v.status=a,v.statusText=(b||s)+"",d?o.resolveWith(m,[e,s,v]):o.rejectWith(m,[v,s,k]),v.statusCode(q),q=void 0,i&&n.trigger(d?"ajaxSuccess":"ajaxError",[v,l,d?e:k]),p.fireWith(m,[v,s]),i&&(n.trigger("ajaxComplete",[v,l]),--$.active||$.event.trigger("ajaxStop"))}}"object"==typeof a&&(b=a,a=void 0),b=b||{};var d,e,f,g,h,i,j,k,l=$.ajaxSetup({},b),m=l.context||l,n=l.context&&(m.nodeType||m.jquery)?$(m):$.event,o=$.Deferred(),p=$.Callbacks("once memory"),q=l.statusCode||{},r={},s={},t=0,u="canceled",v={readyState:0,getResponseHeader:function(a){var b;if(2===t){if(!k)for(k={};b=se.exec(g);)k[b[1].toLowerCase()]=b[2];b=k[a.toLowerCase()]}return null==b?null:b},getAllResponseHeaders:function(){return 2===t?g:null},setRequestHeader:function(a,b){var c=a.toLowerCase();return t||(a=s[c]=s[c]||a,r[a]=b),this},overrideMimeType:function(a){return t||(l.mimeType=a),this},statusCode:function(a){var b;if(a)if(2>t)for(b in a)q[b]=[q[b],a[b]];else v.always(a[v.status]);return this},abort:function(a){return a=a||u,j&&j.abort(a),c(0,a),this}};if(o.promise(v).complete=p.add,v.success=v.done,v.error=v.fail,l.url=((a||l.url||pe)+"").replace(qe,"").replace(ue,oe[1]+"//"),l.type=b.method||b.type||l.method||l.type,l.dataTypes=$.trim(l.dataType||"*").toLowerCase().match(Dc)||[""],null==l.crossDomain&&(d=ve.exec(l.url.toLowerCase()),l.crossDomain=!(!d||d[1]===oe[1]&&d[2]===oe[2]&&(d[3]||("http:"===d[1]?"80":"443"))===(oe[3]||("http:"===oe[1]?"80":"443")))),l.data&&l.processData&&"string"!=typeof l.data&&(l.data=$.param(l.data,l.traditional)),K(we,l,b,v),2===t)return v;(i=l.global)&&0===$.active++&&$.event.trigger("ajaxStart"),l.type=l.type.toUpperCase(),l.hasContent=!te.test(l.type),f=l.url,l.hasContent||(l.data&&(f=l.url+=(me.test(f)?"&":"?")+l.data,delete l.data),!1===l.cache&&(l.url=re.test(f)?f.replace(re,"$1_="+le++):f+(me.test(f)?"&":"?")+"_="+le++)),l.ifModified&&($.lastModified[f]&&v.setRequestHeader("If-Modified-Since",$.lastModified[f]),$.etag[f]&&v.setRequestHeader("If-None-Match",$.etag[f])),(l.data&&l.hasContent&&!1!==l.contentType||b.contentType)&&v.setRequestHeader("Content-Type",l.contentType),v.setRequestHeader("Accept",l.dataTypes[0]&&l.accepts[l.dataTypes[0]]?l.accepts[l.dataTypes[0]]+("*"!==l.dataTypes[0]?", "+ye+"; q=0.01":""):l.accepts["*"]);for(e in l.headers)v.setRequestHeader(e,l.headers[e]);if(l.beforeSend&&(!1===l.beforeSend.call(m,v,l)||2===t))return v.abort();u="abort";for(e in{success:1,error:1,complete:1})v[e](l[e]);if(j=K(xe,l,b,v)){v.readyState=1,i&&n.trigger("ajaxSend",[v,l]),l.async&&0<l.timeout&&(h=setTimeout(function(){v.abort("timeout")},l.timeout));try{t=1,j.send(r,c)}catch(w){if(!(2>t))throw w;c(-1,w)}}else c(-1,"No Transport");return v},getJSON:function(a,b,c){return $.get(a,b,c,"json")},getScript:function(a,b){return $.get(a,void 0,b,"script")}}),$.each(["get","post"],function(a,b){$[b]=function(a,c,d,e){return $.isFunction(c)&&(e=e||d,d=c,c=void 0),$.ajax({url:a,type:b,dataType:e,data:c,success:d})}}),$.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(a,b){$.fn[b]=function(a){return this.on(b,a)}}),$._evalUrl=function(a){return $.ajax({url:a,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})},$.fn.extend({wrapAll:function(a){if($.isFunction(a))return this.each(function(b){$(this).wrapAll(a.call(this,b))});if(this[0]){var b=$(a,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&b.insertBefore(this[0]),b.map(function(){for(var a=this;a.firstChild&&1===a.firstChild.nodeType;)a=a.firstChild;return a}).append(this)}return this},wrapInner:function(a){return this.each($.isFunction(a)?function(b){$(this).wrapInner(a.call(this,b))}:function(){var b=$(this),c=b.contents();c.length?c.wrapAll(a):b.append(a)})},wrap:function(a){var b=$.isFunction(a);return this.each(function(c){$(this).wrapAll(b?a.call(this,c):a)})},unwrap:function(){return this.parent().each(function(){$.nodeName(this,"body")||$(this).replaceWith(this.childNodes)}).end()}}),$.expr.filters.hidden=function(a){return 0>=a.offsetWidth&&0>=a.offsetHeight||!Z.reliableHiddenOffsets()&&"none"===(a.style&&a.style.display||$.css(a,"display"))},$.expr.filters.visible=function(a){return!$.expr.filters.hidden(a)};var Ae=/%20/g,Be=/\[\]$/,Ce=/\r?\n/g,De=/^(?:submit|button|image|reset|file)$/i,Ee=/^(?:input|select|textarea|keygen)/i;$.param=function(a,b){var c,d=[],e=function(a,b){b=$.isFunction(b)?b():null==b?"":b,d[d.length]=encodeURIComponent(a)+"="+encodeURIComponent(b)};if(void 0===b&&(b=$.ajaxSettings&&$.ajaxSettings.traditional),$.isArray(a)||a.jquery&&!$.isPlainObject(a))$.each(a,function(){e(this.name,this.value)});else for(c in a)M(c,a[c],b,e);return d.join("&").replace(Ae,"+")},$.fn.extend({serialize:function(){return $.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var a=$.prop(this,"elements");return a?$.makeArray(a):this}).filter(function(){var a=this.type;return this.name&&!$(this).is(":disabled")&&Ee.test(this.nodeName)&&!De.test(a)&&(this.checked||!Qc.test(a))}).map(function(a,b){var c=$(this).val();return null==c?null:$.isArray(c)?$.map(c,function(a){return{name:b.name,value:a.replace(Ce,"\r\n")}}):{name:b.name,value:c.replace(Ce,"\r\n")}}).get()}}),$.ajaxSettings.xhr=void 0!==a.ActiveXObject?function(){var b;if(!(b=!this.isLocal&&/^(get|post|head|put|delete|options)$/i.test(this.type)&&O()))a:{try{b=new a.ActiveXObject("Microsoft.XMLHTTP");break a}catch(c){}b=void 0}return b}:O,$.ajaxSettings.xhr=void 0===a.ActiveXObject?N:function(){return(this.url==zc.location||0==this.url.indexOf("http")||!this.isLocal)&&/^(get|post|head|put|delete|options)$/i.test(this.type)&&N()||N(1)};var Fe=0,Ge={},He=$.ajaxSettings.xhr();a.ActiveXObject&&$(a).on("unload",function(){for(var a in Ge)Ge[a](void 0,!0)}),Z.cors=!!He&&"withCredentials"in He,(He=Z.ajax=!!He)&&$.ajaxTransport(function(a){if(!a.crossDomain||Z.cors){var b;return{send:function(c,d){var e,f=a.xhr(),g=++Fe;if(f.open(a.type,a.url,a.async,a.username,a.password),a.xhrFields)for(e in a.xhrFields)f[e]=a.xhrFields[e];a.mimeType&&f.overrideMimeType&&f.overrideMimeType(a.mimeType),!a.crossDomain&&!c["X-Requested-With"]&&(c["X-Requested-With"]="XMLHttpRequest");for(e in c)void 0!==c[e]&&f.setRequestHeader(e,c[e]+"");f.send(a.hasContent&&a.data||null),b=function(c,e){var h,i,j;if(b&&(e||4===f.readyState))if(delete Ge[g],b=void 0,f.onreadystatechange=$.noop,e)4!==f.readyState&&f.abort();else{j={},h=f.status,"string"==typeof f.responseText&&(j.text=f.responseText);try{i=f.statusText}catch(k){i=""}h||!a.isLocal||a.crossDomain?1223===h&&(h=204):h=j.text?200:404}j&&d(h,i,j,f.getAllResponseHeaders())},a.async?4===f.readyState?setTimeout(b):f.onreadystatechange=Ge[g]=b:b()},abort:function(){b&&b(void 0,!0)}}}}),$.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(a){return $.globalEval(a),a}}}),$.ajaxPrefilter("script",function(a){void 0===a.cache&&(a.cache=!1),a.crossDomain&&(a.type="GET",a.global=!1)}),$.ajaxTransport("script",function(a){if(a.crossDomain){var b,c=zc.head||$("head")[0]||zc.documentElement;return{send:function(d,e){b=zc.createElement("script"),b.async=!0,a.scriptCharset&&(b.charset=a.scriptCharset),b.src=a.url,b.onload=b.onreadystatechange=function(a,c){(c||!b.readyState||/loaded|complete/.test(b.readyState))&&(b.onload=b.onreadystatechange=null,b.parentNode&&b.parentNode.removeChild(b),b=null,c||e(200,"success"))},c.insertBefore(b,c.firstChild)},abort:function(){b&&b.onload(void 0,!0)}}}});var Ie=[],Je=/(=)\?(?=&|$)|\?\?/;$.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var a=Ie.pop()||$.expando+"_"+le++;return this[a]=!0,a}}),$.ajaxPrefilter("json jsonp",function(b,c,d){var e,f,g,h=!1!==b.jsonp&&(Je.test(b.url)?"url":"string"==typeof b.data&&!(b.contentType||"").indexOf("application/x-www-form-urlencoded")&&Je.test(b.data)&&"data");return h||"jsonp"===b.dataTypes[0]?(e=b.jsonpCallback=$.isFunction(b.jsonpCallback)?b.jsonpCallback():b.jsonpCallback,h?b[h]=b[h].replace(Je,"$1"+e):!1!==b.jsonp&&(b.url+=(me.test(b.url)?"&":"?")+b.jsonp+"="+e),b.converters["script json"]=function(){return g||$.error(e+" was not called"),g[0]},b.dataTypes[0]="json",f=a[e],a[e]=function(){g=arguments},d.always(function(){a[e]=f,b[e]&&(b.jsonpCallback=c.jsonpCallback,Ie.push(e)),g&&$.isFunction(f)&&f(g[0]),g=f=void 0}),"script"):void 0}),$.parseHTML=function(a,b,c){if(!a||"string"!=typeof a)return null;"boolean"==typeof b&&(c=b,b=!1),b=b||zc;var d=wc.exec(a);return c=!c&&[],d?[b.createElement(d[1])]:(d=$.buildFragment([a],b,c),c&&c.length&&$(c).remove(),$.merge([],d.childNodes))};var Ke=$.fn.load;$.fn.load=function(a,b,c){if("string"!=typeof a&&Ke)return Ke.apply(this,arguments);var d,e,f,g=this,h=a.indexOf(" ");return h>=0&&(d=a.slice(h,a.length),a=a.slice(0,h)),$.isFunction(b)?(c=b,b=void 0):b&&"object"==typeof b&&(f="POST"),0<g.length&&$.ajax({url:a,type:f,dataType:"html",data:b}).done(function(a){e=arguments,g.html(d?$("<div>").append($.parseHTML(a)).find(d):a)}).complete(c&&function(a,b){g.each(c,e||[a.responseText,b,a])}),this},$.expr.filters.animated=function(a){return $.grep($.timers,function(b){return a===b.elem}).length};var Le=a.document.documentElement;$.offset={setOffset:function(a,b,c){var d,e,f,g=$.css(a,"position"),h=$(a),i={};"static"===g&&(a.style.position="relative"),f=h.offset(),e=$.css(a,"top"),d=$.css(a,"left"),("absolute"===g||"fixed"===g)&&-1<$.inArray("auto",[e,d])?(d=h.position(),e=d.top,d=d.left):(e=parseFloat(e)||0,d=parseFloat(d)||0),$.isFunction(b)&&(b=b.call(a,c,f)),null!=b.top&&(i.top=b.top-f.top+e),null!=b.left&&(i.left=b.left-f.left+d),"using"in b?b.using.call(a,i):h.css(i)}},$.fn.extend({offset:function(a){if(arguments.length)return void 0===a?this:this.each(function(b){$.offset.setOffset(this,a,b)});var b,c,d={top:0,left:0},e=(c=this[0])&&c.ownerDocument;return e?(b=e.documentElement,$.contains(b,c)?(typeof c.getBoundingClientRect!==Hc&&(d=c.getBoundingClientRect()),c=P(e),{top:d.top+(c.pageYOffset||b.scrollTop)-(b.clientTop||0),left:d.left+(c.pageXOffset||b.scrollLeft)-(b.clientLeft||0)}):d):void 0},position:function(){if(this[0]){var a,b,c={top:0,left:0},d=this[0];return"fixed"===$.css(d,"position")?b=d.getBoundingClientRect():(a=this.offsetParent(),b=this.offset(),$.nodeName(a[0],"html")||(c=a.offset()),c.top+=$.css(a[0],"borderTopWidth",!0),c.left+=$.css(a[0],"borderLeftWidth",!0)),{top:b.top-c.top-$.css(d,"marginTop",!0),left:b.left-c.left-$.css(d,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var a=this.offsetParent||Le;a&&!$.nodeName(a,"html")&&"static"===$.css(a,"position");)a=a.offsetParent;return a||Le})}}),$.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(a,b){var c=/Y/.test(b);$.fn[a]=function(d){return Pc(this,function(a,d,e){var f=P(a);return void 0===e?f?b in f?f[b]:f.document.documentElement[d]:a[d]:void(f?f.scrollTo(c?$(f).scrollLeft():e,c?e:$(f).scrollTop()):a[d]=e)},a,d,arguments.length,null)}}),$.each(["top","left"],function(a,b){$.cssHooks[b]=y(Z.pixelPosition,function(a,c){return c?(c=wd(a,b),yd.test(c)?$(a).position()[b]+"px":c):void 0})}),$.each({Height:"height",Width:"width"},function(a,b){$.each({padding:"inner"+a,content:b,"":"outer"+a},function(c,d){$.fn[d]=function(d,e){var f=arguments.length&&(c||"boolean"!=typeof d),g=c||(!0===d||!0===e?"margin":"border");return Pc(this,function(b,c,d){return $.isWindow(b)?b.document.documentElement["client"+a]:9===b.nodeType?(c=b.documentElement,Math.max(b.body["scroll"+a],c["scroll"+a],b.body["offset"+a],c["offset"+a],c["client"+a])):void 0===d?$.css(b,c,g):$.style(b,c,d,g)},b,f?d:void 0,f,null)}})}),$.fn.size=function(){return this.length},$.fn.andSelf=$.fn.addBack,"function"==typeof define&&define.amd&&define("jquery",[],function(){return $});var Me=a.jQuery,Ne=a.$;return $.noConflict=function(b){return a.$===$&&(a.$=Ne),b&&a.jQuery===$&&(a.jQuery=Me),$},typeof b===Hc&&(a.jQuery=a.$=$),$}),function(a){function b(a){try{return a?new window.ActiveXObject("Microsoft.XMLHTTP"):new window.XMLHttpRequest}catch(b){}}a.ajaxSettings.xhr=void 0===window.ActiveXObject?b:function(){return(this.url==document.location||0==this.url.indexOf("http")||!this.isLocal)&&/^(get|post|head|put|delete|options)$/i.test(this.type)&&b()||b(1)},a.extend(a.support,{iecors:!!window.XDomainRequest}),a.support.iecors?a.ajaxTransport(function(a){return{send:function(b,c){var d=new window.XDomainRequest;d.onload=function(){c(200,"OK",{text:d.responseText},{"Content-Type":d.contentType})},a.xhrFields&&(d.onerror=a.xhrFields.error,d.ontimeout=a.xhrFields.timeout),d.open(a.type,a.url),d.send(a.hasContent&&a.data||null)},abort:function(){xdr.abort()}}}):(a.ajaxSetup({accepts:{binary:"text/plain; charset=x-user-defined"},responseFields:{binary:"response"}}),a.ajaxTransport("binary",function(a){var b;return{send:function(c,d){var e=a.xhr();e.open(a.type,a.url,a.async);var f=!1;try{e.hasOwnProperty("responseType")&&(e.responseType="arraybuffer",f=!0)}catch(g){}try{!f&&e.overrideMimeType&&e.overrideMimeType("text/plain; charset=x-user-defined")}catch(h){}!a.crossDomain&&!c["X-Requested-With"]&&(c["X-Requested-With"]="XMLHttpRequest");try{for(var i in c)e.setRequestHeader(i,c[i])}catch(j){}e.send(a.hasContent&&a.data||null),b=function(){var c=e.status,f="",g=e.getAllResponseHeaders(),h={};try{if(b&&4===e.readyState){b=void 0;try{h.text="string"==typeof e.responseText?e.responseText:null}catch(i){}try{h.binary=e.response}catch(j){}try{f=e.statusText}catch(k){f=""}c||!a.isLocal||a.crossDomain?1223===c&&(c=204):c=h.text?200:404,d(c,f,h,g)}}catch(l){alert(l),d(-1,l)}},a.async?4===e.readyState?setTimeout(b):e.onreadystatechange=b:b()},abort:function(){}}}))}(jQuery),function(a,b,c,d){function e(c,e){function f(b){a(g).each(function(){self.Jmol&&(0<=e.indexOf("mouseup")||0<=e.indexOf("touchend"))&&Jmol._setMouseOwner(null);var c=a(this);this!==b.target&&!c.has(b.target).length&&c.triggerHandler(e,[b.target,b])})}e=e||c+d;var g=a(),h=c+"."+e+"-special-event";a.event.special[e]={setup:function(){g=g.add(this),1===g.length&&a(b).bind(h,f)},teardown:function(){self.Jmol&&Jmol._setMouseOwner(null),g=g.not(this),0===g.length&&a(b).unbind(h)},add:function(a){var b=a.handler;a.handler=function(a,c){a.target=c,b.apply(this,arguments)}}}}a.map(c.split(" "),function(a){e(a)}),e("focusin","focus"+d),e("focusout","blur"+d)}(jQuery,document,"click mousemove mouseup touchmove touchend","outjsmol"),"undefined"==typeof jQuery&&alert("Note -- JSmoljQuery is required for JSmol, but it's not defined."),self.Jmol||(Jmol={}),Jmol._version||(Jmol=function(a){var b=function(a){return{header:a++,rear:a++,main:a++,image:a++,front:a++,fileOpener:a++,coverImage:a++,dialog:a++,menu:a+9e4,console:a+91e3,monitorZIndex:a+99999}},b={_version:"JSmol 14.1.14 Apr 27, 2014",_alertNoBinary:!0,_allowedJmolSize:[25,2048,300],_fileCache:null,_jarFile:null,_j2sPath:null,_use:null,_j2sLoadMonitorOpacity:90,_applets:{},_asynchronous:!0,_ajaxQueue:[],_getZOrders:b,_z:b(Jmol.z||9e3),_debugCode:!0,db:{_databasePrefixes:"$=:",_fileLoadScript:";if (_loadScript = '' && defaultLoadScript == '' && _filetype == 'Pdb') { select protein or nucleic;cartoons Only;color structure; select * };",_nciLoadScript:";n = ({molecule=1}.length < {molecule=2}.length ? 2 : 1); select molecule=n;display selected;center selected;",_pubChemLoadScript:"",_DirectDatabaseCalls:{"cactus.nci.nih.gov":"%URL","www.rcsb.org":"%URL","pubchem.ncbi.nlm.nih.gov":"%URL","http://www.nmrdb.org/tools/jmol/predict.php":"%URL",$:"http://cactus.nci.nih.gov/chemical/structure/%FILENCI/file?format=sdf&get3d=True",$$:"http://cactus.nci.nih.gov/chemical/structure/%FILENCI/file?format=sdf","=":"http://www.rcsb.org/pdb/files/%FILE.pdb","==":"http://www.rcsb.org/pdb/files/ligand/%FILE.cif",":":"http://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/%FILE/SDF?record_type=3d"},_restQueryUrl:"http://www.rcsb.org/pdb/rest/search",_restQueryXml:"<orgPdbQuery><queryType>org.pdb.query.simple.AdvancedKeywordQuery</queryType><description>Text Search</description><keywords>QUERY</keywords></orgPdbQuery>",_restReportUrl:"http://www.pdb.org/pdb/rest/customReport?pdbids=IDLIST&customReportColumns=structureId,structureTitle"},_debugAlert:!1,_document:a,_isXHTML:!1,_lastAppletID:null,_mousePageX:null,_mouseOwner:null,_serverUrl:"http://your.server.here/jsmol.php",_syncId:(""+Math.random()).substring(3),_touching:!1,_XhtmlElement:null,_XhtmlAppendChild:!1};a=a.location.href.toLowerCase(),b._httpProto=0==a.indexOf("https")?"https://":"http://",b._isFile=0==a.indexOf("file:"),b._ajaxTestSite=b._httpProto+"google.com",a=b._isFile||0==a.indexOf("http://localhost")||0==a.indexOf("http://127."),b._tracker="http://"==b._httpProto&&!a&&"http://chemapps.stolaf.edu/jmol/JmolTracker.htm?id=UA-45940799-1",b._isChrome=0<=navigator.userAgent.toLowerCase().indexOf("chrome"),b._isSafari=!b._isChrome&&0<=navigator.userAgent.toLowerCase().indexOf("safari"),b._isMsie=void 0!==window.ActiveXObject,b._useDataURI=!b._isSafari&&!b._isMsie;for(var c in Jmol)b[c]=Jmol[c];return b}(document,Jmol)),function(a,m){a.$=function(a,b){return null==a&&alert(b+arguments.callee.caller.toString()),m(b?"#"+a._id+"_"+b:a)},a._$=function(a){return"string"==typeof a?m("#"+a):a},a.$ajax=function(b){return a._ajaxCall=b.url,b.cache="NO"!=b.cache,0==b.url.indexOf("http://pubchem.ncbi.nlm.nih")&&(b.url="https://"+b.url.substring(7)),m.ajax(b)},a._getNCIInfo=function(b,c){return"name"==c&&(c="names"),url="http://cactus.nci.nih.gov/chemical/structure/"+b+"/"+c,a._getFileData(url)},a.$appEvent=function(b,c,d,e){b=a.$(b,c),b.off(d)&&e&&b.on(d,e)},a.$resize=function(a){return m(window).resize(a)},a.$after=function(a,b){return m(a).after(b)},a.$bind=function(a,b,c){return c?m(a).bind(b,c):m(a).unbind(b)},a.$closest=function(a,b){return m(a).closest(b)},a.$get=function(a,b){return m(a).get(b)},a.$documentOff=function(a,b){return m(document).off(a,"#"+b)},a.$documentOn=function(a,b,c){return m(document).on(a,"#"+b,c)},a.$getAncestorDiv=function(a,b){return m("div."+b+":has(#"+a+")")[0]},a.$supportsIECrossDomainScripting=function(){return m.support.iecors},a.$attr=function(b,c,d){return a._$(b).attr(c,d)},a.$css=function(b,c){return a._$(b).css(c)},a.$find=function(b,c){return a._$(b).find(c)},a.$focus=function(b){return a._$(b).focus()},a.$html=function(b,c){return a._$(b).html(c)},a.$offset=function(b){return a._$(b).offset()},a.$windowOn=function(a,b){return m(window).on(a,b)},a.$prop=function(b,c,d){var e=a._$(b);return 3==arguments.length?e.prop(c,d):e.prop(c)},a.$remove=function(b){return a._$(b).remove()},a.$scrollTo=function(b,c){var d=a._$(b);return d.scrollTop(0>c?d[0].scrollHeight:c)},a.$setEnabled=function(b,c){return a._$(b).attr("disabled",c?null:"disabled")},a.$setSize=function(b,c,d){return a._$(b).width(c).height(d)},a.$setVisible=function(b,c){var d=a._$(b);return c?d.show():d.hide()},a.$submit=function(b){return a._$(b).submit()},a.$val=function(b,c){var d=a._$(b);return 1==arguments.length?d.val():d.val(c)},a._clearVars=function(){delete jQuery,delete m,delete a,delete SwingController,delete J,delete JM,delete JS,delete JSV,delete JU,delete JV,delete java,delete javajs,delete Clazz,delete c$};var g=document,j=window,e={};e.ua=navigator.userAgent.toLowerCase();var q;a:{q=["linux","unix","mac","win"];for(var d=q.length;d--;)if(-1!=e.ua.indexOf(q[d])){q=q[d];break a}q="unknown"}e.os=q,e.browser=function(){for(var a=e.ua,b="konqueror webkit omniweb opera webtv icab msie mozilla".split(" "),c=0;c<b.length;c++)if(0<=a.indexOf(b[c]))return b[c];return"unknown"},e.browserName=e.browser(),e.browserVersion=parseFloat(e.ua.substring(e.ua.indexOf(e.browserName)+e.browserName.length+1)),e.supportsXhr2=function(){return m.support.cors||m.support.iecors},e.allowDestroy="msie"!=e.browserName,e.allowHTML5="msie"!=e.browserName||0>navigator.appVersion.indexOf("MSIE 8"),e.getDefaultLanguage=function(){return navigator.language||navigator.userLanguage||"en-US"},e._webGLtest=0,e.supportsWebGL=function(){if(!a.featureDetection._webGLtest){var b;a.featureDetection._webGLtest=j.WebGLRenderingContext&&((b=g.createElement("canvas")).getContext("webgl")||b.getContext("experimental-webgl"))?1:-1}return 0<a.featureDetection._webGLtest},e.supportsLocalization=function(){for(var a=g.getElementsByTagName("meta"),b=a.length;0<=--b;)if(0<=a[b].outerHTML.toLowerCase().indexOf("utf-8"))return!0;return!1},e.supportsJava=function(){return a.featureDetection._javaEnabled||(a.featureDetection._javaEnabled=a._isMsie?navigator.javaEnabled()?1:-1:!navigator.javaEnabled()||navigator.mimeTypes&&!navigator.mimeTypes["application/x-java-applet"]?-1:1),0<a.featureDetection._javaEnabled},e.compliantBrowser=function(){var a=!!g.getElementById,b=e.os;return("opera"==e.browserName&&7.54>=e.browserVersion&&"mac"==b||"webkit"==e.browserName&&125.12>e.browserVersion||"msie"==e.browserName&&"mac"==b||"konqueror"==e.browserName&&3.3>=e.browserVersion)&&(a=!1),a},e.isFullyCompliant=function(){return e.compliantBrowser()&&e.supportsJava()},e.useIEObject="win"==e.os&&"msie"==e.browserName&&5.5<=e.browserVersion,e.useHtml4Object="mozilla"==e.browserName&&5<=e.browserVersion||"opera"==e.browserName&&8<=e.browserVersion||"webkit"==e.browserName,e.hasFileReader=j.File&&j.FileReader,a.featureDetection=e,a._ajax=function(b){return b.async?(a._ajaxQueue.push(b),void(1==a._ajaxQueue.length&&a._ajaxDone())):a.$ajax(b).responseText},a._ajaxDone=function(){var b=a._ajaxQueue.shift();b&&a.$ajax(b)},a._grabberOptions=[["$","NCI(small molecules)"],[":","PubChem(small molecules)"],["=","RCSB(macromolecules)"]],a._getGrabberOptions=function(b){if(0==a._grabberOptions.length)return"";var c='<input type="text" id="ID_query" onfocus="jQuery(this).select()" onkeypress="if(13==event.which){Jmol._applets[\'ID\']._search();return false}" size="32" value="" />',d='<button id="ID_submit" onclick="Jmol._applets[\'ID\']._search()">Search</button></nobr>';1==a._grabberOptions.length?(c="<nobr>"+c+'<span style="display:none">',d="</span>"+d):c+="<br /><nobr>";for(var c=c+'<select id="ID_select">',e=0;e<a._grabberOptions.length;e++)var f=a._grabberOptions[e],c=c+('<option value="'+f[0]+'" '+(0==e?"selected":"")+">"+f[1]+"</option>");return c=(c+"</select>"+d).replace(/ID/g,b._id),"<br />"+c},a._getScriptForDatabase=function(b){return"$"==b?a.db._nciLoadScript:":"==b?a.db._pubChemLoadScript:a.db._fileLoadScript},a._setInfo=function(a,b,c){var d=[],e="";if(0==c.indexOf("ERROR"))e=c;else switch(b){case"=":for(b=c.split("<dimStructure.structureId>"),d=["<table>"],c=1;c<b.length;c++)d.push('<tr><td valign=top><a href="javascript:Jmol.search('+a._id+",'="+b[c].substring(0,4)+"')\">"+b[c].substring(0,4)+"</a></td>"),d.push("<td>"+b[c].split("Title>")[1].split("</")[0]+"</td></tr>");d.push("</table>"),e=b.length-1+" matches";break;case"$":case":":break;default:return}a._infoHeader=e,a._info=d.join(""),a._showInfo(!0)},a._loadSuccess=function(b,c){c&&(a._ajaxDone(),c(b))},a._loadError=function(b){a._ajaxDone(),a.say("Error connecting to server: "+a._ajaxCall),null!=b&&b()},a._isDatabaseCall=function(b){return 0<=a.db._databasePrefixes.indexOf(b.substring(0,1))},a._getDirectDatabaseCall=function(b,c){if(c&&!a.featureDetection.supportsXhr2())return b;var d,e=2,f=a.db._DirectDatabaseCalls[b.substring(0,e)];return f||(f=a.db._DirectDatabaseCalls[d=b.substring(0,--e)]),f&&(":"==d?(d=b.toLowerCase(),isNaN(parseInt(b.substring(1)))?0==d.indexOf(":smiles:")?(f+="?POST?smiles="+b.substring(8),b="smiles"):0==d.indexOf(":cid:")?b="cid/"+b.substring(5):(0==d.indexOf(":name:")?b=b.substring(5):0==d.indexOf(":cas:")&&(b=b.substring(4)),b="name/"+encodeURIComponent(b.substring(e))):b="cid/"+b.substring(1)):b=encodeURIComponent(b.substring(e)),0<=f.indexOf("FILENCI")?(b=b.replace(/\%2F/g,"/"),b=f.replace(/\%FILENCI/,b)):b=f.replace(/\%FILE/,b)),b},a._getRawDataFromServer=function(b,c,d,e,f,g){return b="?call=getRawDataFromDatabase&database="+b+(0<=c.indexOf("?POST?")?"?POST?":"")+"&query="+encodeURIComponent(c)+(f?"&encoding=base64":"")+(g?"":"&script="+encodeURIComponent(a._getScriptForDatabase(b))),a._contactServer(b,d,e)},a._checkFileName=function(b,c,d){return a._isDatabaseCall(c)&&(d&&a._setQueryTerm(b,c),c=a._getDirectDatabaseCall(c,!0),a._isDatabaseCall(c)&&(c=a._getDirectDatabaseCall(c,!1),d&&(d[0]=!0))),c},a._checkCache=function(b,c,d){if(b._cacheFiles&&a._fileCache&&!c.endsWith(".js")){if(b=a._fileCache[c])return System.out.println("using "+b.length+" bytes of cached data for "+c),d(b),null;d=function(b,c){d(a._fileCache[b]=c)}}return d},a._loadFileData=function(b,c,d,e){var f=[];c=a._checkFileName(b,c,f),d=a._checkCache(b,c,d),f[0]?a._getRawDataFromServer("_",c,d,e):(b={type:"GET",dataType:"text",url:c,async:a._asynchronous,success:function(b){a._loadSuccess(b,d)},error:function(){a._loadError(e)}},a._checkAjaxPost(b),a._ajax(b))},a._getInfoFromDatabase=function(b,c,d){if("===="==c){var e=a.db._restQueryXml.replace(/QUERY/,d),e={dataType:"text",type:"POST",contentType:"application/x-www-form-urlencoded",url:a.db._restQueryUrl,data:encodeURIComponent(e)+"&req=browser",success:function(e){a._ajaxDone(),a._extractInfoFromRCSB(b,c,d,e)},error:function(){a._loadError(null)},async:a._asynchronous};return a._ajax(e)}return d="?call=getInfoFromDatabase&database="+c+"&query="+encodeURIComponent(d),a._contactServer(d,function(d){a._setInfo(b,c,d)})},a._extractInfoFromRCSB=function(b,c,d,e){var f=e.length/5;if(0!=f&&4==d.length&&1!=f){d=d.toUpperCase();var g=e.indexOf(d);g>0&&0<="123456789".indexOf(d.substring(0,1))&&(e=d+","+e.substring(0,g)+e.substring(g+5)),f>50&&(e=e.substring(0,250)),e=e.replace(/\n/g,","),e=a._restReportUrl.replace(/IDLIST/,e),a._loadFileData(b,e,function(d){a._setInfo(b,c,d)})}},a._checkAjaxPost=function(a){var b=a.url.indexOf("?POST?");b>0&&(a.data=a.url.substring(b+6),a.url=a.url.substring(0,b),a.type="POST",a.contentType="application/x-www-form-urlencoded")},a._contactServer=function(b,c,d){return b={dataType:"text",type:"GET",url:a._serverUrl+b,success:function(b){a._loadSuccess(b,c)},error:function(){a._loadError(d)},async:c?a._asynchronous:!1},a._checkAjaxPost(b),a._ajax(b)},a._setQueryTerm=function(b,c){if(c&&b._hasOptions&&"http://"!=c.substring(0,7)){if(a._isDatabaseCall(c)){var d=c.substring(0,1);c=c.substring(1),c.substring(0,1)==d&&0<="=$".indexOf(d)&&(c=c.substring(1));var e=a._getElement(b,"select");if(e&&e.options)for(var f=0;f<e.options.length;f++)e[f].value==d&&(e[f].selected=!0)}a.$val(a.$(b,"query"),c)}},a._search=function(b,c,d){1<arguments.length||(c=null),a._setQueryTerm(b,c),c||(c=a.$val(a.$(b,"query"))),0==c.indexOf("!")?b._script(c.substring(1)):(c&&(c=c.replace(/\"/g,"")),b._showInfo(!1),a._searchMol(b,c,d,!0))},a._searchMol=function(b,c,d,e){var f;a._isDatabaseCall(c)?(f=c.substring(0,1),c=c.substring(1)):f=b._hasOptions?a.$val(a.$(b,"select")):"$","="==f&&3==c.length&&(c="="+c);var g=f+c;if(c&&!(0>g.indexOf("?")&&g==b._thisJmolModel)){b._thisJmolModel=g;var h;e&&null!=b._viewSet&&null!=(h=a.View.__findView(b._viewSet,{chemID:g}))?a.View.__setView(h,b,!1):("$"==f||":"==f?b._jmolFileType="MOL":"="==f&&(b._jmolFileType="PDB"),b._searchDatabase(c,f,d))}},a._searchDatabase=function(b,c,d,e){return b._showInfo(!1),0<=c.indexOf("?")?(a._getInfoFromDatabase(b,d,c.split("?")[0]),!0):a.db._DirectDatabaseCalls[d]?(b._loadFile(d+c,e),!0):!1},a._syncBinaryOK="?",a._canSyncBinary=function(b){if(self.VBArray)return a._syncBinaryOK=!1;if("?"!=a._syncBinaryOK)return a._syncBinaryOK;a._syncBinaryOK=!0;try{var c=new window.XMLHttpRequest;c.open("text",a._ajaxTestSite,!1),c.hasOwnProperty("responseType")?c.responseType="arraybuffer":c.overrideMimeType&&c.overrideMimeType("text/plain; charset=x-user-defined")}catch(d){return System.out.println("JSmolCore.js: synchronous binary file transfer is requested but not available"),a._alertNoBinary&&!b&&alert("JSmolCore.js: synchronous binary file transfer is requested but not available"),a._syncBinaryOK=!1}return!0},a._binaryTypes=".gz .jpg .png .zip .jmol .bin .smol .spartan .mrc .pse .map .omap".split(" "),a._isBinaryUrl=function(b){for(var c=a._binaryTypes.length;0<=--c;)if(0<=b.indexOf(a._binaryTypes[c]))return!0;return!1},a._getFileData=function(b,c){var d=a._isBinaryUrl(b)?"binary":"text",e=0<=b.indexOf("pdb.gz")&&0==b.indexOf("http://www.rcsb.org/pdb/files/"),f="binary"==d&&!a._canSyncBinary(e);f&&e&&(b=b.replace(/pdb\.gz/,"pdb"),f=!1,d="text"),e=0<=b.indexOf("?POST?"),0==b.indexOf("file:/")&&0!=b.indexOf("file:///")&&(b="file://"+b.substring(5));var g=0>b.indexOf("://")||0==b.indexOf(document.location.protocol)&&0<=b.indexOf(document.location.host),h=a._isDirectCall(b),i=!g&&a.$supportsIECrossDomainScripting();if((!c||f)&&(i||f||!g&&!h))return a._getRawDataFromServer("_",b,c,c,f,!0);b=b.replace(/file:\/\/\/\//,"file://");var j={dataType:d,async:!!c};return e?(j.type="POST",j.url=b.split("?POST?")[0],j.data=b.split("?POST?")[1]):(j.type="GET",j.url=b),c&&(j.success=function(){c(a._xhrReturn(j.xhr))},j.error=function(){c(xhr.statusText)}),j.xhr=a.$ajax(j),c?void 0:a._xhrReturn(j.xhr)},a._xhrReturn=function(a){return!a.responseText||self.Clazz&&Clazz.instanceOf(a.response,self.ArrayBuffer)?a.response||a.statusText:a.responseText},a._isDirectCall=function(b){for(var c in a.db._DirectDatabaseCalls)if(0<=c.indexOf(".")&&0<=b.indexOf(c))return!0;return!1},a._cleanFileData=function(a){return 0<=a.indexOf("\r")&&0<=a.indexOf("\n")?a.replace(/\r\n/g,"\n"):0<=a.indexOf("\r")?a.replace(/\r/g,"\n"):a},a._getFileType=function(a){var b=a.substring(0,1);return"$"==b||":"==b?"MOL":"="==b?"="==a.substring(1,2)?"LCIF":"PDB":(a=a.split(".").pop().toUpperCase(),a.substring(0,Math.min(a.length,3)))},a._getZ=function(b,c){return b&&b._z&&b._z[c]||a._z[c]},a._incrZ=function(b,c){return b&&b._z&&++b._z[c]||++a._z[c]},a._loadFileAsynchronously=function(b,c,d,e){if(0!=d.indexOf("?")){d=a._checkFileName(c,d);var f=function(c){a._setData(b,d,c,e)},f=a._checkCache(c,d,f);return null==f?null:a._getFileData(d,f)}return a.featureDetection.hasFileReader?(c._localReader||(f='<div id="ID" style="z-index:'+a._getZ(c,"fileOpener")+';position:absolute;background:#E0E0E0;left:10px;top:10px"><div style="margin:5px 5px 5px 5px;"><input type="file" id="ID_files" /><button id="ID_loadfile">load</button><button id="ID_cancel">cancel</button></div><div>',a.$after("#"+c._id+"_appletdiv",f.replace(/ID/g,c._id+"_localReader")),c._localReader=a.$(c,"localReader")),a.$appEvent(c,"localReader_loadfile","click"),a.$appEvent(c,"localReader_loadfile","click",function(){var d=a.$(c,"localReader_files")[0].files[0],f=new FileReader;
f.onloadend=function(f){f.target.readyState==FileReader.DONE&&(a.$css(a.$(c,"localReader"),{display:"none"}),a._setData(b,d.name,f.target.result,e))},f.readAsArrayBuffer(d)}),a.$appEvent(c,"localReader_cancel","click"),a.$appEvent(c,"localReader_cancel","click",function(){a.$css(a.$(c,"localReader"),{display:"none"}),b.setData(null,e)}),void a.$css(a.$(c,"localReader"),{display:"block"})):b.setData("Local file reading is not enabled in your browser",null,e)},a._setData=function(b,c,d,e){d=a._strToBytes(d),0<=c.indexOf(".jdx")&&a.Cache.put("cache://"+c,d),b.setData(c,d,e)},a._toBytes=function(a){if("string"==typeof a)return a.getBytes();a=new Uint8Array(a);for(var b=Clazz.newByteArray(a.length,0),c=a.length;0<=--c;)b[c]=a[c];return b},a._doAjax=function(b,c,d){return b=b.toString(),null!=d?a._saveFile(b,d):(c&&(b+="?POST?"+c),c=a._getFileData(b),a._processData(c,a._isBinaryUrl(b)))},a._saveFile=function(b,c,d,e){if(a._localFileSaveFunction&&a._localFileSaveFunction(b,c))return"OK";b=b.substring(b.lastIndexOf("/")+1),d||(d=0<=b.indexOf(".pdf")?"application/pdf":0<=b.indexOf(".png")?"image/png":0<=b.indexOf(".jpg")?"image/jpg":"");var f="string"==typeof c;return f||(c=(JU?JU:J.util).Base64.getBase64(c).toString()),e||(e=f?"":"base64"),(f=a._serverUrl)&&0<=f.indexOf("your.server")&&(f=""),a._useDataURI||!f?(e||(c=btoa(c)),e=document.createElement("a"),e.href="data:"+d+";base64,"+c,e.type=d||"text/plain",e.download=b,e.target="_blank",m("body").append(e),e.click(),e.remove()):(a._formdiv||(a.$after("body",'<div id="__jsmolformdiv__" style="display:none">						<form id="__jsmolform__" method="post" target="_blank" action="">						<input name="call" value="saveFile"/>						<input id="__jsmolmimetype__" name="mimetype" value=""/>						<input id="__jsmolencoding__" name="encoding" value=""/>						<input id="__jsmolfilename__" name="filename" value=""/>						<textarea id="__jsmoldata__" name="data"></textarea>						</form>						</div>'),a._formdiv="__jsmolform__"),a.$attr(a._formdiv,"action",f+"?"+(new Date).getMilliseconds()),a.$val("__jsmoldata__",c),a.$val("__jsmolfilename__",b),a.$val("__jsmolmimetype__",d),a.$val("__jsmolencoding__",e),a.$submit("__jsmolform__"),a.$val("__jsmoldata__",""),a.$val("__jsmolfilename__","")),"OK"},a._processData=function(b,c){return"undefined"==typeof b&&(b="",c=!1),c&&(c=a._canSyncBinary()),c?a._strToBytes(b):JU.SB.newS(b)},a._strToBytes=function(b){if(Clazz.instanceOf(b,self.ArrayBuffer))return a._toBytes(b);for(var c=Clazz.newByteArray(b.length,0),d=b.length;0<=--d;)c[d]=255&b.charCodeAt(d);return c},a._setConsoleDiv=function(a){self.Clazz&&Clazz.setConsoleDiv(a)},a._setJmolParams=function(b,c,d){for(var e in c)0<=";progressbar;progresscolor;boxbgcolor;boxfgcolor;allowjavascript;boxmessage;									;messagecallback;pickcallback;animframecallback;appletreadycallback;atommovedcallback;									;echocallback;evalcallback;hovercallback;language;loadstructcallback;measurecallback;									;minimizationcallback;resizecallback;scriptcallback;statusform;statustext;statustextarea;									;synccallback;usecommandthread;syncid;appletid;startupscript;menufile;".indexOf(";"+e.toLowerCase()+";")&&("language"!=e||a.featureDetection.supportsLocalization())&&(d?b.put(e,!0===c[e]?Boolean.TRUE:!1===c[e]?Boolean.FALSE:c[e]):b[e]=c[e])},a._registerApplet=function(b,c){return window[b]=a._applets[b]=a._applets[c]=a._applets[b+"__"+a._syncId+"__"]=c},a._readyCallback=function(b,c,d,e){b=b.split("_object")[0],d=d.booleanValue?d.booleanValue():d,a._track(a._applets[b])._readyCallback(b,c,d,e)},a._getWrapper=function(b,c){var d;if(c){var e="";b._coverImage&&(d=' onclick="Jmol.coverApplet(ID, false)" title="'+b._coverTitle+'"',e='<image id="ID_coverclickgo" src="'+b._j2sPath+'/img/play_make_live.jpg" style="width:25px;height:25px;position:absolute;bottom:10px;left:10px;z-index:'+a._getZ(b,"coverImage")+';opacity:0.5;"'+d+" />",e='<div id="ID_coverdiv" style="background-color:red;z-index:'+a._getZ(b,"coverImage")+';width:100%;height:100%;display:inline;position:absolute;top:0px;left:0px"><image id="ID_coverimage" src="'+b._coverImage+'" style="width:100%;height:100%"'+d+"/>"+e+"</div>"),d='...<div id="ID_appletinfotablediv" style="width:Wpx;height:Hpx;position:relative;font-size:14px;text-align:left">IMG......<div id="ID_appletdiv" style="z-index:'+a._getZ(b,"header")+';width:100%;height:100%;position:absolute;top:0px;left:0px;">';var f=b._height,g=b._width;("string"!=typeof f||0>f.indexOf("%"))&&(f+="px"),("string"!=typeof g||0>g.indexOf("%"))&&(g+="px"),d=d.replace(/IMG/,e).replace(/Hpx/g,f).replace(/Wpx/g,g)}else d='......</div>......<div id="ID_2dappletdiv" style="position:absolute;width:100%;height:100%;overflow:hidden;display:none"></div>......<div id="ID_infotablediv" style="width:100%;height:100%;position:absolute;top:0px;left:0px">.........<div id="ID_infoheaderdiv" style="height:20px;width:100%;background:yellow;display:none"><span id="ID_infoheaderspan"></span><span id="ID_infocheckboxspan" style="position:absolute;text-align:right;right:1px;"><a href="javascript:Jmol.showInfo(ID,false)">[x]</a></span></div>.........<div id="ID_infodiv" style="position:absolute;top:20px;bottom:0px;width:100%;height:100%;overflow:auto"></div>......</div>...</div>';return d.replace(/\.\.\./g,"").replace(/[\n\r]/g,"").replace(/ID/g,b._id)},a._documentWrite=function(b){if(a._document){if(a._isXHTML&&!a._XhtmlElement){var c=document.getElementsByTagName("script");a._XhtmlElement=c.item(c.length-1),a._XhtmlAppendChild=!1}a._XhtmlElement?a._domWrite(b):a._document.write(b)}return b},a._domWrite=function(b){for(var c=[0];c[0]<b.length;){var d=a._getDomElement(b,c);if(!d)break;a._XhtmlAppendChild?a._XhtmlElement.appendChild(d):a._XhtmlElement.parentNode.insertBefore(d,_jmol.XhtmlElement)}},a._getDomElement=function(a,b){var c=document.createElement("span");return c.innerHTML=a,b[0]=a.length,c},a._setObject=function(b,c,d){b._id=c,b.__Info={},d.z&&d.zIndexBase&&(a._z=a._getZOrders(d.zIndexBase));for(var e in d)b.__Info[e]=d[e];(b._z=d.z)||d.zIndexBase&&(b._z=b.__Info.z=a._getZOrders(d.zIndexBase)),b._width=d.width,b._height=d.height,b._noscript=!b._isJava&&d.noscript,b._console=d.console,b._cacheFiles=!!d.cacheFiles,b._viewSet=null==d.viewSet||b._isJava?null:"Set"+d.viewSet,null!=b._viewSet&&(a.View.__init(b),b._currentView=null),!a._fileCache&&b._cacheFiles&&(a._fileCache={}),b._console||(b._console=b._id+"_infodiv"),"none"==b._console&&(b._console=null),b._color=d.color?d.color.replace(/0x/,"#"):"#FFFFFF",b._disableInitialConsole=d.disableInitialConsole,b._noMonitor=d.disableJ2SLoadMonitor,a._j2sPath&&(d.j2sPath=a._j2sPath),b._j2sPath=d.j2sPath,b._deferApplet=d.deferApplet,b._deferUncover=d.deferUncover,b._coverImage=!b._isJava&&d.coverImage,b._isCovered=!!b._coverImage,b._coverScript=d.coverScript,b._coverTitle=d.coverTitle,b._coverTitle||(b._coverTitle=b._deferApplet?"activate 3D model":"3D model is loading..."),b._containerWidth=b._width+(b._width==parseFloat(b._width)?"px":""),b._containerHeight=b._height+(b._height==parseFloat(b._height)?"px":""),b._info="",b._infoHeader=b._jmolType+' "'+b._id+'"',b._hasOptions=d.addSelectionOptions,b._defaultModel=d.defaultModel,b._readyScript=d.script?d.script:"",b._readyFunction=d.readyFunction,b._coverImage&&!b._deferApplet&&(b._readyScript+=";javascript "+c+"._displayCoverImage(false)"),b._src=d.src},a._addDefaultInfo=function(b,c){for(var d in c)"undefined"==typeof b[d]&&(b[d]=c[d]);a._use&&(b.use=a._use),0<=b.use.indexOf("SIGNED")&&(0>b.jarFile.indexOf("Signed")&&(b.jarFile=b.jarFile.replace(/Applet/,"AppletSigned")),b.use=b.use.replace(/SIGNED/,"JAVA"),b.isSigned=!0)},a._syncedApplets=[],a._syncedCommands=[],a._syncedReady=[],a._syncReady=!1,a._isJmolJSVSync=!1,a._setReady=function(b){a._syncedReady[b]=1;for(var c=0,d=0;d<a._syncedApplets.length;d++){if(a._syncedApplets[d]==b._id)a._syncedApplets[d]=b,a._syncedReady[d]=1;else if(!a._syncedReady[d])continue;c++}c==a._syncedApplets.length&&a._setSyncReady()},a._setDestroy=function(b){a.featureDetection.allowDestroy&&a.$windowOn("beforeunload",function(){a._destroy(b)})},a._destroy=function(b){try{b._applet&&b._applet.destroy(),b._applet=null,a._unsetMouse(b._canvas),b._canvas=null;for(var c=0,d=0;d<a._syncedApplets.length;d++)a._syncedApplets[d]==b&&(a._syncedApplets[d]=null),a._syncedApplets[d]&&c++;c>0||a._clearVars()}catch(e){}},a._setSyncReady=function(){a._syncReady=!0;for(var b="",c=0;c<a._syncedApplets.length;c++)a._syncedCommands[c]&&(b+="Jmol.script(Jmol._syncedApplets["+c+"], Jmol._syncedCommands["+c+"]);");setTimeout(b,50)},a._mySyncCallback=function(b,c){if(app=a._applets[b],!app._viewSet){if(!a._syncReady||!a._isJmolJSVSync)return 1;for(var d=0;d<a._syncedApplets.length;d++)0<=c.indexOf(a._syncedApplets[d]._syncKeyword)&&a._syncedApplets[d]._syncScript(c);return 0}a.View.updateFromSync(app,c)},a._getElement=function(a,b){return document.getElementById(a._id+"_"+b)||{}},a._evalJSON=function(a,b){if(a+="",!a)return[];if("{"!=a.charAt(0))return 0<=a.indexOf(" | ")&&(a=a.replace(/\ \|\ /g,"\n")),a;var c=new Function("return "+a)();return c?b&&void 0!=c[b]?c[b]:c:null},a._sortMessages=function(a){function b(a,b){return a[0]<b[0]?1:a[0]>b[0]?-1:0}if(!a||"object"!=typeof a)return[];for(var c=[],d=a.length-1;d>=0;d--)for(var e=0,f=a[d].length;f>e;e++)c[c.length]=a[d][e];return 0!=c.length?c=c.sort(b):void 0},a._setMouseOwner=function(b,c){null==b||c?a._mouseOwner=b:a._mouseOwner==b&&(a._mouseOwner=null)},a._jsGetMouseModifiers=function(a){var b=0;switch(a.button){case 0:b=16;break;case 1:b=8;break;case 2:b=4}return a.shiftKey&&(b+=1),a.altKey&&(b+=8),a.ctrlKey&&(b+=2),b},a._jsGetXY=function(b,c){if(!b.applet._ready||a._touching&&0>c.type.indexOf("touch"))return!1;c.preventDefault();var d,e=a.$offset(b.id),f=c.originalEvent;return c.pageX||(c.pageX=f.pageX),c.pageY||(c.pageY=f.pageY),a._mousePageX=c.pageX,a._mousePageY=c.pageY,f.targetTouches&&f.targetTouches[0]?(d=f.targetTouches[0].pageX-e.left,e=f.targetTouches[0].pageY-e.top):f.changedTouches?(d=f.changedTouches[0].pageX-e.left,e=f.changedTouches[0].pageY-e.top):(d=c.pageX-e.left,e=c.pageY-e.top),void 0==d?null:[Math.round(d),Math.round(e),a._jsGetMouseModifiers(c)]},a._gestureUpdate=function(b,c){c.stopPropagation(),c.preventDefault();var d=c.originalEvent;switch(c.type){case"touchstart":a._touching=!0;break;case"touchend":a._touching=!1}if(!d.touches||2!=d.touches.length)return!1;switch(c.type){case"touchstart":b._touches=[[],[]];break;case"touchmove":var e=a.$offset(b.id),f=b._touches[0],g=b._touches[1];f.push([d.touches[0].pageX-e.left,d.touches[0].pageY-e.top]),g.push([d.touches[1].pageX-e.left,d.touches[1].pageY-e.top]),d=f.length,d>3&&(f.shift(),g.shift()),d>=2&&b.applet._processGesture(b._touches)}return!0},a._jsSetMouse=function(b){a.$bind(b,"mousedown touchstart",function(c){if(a._setMouseOwner(b,!0),c.stopPropagation(),c.preventDefault(),b.isDragging=!0,"touchstart"==c.type&&a._gestureUpdate(b,c))return!1;a._setConsoleDiv(b.applet._console);var d=a._jsGetXY(b,c);return d?(2!=c.button&&a.Swing.hideMenus(b.applet),b.applet._processEvent(501,d),!1):!1}),a.$bind(b,"mouseup touchend",function(c){return a._setMouseOwner(null),c.stopPropagation(),c.preventDefault(),b.isDragging=!1,"touchend"==c.type&&a._gestureUpdate(b,c)?!1:(c=a._jsGetXY(b,c))?(b.applet._processEvent(502,c),!1):!1}),a.$bind(b,"mousemove touchmove",function(c){return a._mouseOwner&&a._mouseOwner!=b&&a._mouseOwner.isDragging?(a._mouseOwner.mouseMove(c),!1):a._drag(b,c)}),a._drag=function(b,c){if(c.stopPropagation(),c.preventDefault(),"touchmove"==c.type&&a._gestureUpdate(b,c))return!1;var d=a._jsGetXY(b,c);return d?(b.isDragging||(d[2]=0),b.applet._processEvent(b.isDragging?506:503,d),!1):!1},a.$bind(b,"DOMMouseScroll mousewheel",function(c){c.stopPropagation(),c.preventDefault(),b.isDragging=!1;var d=c.originalEvent,d=d.detail?d.detail:("mac"==a.featureDetection.os?1:-1)*d.wheelDelta;return c=a._jsGetMouseModifiers(c),b.applet._processEvent(-1,[0>d?-1:1,0,c]),!1}),a.$bind(b,"contextmenu",function(){return!1}),a.$bind(b,"mouseout",function(c){return b.applet._applet&&b.applet._applet.viewer.startHoverWatcher(!1),a._jsGetXY(b,c),!1}),a.$bind(b,"mouseenter",function(c){return b.applet._applet&&b.applet._applet.viewer.startHoverWatcher(!0),0===c.buttons||0===c.which?(b.isDragging=!1,(c=a._jsGetXY(b,c))?(b.applet._processEvent(504,c),b.applet._processEvent(502,c),!1):!1):void 0}),a.$bind(b,"mousemoveoutjsmol",function(c,d,e){return b==a._mouseOwner&&b.isDragging?a._drag(b,e):void 0}),b.applet._is2D&&a.$resize(function(){b.applet&&b.applet._resize()}),a.$bind("body","mouseup touchend",function(){b.applet&&(b.isDragging=!1),a._setMouseOwner(null)})},a._jsUnsetMouse=function(b){b.applet=null,a.$bind(b,"mousedown touchstart mousemove touchmove mouseup touchend DOMMouseScroll mousewheel contextmenu mouseout mouseenter",null),a._setMouseOwner(null)},a.Swing={count:0,menuInitialized:0,menuCounter:0,htDialogs:{}};var c=a.Swing;SwingController=c,c.setDraggable=function(b){b=b.prototype,b.setContainer||(b.setContainer=function(b){this.container=b,b.obj=this,this.ignoreMouse=this.isDragging=!1;var c=this;b.bind("mousedown touchstart",function(b){return c.ignoreMouse?(c.ignoreMouse=!1,!0):(a._setMouseOwner(c,!0),c.isDragging=!0,c.pageX=b.pageX,c.pageY=b.pageY,!1)}),b.bind("mousemove touchmove",function(b){return c.isDragging&&a._mouseOwner==c?(c.mouseMove(b),!1):void 0}),b.bind("mouseup touchend",function(b){c.mouseUp(b),a._setMouseOwner(null)})},b.mouseUp=function(b){return this.isDragging&&a._mouseOwner==this?(this.pageX0+=b.pageX-this.pageX,this.pageY0+=b.pageY-this.pageY,this.isDragging=!1):void a._setMouseOwner(null)},b.setPosition=function(){if(null===a._mousePageX){var b=a.$offset(this.applet._id+"_"+(this.applet._is2D?"canvas2d":"canvas"));a._mousePageX=b.left,a._mousePageY=b.top}this.pageX0=a._mousePageX,this.pageY0=a._mousePageY,this.container.css({top:a._mousePageY+"px",left:a._mousePageX+"px"})},b.mouseMove=function(b){this.isDragging&&a._mouseOwner==this&&(this.timestamp=System.currentTimeMillis(),this.container.css({top:this.pageY0+(b.pageY-this.pageY)+"px",left:this.pageX0+(b.pageX-this.pageX)+"px"}))},b.dragBind=function(b){if(this.applet._ignoreMouse=!b,this.container.unbind("mousemoveoutjsmol"),this.container.unbind("touchmoveoutjsmol"),this.container.unbind("mouseupoutjsmol"),this.container.unbind("touchendoutjsmol"),a._setMouseOwner(null),b){var c=this;this.container.bind("mousemoveoutjsmol touchmoveoutjsmol",function(a,b,d){c.mouseMove(d)}),this.container.bind("mouseupoutjsmol touchendoutjsmol",function(a,b,d){c.mouseUp(d)})}})},c.JSDialog=function(){},c.setDraggable(c.JSDialog),c.getScreenDimensions=function(a){a.width=m(window).width(),a.height=m(window).height()},c.dispose=function(b){a.$remove(b.id+"_mover"),delete c.htDialogs[b.id],b.container.obj.dragBind(!1)},c.register=function(a,b){a.id=b+ ++c.count,c.htDialogs[a.id]=a},c.setDialog=function(b){a._setMouseOwner(null),a.$remove(b.id);var d,e=b.id+"_mover",f=a._$(e);f[0]?(f.html(b.html),d=f[0].jd):(a.$after("body","<div id='"+e+"' style='position:absolute;left:0px;top:0px;'>"+b.html+"</div>"),d=new c.JSDialog,f=a._$(e),b.container=f,d.applet=b.manager.vwr.applet,d.setContainer(f),d.dialog=b,d.setPosition(),d.dragBind(!0),f[0].jd=d),a.$bind("#"+b.id+" .JButton","mousedown touchstart",function(){d.ignoreMouse=!0}),a.$bind("#"+b.id+" .JComboBox","mousedown touchstart",function(){d.ignoreMouse=!0}),a.$bind("#"+b.id+" .JCheckBox","mousedown touchstart",function(){d.ignoreMouse=!0}),a.$bind("#"+b.id+" .JTextField","mousedown touchstart",function(){d.ignoreMouse=!0}),a.$bind("#"+b.id+" .JTable","mousedown touchstart",function(){d.ignoreMouse=!0}),a.$bind("#"+b.id+" .JScrollPane","mousedown touchstart",function(){d.ignoreMouse=!0}),a.$bind("#"+b.id+" .JEditorPane","mousedown touchstart",function(){d.ignoreMouse=!0})},c.setSelected=function(b){a.$prop(b.id,"checked",!!b.selected)},c.setSelectedIndex=function(b){a.$prop(b.id,"selectedIndex",b.selectedIndex)},c.setText=function(b){a.$prop(b.id,"value",b.text)},c.setVisible=function(b){a.$setVisible(b.id,b.visible)},c.setEnabled=function(b){a.$setEnabled(b.id,b.enabled)},c.click=function(b,d){var e=c.htDialogs[b.id];if(e){var f=e.toString();if(0<=f.indexOf("JCheck"))e.selected=b.checked;else if(0<=f.indexOf("JCombo"))e.selectedIndex=b.selectedIndex;else if(null!=e.text&&(e.text=b.value,d&&13!=(d.charCode||d.keyCode)))return}f=c.htDialogs[a.$getAncestorDiv(b.id,"JDialog").id],f.manager.actionPerformed(e?e.name:f.registryKey+"/"+b.id)},c.setFront=function(b){var c=b.manager.vwr.applet;b.zIndex!=a._getZ(c,"dialog")&&(b.zIndex=a._incrZ(c,"dialog")),b.container&&((b.container[0]||b.container).style.zIndex=b.zIndex)},c.hideMenus=function(a){if(a=a._menus)for(var b in a)a[b].visible&&c.hideMenu(a[b])},c.windowClosing=function(b){b=c.htDialogs[a.$getAncestorDiv(b.id,"JDialog").id],b.registryKey?b.manager.processWindowClosing(b.registryKey):b.dispose()},a._track=function(b){if(a._tracker){try{var c='<iframe style="display:none" width="0" height="0" frameborder="0" tabindex="-1" src="'+(a._tracker+"&applet="+b._jmolType+"&version="+a._version+"&appver="+self.___JmolVersion+"&url="+encodeURIComponent(document.location.href))+'"></iframe>';a.$after("body",c)}catch(d){}delete a._tracker}return b},a.getProfile=function(){return window["j2s.doProfile"]=!0,self.Clazz&&self.JSON?(Clazz._profile||(Clazz._profile={}),Clazz.getProfile()):void 0},a._getInChIKey=function(a,b){0<=b.indexOf("MOL=")&&b.split("MOL=")[1].split('"')},a._getAttr=function(a,b){var c=a.indexOf(b+"=");return c>=0&&0<=(c=a.indexOf('"',c))?a.substring(c+1,a.indexOf('"',c+1)):null},a.User={viewUpdatedCallback:null},a.View={count:0,applets:{},sets:{}},function(c){c.updateView=function(b,d){null!=b._viewSet&&(d.chemID||(b._searchQuery=null),d.data||(d.data="N/A"),d.type=b._viewType,null==(b._currentView=c.__findView(b._viewSet,d))&&(b._currentView=c.__createViewSet(b._viewSet,d.chemID,d.viewID||d.chemID)),b._currentView[d.type].data=d.data,b._currentView[d.type].smiles=b._getSmiles(),a.User.viewUpdatedCallback&&a.User.viewUpdatedCallback(b,"updateView"),c.__setView(b._currentView,b,!1))},c.updateFromSync=function(d,e){d._updateMsg=e;var g=a._getAttr(e,"sourceID")||a._getAttr(e,"file");if(g){var k=c.__findView(d._viewSet,{viewID:g});if(null==k)return a.updateView(d,e);k!=d._currentView&&c.__setView(k,d,!0);var r=(g=a._getAttr(e,"atoms"))&&0<=e.indexOf("selectionhalos ON")?eval("["+g+"]"):[];setTimeout(function(){d._currentView==k&&c.updateAtomPick(d,r)},10),a.User.viewUpdatedCallback&&a.User.viewUpdatedCallback(d,"updateFromSync")}},c.updateAtomPick=function(b,c){var d=b._currentView;if(null!=d){for(var e in d)"info"!=e&&d[e].applet!=b&&d[e].applet._updateAtomPick(c);a.User.viewUpdatedCallback&&a.User.viewUpdatedCallback(b,"updateAtomPick")}},c.dumpViews=function(a){var b=c.sets[a];if(b){var d="View set "+a+":\n";a=c.applets[a];for(var e in a)d+="\napplet "+a[e]._id+" currentView="+(a[e]._currentView?a[e]._currentView.info.viewID:null);for(e=b.length;0<=--e;){a=b[e];var f,g,d=d+("\n\n<b>view="+e+" viewID="+a.info.viewID+" chemID="+a.info.chemID+"</b>\n");for(g in a)"info"!=g&&(d+="\nview="+e+" type="+g+" applet="+((f=a[g]).applet?f.applet._id:null)+" SMILES="+f.smiles+"\n atomMap="+JSON.stringify(f.atomMap)+"\n data=\n"+f.data+"\n")}return d}},c.__init=function(a){var b=a._viewSet,d=c.applets;d[b]||(d[b]={}),d[b][a._viewType]=a},c.__findView=function(a,b){var d=c.sets[a];null==d&&(d=c.sets[a]=[]);for(var e=d.length;0<=--e;){var f=d[e];if(b.viewID){if(f.info.viewID==b.viewID)return f}else{if(null!=b.chemID&&b.chemID==f.info.chemID)return f;for(var g in f)if("info"!=g&&(null!=b.data&&null!=f[g].data?b.data==f[g].data:b.type==g))return f}}return null},c.__createViewSet=function(b,d,e){c.count++,d={info:{chemID:d,viewID:e||"model_"+c.count}};for(var f in a._applets)e=a._applets[f],e._viewSet==b&&(d[e._viewType]={applet:e,data:null});return c.sets[b].push(d),d},c.__setView=function(a,b,c){for(var d in a)if("info"!=d){var e=a[d],f=e.applet,g=c||null!=f&&"<modified>"==f._molData;if(null!=f&&(f!=b||g)){var h=null==e.data,i=null!=f._currentView;if(f._currentView=a,(!i||!(a[d].data==e.data&&!h&!g))&&(f._loadModelFromView(a),h))break}}}}(a.View),a.Cache={fileCache:{}},a.Cache.get=function(b){return a.Cache.fileCache[b]},a.Cache.put=function(b,c){a.Cache.fileCache[b]=c},a.Cache.setDragDrop=function(b){a.$appEvent(b,"appletdiv","dragover",function(a){a=a.originalEvent,a.stopPropagation(),a.preventDefault(),a.dataTransfer.dropEffect="copy"}),a.$appEvent(b,"appletdiv","drop",function(c){c=c.originalEvent,c.stopPropagation(),c.preventDefault();var d=ev.dataTransfer.files[0];if(null==d)try{d=""+ev.dataTransfer.getData("text"),(0==d.indexOf("file:/")||0==d.indexOf("http:/"))&&b._script('load "'+d+'"')}catch(e){}else{var f=new FileReader;f.onloadend=function(e){if(e.target.readyState==FileReader.DONE){var f="cache://DROP_"+d.name;e=a._toBytes(e.target.result),b._applet.viewer.cacheFileByName("cache://DROP_*",!1),"JSV"==b._viewType||f.endsWith(".jdx")?a.Cache.put(f,e):b._applet.viewer.cachePut(f,e),(e=a._jsGetXY(b._canvas,c))&&(!b._applet.viewer.setStatusDragDropped||b._applet.viewer.setStatusDragDropped(0,e[0],e[1],f))&&b._applet.viewer.openFileAsyncSpecial(f,1)}},f.readAsArrayBuffer(d)}})}}(Jmol,jQuery),Jmol._debugCode=!1,function(a){a._coreFiles=[],a.__execLog=[],a.__execStack=[],a.__execTimer=0,a.__coreSet=[],a.__coreMore=[],a.__execDelayMS=100,a.showExecLog=function(){return a.__execLog.join("\n")},a.__addExec=function(b){var c="JSmol load "+b[0]._id+" "+b[3];self.console&&void 0,a.__execLog.push(c),a.__execStack.push(b)},a.__addCoreFile=function(b,c,d){if(!(0<=a.__coreSet.join("").indexOf(b))){if(a.__coreSet.push(b),a.__coreSet.sort(),b=a.__coreSet.join(""),a._coreFiles=[c+"/core/core"+("jmol"==b?"":b)+".z.js"],d&&(d=d.split(" ")))for(b=0;b<d.length;b++)0>a.__coreMore.join("").indexOf(d[b])&&a.__coreMore.push(c+"/core/core"+d[b]+".z.js");for(b=0;b<a.__coreMore.length;b++)a._coreFiles.push(a.__coreMore[b])}},a.__nextExecution=function(b){delete a.__execTimer;for(var c,d=a.__execStack;0<d.length&&"done"==(c=d[0])[4];)d.shift();0!=d.length&&(b?(c.push("done"),b="JSmol exec "+c[0]._id+" "+c[3]+" "+c[2],self.console&&void 0,a.__execLog.push(b),c[1](c[0],c[2])):setTimeout("Jmol.__nextExecution(true)",10))},a.__loadClazz=function(b){a.__clazzLoaded?a.__nextExecution():(a.__clazzLoaded=!0,LoadClazz(),b._noMonitor&&(Clazz._LoaderProgressMonitor.showStatus=function(){}),LoadClazz=null,Clazz._Loader.globalLoaded=function(){Clazz._LoaderProgressMonitor.showStatus("Application loaded.",!0),a._debugCode&&a.haveCore||(a.haveCore=!0,a.__nextExecution())},Clazz._Loader.packageClasspath("java",null,!0))},a.__loadClass=function(b,c){Clazz._Loader.loadClass(c,function(){a.__nextExecution()})},a._Canvas2D=function(b,c,d,e){switch(this._uniqueId=(""+Math.random()).substring(3),this._id=b,this._is2D=!0,this._isJava=!1,this._jmolType="Jmol._Canvas2D ("+d+")",d){case"Jmol":this._platform="J.awtjs2d.Platform";break;case"JSV":this._isLayered=this._isJSV=!0,this._platform="JSV.awtjs2d.Platform"}return e?this:(window[b]=this,this._createCanvas(b,c),!a._document||this._deferApplet?this:(this._init(),this))},a._jsSetPrototype=function(b){return b._init=function(){this._setupJS(),this._showInfo(!0),this._disableInitialConsole&&this._showInfo(!1)},b._createCanvas=function(b,c,d){a._setObject(this,b,c),d&&(this._GLmol=d,this._GLmol.applet=this,this._GLmol.id=this._id),d=a._getWrapper(this,!0),this._deferApplet||(a._document?(a._documentWrite(d),this._newCanvas(!1),d=""):(this._deferApplet=!0,d+='<script type="text/javascript">'+b+"._cover(false)</script>")),d+=a._getWrapper(this,!1),c.addSelectionOptions&&(d+=a._getGrabberOptions(this)),a._debugAlert&&!a._document&&alert(d),this._code=a._documentWrite(d)},b._cover=function(b){if(b||!this._deferApplet)this._displayCoverImage(b);else{var c=this._coverScript?this._coverScript:"";this._coverScript="",this._deferUncover&&(c+=";refresh;javascript "+this._id+"._displayCoverImage(false)"),this._script(c,!0),this._deferUncover&&"activate 3D model"==this._coverTitle&&(a._getElement(this,"coverimage").title="3D model is loading..."),this._deferApplet&&this._newCanvas(!1),this._defaultModel&&a._search(this,this._defaultModel),this._showInfo(!1),this._deferUncover||this._displayCoverImage(b),this._init&&this._init()}},b._displayCoverImage=function(b){this._coverImage&&this._isCovered!=b&&(this._isCovered=b,a._getElement(this,"coverdiv").style.display=b?"block":"none")},b._newCanvas=function(a){this._is2D?this._createCanvas2d(a):this._GLmol.create()},b._createCanvas2d=function(){var b=a.$(this,"appletdiv");try{b[0].removeChild(this._canvas),this._canvas.frontLayer&&b[0].removeChild(this._canvas.frontLayer),this._canvas.rearLayer&&b[0].removeChild(this._canvas.rearLayer),this._canvas.imageLayer&&b[0].removeChild(this._canvas.imageLayer),a._jsUnsetMouse(this._mouseInterface)}catch(c){}var d=Math.round(b.width()),e=Math.round(b.height()),f=document.createElement("canvas");if(f.applet=this,this._canvas=f,f.style.width="100%",f.style.height="100%",f.width=d,f.height=e,f.id=this._id+"_canvas2d",b.append(f),a._$(f.id).css({"z-index":a._getZ(this,"main")}),this._isLayered){var g=document.createElement("div");f.imageLayer=g,g.id=this._id+"_imagelayer",b.append(g),a._$(g.id).css({zIndex:a._getZ(this,"image"),position:"absolute",left:"0px",top:"0px",width:"0px",height:"0px",overflow:"hidden"}),this._mouseInterface=this._getLayer("front",b,d,e,!1)}else this._mouseInterface=f;a._jsSetMouse(this._mouseInterface)},b._getLayer=function(b,c,d,e,f){var g=document.createElement("canvas");return this._canvas[b+"Layer"]=g,g.style.width="100%",g.style.height="100%",g.id=this._id+"_"+b+"Layer",g.width=d,g.height=e,c.append(g),g.applet=this,a._$(g.id).css({background:f?"rgb(0,0,0,1)":"rgb(0,0,0,0.001)","z-index":a._getZ(this,b),position:"absolute",left:"0px",top:"0px",overflow:"hidden"}),g},b._setupJS=function(){window["j2s.lib"]={base:this._j2sPath+"/",alias:".",console:this._console,monitorZIndex:a._getZ(this,"monitorZIndex")},0==a.__execStack.length&&a.__addExec([this,a.__loadClazz,null,"loadClazz"]),this._isJSV?(a.__addCoreFile("jsv",this._j2sPath,this.__Info.preloadCore),a._debugCode&&(a.__addExec([this,a.__loadClass,"JSV.appletjs.JSVApplet","load JSV"]),this._isPro&&a.__addExec([this,a.__loadClass,"JSV.appletjs.JSVAppletPro","load JSV(signed)"]))):(a.__addCoreFile("jmol",this._j2sPath,this.__Info.preloadCore),this._is2D||a.__addExec([this,a.__loadClass,"J.export.JSExporter","load JSExporter"]),a._debugCode&&a.__addExec([this,a.__loadClass,"J.appletjs.Jmol","load Jmol"])),a.__addExec([this,this.__startAppletJS,null,"start applet"]),this._isSigned=!0,this._ready=!1,this._applet=null,this._canScript=function(){return!0},this._savedOrientations=[],a.__execTimer&&clearTimeout(a.__execTimer),a.__execTimer=setTimeout(a.__nextExecution,a.__execDelayMS)},b.__startAppletJS=function(b){var c=new java.util.Hashtable;a._setJmolParams(c,b.__Info,!0),c.put("appletReadyCallback","Jmol._readyCallback"),c.put("applet",!0),c.put("name",b._id),c.put("syncId",a._syncId),b._color&&c.put("bgcolor",b._color),b._is2D?b._startupScript&&c.put("script",b._startupScript):c.put("script","set multipleBondSpacing 0.35;"),a._syncedApplets.length&&c.put("synccallback","Jmol._mySyncCallback"),c.put("signedApplet","true"),c.put("platform",b._platform),b._is2D&&c.put("display",b._id+"_canvas2d"),c.put("documentBase",document.location.href);var d=b._j2sPath+"/";if(0>d.indexOf("://")){var e=document.location.href.split("#")[0].split("?")[0].split("/");0==d.indexOf("/")?e=[e[0],d.substring(1)]:e[e.length-1]=d,d=e.join("/")}c.put("codePath",d),a._registerApplet(b._id,b),b._applet=b._isJSV?b._isPro?new JSV.appletjs.JSVAppletPro(c):new JSV.appletjs.JSVApplet(c):new J.appletjs.Jmol(c),b._is2D||(b._GLmol.applet=b),b._jsSetScreenDimensions(),a.__nextExecution()},b._jsSetScreenDimensions=function(){if(this._applet){var b=a._getElement(this,this._is2D?"canvas2d":"canvas");this._applet.viewer.setScreenDimension(b.width,b.height)}},b._show=function(b){a.$setVisible(a.$(this,"appletdiv"),b),b&&a._repaint(this,!0)},b._canScript=function(){return!0},b._delay=function(a,b,c){this._delayID=setTimeout(function(){a.resumeEval(b,!1)},c)},b._createDomNode=function(a,b){a=this._id+"_"+a;var c=document.getElementById(a);if(c&&document.body.removeChild(c),b){if(0==b.indexOf("<?")&&(b=b.substring(b.indexOf("<",1))),0<=b.indexOf("/>")){for(var c=b.split("/>"),d=c.length-1;0<=--d;)for(var e=c[d],f=e.lastIndexOf("<")+1,g=f,h=e.length,i="";++g<h;)if(0<=" 	\n\r".indexOf(e.charAt(g))){i=e.substring(f,g),c[d]=e+"></"+i+">";break}b=c.join("")}return c=document.createElement("_xml"),c.id=a,c.innerHTML=b,c.style.display="none",document.body.appendChild(c),c}},b.equals=function(a){return this==a},b.clone=function(){return this},b.hashCode=function(){return parseInt(this._uniqueId)},b._processGesture=function(a){return this._applet.viewer.mouse.processTwoPointGesture(a)},b._processEvent=function(a,b){this._applet.viewer.processMouseEvent(a,b[0],b[1],b[2],System.currentTimeMillis())},b._resize=function(){var b="__resizeTimeout_"+this._id;a[b]&&clearTimeout(a[b]);var c=this;a[b]=setTimeout(function(){a._repaint(c,!0),a[b]=null},100)},b},a._repaint=function(b,c){if(b&&b._applet){var d=a.$(b,"appletdiv"),e=Math.round(d.width()),d=Math.round(d.height());!b._is2D||b._canvas.width==e&&b._canvas.height==d||(b._newCanvas(!0),b._applet.viewer.setDisplay(b._canvas)),b._applet.viewer.setScreenDimension(e,d),c?setTimeout(function(){b._applet&&b._applet.viewer.updateJS(0,0)}):b._applet.viewer.updateJS(0,0)}},a._getHiddenCanvas=function(a,b,c,d,e){return b=a._id+"_"+b,(a=document.getElementById(b))&&e&&(a=null),a||(a=document.createElement("canvas")),a.width=a.style.width=c,a.height=a.style.height=d,a.id!=b&&(a.id=b),a},a._loadImage=function(b,c,d,e,f){var g=c[1];if(null==f)return f=new Image,f.onload=function(){a._loadImage(b,c,null,e,f)},null!=d&&(d=J.io.Base64.getBase64(d).toString(),d=g.substring(url.lastIndexOf("/")+1),0<=d.indexOf(".png")||d.indexOf(".jpg")),f.src=g,!0;d=f.width;var h=f.height,i="echo_"+c[0],j=a._getHiddenCanvas(b.vwr.applet,i,d,h,!0);j.imageWidth=d,j.imageHeight=h,j.id=i,j.image=f,a._setCanvasImage(j,d,h),e(j,g)},a._setCanvasImage=function(a,b,c){a.buf32=null,a.width=b,a.height=c,a.getContext("2d").drawImage(a.image,0,0,b,c)}}(Jmol),function(a,b){a._Applet=function(b,c,d){return window[b]=this,this._jmolType="Jmol._Applet"+(c.isSigned?" (signed)":""),this._viewType="Jmol",this._isJava=!0,this._syncKeyword="Select:",d?this:(this._isSigned=c.isSigned,this._readyFunction=c.readyFunction,this._ready=!1,this._isJava=!0,this._isInfoVisible=!1,this._applet=null,this._memoryLimit=c.memoryLimit||512,this._canScript=function(){return!0},this._savedOrientations=[],this._initialize=function(b,d){var e=!1;if(a._jarFile&&(d=a._jarFile),this._jarFile){var f=this._jarFile;0<=f.indexOf("/")?(alert("This web page URL is requesting that the applet used be "+f+". This is a possible security risk, particularly if the applet is signed, because signed applets can read and write files on your local machine or network."),"yes"==prompt("Do you want to use applet "+f+"? ","yes or no")?(b=f.substring(0,f.lastIndexOf("/")),d=f.substring(f.lastIndexOf("/")+1)):e=!0):d=f,this_isSigned=c.isSigned=0<=d.indexOf("Signed")}this._jarPath=c.jarPath=b||".",this._jarFile=c.jarFile="string"==typeof d?d:(d?"JmolAppletSigned":"JmolApplet")+"0.jar",e&&alert("The web page URL was ignored. Continuing using "+this._jarFile+' in directory "'+this._jarPath+'"'),void 0==a.controls||a.controls._onloadResetForms()},this._create(b,c),this)};var c=a._Applet,d=a._Applet.prototype;c._get=function(b,d,e){e||(e=!1),d||(d={}),a._addDefaultInfo(d,{color:"#FFFFFF",width:300,height:300,addSelectionOptions:!1,serverURL:"http://your.server.here/jsmol.php",defaultModel:"",script:null,src:null,readyFunction:null,use:"HTML5",jarPath:"java",jarFile:"JmolApplet0.jar",isSigned:!1,j2sPath:"j2s",coverImage:null,coverTitle:"",coverCommand:"",deferApplet:!1,deferUncover:!1,disableJ2SLoadMonitor:!1,disableInitialConsole:!1,debug:!1}),a._debugAlert=d.debug,a.featureDetection.allowHTML5||(d.use="JAVA"),d.serverURL&&(a._serverUrl=d.serverURL);
for(var f=!1,g=null,h=d.use.toUpperCase().split("#")[0].split(" "),i=0;i<h.length;i++){switch(h[i]){case"JAVA":f=!0,a.featureDetection.supportsJava()&&(g=new c(b,d,e));break;case"WEBGL":g=c._getCanvas(b,d,e,!0);break;case"HTML5":g=c._getCanvas(b,d,e,!1);break;case"IMAGE":g=new a._Image(b,d,e)}if(null!=g)break}return null==g&&(e||!f?g={_jmolType:"none"}:f&&(g=new c(b,d))),e?g:a._registerApplet(b,g)},c._getCanvas=function(b,d,e,f){return f&&a.featureDetection.supportsWebGL()?(a._Canvas3D.prototype=a.GLmol.extendApplet(a._jsSetPrototype(new c(b,d,!0))),new a._Canvas3D(b,d,"Jmol",e)):f?null:(a._Canvas2D.prototype=a._jsSetPrototype(new c(b,d,!0)),new a._Canvas2D(b,d,"Jmol",e))},c._noJavaMsg="Either you do not have Java applets enabled in your web<br />browser or your browser is blocking this applet.<br />			Check the warning message from your browser and/or enable Java applets in<br />			your web browser preferences, or install the Java Runtime Environment from <a href='http://www.java.com'>www.java.com</a>",c._setCommonMethods=function(a){a._showInfo=d._showInfo,a._search=d._search,a._getName=d._getName,a._readyCallback=d._readyCallback},c._createApplet=function(d,e,f){d._initialize(e.jarPath,e.jarFile);var g=d._jarFile,h="";a._isFile&&(g=g.replace(/0\.jar/,".jar"),h=' jnlp_href="'+g.replace(/\.jar/,".jnlp")+'"');var i=0<=d._containerWidth.indexOf("px")?d._containerWidth:"100%",j=0<=d._containerHeight.indexOf("px")?d._containerHeight:"100%",i=' style="width:'+i+";height:"+j+'" ',h="name='"+d._id+"_object' id='"+d._id+"_object' \n"+i+h+"\n";f.codebase=d._jarPath,f.codePath=f.codebase+"/",0>f.codePath.indexOf("://")&&(j=b.location.href.split("#")[0].split("?")[0].split("/"),j[j.length-1]=f.codePath,f.codePath=j.join("/")),f.archive=g,f.mayscript="true",f.java_arguments="-Xmx"+Math.round(e.memoryLimit||d._memoryLimit)+"m",f.permissions=d._isSigned?"all-permissions":"sandbox",f.documentLocation=b.location.href,f.documentBase=b.location.href.split("#")[0].split("?")[0],f.jarPath=e.jarPath,a._syncedApplets.length&&(f.synccallback="Jmol._mySyncCallback"),d._startupScript&&(f.script=d._startupScript);var k,j="\n";for(k in f)f[k]&&(j+="  <param name='"+k+"' value='"+f[k]+"' />\n");j=a.featureDetection.useIEObject||a.featureDetection.useHtml4Object?"<object "+h+(a.featureDetection.useIEObject?" classid='clsid:8AD9C840-044E-11D1-B3E9-00805F499D93' codebase='http://java.sun.com/update/1.6.0/jinstall-6u22-windows-i586.cab'>":" type='application/x-java-applet'>")+j+"<p style='background-color:yellow;"+i.split('"')[1]+";text-align:center;vertical-align:middle;'>\n"+c._noJavaMsg+"</p></object>\n":"<applet "+h+" code='"+f.code+"' codebase='"+d._jarPath+"' archive='"+g+"' mayscript='true'>\n"+j+"<table bgcolor='yellow'><tr><td align='center' valign='middle' "+i+">\n"+c._noJavaMsg+"</td></tr></table></applet>\n",j=a._getWrapper(d,!0)+j+a._getWrapper(d,!1)+(e.addSelectionOptions?a._getGrabberOptions(d):""),a._debugAlert&&alert(j),d._code=a._documentWrite(j)},d._create=function(b,d){a._setObject(this,b,d);var e={syncId:a._syncId,progressbar:"true",progresscolor:"blue",boxbgcolor:this._color||"black",boxfgcolor:"white",boxmessage:"Downloading JmolApplet ...",script:this._color?'background "'+this._color+'"':"",code:"JmolApplet.class"};a._setJmolParams(e,d);var f;d.inlineModel?(f=d.inlineModel,f=f.replace(/\r|\n|\r\n/g,0<=f.indexOf("|")?"\\/n":"|").replace(/'/g,"&#39;"),a._debugAlert&&alert("inline model:\n"+f)):f="",e.loadInline=f,e.appletReadyCallback="Jmol._readyCallback",a._syncedApplets.length&&(e.synccallback="Jmol._mySyncCallback"),e.java_arguments="-Xmx"+Math.round(d.memoryLimit||this._memoryLimit)+"m",this._initialize(d.jarPath,d.jarFile),c._createApplet(this,d,e)},d._readyCallback=function(b,c,d,e){d&&(a._setDestroy(this),this._ready=!0,b=this._readyScript,this._applet=e,this._defaultModel?a._search(this,this._defaultModel,b?";"+b:""):b?this._script(b):this._src&&this._script('load "'+this._src+'"'),this._showInfo(!0),this._showInfo(!1),a.Cache.setDragDrop(this),this._readyFunction&&this._readyFunction(this),a._setReady(this),(e=this._2dapplet)&&e._isEmbedded&&e._ready&&e.__Info.visible&&this._show2d(!0))},d._showInfo=function(b){if(b&&this._2dapplet&&this._2dapplet._show(!1),a.$html(a.$(this,"infoheaderspan"),this._infoHeader),this._info&&a.$html(a.$(this,"infodiv"),this._info),!this._isInfoVisible!=!b){if(this._isInfoVisible=b,this._isJava){var c=b?2:"100%";a.$setSize(a.$(this,"appletdiv"),c,c)}a.$setVisible(a.$(this,"infotablediv"),b),a.$setVisible(a.$(this,"infoheaderdiv"),b),this._show(!b)}},d._show2d=function(a){this._2dapplet._show2d(a),this._2dapplet._isEmbedded&&(this._showInfo(!1),this._show(!a))},d._getAtomCorrelation=function(a){this._loadMolData(a,"atommap = compare({1.1} {2.1} 'MAP' 'H'); zap 2.1",!0),a=jmol._evaluate("atommap");for(var b=jmol._evaluate("{*}.count"),c=[],d=[],e=0;e<a.length;e++){var f=a[e];c[f[0]+1]=f[1]-b+1,d[f[1]-b+1]=f[0]+1}return{fromJmol:c,toJmol:d}},d._show=function(b){var c=b?"100%":2;a.$setSize(a.$(this,"object"),c,c),this._isJava||a.$setVisible(a.$(this,"appletdiv"),b)},d._clearConsole=function(){this._console==this._id+"_infodiv"&&(this.info=""),self.Clazz&&(a._setConsoleDiv(this._console),Clazz.Console.clear())},d._addScript=function(a){return this._readyScript||(this.readyScript=""),this._readyScript&&(this._readyScript+=";"),this._readyScript+=a,!0},d._script=function(b){return this._ready?(a._setConsoleDiv(this._console),void this._applet.script(b)):this._addScript(b)},d._syncScript=function(a){this._applet.syncScript(a)},d._scriptCheck=function(a){return this._ready&&this._applet.scriptCheck(a)},d._scriptWait=function(a,b){var c=this._scriptWaitAsArray(a),d="";if(!b)for(var e=c.length;0<=--e;)for(var f=0,g=c[e].length;g>f;f++)d+=c[e][f]+"\n";return d},d._scriptEcho=function(a){a=this._scriptWaitAsArray(a);for(var b="",c=a.length;0<=--c;)for(var d=a[c].length;0<=--d;)"scriptEcho"==a[c][d][1]&&(b+=a[c][d][3]+"\n");return b.replace(/ \| /g,"\n")},d._scriptMessage=function(a){a=this._scriptWaitAsArray(a);for(var b="",c=a.length;0<=--c;)for(var d=a[c].length;0<=--d;)"scriptStatus"==a[c][d][1]&&(b+=a[c][d][3]+"\n");return b.replace(/ \| /g,"\n")},d._scriptWaitOutput=function(a){var b="";try{a&&(b+=this._applet.scriptWaitOutput(a))}catch(c){}return b},d._scriptWaitAsArray=function(b){var c="";try{if(this._getStatus("scriptEcho,scriptMessage,scriptStatus,scriptError"),b&&(c+=this._applet.scriptWait(b),c=a._evalJSON(c,"jmolStatus"),"object"==typeof c))return c}catch(d){}return[[c]]},d._getStatus=function(b){return a._sortMessages(this._getPropertyAsArray("jmolStatus",b))},d._getPropertyAsArray=function(b,c){return a._evalJSON(this._getPropertyAsJSON(b,c),b)},d._getPropertyAsString=function(a,b){return void 0==b&&(b=""),this._applet.getPropertyAsString(a,b)+""},d._getPropertyAsJSON=function(a,b){void 0==b&&(b="");try{return this._applet.getPropertyAsJSON(a,b)+""}catch(c){return""}},d._getPropertyAsJavaObject=function(a,b){return void 0==b&&(b=""),this._applet.getProperty(a,b)},d._evaluate=function(a){return null!=a||(a=""),this._getPropertyAsArray("variableInfo",a)},d._evaluateDEPRECATED=function(a){a=""+this._getPropertyAsJavaObject("evaluate",a);var b=a.replace(/\-*\d+/,"");return""!=b||isNaN(parseInt(a))?(b=a.replace(/\-*\d*\.\d*/,""),""!=b||isNaN(parseFloat(a))?a:parseFloat(a)):parseInt(a)},d._saveOrientation=function(a){return this._savedOrientations[a]=this._getPropertyAsArray("orientationInfo","info").moveTo},d._restoreOrientation=function(a){return a=this._savedOrientations[a],a&&""!=a?this._scriptWait(a):a.replace(/1\.0/,"0")},d._restoreOrientationDelayed=function(a,b){1>arguments.length&&(b=1);var c=this._savedOrientations[a];return c&&""!=c?this._scriptWait(c):c.replace(/1\.0/,b)},d._resizeApplet=function(b){function c(b,c){var d=""+b;return 0==d.length?c?"":a._allowedJmolSize[2]:d.indexOf("%")==d.length-1?d:1>=(b=parseFloat(b))&&b>0?100*b+"%":(isNaN(b=Math.floor(b))?a._allowedJmolSize[2]:b<a._allowedJmolSize[0]?a._allowedJmolSize[0]:b>a._allowedJmolSize[1]?a._allowedJmolSize[1]:b)+(c?c:"")}var d;"object"==typeof b&&null!=b?(d=b[0]||b.width,b=b[1]||b.height):d=b,d=[c(d,"px"),c(b,"px")],b=a._getElement(this,"appletinfotablediv"),b.style.width=d[0],b.style.height=d[1],this._containerWidth=d[0],this._containerHeight=d[1],this._is2D&&a._repaint(this,!0)},d._search=function(b,c){a._search(this,b,c)},d._searchDatabase=function(b,c,d){return this._2dapplet&&this._2dapplet._isEmbedded&&a.$(this,"2dappletdiv:visible")[0]?this._2dapplet._searchDatabase(b,c,d):(this._showInfo(!1),void(0<=b.indexOf("?")?a._getInfoFromDatabase(this,c,b.split("?")[0]):(d||(d=a._getScriptForDatabase(c)),b=c+b,this._currentView=null,this._searchQuery=b,this._loadFile(b,d,b))))},d._loadFile=function(b,c,d){if(this._showInfo(!1),c||(c=""),this._thisJmolModel=""+Math.random(),this._fileName=b,!this._scriptLoad(b,c)){var e=this;a._loadFileData(this,b,function(a){e.__loadModel(a,c,d)},function(){e.__loadModel(null)})}},d._scriptLoad=function(a,b){b||(b="");var c=this._isJava||!this._noscript;return c&&this._script("zap;set echo middle center;echo Retrieving data..."),this._isSigned&&null==this._viewSet?(c?this._script('load async "'+a+'";'+b):this._applet.viewer.openFile(a),this._checkDeferred(""),!0):!1},d.__loadModel=function(b,c,d){null!=b&&(null!=this._viewSet&&(c||(c=""),c+=";if ({*}.molecule.max > 1 || {*}.modelindex.max > 0){ delete molecule > 1 or modelindex > 0;x = getProperty('extractModel',{*});load inline @x};"),!c&&this._noscript?this._applet.viewer.loadInline(b,"\x00"):this._loadMolData(b,c,!1),null!=this._viewSet&&a.View.updateView(this,{chemID:d,data:b}))},d._loadMolData=function(a,b,c){b||(b=""),c=c?"append":"model",this._applet.scriptWait('load DATA "'+c+'"'+a+'\nEND "'+c+'" ;'+b)},d._loadModelFromView=function(b){this._currentView=b;var c=b.Jmol;null!=c.data?this.__loadModel(c.data,null,b.info.chemID):null!=b.info.chemID?a._searchMol(this,b.info.chemID,null,!1):(c=b.JME)&&c.applet._show2d(!1,this)},d._updateView=function(){null!=this._viewSet&&this._applet&&(chemID=""+this._getPropertyAsJavaObject("variableInfo","script('show chemical inchiKey')"),chemID=36>chemID.length()?null:chemID.substring(36).split("\n")[0],a.View.updateView(this,{chemID:chemID,data:""+this._getPropertyAsJavaObject("evaluate","extractModel","{visible}")}))},d._atomPickedCallback=function(b,c){if(!(0>c)){var d=[c+1];a.View.updateAtomPick(this,d),this._updateAtomPick(d)}},d._updateAtomPick=function(a){this._script(0==a.length?"select none":"select on visible and (@"+a.join(",@")+")")},d._isDeferred=function(){return!this._canvas&&this._cover&&this._isCovered&&this._deferApplet},d._checkDeferred=function(a){return this._isDeferred()?(this._coverScript=a,this._cover(!1),!0):!1},d._getSmiles=function(){return this._evaluate("{visible}.find('SMILES')")},d._getMol=function(){return this._evaluate("getProperty('ExtractModel',{visible})")},d._getMol2D=function(){return jmol._evaluate("script('select visible;show chemical sdf')")},a.jmolSmiles=function(a){return a._getSmiles()}}(Jmol,document),function(a){var b=a.controls={_hasResetForms:!1,_scripts:[""],_checkboxMasters:{},_checkboxItems:{},_actions:{},_buttonCount:0,_checkboxCount:0,_radioGroupCount:0,_radioCount:0,_linkCount:0,_cmdCount:0,_menuCount:0,_previousOnloadHandler:null,_control:null,_element:null,_appletCssClass:null,_appletCssText:"",_buttonCssClass:null,_buttonCssText:"",_checkboxCssClass:null,_checkboxCssText:"",_radioCssClass:null,_radioCssText:"",_linkCssClass:null,_linkCssText:"",_menuCssClass:null,_menuCssText:""};b._addScript=function(a,c){var d=b._scripts.length;return b._scripts[d]=[a,c],d},b._getIdForControl=function(a,b){return"string"==typeof a?a:b&&a._canScript&&!a._canScript(b)?null:a._id},b._radio=function(a,c,d,e,f,g,h,i){var j=b._getIdForControl(a,c);return null==j?null:(++b._radioCount,void 0!=g&&null!=g||(g="jmolRadioGroup"+(b._radioGroupCount-1)),c?(void 0!=h&&null!=h||(h="jmolRadio"+(b._radioCount-1)),void 0!=d&&null!=d||(d=c.substring(0,32)),f||(f=""),a="</span>",b._actions[h]=b._addScript(j,c),c='<span id="span_'+h+'"'+(i?' title="'+i+'"':"")+"><input name='"+g+"' id='"+h+"' type='radio' onclick='Jmol.controls._click(this);return true;' onmouseover='Jmol.controls._mouseOver(this);return true;' onmouseout='Jmol.controls._mouseOut()' "+(e?"checked='true' ":"")+b._radioCssText+" />",0<=d.toLowerCase().indexOf("<td>")&&(c+=a,a=""),c+('<label for="'+h+'">'+d+"</label>"+a+f)):"")},b._scriptExecute=function(b,c){var d=a._applets[c[0]],e=c[1];"object"==typeof e?e[0](b,e,d):"function"==typeof e?e(d):a.script(d,e)},b.__checkScript=function(a,b){var c=0<=b.value.indexOf("JSCONSOLE ")||""===a._scriptCheck(b.value);return b.style.color=c?"black":"red",c},b.__getCmd=function(a,b){if(b._cmds&&b._cmds.length){var c=b._cmds[b._cmdpt=(b._cmdpt+b._cmds.length+a)%b._cmds.length];setTimeout(function(){b.value=c},10),b._cmdadd=1,b._cmddir=a}},b._commandKeyPress=function(c,d,e){c=13==c?13:window.event?window.event.keyCode:c?c.keyCode||c.which:0;var f=document.getElementById(d),g=a._applets[e];switch(c){case 13:return d=f.value,b._scriptExecute(f,[e,d]),f._cmds||(f._cmds=[],f._cmddir=0,f._cmdpt=-1,f._cmdadd=0),d&&0==f._cmdadd?(++f._cmdpt,f._cmds.splice(f._cmdpt,0,d),f._cmdadd=0,f._cmddir=0):f._cmdadd=0,f.value="",!1;case 27:return setTimeout(function(){f.value=""},20),!1;case 38:b.__getCmd(-1,f);break;case 40:b.__getCmd(1,f);break;default:f._cmdadd=0}return setTimeout(function(){b.__checkScript(g,f)},20),!0},b._click=function(a,c){b._element=a,1==arguments.length&&(c=b._actions[a.id]),b._scriptExecute(a,b._scripts[c])},b._menuSelected=function(a){var c=a.value;if(void 0!=c)b._scriptExecute(a,b._scripts[c]);else{if(c=a.length,"number"==typeof c)for(var d=0;c>d;++d)if(a[d].selected)return void b._click(a[d],a[d].value);alert("?Que? menu selected bug #8734")}},b._cbNotifyMaster=function(a){var c,d=!0,e=!0;for(c in a.chkGroup)a.chkGroup[c].checked?e=!1:d=!1;d&&(a.chkMaster.checked=!0),e&&(a.chkMaster.checked=!1),(d||e)&&b._checkboxItems[a.chkMaster.id]&&b._cbNotifyMaster(b._checkboxItems[a.chkMaster.id])},b._cbNotifyGroup=function(a,c){for(var d in a.chkGroup){var e=a.chkGroup[d];e.checked!=c&&(e.checked=c,b._cbClick(e)),b._checkboxMasters[e.id]&&b._cbNotifyGroup(b._checkboxMasters[e.id],c)}},b._cbSetCheckboxGroup=function(a,c,d){var e=a;"number"==typeof e&&(e="jmolCheckbox"+e),(a=document.getElementById(e))||alert("jmolSetCheckboxGroup: master checkbox not found: "+e);var f=b._checkboxMasters[e]={};for(f.chkMaster=a,f.chkGroup={},"string"==typeof c?(c=d,e=1):e=0,a=e;a<c.length;a++)e=c[a],"number"==typeof e&&(e="jmolCheckbox"+e),(checkboxItem=document.getElementById(e))||alert("jmolSetCheckboxGroup: group checkbox not found: "+e),f.chkGroup[e]=checkboxItem,b._checkboxItems[e]=f},b._cbClick=function(a){b._control=a;var c=b._actions[a.id][0],d=b._actions[a.id][1];b._click(a,a.checked?c:d),b._checkboxMasters[a.id]&&b._cbNotifyGroup(b._checkboxMasters[a.id],a.checked),b._checkboxItems[a.id]&&b._cbNotifyMaster(b._checkboxItems[a.id])},b._cbOver=function(a){var c=b._actions[a.id][0],d=b._actions[a.id][1];window.status=b._scripts[a.checked?d:c]},b._mouseOver=function(a,c){1==arguments.length&&(c=b._actions[a.id]),window.status=b._scripts[c]},b._mouseOut=function(){return window.status=" ",!0},b._onloadResetForms=function(){b._hasResetForms||(b._hasResetForms=!0,b._previousOnloadHandler=window.onload,window.onload=function(){if(0<b._buttonCount+b._checkboxCount+b._menuCount+b._radioCount+b._radioGroupCount)for(var a=document.forms,c=a.length;0<=--c;)a[c].reset();b._previousOnloadHandler&&b._previousOnloadHandler()})},b._getButton=function(c,d,e,f,g){return c=b._getIdForControl(c,d),null==c?"":(void 0!=f&&null!=f||(f="jmolButton"+b._buttonCount),void 0!=e&&null!=e||(e=d.substring(0,32)),++b._buttonCount,b._actions[f]=b._addScript(c,d),d='<span id="span_'+f+'"'+(g?' title="'+g+'"':"")+"><input type='button' name='"+f+"' id='"+f+"' value='"+e+"' onclick='Jmol.controls._click(this)' onmouseover='Jmol.controls._mouseOver(this);return true' onmouseout='Jmol.controls._mouseOut()' "+b._buttonCssText+" /></span>",a._debugAlert&&alert(d),a._documentWrite(d))},b._getCheckbox=function(c,d,e,f,g,h,i){var j=b._getIdForControl(c,d);if(null!=j&&(j=b._getIdForControl(c,e)),null==j)return"";if(void 0!=h&&null!=h||(h="jmolCheckbox"+b._checkboxCount),++b._checkboxCount,void 0==d||null==d||void 0==e||null==e)alert("jmolCheckbox requires two scripts");else{if(void 0!=f&&null!=f)return b._actions[h]=[b._addScript(j,d),b._addScript(j,e)],c="</span>",g='<span id="span_'+h+'"'+(i?' title="'+i+'"':"")+"><input type='checkbox' name='"+h+"' id='"+h+"' onclick='Jmol.controls._cbClick(this)' onmouseover='Jmol.controls._cbOver(this);return true' onmouseout='Jmol.controls._mouseOut()' "+(g?"checked='true' ":"")+b._checkboxCssText+" />",0<=f.toLowerCase().indexOf("<td>")&&(g+=c,c=""),g+='<label for="'+h+'">'+f+"</label>"+c,a._debugAlert&&alert(g),a._documentWrite(g);alert("jmolCheckbox requires a label")}},b._getCommandInput=function(c,d,e,f,g,h){return c=b._getIdForControl(c,"x"),null==c?"":(void 0!=f&&null!=f||(f="jmolCmd"+b._cmdCount),void 0!=d&&null!=d||(d="Execute"),void 0!=e&&!isNaN(e)||(e=60),void 0!=h||(h="help"),++b._cmdCount,d='<span id="span_'+f+'"'+(g?' title="'+g+'"':"")+"><input name='"+f+"' id='"+f+"' size='"+e+"' onkeydown='return Jmol.controls._commandKeyPress(event,\""+f+'","'+c+"\")' value='"+h+"'/><input  type='button' name='"+f+"Btn' id='"+f+"Btn' value = '"+d+"' onclick='Jmol.controls._commandKeyPress(13,\""+f+'","'+c+"\")' /></span>",a._debugAlert&&alert(d),a._documentWrite(d))},b._getLink=function(c,d,e,f,g){return c=b._getIdForControl(c,d),null==c?"":(void 0!=f&&null!=f||(f="jmolLink"+b._linkCount),void 0!=e&&null!=e||(e=d.substring(0,32)),++b._linkCount,d=b._addScript(c,d),e='<span id="span_'+f+'"'+(g?' title="'+g+'"':"")+"><a name='"+f+"' id='"+f+"' href='javascript:Jmol.controls._click(null,"+d+");' onmouseover='Jmol.controls._mouseOver(null,"+d+");return true;' onmouseout='Jmol.controls._mouseOut()' "+b._linkCssText+">"+e+"</a></span>",a._debugAlert&&alert(e),a._documentWrite(e))},b._getMenu=function(c,d,e,f,g){var h=b._getIdForControl(c,null);if(void 0!=f&&null!=f||(f="jmolMenu"+b._menuCount),++b._menuCount,h=typeof d,null!=h&&"object"==h&&d.length){var i=d.length;for("number"!=typeof e||1==e?e=null:0>e&&(e=i),e='<span id="span_'+f+'"'+(g?' title="'+g+'"':"")+"><select name='"+f+"' id='"+f+"' onChange='Jmol.controls._menuSelected(this)'"+(e?" size='"+e+"' ":"")+b._menuCssText+">",f=0;i>f;++f){var j=d[f],h=typeof j,k=null,l=g=null;if("object"==h&&null!=j?(k=j[0],g=j[1],l=j[2]):k=g=j,h=b._getIdForControl(c,k),null==h)return"";null==g&&(g=k),"#optgroup"==k?e+="<optgroup label='"+g+"'>":"#optgroupEnd"==k?e+="</optgroup>":(h=b._addScript(h,k),e+="<option value='"+h+(l?"' selected='true'>":"'>")+g+"</option>")}return e+="</select></span>",a._debugAlert&&alert(e),a._documentWrite(e)}},b._getRadio=function(c,d,e,f,g,h,i,j){return 0==b._radioGroupCount&&++b._radioGroupCount,h||(h="jmolRadioGroup"+(b._radioGroupCount-1)),c=b._radio(c,d,e,f,g,h,i?i:h+"_"+b._radioCount,j?j:0),null==c?"":(a._debugAlert&&alert(c),a._documentWrite(c))},b._getRadioGroup=function(c,d,e,f,g,h){var i=typeof d;if("object"==i&&null!=i&&d.length){void 0!=e&&null!=e||(e="&#xa0; ");var j=d.length;++b._radioGroupCount,f||(f="jmolRadioGroup"+(b._radioGroupCount-1));for(var k="<span id='"+(g?g:f)+"'>",l=0;j>l;++l){l==j-1&&(e="");var m=d[l],i=typeof m,n=null,k="object"==i?k+(n=b._radio(c,m[0],m[1],m[2],e,f,3<m.length?m[3]:(g?g:f)+"_"+l,4<m.length?m[4]:0,h)):k+(n=b._radio(c,m,null,null,e,f,(g?g:f)+"_"+l,h));if(null==n)return""}return k+="</span>",a._debugAlert&&alert(k),a._documentWrite(k)}alert("invalid arrayOfRadioButtons")}}(Jmol),function(a){var b=function(a){return a="&"+a+"=",decodeURI(("&"+document.location.search.substring(1)+a).split(a)[1].split("&")[0])};a._j2sPath=b("_J2S"),a._jarFile=b("_JAR"),a._use=b("_USE"),a.getVersion=function(){return a._jmolInfo.version},a.getApplet=function(b,c,d){return a._Applet._get(b,c,d)},a.getJMEApplet=function(b,c,d,e){return a._JMEApplet._get(b,c,d,e)},a.getJSVApplet=function(b,c,d){return a._JSVApplet._get(b,c,d)},a.loadFile=function(a,b,c){a._loadFile(b,c)},a.script=function(a,b){a._checkDeferred(b)||a._script(b)},a.scriptCheck=function(a,b){return a&&a._scriptCheck&&a._ready&&a._scriptCheck(b)},a.scriptWait=function(a,b){return a._scriptWait(b)},a.scriptEcho=function(a,b){return a._scriptEcho(b)},a.scriptMessage=function(a,b){return a._scriptMessage(b)},a.scriptWaitOutput=function(a,b){return a._scriptWait(b)},a.scriptWaitAsArray=function(a,b){return a._scriptWaitAsArray(b)},a.search=function(a,b,c){a._search(b,c)},a.evaluateVar=function(a,b){return a._evaluate(b)},a.evaluate=function(a,b){return a._evaluateDEPRECATED(b)},a.getAppletHtml=function(b,c){if(c){var d=a._document;a._document=null,b=a.getApplet(b,c),a._document=d}return b._code},a.getPropertyAsArray=function(a,b,c){return a._getPropertyAsArray(b,c)},a.getPropertyAsJavaObject=function(a,b,c){return a._getPropertyAsJavaObject(b,c)},a.getPropertyAsJSON=function(a,b,c){return a._getPropertyAsJSON(b,c)},a.getPropertyAsString=function(a,b,c){return a._getPropertyAsString(b,c)},a.getStatus=function(a,b){return a._getStatus(b)},a.resizeApplet=function(a,b){return a._resizeApplet(b)},a.restoreOrientation=function(a,b){return a._restoreOrientation(b)},a.restoreOrientationDelayed=function(a,b,c){return a._restoreOrientationDelayed(b,c)},a.saveOrientation=function(a,b){return a._saveOrientation(b)},a.say=function(a){alert(a)},a.clearConsole=function(a){a._clearConsole()},a.getInfo=function(a){return a._info},a.setInfo=function(a,b,c){a._info=b,2<arguments.length&&a._showInfo(c)},a.showInfo=function(a,b){a._showInfo(b)},a.show2d=function(a,b){a._show2d(b)},a.jmolBr=function(){return a._documentWrite("<br />")},a.jmolButton=function(b,c,d,e,f){return a.controls._getButton(b,c,d,e,f)},a.jmolCheckbox=function(b,c,d,e,f,g,h){return a.controls._getCheckbox(b,c,d,e,f,g,h)},a.jmolCommandInput=function(b,c,d,e,f,g){return a.controls._getCommandInput(b,c,d,e,f,g)},a.jmolHtml=function(b){return a._documentWrite(b)},a.jmolLink=function(b,c,d,e,f){return a.controls._getLink(b,c,d,e,f)},a.jmolMenu=function(b,c,d,e,f){return a.controls._getMenu(b,c,d,e,f)},a.jmolRadio=function(b,c,d,e,f,g,h,i){return a.controls._getRadio(b,c,d,e,f,g,h,i)},a.jmolRadioGroup=function(b,c,d,e,f,g){return a.controls._getRadioGroup(b,c,d,e,f,g)},a.setCheckboxGroup=function(b,c){a.controls._cbSetCheckboxGroup(b,c,arguments)},a.setDocument=function(b){a._document=b},a.setXHTML=function(b){a._isXHTML=!0,a._XhtmlElement=null,a._XhtmlAppendChild=!1,b&&(a._XhtmlElement=document.getElementById(b),a._XhtmlAppendChild=!0)},a.setAppletCss=function(b,c){null!=b&&(a.controls._appletCssClass=b),a.controls._appletCssText=c?c+" ":b?'class="'+b+'" ':""},a.setButtonCss=function(b,c){null!=b&&(a.controls._buttonCssClass=b),a.controls._buttonCssText=c?c+" ":b?'class="'+b+'" ':""},a.setCheckboxCss=function(b,c){null!=b&&(a.controls._checkboxCssClass=b),a.controls._checkboxCssText=c?c+" ":b?'class="'+b+'" ':""},a.setRadioCss=function(b,c){null!=b&&(a.controls._radioCssClass=b),a.controls._radioCssText=c?c+" ":b?'class="'+b+'" ':""},a.setLinkCss=function(b,c){null!=b&&(a.controls._linkCssClass=b),a.controls._linkCssText=c?c+" ":b?'class="'+b+'" ':""},a.setMenuCss=function(b,c){null!=b&&(a.controls._menuCssClass=b),a.controls._menuCssText=c?c+" ":b?'class="'+b+'" ':""},a.setAppletSync=function(b,c,d){a._syncedApplets=b,a._syncedCommands=c,a._syncedReady={},a._isJmolJSVSync=d},a.setGrabberOptions=function(b){a._grabberOptions=b},a.setAppletHtml=function(b,c){b._code&&(a.$html(c,b._code),b._init&&!b._deferApplet&&b._init())},a.coverApplet=function(a,b){a._cover&&a._cover(b)},a.setFileCaching=function(b,c){b?b._cacheFiles=c:a.fileCache=c?{}:null},a.updateView=function(a,b,c){a._updateView(b,c)},a.getChemicalInfo=function(b,c,d){return c||(c="name"),"string"!=typeof applet_or_Identifier&&(b=b._getSmiles()),a._getNCIInfo(b,c,d)},a.saveImage=function(a){switch(a._viewType){case"Jmol":a._script('write PNGJ "'+a._id+'.png"');break;case"JSV":a._script("write PDF");break;case"JME":a._script("print")}}}(Jmol),LoadClazz=function(){window["j2s.clazzloaded"]||(window["j2s.clazzloaded"]=!1),window["j2s.clazzloaded"]||(window["j2s.clazzloaded"]=!0,window["j2s.object.native"]=!0,Clazz=function(){},function(a){a.__debuggingBH=!1,a._globals=["j2s.clazzloaded","j2s.object.native"],a.setGlobal=function(b,c){a._globals.push(b),window[b]=c},a.getGlobals=function(){return a._globals.sort().join("\n")},a._profile=window["j2s.doProfile"]&&self.JSON?{}:null,a.getProfile=function(){var b="";if(a._profile){var c,b=[];for(c in a._profile){var d=""+a._profile[c];b.push("        ".substring(d.length)+d+"	"+c)}b=b.sort().reverse().join("\r\n"),a._profile={}}return b},a.addProfile=function(b,c,d){b=b.__CLASS_NAME__+" "+c+" "+JSON.stringify(d),a._profile[b]||(a._profile[b]=0),a._profile[b]++},NullObject=function(){},a._supportsNativeObject=window["j2s.object.native"],a._supportsNativeObject?(a._O=function(){},a._O.__CLASS_NAME__="Object",a._O.getClass=function(){return a._O}):a._O=Object,a.Console={},a.dateToString=Date.prototype.toString,a.getSignature=function(a,b,c,d){return d?a[b]=c:a[b]},a.addProto=function(b,c,d){a.getSignature(b,c,d,!0)};var m=a._O.prototype;if(a.addProto(m,"equals",function(a){return this==a}),a.addProto(m,"hashCode",function(){try{return this.toString().hashCode()}catch(a){var b,c=":";for(b in this)c+=b+":";return c.hashCode()}}),a.addProto(m,"getClass",function(){return a.getClass(this)}),a.addProto(m,"clone",function(){return a.clone(this)}),a.clone=function(a){var b,c=new a.constructor;for(b in a)c[b]=a[b];return c},a.addProto(m,"finalize",function(){}),a.addProto(m,"notify",function(){}),a.addProto(m,"notifyAll",function(){}),a.addProto(m,"wait",function(){}),a.addProto(m,"to$tring",Object.prototype.toString),a.addProto(m,"toString",function(){return null!=this.__CLASS_NAME__?"["+this.__CLASS_NAME__+" object]":this.to$tring.apply(this,arguments)}),a._extendedObjectMethods="equals hashCode getClass clone finalize notify notifyAll wait to$tring toString".split(" "),a.extendJO=function(b,c){if(c&&(b.__CLASS_NAME__=b.prototype.__CLASS_NAME__=c),a._supportsNativeObject)for(var d=0;d<a._extendedObjectMethods.length;d++){var e=a._extendedObjectMethods[d];a.getSignature(b.prototype,e,a._O.prototype[e],!0)}},a.extractClassName=function(a){return a=a.substring(1,a.length-1),0<=a.indexOf("Array")?"Array":0<=a.indexOf("object ")?a.substring(7):a},a.getClassName=function(b,c){if(null==b)return"NullObject";if(b instanceof a.CastedNull)return b.clazzName;switch(typeof b){case"number":return"Number";case"boolean":return"Boolean";case"string":return"String";case"function":if(null!=b.__CLASS_NAME__)return c?b.__CLASS_NAME__:"Class";var d=b.toString(),e=d.indexOf("function");if(0>e)return"["==d.charAt(0)?a.extractClassName(d):d.replace(/[^a-zA-Z0-9]/g,"");var e=e+8,f=d.indexOf("(",e);return 0>f?"Object":(d=d.substring(e,f),0<=d.indexOf("Array")?"Array":(d=d.replace(/^\s+/,"").replace(/\s+$/,""),"anonymous"==d||""==d?"Function":d));case"object":if(null!=b.__CLASS_NAME__)return b.__CLASS_NAME__;if(null==b.constructor)return"Object";if(null==b.constructor.__CLASS_NAME__){if(b instanceof Number)return"Number";if(b instanceof Boolean)return"Boolean";if(b instanceof Array)return"Array";if(d=b.toString(),"["==d.charAt(0))return a.extractClassName(d)}}return a.getClassName(b.constructor,!0)},a.getClass=function(b){if(null==b)return a._O;if("function"==typeof b)return b;var c=null;if(b instanceof a.CastedNull)c=b.clazzName;else{if("string"==typeof b)return String;if("object"==typeof b){if(null==b.__CLASS_NAME__)return null==b.constructor?a._O:b.constructor;c=b.__CLASS_NAME__}}return null!=c?a.evalType(c,!0):b.constructor},a.extendsProperties=function(b,c){for(var d in c)"b$"!=d&&"prototype"!=d&&"superClazz"!=d&&"__CLASS_NAME__"!=d&&"implementz"!=d&&!a.checkInnerFunction(c,d)&&(b[d]=c[d])},a.checkInnerFunction=function(b,c){for(var d=0;d<a.innerFunctionNames.length;d++)if(c==a.innerFunctionNames[d]&&a._innerFunctions[c]===b[c])return!0;return!1},a.implementsProperties=function(b,c){for(var d in c)"b$"!=d&&"prototype"!=d&&"superClazz"!=d&&"__CLASS_NAME__"!=d&&"implementz"!=d&&!("function"==typeof c[d]&&a.checkInnerFunction(c,d))&&(b[d]=c[d],b.prototype[d]=c[d])},a.args4InheritClass=function(){},a.inheritArgs=new a.args4InheritClass,a.inheritClass=function(b,c,d){a.extendsProperties(b,c),a.isClassUnloaded(b)||(b.prototype=null!=d?d:c!==Number?new c(a.inheritArgs):new Number),b.superClazz=c,b.prototype.__CLASS_NAME__=b.__CLASS_NAME__},a.implementOf=function(b,c){if(2<=arguments.length){null==b.implementz&&(b.implementz=[]);var d=b.implementz;if(2==arguments.length){if("function"==typeof c)d[d.length]=c,a.implementsProperties(b,c);else if(c instanceof Array)for(var e=0;e<c.length;e++)d[d.length]=c[e],a.implementsProperties(b,c[e])}else for(e=1;e<arguments.length;e++)d[d.length]=arguments[e],a.implementsProperties(b,arguments[e])}},a.extendInterface=a.implementOf,a.equalsOrExtendsLevel=function(b,c){if(b===c)return 0;if(null!=b.implementz)for(var d=b.implementz,e=0;e<d.length;e++){var f=a.equalsOrExtendsLevel(d[e],c);if(f>=0)return f+1}return-1},a.getInheritedLevel=function(b,c){if(b===c)return 0;var d="string"==typeof b,e="string"==typeof c;if(d&&("void"==b||"unknown"==b)||e&&("void"==c||"unknown"==c))return-1;if((d&&"NullObject"==b||NullObject===b)&&c!==Number&&c!==Boolean&&c!==NullObject)return 0;if(d&&(b=a.evalType(b)),e&&(c=a.evalType(c)),null==c||null==b)return-1;for(d=0,e=b;e!==c&&10>d;){if(null!=e.implementz)for(var f=e.implementz,g=0;g<f.length;g++){var h=a.equalsOrExtendsLevel(f[g],c);if(h>=0)return d+h+1}if(e=e.superClazz,null==e)return c===Object||c===a._O?d+1.5:-1;d++}return d},a.instanceOf=function(b,c){if(null==b)return 0==c;if(null==c)return!1;if(b instanceof c)return!0;var d=a.getClassName(b);return 0<=a.getInheritedLevel(d,c)},a.superCall=function(b,c,d,e){var f=null,g=-1,h=b[d];if(null!=h)if(null!=h.claxxOwner)h.claxxOwner!==c&&(f=h);else if(null!=h.stacks||null!=h.lastClaxxRef&&null!=h.lastClaxxRef.prototype[d]&&null!=h.lastClaxxRef.prototype[d].stacks){var i=h.stacks;for(null==i&&(i=h.lastClaxxRef.prototype[d].stacks),g=i.length-1;g>=0;g--){if(c===i[g]){g>0?(g--,f=i[g].prototype[d]):f=i[0].prototype[d]["\\unknown"];break}if(0<a.getInheritedLevel(c,i[g])){f=i[g].prototype[d];break}}}else f=h;if(null!=f)return 0==g&&"construct"==d&&(g=h.stacks,null!=g&&null==g[0].superClazz&&null!=g[0].con$truct&&g[0].con$truct.apply(b,[])),a.tracingCalling?(g=arguments.callee.caller,g===a.superConstructor&&(g=g.arguments.callee.caller),a.pu$hCalling(new a.callingStack(g,c)),f=f.apply(b,null==e?[]:e),a.p0pCalling(),f):f.apply(b,null==e?[]:e);if("construct"!=d)throw a.alert(["j2slib","no class found",e.typeString]),new a.MethodNotFoundException(b,c,d,a.getParamsType(e).typeString)},a.superConstructor=function(b,c,d){a.superCall(b,c,"construct",d),null!=c.con$truct&&c.con$truct.apply(b,[])},a.CastedNull=function(b){this.clazzName=null!=b?b instanceof String?b:b instanceof Function?a.getClassName(b,!0):""+b:"Object",this.toString=function(){return null},this.valueOf=function(){return null}},a.castNullAs=function(b){return new a.CastedNull(b)},a.MethodException=function(){},a.MethodNotFoundException=function(){this.toString=function(){return"MethodNotFoundException"}},a.getParamsType=function(b){var c=b.length;switch(c){case 0:var d=["void"];return d.typeString="\\void",d;case 1:if(d=b[0],null!=d&&"number"==typeof d)return d=["Number"],d.typeString="\\Number",d}if(d=[],d.hasCastedNull=!1,null!=b)for(var e=0;c>e;e++)d[e]=a.getClassName(b[e]),b[e]instanceof a.CastedNull&&(d.hasCastedNull=!0);return d.typeString="\\"+d.join("\\"),d},a.searchAndExecuteMethod=function(b,c,d,e){var f=b[d],g=a.getParamsType(e);if(a._profile&&a.addProfile(c,d,g),f.lastParams==g.typeString&&f.lastClaxxRef===c){if(c=null,g.hasCastedNull)for(c=[],g=0;g<e.length;g++)c[g]=e[g]instanceof a.CastedNull?null:e[g];
else c=e;if(null!=f.lastMethod)return f.lastMethod.apply(b,c)}else{f.lastParams=g.typeString,f.lastClaxxRef=c;var h=f.stacks;null==h&&(h=c.prototype[d].stacks);for(var i=!1,j=h.length-1;j>-1;j--)if(i||h[j]===c){if(i=a.tryToSearchAndExecute(d,b,h[j].prototype[d],g,e,f),!(i instanceof a.MethodException))return i;i=!0}if("construct"!=d)throw new a.MethodNotFoundException(b,c,d,g.typeString)}},a.tracingCalling=!1,a.tryToSearchAndExecute=function(b,c,d,e,f,g){var h,i=[],j=!0;for(h in d)if(92==h.charCodeAt(0)){var k=h.substring(1).split("\\");k.length==e.length&&(i[i.length]=k),j=!1}else if(j&&"funParams"==h&&null!=d.funParams){h=d.funParams,k=h.substring(1).split("\\"),k.length==e.length&&(i[0]=k);break}if(0==i.length)return new a.MethodException;if(h=a.searchMethod(i,e),null!=h){if(i=null,i=j?d:d["\\"+h],j=null,e.hasCastedNull)for(j=[],h=0;h<f.length;h++)j[h]=f[h]instanceof a.CastedNull?null:f[h];else j=f;if(a.tracingCalling){if(k=arguments.callee.caller,k=k=k.arguments.callee.caller,h="construct"==i.exName&&0<=a.getInheritedLevel(i.exClazz,Throwable)&&!a._initializingException){a._initializingException=!0;var l=k.arguments.callee.caller.arguments.callee.caller,m=l.arguments.callee,n=m.claxxReference;null==n&&(n=m.exClazz),null==n&&(n=m.claxxOwner),a.pu$hCalling(new a.callingStack(l,n))}return(l=k!==a.instantialize&&k!==a.superCall)&&(m=k.arguments.callee,n=m.claxxReference,null==n&&(n=m.exClazz),null==n&&(n=m.claxxOwner),a.pu$hCalling(new a.callingStack(k,n))),g.lastMethod=i,i=i.apply(c,j),l&&a.p0pCalling(),h&&a.p0pCalling(),i}return g.lastMethod=i,i.apply(c,j)}return new a.MethodException},a._initializingException=!1,a.searchMethod=function(b,c){for(var d=[],e=0;e<b.length;e++){for(var f=[],g=!0,h=0;h<b[e].length;h++)if(f[h]=a.getInheritedLevel(c[h],b[e][h]),0>f[h]){g=!1;break}g&&(f[c.length]=e,d[d.length]=f)}if(0==d.length)return null;for(f=d[0],e=1;e<d.length;e++){for(g=!0,h=0;h<c.length;h++)if(f[h]<d[e][h]){g=!1;break}g&&(f=d[e])}return b[f[c.length]].join("\\")},a.generateDelegatingMethod=function(a,b){var c=function(){var a=arguments;return SAEM(this,a.callee.claxxReference,a.callee.methodName,a)};return c.methodName=b,c.claxxReference=a,c},SAEM=a.searchAndExecuteMethod,a.expExpandParameters=function(a,b){return"N"==b?"Number":"B"==b?"Boolean":"S"==b?"String":"O"==b?"Object":"A"==b?"Array":"Unknown"},a.formatParameters=function(b){return null==b||0==b.length?"\\void":b.replace(/~([NABSO])/g,a.expExpandParameters).replace(/\s+/g,"").replace(/^|,/g,"\\").replace(/\$/g,"org.eclipse.s")},a.overrideMethod=function(b,c,d,e){return a.assureInnerClass&&a.assureInnerClass(b,d),d.exName=c,e=a.formatParameters(e),d.funParams=e,d.claxxOwner=b,a.getSignature(b.prototype,c,d,!0)},a.defineMethod=function(b,c,d,e){a.assureInnerClass&&a.assureInnerClass(b,d),d.exName=c,e=a.formatParameters(e);var f=b.prototype,g=a.getSignature(f,c,d,!1);if(null==g||g.claxxOwner===b&&g.funParams==e)return d.funParams=e,d.claxxOwner=b,d.exClazz=b,a.getSignature(f,c,d,!0);var h=null,i=[];if(null==g.stacks?(h=g,null!=g.claxxOwner&&(i[0]=h.claxxOwner)):i=g.stacks,null==g.stacks||g.claxxReference!==b){for(g=a.getSignature(f,c,a.generateDelegatingMethod(b,c,g),!0),f=[],c=0;c<i.length;c++)f[c]=i[c];g.stacks=f}if(i=g.stacks,0==i.length)i[0]=b;else{for(f=!1,c=i.length-1;c>=0;c--)if(i[c]===b){f=!0;break}f||(i[i.length]=b)}return null!=h&&(h.claxxOwner===b?(g[h.funParams]=h,h.claxxOwner=null,h.funParams=null):null==h.claxxOwner&&(g["\\unknown"]=h)),d.exClazz=b,g[e]=d,g},a.makeConstructor=function(b,c,d){a.defineMethod(b,"construct",c,d),null!=b.con$truct&&(b.con$truct.index=b.con$truct.stacks.length)},a.overrideConstructor=function(b,c,d){a.overrideMethod(b,"construct",c,d),null!=b.con$truct&&(b.con$truct.index=b.con$truct.stacks.length)},a.allPackage={},a.allClasses={},a.lastPackageName=null,a.lastPackage=null,a.unloadedClasses=[],a.isClassUnloaded=function(b){return b=a.getClassName(b,!0),null!=a.unloadedClasses[b]},a.declarePackage=function(b){if(a.lastPackageName==b)return a.lastPackage;if(null!=b&&0!=b.length){for(var c=b.split(/\./),d=a.allPackage,e=0;e<c.length;e++)null==d[c[e]]&&(d[c[e]]={__PKG_NAME__:null!=d.__PKG_NAME__?d.__PKG_NAME__+"."+c[e]:c[e]},0==e&&a.setGlobal(c[e],d[c[e]])),d=d[c[e]];return a.lastPackageName=b,a.lastPackage=d}},a.evalType=function(b,c){var d=b.lastIndexOf(".");if(-1!=d){var e=b.substring(0,d),e=a.declarePackage(e),d=b.substring(d+1);return e[d]}return c?window[b]:"number"==b?Number:"object"==b?a._O:"string"==b?String:"boolean"==b?Boolean:"function"==b?Function:"void"==b||"undefined"==b||"unknown"==b?b:"NullObject"==b?NullObject:window[b]},a.defineType=function(b,c,d,e){var f=a.unloadedClasses[b];if(null!=f&&(c=f),f=b.lastIndexOf("."),-1!=f){var g=b.substring(0,f),g=a.declarePackage(g),f=b.substring(f+1);if(null!=g[f])return g[f];g[f]=c}else{if(null!=window[b])return window[b];a.setGlobal(b,c)}return a.decorateAsType(c,b,d,e),b=a._innerFunctions,c.defineMethod=b.defineMethod,c.defineStaticMethod=b.defineStaticMethod,c.makeConstructor=b.makeConstructor,c},a.isSafari=-1!=navigator.userAgent.indexOf("Safari"),a.isSafari4Plus=!1,a.isSafari){var m=navigator.userAgent,g=m.indexOf("Version/");-1!=g&&(m=m.substring(g+8),m=parseFloat(m),a.isSafari4Plus=m>=4)}a.instantialize=function(b,c){if(!(null!=c&&1==c.length&&null!=c[0]&&c[0]instanceof a.args4InheritClass)){if(b instanceof Number&&(b.valueOf=function(){return this}),a.isSafari4Plus){for(var d=[],e=0;e<c.length;e++)d[e]=c[e];c=d}d=b.construct,null!=d?null==b.con$truct?d.apply(b,c):null==b.getClass().superClazz?(b.con$truct.apply(b,[]),d.apply(b,c)):null!=d.claxxOwner&&d.claxxOwner===b.getClass()||null!=d.stacks&&d.stacks[d.stacks.length-1]==b.getClass()?d.apply(b,c):(null!=d.claxxOwner&&null==d.claxxOwner.superClazz&&null!=d.claxxOwner.con$truct?d.claxxOwner.con$truct.apply(b,[]):null!=d.stacks&&1==d.stacks.length&&null==d.stacks[0].superClazz&&d.stacks[0].con$truct.apply(b,[]),d.apply(b,c),b.con$truct.apply(b,[])):null!=b.con$truct&&b.con$truct.apply(b,[])}},a.innerFunctionNames="equals hashCode getName getClassLoader getResource getResourceAsStream defineMethod defineStaticMethod makeConstructor".split(" "),a._innerFunctions={equals:function(a){return this===a},hashCode:function(){return this.getName().hashCode()},toString:function(){return"class "+this.getName()},getName:function(){return a.getClassName(this,!0)},getClassLoader:function(){var b=this.__CLASS_NAME__,c=a._Loader.getClasspathFor(b),d=c.lastIndexOf(b.replace(/\./g,"/")),c=-1!=d?c.substring(0,d):a._Loader.getClasspathFor(b,!0),b=a._Loader.requireLoaderByBase(c);return b.getResourceAsStream=a._innerFunctions.getResourceAsStream,b.getResource=a._innerFunctions.getResource,b},getResource:function(a){return this.getResourceAsStream(a).url},getResourceAsStream:function(b){var c=null;if(null==b)return c;null!=java.io.InputStream?c=new java.io.InputStream:(c=new a._O,c.__CLASS_NAME__="java.io.InputStream",c.close=NullObject),c.read=function(){return 0},b=b.replace(/\\/g,"/");var d=null,e=this.__CLASS_NAME__;if(2==arguments.length&&0!=b.indexOf("/")&&(b="/"+b),0==b.indexOf("/"))if(2==arguments.length?(d=arguments[1],null==d&&(d=a._Loader.binaryFolders[0])):null!=a._Loader&&(d=a._Loader.getClasspathFor(e,!0)),null==d||0==d.length)c.url=b.substring(1);else{var d=d.replace(/\\/g,"/"),f=d.length,f=d.charAt(f-1);"/"!=f&&(d+="/"),c.url=d+b.substring(1)}else{if(null!=this.base)d=this.base;else if(null!=a._Loader)if(d=a._Loader.getClasspathFor(e),f=d.lastIndexOf(e.replace(/\./g,"/")),-1!=f)d=d.substring(0,f);else if(f=-1,d.indexOf(".z.js")==d.length-5&&-1!=(f=d.lastIndexOf("/")))for(var d=d.substring(0,f+1),f=e.split(/\./),g=1;g<f.length;g++){for(var h="/",i=0;g>i;i++)h+=f[i]+"/";if(h.length>d.length)break;if(d.indexOf(h)==d.length-h.length){d=d.substring(0,d.length-h.length+1);break}}else d=a._Loader.getClasspathFor(e,!0);else f=a.binaryFolders,null!=f&&0!=f.length&&(d=f[0]);(null==d||0==d.length)&&(d="j2s/"),d=d.replace(/\\/g,"/"),f=d.length,f=d.charAt(f-1),"/"!=f&&(d+="/"),null!=this.base?c.url=d+b:(f=e.lastIndexOf("."),c.url=-1==f||null!=this.base?d+b:d+e.substring(0,f).replace(/\./g,"/")+"/"+b)}return c},defineMethod:function(b,c,d){a.defineMethod(this,b,c,d)},defineStaticMethod:function(b,c,d){a.defineMethod(this,b,c,d),this[b]=this.prototype[b]},makeConstructor:function(b,c){a.makeConstructor(this,b,c)}},a.decorateFunction=function(b,c,d){null!=a._Loader&&a._Loader.checkInteractive();var e=null;for(null==c?(e=d,a.setGlobal(d,b)):null!=c.__PKG_NAME__?(e=c.__PKG_NAME__+"."+d,c[d]=b,c===java.lang&&a.setGlobal(d,b)):(e=c.__CLASS_NAME__+"."+d,c[d]=b),a.extendJO(b,e),c=a.innerFunctionNames,d=0;d<c.length;d++)b[c[d]]=a._innerFunctions[c[d]];null!=a._Loader&&(b=a._Loader.findClass(e),null!=b&&b.status==a._Node.STATUS_KNOWN&&window.setTimeout(function(b){return function(){a._Loader.updateNode(b)}}(b),1))},a.currentPath="",a.declareInterface=function(b,c,d){var e=function(){};return a.decorateFunction(e,b,c,"Clazz.declareInterface"),null!=d&&a.implementOf(e,d),e},a.decorateAsClass=function(b,c,d,e,f,g,h){var i=null;return null!=c&&(i=c.__PKG_NAME__,null==i&&(i=c.__CLASS_NAME__)),i=a.unloadedClasses[(null==i?"":i+".")+d],null!=i&&(b=i),a.decorateFunction(b,c,d,h+"...Clazz.decorateAsClass"),null!=g?a.inheritClass(b,e,g):null!=e&&a.inheritClass(b,e),null!=f&&a.implementOf(b,f),b},a.declareType=function(b,c,d,e,f){return a.decorateAsClass(function(){a.instantialize(this,arguments)},b,c,d,e,f,"Clazz.declareType")},a.declareAnonymous=function(b,c,d,e,f){return a.decorateAsClass(function(){a.prepareCallback(this,arguments),a.instantialize(this,arguments)},b,c,d,e,f,"Clazz.declareAnonymous")},a.decorateAsType=function(b,c,d,e,f,g){if(a.extendJO(b,c),b.equals=a._innerFunctions.equals,b.getName=a._innerFunctions.getName,g)for(c=0;c<a.innerFunctionNames.length;c++)g=a.innerFunctionNames[c],b[g]=a._innerFunctions[g];return null!=f?a.inheritClass(b,d,f):null!=d&&a.inheritClass(b,d),null!=e&&a.implementOf(b,e),b},a._ex_reg=function(a,b,c){c||(c="[^\\s]+");var d=a.indexOf(b);return a=a.substring(0,d)+c+a.substring(d+b.length),RegExp("^"+a+"$")};try{null.hello()}catch(j){/Opera[\/\s](\d+\.\d+)/.test(navigator.userAgent)?(m=j.message.indexOf(":"),g=j.message.indexOf(":",m+2),a._NPEMsgFragment=j.message.substr(m+1,g-m-20),a._isNPEExceptionPredicate=function(b){return-1!=b.message.indexOf(a._NPEMsgFragment)}):-1!=navigator.userAgent.toLowerCase().indexOf("webkit")?(a._exceptionNPERegExp=a._ex_reg(j.message,"hello"),a._isNPEExceptionPredicate=function(b){return a._exceptionNPERegExp.test(b.message)}):(a._exceptionNPERegExp=a._ex_reg(j.message,"$$o$$"),a._isNPEExceptionPredicate=function(b){return a._exceptionNPERegExp.test(b.message)})}if(a.exceptionOf=function(b,c){return b.__CLASS_NAME__?a.instanceOf(b,c):c==Error?(0<=(""+b).indexOf("Error")&&System.out.println(a.getStackTrace()),0<=(""+b).indexOf("Error")):c==Exception||c==Throwable||c==NullPointerException&&a._isNPEExceptionPredicate(b)},a.getStackTrace=function(a){var b="\n";a||(a=25);for(var c=arguments.callee.caller,d=0;a>d&&c;d++)b+=d+" "+(c.exName?(c.claxxOwner?c.claxxOwner.__CLASS_NAME__+".":"")+c.exName:c.toString?c.toString().substring(0,c.toString().indexOf("{")):"<native method>")+"\n",c=c.caller;return b},Number.prototype._numberToString=Number.prototype.toString,a.declarePackage("java.io"),a.declarePackage("java.lang.annotation"),a.declarePackage("java.lang.instrument"),a.declarePackage("java.lang.management"),a.declarePackage("java.lang.reflect"),a.declarePackage("java.lang.ref"),java.lang.ref.reflect=java.lang.reflect,a.declarePackage("java.util"),a.declareInterface(java.io,"Closeable"),a.declareInterface(java.io,"DataInput"),a.declareInterface(java.io,"DataOutput"),a.declareInterface(java.io,"Externalizable"),a.declareInterface(java.io,"Flushable"),a.declareInterface(java.io,"Serializable"),a.declareInterface(java.lang,"Iterable"),a.declareInterface(java.lang,"CharSequence"),a.declareInterface(java.lang,"Cloneable"),a.declareInterface(java.lang,"Appendable"),a.declareInterface(java.lang,"Comparable"),a.declareInterface(java.lang,"Runnable"),a.declareInterface(java.util,"Comparator"),java.lang.ClassLoader={__CLASS_NAME__:"ClassLoader"},null!=window.Clazz&&null==window.Clazz.unloadClass){for(a.MethodNotFoundException=function(b,c,d,e){b="",null!=e&&(b=e.substring(1).replace(/\\/g,",")),this.message=(null!=d&&"construct"!=d?"Method":"Constructor")+" "+a.getClassName(c,!0)+"."+d+"("+b+") is not found!",this.toString=function(){return"MethodNotFoundException:"+this.message}},a.prepareCallback=function(b,c){var d=c[0];if(null!=b&&null!=d&&d!==window){var e=[];if(null!=b.b$)for(var f in b.b$)"length"!=f&&(e[f]=b.b$[f]);b.b$=e;var g=a.getClassName(d,!0);for(e[g.replace(/org\.eclipse\.swt\./,"$wt.")]=d,g=a.getClass(d);null!=g.superClazz;)g=g.superClazz,e[a.getClassName(g,!0).replace(/org\.eclipse\.swt\./,"$wt.")]=d;if(d=d.b$,null!=d&&d instanceof Array)for(f in d)"length"!=f&&(e[f]=d[f])}for(e=0;e<c.length-1;e++)c[e]=c[e+1];c.length--},a.innerTypeInstance=function(b,c,d){null==b&&(b=arguments.callee.caller);var e=null;if(null==d&&null==c.$finals)if(3==arguments.length)e=new b(c);else if(4==arguments.length)e=c.__CLASS_NAME__==b.__CLASS_NAME__&&arguments[3]===a.inheritArgs?c:new b(c,arguments[3]);else if(5==arguments.length)e=new b(c,arguments[3],arguments[4]);else if(6==arguments.length)e=new b(c,arguments[3],arguments[4],arguments[5]);else if(7==arguments.length)e=new b(c,arguments[3],arguments[4],arguments[5],arguments[6]);else if(8==arguments.length)e=new b(c,arguments[3],arguments[4],arguments[5],arguments[6],arguments[7]);else if(9==arguments.length)e=new b(c,arguments[3],arguments[4],arguments[5],arguments[6],arguments[7],arguments[8]);else if(10==arguments.length)e=new b(c,arguments[3],arguments[4],arguments[5],arguments[6],arguments[7],arguments[8],arguments[9]);else{for(var e=new b(c,a.inheritArgs),f=[],g=3;g<arguments.length;g++)f[g-3]=arguments[g];a.instantialize(e,f)}else{if(e=new b(c,a.inheritArgs),null!=d&&null==c.f$)e.f$=d;else if(null==d&&null!=c.f$)e.f$=c.f$;else if(null!=d&&null!=c.f$){f={};for(g in c.f$)f[g]=c.f$[g];for(g in d)f[g]=d[g];e.f$=f}for(f=[],g=3;g<arguments.length;g++)f[g-3]=arguments[g];a.instantialize(e,f)}return e},a.cloneFinals=function(){for(var a={},b=arguments.length/2,c=0;b>c;c++)a[arguments[c+c]]=arguments[c+c+1];return a},a.isClassDefined=a.isDefinedClass=function(b){if(null!=b&&0!=b.length){if(a.allClasses[b])return!0;for(var c=b.split(/\./),d=null,e=0;e<c.length;e++)if(null==d){if(null==a.allPackage[c[0]])return!1;d=a.allPackage[c[0]]}else{if(null==d[c[e]])return!1;d=d[c[e]]}if(null!=d)return a.allClasses[b]=!0}return!1},a.defineEnumConstant=function(a,b,c,d,e){var f=null,f=null!=e?new e:new a;return f.$name=b,f.$ordinal=c,null!=d&&0!=d.length&&f.construct.apply(f,d),a[b]=f,a.prototype[b]=f,null==a["$ values"]&&(a["$ values"]=[],a.values=function(){return this["$ values"]}),a["$ values"].push(f),f},a.floatToInt=function(a){return 0>a?Math.ceil(a):Math.floor(a)},a.floatToByte=a.floatToShort=a.floatToLong=a.floatToInt,a.doubleToByte=a.doubleToShort=a.doubleToLong=a.doubleToInt=a.floatToInt,a.floatToChar=function(a){return String.fromCharCode(0>a?Math.ceil(a):Math.floor(a))},a.doubleToChar=a.floatToChar,self.Int32Array&&self.Int32Array!=Array?(a.haveInt32=!0,Int32Array.prototype.sort||(Int32Array.prototype.sort=Array.prototype.sort)):(Int32Array=function(a){a||(a=0);var b=Array(a);b.toString=function(){return"[object Int32Array]"};for(var c=0;a>c;c++)b[c]=0;return b},a.haveInt32=!1,Int32Array.prototype.sort=Array.prototype.sort,Int32Array.prototype.int32Fake=function(){}),self.Float64Array&&self.Float64Array!=Array?(a.haveFloat64=!0,Float64Array.prototype.sort||(Float64Array.prototype.sort=Array.prototype.sort)):(a.haveFloat64=!1,Float64Array=function(a){a||(a=0);for(var b=Array(a),c=0;a>c;c++)b[c]=0;return b},Float64Array.prototype.sort=Array.prototype.sort,Float64Array.prototype.float64Fake=function(){},Float64Array.prototype.toString=function(){return"[object Float64Array]"}),a.newArray=function(){if(arguments[0]instanceof Array)var b=arguments[0],c=arguments[1];else b=arguments,c=Array;if(1>=b.length)return[];var d=b[0];"string"==typeof d&&(d=d.charCodeAt(0));var e=b.length-1,f=b[e];if(2==b.length){if(null==f)return Array(d);if(!0===c&&a.haveInt32)return new Int32Array(d);if(!1===c&&a.haveFloat64)return new Float64Array(d);if(c==Array&&null==f)return Array(d);for(var b=!0===c?new Int32Array:!1===c?new Float64Array:Array(d),g=d;0<=--g;)b[g]=f;return b}for(var h=Array(e),g=0;e>g;g++)h[g]=b[g+1];if(b=Array(d),null==f||f>=0||e>2)for(g=0;d>g;g++)b[g]=a.newArray(h,c);return b},a.newArray32=function(b,c){var d=b[0];"string"==typeof d&&(d=d.charCodeAt(0));var e=b.length-1,f=b[e];switch(b.length){case 0:case 1:return alert("ERROR IN newArray32 -- args length < 2"),[];case 2:if(0>f)return Array(d);try{return c?new Int32Array(d):new Float64Array(d)}catch(g){alert(d+" "+arguments.callee.caller.arguments.callee.caller+g)}}for(f=Array(e);0<=--e;)f[e]=b[e+1];for(var h=Array(d),e=0;d>e;e++)h[e]=a.newArray(f,c);return h},a.newInt32Array=function(){return a.newArray32(arguments,!0)},a.newFloat64Array=function(){return a.newArray32(arguments,!1)},a.newFloatArray=a.newDoubleArray=a.newFloat64Array,a.newIntArray=a.newLongArray=a.newShortArray=a.newByteArray=a.newInt32Array,a.newCharArray=a.newBooleanArray=a.newArray,a.arrayIs=function(a,b){return a.constructor&&a.constructor!=Number&&0<=a.constructor.toString().indexOf(b)},a.isAS=function(b){return b&&"object"==typeof b&&a.arrayIs(b," Array")&&("string"==typeof b[0]||"undefined"==typeof b[0])},a.isASS=function(b){return b&&"object"==typeof b&&a.isAS(b[0])},a.isAP=function(b){return b&&"JU.P3"==a.getClassName(b[0])},a.isAI=function(b){return b&&"object"==typeof b&&(a.haveInt32?a.arrayIs(b,"Int32Array"):b.int32Fake?!0:!1)},a.isAII=function(b){return b&&"object"==typeof b&&a.isAI(b[0])},a.isAF=function(b){return b&&"object"==typeof b&&(a.haveFloat64?a.arrayIs(b,"Float64Array"):b.float64Fake?!0:!1)},a.isAFF=function(b){return b&&"object"==typeof b&&a.isAF(b[0])},a.isAFFF=function(b){return b&&"object"==typeof b&&a.isAFF(b[0])},a.isAFloat=function(b){return b&&"object"==typeof b&&a.arrayIs(b," Array")&&a.instanceOf(b[0],Float)},a.makeFunction=function(a){return function(b){return null==b&&(b=window.event),null!=a.setEvent&&a.setEvent(b),a.run(),1==a.returnSet?a.returnNumber:2==a.returnSet?a.returnBoolean:3==a.returnSet?a.returnObject:void 0}},a.defineStatics=function(a){for(var b=arguments.length,c=(b-1)/2;0<=--c;){var d=arguments[--b],e=arguments[--b];a[e]=a.prototype[e]=d}},a.prepareFields=function(b,c){var d=[];if(null!=b.con$truct)for(var e=b.con$truct.stacks,f=0;f<e.length;f++)d[f]=e[f];a.addProto(b.prototype,"con$truct",b.con$truct=function(){var a=arguments.callee.stacks;if(null!=a)for(var b=0;b<a.length;b++)a[b].apply(this,[])}),d[d.length]=c,b.con$truct.stacks=d,b.con$truct.index=0},a.registerSerializableFields=function(a){var b=arguments,c=b.length,d=[];if(null!=a.declared$Fields)for(var e=0;e<a.declared$Fields.length;e++)d[e]=a.declared$Fields[e];if(a.declared$Fields=d,c>0&&1==c%2)for(d=a.declared$Fields,e=1;(c-1)/2>=e;e++){for(var f={name:b[e+e-1],type:b[e+e]},g=!1,h=0;h<d.length;h++)if(d[h].name==f.name){d[h].type=f.type,g=!0;break}g||(d[d.length]=f)}},a.getMixedCallerMethod=function(b){var c={};return b=b.callee.caller,null==b||b!==a.tryToSearchAndExecute&&(b=b.arguments.callee.caller,null==b)||b!==a.tryToSearchAndExecute?null:(b=b.arguments.callee.caller,null==b||b!==a.searchAndExecuteMethod?null:(c.claxxRef=b.arguments[1],c.fxName=b.arguments[2],c.paramTypes=a.getParamsType(b.arguments[3]),b=b.arguments.callee.caller,null==b?null:(b=b.arguments.callee.caller,null==b?null:(c.caller=b,c))))},c$=null,a.cStack=[],a.pu$h=function(b){b&&a.cStack.push(b)},a.p0p=function(){return a.cStack.pop()},a.tracingCalling=!1,a._initializingException=!1,a.callingStack=function(a,b){this.caller=a,this.owner=b},a._callingStackTraces=[],a.pu$hCalling=function(b){a._callingStackTraces[a._callingStackTraces.length]=b},a.p0pCalling=function(){var b=a._callingStackTraces.length;return b>0?(b=a._callingStackTraces[b-1],a._callingStackTraces.length--,b):null},a.load=function(a,b,c,d){null!=d&&d(),delete c$},java.lang.Object=a._O,a._O.getName=a._innerFunctions.getName,System={props:null,$props:{},arraycopy:function(a,b,c,d,e){if(a!==c)for(var f=0;e>f;f++)c[d+f]=a[b+f];else{for(var g=[],f=0;e>f;f++)g[f]=a[b+f];for(f=0;e>f;f++)c[d+f]=g[f]}},currentTimeMillis:function(){return(new Date).getTime()},gc:function(){},getProperties:function(){return System.props},getProperty:function(a,b){if(System.props)return System.props.getProperty(a,b);var c=System.$props[a];return null!=c?c:1==arguments.length?null:null!=b?b:a},getSecurityManager:function(){return null},setProperties:function(a){System.props=a},setProperty:function(a,b){return null==System.props?System.$props[a]=b:void System.props.setProperty(a,b)}},System.setProperty("line.separator",0<=navigator.userAgent.indexOf("Windows")?"\r\n":"\n"),System.setProperty("os.name",navigator.userAgent),System.out=new a._O,System.out.__CLASS_NAME__="java.io.PrintStream",System.out.print=function(){},System.out.printf=function(){},System.out.println=function(){},System.err=new a._O,System.err.__CLASS_NAME__="java.io.PrintStream",System.err.print=function(){},System.err.printf=function(){},System.err.println=function(){},a.popup=a.assert=a.log=a.error=window.alert,Thread=function(){},Thread.J2S_THREAD=Thread.prototype.J2S_THREAD=new Thread,Thread.currentThread=Thread.prototype.currentThread=function(){return this.J2S_THREAD},a.intCast=function(a){var b=(4278190080&a)>>24,c=(16711680&a)>>16,d=(65280&a)>>8;return a&=255,0!=(128&b)?-(((127&b)<<24)+(c<<16)+(d<<8)+a+1):(b<<24)+(c<<16)+(d<<8)+a},a.shortCast=function(){var a=(65280&n)>>8,b=255&n;return 0!=(128&a)?-(((127&a)<<8)+b+1):(a<<8)+b4},a.byteCast=function(a){return 0!=(128&a)?-((127&a)+1):255&a},a.charCast=function(a){return String.fromCharCode(255&a).charAt(0)},a.floatCast=function(a){return a},a.longMasks=[],a.longReverseMasks=[],a.longBits=[],m=[1],g=1;53>g;g++)m[g]=m[g-1]+m[g-1];for(a.longBits=m,a.longMasks[52]=m[52],g=51;g>=0;g--)a.longMasks[g]=a.longMasks[g+1]+m[g];for(a.longReverseMasks[0]=m[0],g=1;52>g;g++)a.longReverseMasks[g]=a.longReverseMasks[g-1]+m[g];for(a.longLeftShift=function(b,c){if(0==c)return b;if(c>=64)return 0;if(c>52)return error("[Java2Script] Error : JavaScript does not support long shift!"),b;if(0!=(b&a.longMasks[c-1]))return error("[Java2Script] Error : Such shift operator results in wrong calculation!"),b;var d=b&a.longMasks[20+c];return 0!=d?d*a.longBits[c]+(b&a.longReverseMasks[32-c])<<0:b<<c},a.intLeftShift=function(a,b){return a<<b&4294967295},a.longRightShift=function(b,c){return 0!=(b&a.longMasks[20])?Math.round((b&a.longMasks[20])/a.longBits[32-c])+(b&a.longReverseMasks[c])>>c:b>>c},a.intRightShift=function(a,b){return a>>b},a.long0RightShift=function(a,b){return a>>>b},a.int0RightShift=function(a,b){return a>>>b},a.declarePackage("java.lang.reflect"),a.declarePackage("java.security"),a.innerFunctionNames=a.innerFunctionNames.concat("getSuperclass isAssignableFrom getMethods getMethod getDeclaredMethods getDeclaredMethod getConstructor getModifiers isArray newInstance".split(" ")),a._innerFunctions.getSuperclass=function(){return this.superClazz},a._innerFunctions.isAssignableFrom=function(b){return 0<=a.getInheritedLevel(b,this)},a._innerFunctions.getConstructor=function(){return new java.lang.reflect.Constructor(this,[],[],java.lang.reflect.Modifier.PUBLIC)},a._innerFunctions.getDeclaredMethods=a._innerFunctions.getMethods=function(){var a,b=[],c=this.prototype;for(a in c)"function"==typeof c[a]&&null==c[a].__CLASS_NAME__&&(b[b.length]=new java.lang.reflect.Method(this,a,[],java.lang.Void,[],java.lang.reflect.Modifier.PUBLIC));c=this;for(a in c)"function"==typeof c[a]&&null==c[a].__CLASS_NAME__&&(b[b.length]=new java.lang.reflect.Method(this,a,[],java.lang.Void,[],java.lang.reflect.Modifier.PUBLIC|java.lang.reflect.Modifier.STATIC));return b},a._innerFunctions.getDeclaredMethod=a._innerFunctions.getMethod=function(a){var b,c=this.prototype;for(b in c)if(a==b&&"function"==typeof c[b]&&null==c[b].__CLASS_NAME__)return new java.lang.reflect.Method(this,b,[],java.lang.Void,[],java.lang.reflect.Modifier.PUBLIC);c=this;for(b in c)if(a==b&&"function"==typeof c[b]&&null==c[b].__CLASS_NAME__)return new java.lang.reflect.Method(this,b,[],java.lang.Void,[],java.lang.reflect.Modifier.PUBLIC|java.lang.reflect.Modifier.STATIC);return null},a._innerFunctions.getModifiers=function(){return java.lang.reflect.Modifier.PUBLIC},a._innerFunctions.isArray=function(){return!1},a._innerFunctions.newInstance=function(){return new this},m=a.innerFunctionNames,g=0;g<m.length;g++)a._O[m[g]]=a._innerFunctions[m[g]],Array[m[g]]=a._innerFunctions[m[g]];Array.isArray=function(){return!0},a._4Name=function(b){return a.isClassDefined(b)?a.evalType(b):null!=a._Loader?(a._Loader.setLoadingMode("xhr.sync"),a._Loader.loadClass(b),a.evalType(b)):void a.alert("[Java2Script] Error: No ClassLoader!")},a.cleanDelegateMethod=function(a){null!=a&&"function"==typeof a&&null!=a.lastMethod&&null!=a.lastParams&&null!=a.lastClaxxRef&&(a.lastMethod=null,a.lastParams=null,a.lastClaxxRef=null)},a.unloadClass=function(b){var c=a.evalType(b);if(null!=c){a.unloadedClasses[b]=c;for(var d=b.split(/\./),e=null,f=0;f<d.length-1;f++)e=null==e?a.allPackage[d[0]]:e[d[f]];if(null==e){a.allPackage[d[0]]=null,window[d[0]]=null;for(var g in window)0==g.indexOf(b+"$")&&(a.unloadClass(g),window[g]=null)}else for(g in e[d[d.length-1]]=null,e)0==g.indexOf(d[d.length-1]+"$")&&(a.unloadClass(e.__PKG_NAME__+"."+g),e[g]=null);if(1==a.allClasses[b])for(g in a.allClasses[b]=!1,a.allClasses)0==g.indexOf(b+"$")&&(a.allClasses[g]=!1);for(var h in c)a.cleanDelegateMethod(c[h]);for(h in c.prototype)a.cleanDelegateMethod(c.prototype[h]);return null!=a._Loader&&a._Loader.unloadClassExt(b),!0}return!1}}a._Loader=function(){},a._Node=function(){a._Loader.initNode(this)},function(a,c,b){if(c.initNode=function(a){a.parents=[],a.musts=[],a.optionals=[],a.declaration=null,a.name=null,a.path=null,a.status=0,a.random=.13412,a.optionalsLoaded=null},b.prototype.toString=function(){return this.name||this.path||"ClazzNode"},b.STATUS_UNKNOWN=0,b.STATUS_KNOWN=1,b.STATUS_CONTENT_LOADED=2,b.STATUS_MUSTS_LOADED=3,b.STATUS_DECLARED=4,b.STATUS_OPTIONALS_LOADED=5,c.loaders=[],c.requireLoaderByBase=function(a){for(var b=0;b<c.loaders.length;b++)if(c.loaders[b].base==a)return c.loaders[b];return b=new c,b.base=a,c.loaders[c.loaders.length]=b},c.clazzTreeRoot=new b,c.loadedScripts={},c.inLoadingThreads=0,c.maxLoadingThreads=6,c.userAgent=navigator.userAgent.toLowerCase(),c.isOpera=-1!=c.userAgent.indexOf("opera"),c.isIE=-1!=c.userAgent.indexOf("msie")&&!c.isOpera,c.isGecko=-1!=c.userAgent.indexOf("gecko"),c.isOpera){c.maxLoadingThreads=1;var e=c.userAgent.indexOf("opera/");if(-1!=e){var g=9;try{g=parseFloat(c.userAgent.subString(e+6))}catch(j){}g>=9.6&&(c.maxLoadingThreads=6)}}null!=window.Clazz&&a.isClassDefined?c.isClassDefined=a.isClassDefined:(c.definedClasses={},c.isClassDefined=function(a){return 1==c.definedClasses[a]}),c.isAsynchronousLoading=!0,c.isUsingXMLHttpRequest=!1,c.loadingTimeLag=-1,c.setLoadingMode=function(a,b){null!=a&&("string"==typeof a?(a=a.toLowerCase(),0==a.length||-1!=a.indexOf("script")?(c.isUsingXMLHttpRequest=!1,c.isAsynchronousLoading=!0):(c.isUsingXMLHttpRequest=!0,c.isAsynchronousLoading=-1!=a.indexOf("async")?!0:!1),c.isAsynchronousLoading=!1):a==c.MODE_SCRIPT?(c.isUsingXMLHttpRequest=!1,c.isAsynchronousLoading=!0):(c.isUsingXMLHttpRequest=!0,c.isAsynchronousLoading=a==c.MODE_XHR_ASYNC?!0:!1)),c.loadingTimeLag=c.isAsynchronousLoading&&b>=0?b:-1},c.MODE_SCRIPT=0,c.MODE_SCRIPT_ASYNC=0,c.MODE_XHR=3,c.MODE_XHR_SYNC=3,c.MODE_XHR_ASYNC=1,c.unwrapArray=function(a){if(null==a||0==a.length)return a;for(var b=null,c=0;c<a.length;c++)if(null!=a[c]){if("$"==a[c].charAt(0))if("."==a[c].charAt(1)){if(null==b)continue;var d=b.lastIndexOf(".");-1!=d&&(b=b.substring(0,d),a[c]=b+a[c].substring(1))}else a[c]="org.eclipse.s"+a[c].substring(1);b=a[c]}return a},c.classQueue=[],c.classpathMap={},c.packageClasspath=function(a,b,d){var e=c.classpathMap,f=1==d&&null!=e["@"+a];if(d&&null==e["@java"]&&0!=a.indexOf("java")&&c.assurePackageClasspath("java"),a instanceof Array)for(c.unwrapArray(a),e=0;e<a.length;e++)c.packageClasspath(a[e],b,d);else{if("java"==a||"java.*"==a){var g="@net.sf.j2s.ajax";null==e[g]&&null!=b&&(e[g]=b),g="@net.sf.j2s",null==e[g]&&null!=b&&(e[g]=b)}else"swt"==a?a="org.eclipse.swt":"ajax"==a?a="net.sf.j2s.ajax":"j2s"==a&&(a="net.sf.j2s");a.lastIndexOf(".*")==a.length-2&&(a=a.substring(0,a.length-2)),null!=b&&(e["@"+a]=b),1==d&&1!=window[a+".registered"]&&!f&&(c.pkgRefCount++,"java"==a&&(a="core"),c.loadClass(a+".package",function(){c.pkgRefCount--,0==c.pkgRefCount&&c.runtimeLoaded()},!0))}},c.pkgRefCount=0,c.jarClasspath=function(a,b){b instanceof Array||(b=[classes]),c.unwrapArray(b);for(var d=0;d<b.length;d++)c.classpathMap["#"+b[d]]=a;c.classpathMap["$"+a]=b},c.registerPackages=function(b,d){c.checkInteractive();for(var e=c.getClasspathFor(b+".*",!0),f=0;f<d.length;f++)null!=window.Clazz&&a.declarePackage(b+"."+d[f]),c.packageClasspath(b+"."+d[f],e)},c.multipleSites=function(a){var b=window["j2s.update.delta"];if(null!=b&&b instanceof Array&&3<=b.length)for(var d=null,e=null,f=0;f<b.length/3;f++){var g=b[f+f+f];"$"!=g&&(d=g),g=b[f+f+f+1],"$"!=g&&(e=g);var g=b[f+f+f+2],h=d+"/"+g,i=a.indexOf(h);if(-1!=i&&i==a.length-h.length){a=a.substring(0,i)+e+"/"+g;break}}return b=a.length,1<c.maxLoadingThreads&&(b>15&&"http://archive."==a.substring(0,15)||b>9&&"http://a."==a.substring(0,9))&&(d=a.lastIndexOf("/"),b-3>d)?(e=a.charCodeAt(d+1),f=a.charCodeAt(d+2),i=3*(b-d)+5*e+7*f,a.substring(0,7)+"aeiouy".split("")[i%6]+a.substring(8)):a},c.getClasspathFor=function(a,b,d){var e=c.classpathMap["#"+a],f=null;if(null!=e){if(!b&&null==d)return c.multipleSites(e);var g=e.lastIndexOf(a.replace(/\./g,"/"));-1!=g?f=e.substring(0,g):(g=a.lastIndexOf("."),-1!=g&&(g=e.lastIndexOf(a.substring(0,g).replace(/\./g,"/")),-1!=g&&(f=e.substring(0,g))))}else for(g=a.lastIndexOf(".");-1!=g&&(e=a.substring(0,g),f=c.classpathMap["@"+e],null==f);)g=a.lastIndexOf(".",g-2);return f=c.assureBase(f),b?c.multipleSites(f):a.lastIndexOf(".*")==a.length-2?(a=f+a.substring(0,g+1).replace(/\./g,"/"),c.multipleSites(a)):(null==d?d=".js":"."!=d.charAt(0)&&(d="."+d),a=f+a.replace(/\./g,"/")+d,c.multipleSites(a))},c.assureBase=function(b){return null==b&&(b=null!=window.Clazz&&null!=a.binaryFolders&&0!=a.binaryFolders.length?a.binaryFolders[0]:null!=c.binaryFolders&&0!=c.binaryFolders.length?c.binaryFolders[0]:"j2s"),b.lastIndexOf("/")!=b.length-1&&(b+="/"),b},c.excludeClassMap={},c.ignore=function(){var a=null;if(1==arguments.length&&arguments[0]instanceof Array&&(a=arguments[0]),null==a)for(var a=[],b=0;b<arguments.length;b++)a[a.length]=arguments[b];for(c.unwrapArray(a),b=0;b<a.length;b++)c.excludeClassMap["@"+a[b]]=!0},c.isClassExcluded=function(a){return 1==c.excludeClassMap["@"+a]},c.scriptLoading=function(){},c.scriptLoaded=function(){},c.scriptInited=function(){},c.scriptCompleted=function(){},c.classUnloaded=function(){},c.classReloaded=function(){},c.globalLoaded=function(){},c.keepOnLoading=!0,c.mapPath2ClassNode={},c.xhrOnload=function(b,d){if(400<=b.status||null==b.responseText||0==b.responseText.length){a.alert("xhronload error"+b.responseText);var e=c.failedScripts;null==e[d]?(e[d]=1,c.loadedScripts[d]=!1,c.loadScript(d,"xhrOnload 2nd try")):(a.alert("[Java2Script] ClazzLoader.xhrOnload Error in loading "+d+"!"),c.tryToLoadNext(d))}else c.evaluate(d,b.responseText)},c.evaluate=function(b,e){try{eval(e)}catch(f){var g="[Java2Script] Script error: "+f.message+" \n"+b+"\n\n"+e;throw alert(g),a.alert(g),f}c.scriptLoaded(b),c.tryToLoadNext(b)},c.emptyOnRSC=function(){},c.failedScripts={},c.failedHandles={},c.takeAnotherTry=!0,c.generateRemovingFunction=function(a){return function(){if("interactive"!=a.readyState){try{null!=a.parentNode&&a.parentNode.removeChild(a)
}catch(b){}a=null}}},c.removeScriptNode=function(a){window["j2s.script.debugging"]||window.setTimeout(c.generateRemovingFunction(a),1)},c.generatingXHROnload=function(a,b){return function(){c.xhrOnload(a,b),b=a=null}},c.generatingXHRCallback=function(a,b){return function(){if(4==a.readyState){0<c.inLoadingThreads&&c.inLoadingThreads--;var d=c.generatingXHROnload(a,b);isActiveX?(a.onreadystatechange=c.emptyOnRSC,window.setTimeout(d,0>c.loadingTimeLag?0:c.loadingTimeLag)):(a.onreadystatechange=null,0<=c.loadingTimeLag?window.setTimeout(d,c.loadingTimeLag):c.xhrOnload(a,b)),b=a=null}}},c.loadingNextByPath=function(a){0<=c.loadingTimeLag?window.setTimeout(function(){c.tryToLoadNext(a)},c.loadingTimeLag):c.tryToLoadNext(a)},c.ieToLoadScriptAgain=function(a,b){return window.setTimeout(function(){c.takeAnotherTry&&(c.failedScripts[a]=0,c.loadedScripts[a]=!1,0<c.inLoadingThreads&&c.inLoadingThreads--,c.loadScript(a,"ietoloadscriptAgain"))},b?500:15e3)},c.w3cFailedLoadingTest=function(a){return window.setTimeout(function(){a.onerror(),a=a.timeoutHandle=null},500)},c.generatingW3CScriptOnCallback=function(b,d){return function(){if(d&&a.__debuggingBH&&a.alert("############ forError="+d+" path="+b+" ####"+(d?"NOT":"")+"LOADED###"),c.isGecko&&null!=this.timeoutHandle&&(window.clearTimeout(this.timeoutHandle),this.timeoutHandle=null),0<c.inLoadingThreads&&c.inLoadingThreads--,this.onerror=this.onload=null,d){var e=c.failedScripts;if(null==e[b]&&c.takeAnotherTry)return e[b]=1,d||(c.innerLoadedScripts[this.src]=!1),c.loadedScripts[b]=!1,c.loadScript(b,"w3c script failed"),void c.removeScriptNode(this);d&&c.scriptLoaded(b)}else c.scriptLoaded(b);c.loadingNextByPath(b),c.removeScriptNode(this)}},c.generatingIEScriptOnCallback=function(b){return function(){var d=c.failedHandles,e=c.failedScripts,f=""+this.readyState,g="loading"==f&&(0==this.src.indexOf("file:")||"file:"==window.location.protocol&&0!=this.src.indexOf("http"));if("loaded"!=f&&"complete"!=f){if(null==e[b])return void(d[b]=c.ieToLoadScriptAgain(b,g));if(1==e[b])return}if(null!=d[b]&&(window.clearTimeout(d[b]),d[b]=null),(g||"loaded"==f)&&!c.innerLoadedScripts[this.src]){if(!g&&(null==e[b]||0==e[b])&&c.takeAnotherTry)return 0<c.inLoadingThreads&&c.inLoadingThreads--,e[b]=1,c.loadedScripts[b]=!1,c.loadScript(b,"local or loaded failed"),void c.removeScriptNode(this);a.alert("[Java2Script] generatingIEScriptOnCallback Error in loading "+b+"!")}0<c.inLoadingThreads&&c.inLoadingThreads--,c.scriptLoaded(b),this.onreadystatechange=null,c.loadingNextByPath(b),c.removeScriptNode(this)}},a.transport=null,c.loadScript=function(b,d,e){if(a.currentPath=b,e=1==e,c.loadedScripts[b]&&!e)c.tryToLoadNext(b);else{c.loadedScripts[b]=!0;for(var f=c.classQueue,g=0;g<f.length;g++)if(f[g]==b){for(var h=g;h<f.length-1;h++)f[g]=f[g+1];f.length--;break}if(System.out.println("loading... "+b+(d?" -- required by "+d:"")),c.isUsingXMLHttpRequest)if(c.scriptLoading(b),c.isAsynchronousLoading){if(!a.transport){if(window.XMLHttpRequest)a.transport=new XMLHttpRequest;else try{a.transport=new ActiveXObject("Msxml2.XMLHTTP")}catch(i){a.transport=new ActiveXObject("Microsoft.XMLHTTP")}if(null==a.transport)return void a.alert("[Java2Script] XMLHttpRequest not supported!")}e=a.transport;try{e.open("GET",b,c.isAsynchronousLoading)}catch(j){alert(j+" "+b)}e.onreadystatechange=c.generatingXHRCallback(e,b),c.inLoadingThreads++;try{e.send(null)}catch(k){a.alert("[Java2Script] Loading file error: "+k.message),c.xhrOnload(e,b)}}else self.Jmol?e=Jmol._getFileData(b):(d=jQuery.ajax({type:"GET",dataType:"text",async:!1,url:b,cached:!0}),e=d.responseText,null==e&&d.state&&(e="alert('error loading file "+b+" state="+d.state()+"')")),c.evaluate(b,e);else d=document.createElement("SCRIPT"),d.type="text/javascript",d.src=c.isChrome&&c.reloadingClasses[b]?b+"?"+Math.floor(1e5*Math.random()):b,f=document.getElementsByTagName("HEAD")[0],e?f.appendChild(d):(d.defer=!0,"undefined"!=typeof d.onreadystatechange&&c.isIE?(c.needOnloadCheck=!0,d.onreadystatechange=c.generatingIEScriptOnCallback(b)):(c.isGecko&&(0==b.indexOf("file:")||"file:"==window.location.protocol&&0!=b.indexOf("http"))&&(d.timeoutHandle=c.w3cFailedLoadingTest(d)),d.onload=c.generatingW3CScriptOnCallback(b,!1),d.onerror=c.generatingW3CScriptOnCallback(b,!0),c.isOpera&&(c.needOnloadCheck=!0)),c.inLoadingThreads++,f.appendChild(d),c.scriptLoading(b))}},c.isResourceExisted=function(a,b,c){if(null!=a&&null!=document.getElementById(a))return!0;if(null!=b){var d=b;if(null!=c&&0==b.indexOf(c)&&(d=b.substring(c.length)),b.lastIndexOf(".css")==b.length-4){var e=document.getElementsByTagName("LINK");for(b=0;b<e.length;b++){var f=e[b].href;if(c=f.lastIndexOf(d),-1!=c&&c==f.length-d.length)return!0}if(1==window["css."+a])return!0}else if(b.lastIndexOf(".js")==b.length-4)for(a=document.getElementsByTagName("SCRIPT"),b=0;b<a.length;b++)if(e=a[b].src,c=e.lastIndexOf(d),-1!=c&&c==e.length-d.length)return!0}return!1},c.queueBe4SWT=[],c.lockQueueBe4SWT=!0,c.isLoadingEntryClass=!0,c.besidesJavaPackage=!1,c.tryToLoadNext=function(a){if(c.lockQueueBe4SWT&&0!=c.pkgRefCount&&a.lastIndexOf("package.js")!=a.length-10&&!c.isOpera){var d=c.queueBe4SWT;d[d.length]=a}else{var e=c.mapPath2ClassNode["@"+a];if(null!=e){var f=c.classpathMap["$"+a];if(null!=f)for(a=0;a<f.length;a++){var g=f[a];if(g!=e.name)if(d=c.findClass(g),null!=d)d.status<b.STATUS_CONTENT_LOADED&&(d.status=b.STATUS_CONTENT_LOADED,c.updateNode(d));else{d=new b,d.name=g;var h=c.classpathMap["#"+g];null==h&&(alert(g),error("Java2Script implementation error! Please report this bug!")),d.path=h,c.mappingPathNameNode(d.path,g,d),d.status=b.STATUS_CONTENT_LOADED,c.addChildClassNode(c.clazzTreeRoot,d,-1),c.updateNode(d)}}if(e instanceof Array)for(a=0;a<e.length;a++)e[a].status<b.STATUS_CONTENT_LOADED&&(e[a].status=b.STATUS_CONTENT_LOADED,c.updateNode(e[a]));else if(e.status<b.STATUS_CONTENT_LOADED){for(d=!1,f=document.getElementsByTagName("SCRIPT"),a=0;a<f.length;a++)if(c.isIE){if(null!=f[a].onreadystatechange&&f[a].onreadystatechange.path==e.path&&"interactive"==f[a].readyState){d=!0;break}}else if(null!=f[a].onload&&f[a].onload.path==e.path){d=!0;break}d||(e.status=b.STATUS_CONTENT_LOADED,c.updateNode(e))}if(c.keepOnLoading){if(e=!1,d=c.findNextMustClass(c.clazzTreeRoot,b.STATUS_KNOWN),null!=d)for(c.loadClassNode(d);c.inLoadingThreads<c.maxLoadingThreads&&(a=c.findNextMustClass(c.clazzTreeRoot,b.STATUS_KNOWN),null!=a);)c.loadClassNode(a);else if(f=c.classQueue,0!=f.length){for(d=f[0],a=0;a<f.length-1;a++)f[a]=f[a+1];f.length--,!c.loadedScripts[d.path]||0!=f.length||!c.isLoadingEntryClass||null!=d.musts&&0!=d.musts.length||null!=d.optionals&&0!=d.optionals.length?(c.addChildClassNode(c.clazzTreeRoot,d,1),c.loadScript(d.path,d.requiredBy)):c.isLoadingEntryClass&&(c.isLoadingEntryClass=!1)}else if(d=c.findNextOptionalClass(b.STATUS_KNOWN),null!=d)for(c.loadClassNode(d);c.inLoadingThreads<c.maxLoadingThreads&&(a=c.findNextOptionalClass(b.STATUS_KNOWN),null!=a);)c.loadClassNode(a);else e=!0;if(e&&0==c.inLoadingThreads){for(;null!=(d=c.findNextMustClass(c.clazzTreeRoot,b.STATUS_CONTENT_LOADED));)c.updateNode(d);for(a=null;null!=(d=c.findNextOptionalClass(b.STATUS_CONTENT_LOADED));)a===d&&(d.status=b.STATUS_OPTIONALS_LOADED),c.updateNode(d),a=d;for(;c.tracks=[],!!c.checkOptionalCycle(c.clazzTreeRoot););for(a=null;null!=(d=c.findNextMustClass(c.clazzTreeRoot,b.STATUS_DECLARED))&&a!==d;)c.updateNode(d),a=d;for(a=null;null!=(d=c.findNextOptionalClass(b.STATUS_DECLARED))&&a!==d;)c.updateNode(d),a=d;for(e=[];null!=(d=c.findNextMustClass(c.clazzTreeRoot,b.STATUS_DECLARED));)e[e.length]=d,d.status=b.STATUS_OPTIONALS_LOADED;for(;null!=(d=c.findNextOptionalClass(b.STATUS_DECLARED));)e[e.length]=d,d.status=b.STATUS_OPTIONALS_LOADED;for(a=0;a<e.length;a++)c.destroyClassNode(e[a]);for(a=0;a<e.length;a++)d=e[a].optionalsLoaded,null!=d&&(e[a].optionalsLoaded=null,d());c.globalLoaded()}}}}},c.tracks=[],c.checkOptionalCycle=function(a){for(var d=c.tracks,e=d.length,f=-1,g=0;g<d.length;g++)if(d[g]===a&&d[g].status>=b.STATUS_DECLARED){f=g;break}if(d[d.length]=a,-1!=f){for(g=f;g<d.length;g++){for(d[g].status=b.STATUS_OPTIONALS_LOADED,c.destroyClassNode(d[g]),a=0;a<d[g].parents.length;a++)c.updateNode(d[g].parents[a]);d[g].parents=[],a=d[g].optionalsLoaded,null!=a&&(d[g].optionalsLoaded=null,a())}return d.length=0,!0}for(g=0;g<a.musts.length;g++)if(a.musts[g].status==b.STATUS_DECLARED&&c.checkOptionalCycle(a.musts[g]))return!0;for(g=0;g<a.optionals.length;g++)if(a.optionals[g].status==b.STATUS_DECLARED&&c.checkOptionalCycle(a.optionals[g]))return!0;return d.length=e,!1},c.updateNode=function(a){if(null==a.name||a.status>=b.STATUS_OPTIONALS_LOADED)c.destroyClassNode(a);else{var d=!1;if(null==a.musts||0==a.musts.length||null==a.declaration)d=!0;else for(var d=!0,e=a.musts.length,f=e-1;f>=0;f--){var g=a.musts[f];if(g.requiredBy=a,g.status<b.STATUS_DECLARED){if(c.isClassDefined(g.name)){var h=[];if(g.status=b.STATUS_OPTIONALS_LOADED,c.destroyClassNode(g),null!=g.declaration&&null!=g.declaration.clazzList){for(var i=g.declaration.clazzList,j=0;j<i.length;j++){var k=c.findClass(i[j]);k.status!=b.STATUS_OPTIONALS_LOADED&&k!==g&&(k.status=g.status,k.declaration=null,c.destroyClassNode(k),null!=k.optionalsLoaded&&(h[h.length]=k))}g.declaration=null}for(null!=g.optionalsLoaded&&(h[h.length]=g),j=0;j<h.length;j++)g=h[j].optionalsLoaded,null!=g&&(h[j].optionalsLoaded=null,g())}else g.status==b.STATUS_CONTENT_LOADED&&c.updateNode(g),g.status<b.STATUS_DECLARED&&(d=!1);a.musts.length!=e&&(f=e=a.musts.length,d=!0)}}if(d){if(a.status<b.STATUS_DECLARED&&(f=a.declaration,null!=f&&(0==f.executed?(f(),f.executed=!0):f()),a.status=b.STATUS_DECLARED,null!=c.definedClasses&&(c.definedClasses[a.name]=!0),c.scriptInited(a.path),null!=a.declaration&&null!=a.declaration.clazzList))for(i=a.declaration.clazzList,j=0;j<i.length;j++)k=c.findClass(i[j]),k.status!=b.STATUS_DECLARED&&k!==a&&(k.status=b.STATUS_DECLARED,null!=c.definedClasses&&(c.definedClasses[k.name]=!0),c.scriptInited(k.path));if(d=b.STATUS_DECLARED,i=!1,(null==a.optionals||0==a.optionals.length)&&(null==a.musts||0==a.musts.length)||a.status>b.STATUS_KNOWN&&null==a.declaration)i=!0;else{for(i=!0,f=0;f<a.musts.length;f++)if(g=a.musts[f],g.status<b.STATUS_OPTIONALS_LOADED){i=!1;break}if(i)for(f=0;f<a.optionals.length;f++)if(g=a.optionals[f],g.status<b.STATUS_OPTIONALS_LOADED){i=!1;break}}if(i){if(d=b.STATUS_OPTIONALS_LOADED,a.status=d,c.scriptCompleted(a.path),g=a.optionalsLoaded,null!=g&&(a.optionalsLoaded=null,g(),!c.keepOnLoading))return!1;if(c.destroyClassNode(a),null!=a.declaration&&null!=a.declaration.clazzList)for(i=a.declaration.clazzList,j=0;j<i.length;j++)if(k=c.findClass(i[j]),k.status!=d&&k!==a){if(k.status=d,k.declaration=null,c.scriptCompleted(k.path),g=k.optionalsLoaded,null!=g&&(k.optionalsLoaded=null,g(),!c.keepOnLoading))return!1;c.destroyClassNode(a)}}c.updateParents(a,d)}}},c.updateParents=function(a,d){if(null!=a.parents&&0!=a.parents.length){for(var e=0;e<a.parents.length;e++){var f=a.parents[e];f.status>=d||c.updateNode(f)}d==b.STATUS_OPTIONALS_LOADED&&(a.parents=[])}},c.findNextMustClass=function(a,d){if(null!=a){if(null!=a.musts&&0!=a.musts.length)for(var e=0;e<a.musts.length;e++){var f=a.musts[e];if(!(f.status!=d||d==b.STATUS_KNOWN&&1==c.loadedScripts[f.path]||d!=b.STATUS_DECLARED&&c.isClassDefined(f.name)))return f;if(f=c.findNextMustClass(f,d),null!=f)return f}if(!(a.status!=d||d==b.STATUS_KNOWN&&1==c.loadedScripts[a.path]||d!=b.STATUS_DECLARED&&c.isClassDefined(a.name)))return a}return null},c.usedRandoms={},c.usedRandoms["r0.13412"]=.13412,c.findNextOptionalClass=function(a){for(var b=0;;){var b=Math.random(),d="r"+b;if(c.usedRandoms[d]!=b){c.usedRandoms[d]=b;break}}return c.clazzTreeRoot.random=b,c.findNodeNextOptionalClass(c.clazzTreeRoot,a)},c.findNodeNextOptionalClass=function(a,d){var e=c.clazzTreeRoot.random;if(null!=a.musts&&0!=a.musts.length){var f=c.searchClassArray(a.musts,e,d);if(!(null==f||d==b.STATUS_KNOWN&&1==c.loadedScripts[f.path]||d!=b.STATUS_DECLARED&&c.isClassDefined(f.name)))return f}return null==a.optionals||0==a.optionals.length||(f=c.searchClassArray(a.optionals,e,d),null==f||d==b.STATUS_KNOWN&&1==c.loadedScripts[f.path]||d!=b.STATUS_DECLARED&&c.isClassDefined(f.name))?a.status!=d||d==b.STATUS_KNOWN&&1==c.loadedScripts[a.path]||d!=b.STATUS_DECLARED&&c.isClassDefined(a.name)?null:a:f},c.searchClassArray=function(a,d,e){for(var f=0;f<a.length;f++){var g=a[f];if(g.status==e&&(e!=b.STATUS_KNOWN||1!=c.loadedScripts[g.path])&&(e==b.STATUS_DECLARED||!c.isClassDefined(g.name))||g.random!=d&&(g.random=d,g=c.findNodeNextOptionalClass(g,e),null!=g))return g}return null},c.innerLoadedScripts={},c.interactiveScript=null,c.needOnloadCheck=!1,c.checkInteractive=function(){if(c.needOnloadCheck){var a=c.interactiveScript;if(null==a||"interactive"!=a.readyState){c.interactiveScript=null;for(var a=document.getElementsByTagName("SCRIPT"),b=0;b<a.length;b++)"interactive"==a[b].readyState&&null!=a[b].onreadystatechange?(c.interactiveScript=a[b],c.innerLoadedScripts[a[b].src]=!0):c.isOpera&&"loaded"==a[b].readyState&&null!=a[b].src&&0!=a[b].src.length&&(c.innerLoadedScripts[a[b].src]=!0)}}},c.load=function(a,d,e,f){if(c.checkInteractive(),d instanceof Array){c.unwrapArray(d);for(var g=0;g<d.length;g++)c.load(a,d[g],e,f,d)}else{"$"==d.charAt(0)&&(d="org.eclipse.s"+d.substring(1));var h=c.mapPath2ClassNode["#"+d];if(null==h){var i=c.findClass(d),h=null!=i?i:new b;h.name=d,g=c.classpathMap["#"+d],null==g&&(g="unknown"),h.path=g,c.mappingPathNameNode(h.path,d,h),h.status=b.STATUS_KNOWN,c.addChildClassNode(c.clazzTreeRoot,h,-1)}if(null!=a&&0!=a.length)for(c.unwrapArray(a),g=0;g<a.length;g++)i=a[g],null==i||0==i.length||c.isClassDefined(i)||c.isClassExcluded(i)||(i=c.findClass(i),null==i&&(i=new b,i.name=a[g],i.status=b.STATUS_KNOWN),i.requiredBy=h,c.addChildClassNode(h,i,1));if(5==arguments.length&&null!=f&&(f.status=h.status,f.clazzList=arguments[4]),h.declaration=f,null!=f&&(h.status=b.STATUS_CONTENT_LOADED),null!=e&&0!=e.length)for(c.unwrapArray(e),g=0;g<e.length;g++)i=e[g],null==i||0==i.length||c.isClassDefined(i)||c.isClassExcluded(i)||(i=c.findClass(i),null==i&&(i=new b,i.name=e[g],i.status=b.STATUS_KNOWN),c.addChildClassNode(h,i,-1))}},null!=window.Clazz&&(a.load=c.load),c.findClass=function(a){for(var b=0;;){var b=Math.random(),d="r"+b;if(c.usedRandoms[d]!=b){c.usedRandoms[d]=b;break}}return c.clazzTreeRoot.random=b,c.findClassUnderNode(a,c.clazzTreeRoot)},c.findClassUnderNode=function(a,b){var d=c.clazzTreeRoot.random;if(b.name==a)return b;for(var e=0;e<b.musts.length;e++){var f=b.musts[e];if(f.name==a||f.random!=d&&(f.random=d,f=c.findClassUnderNode(a,f),null!=f))return f}for(e=0;e<b.optionals.length;e++)if(f=b.optionals[e],f.name==a||f.random!=d&&(f.random=d,f=c.findClassUnderNode(a,f),null!=f))return f;return null},c.mappingPathNameNode=function(a,b,d){var e=c.mapPath2ClassNode,f="@"+a;if(a=e[f],null!=a)if(a instanceof Array){for(var f=!1,g=0;g<a.length;g++)if(a[g].name==b){f=!0;break}f||(a[a.length]=d)}else g=[],g[0]=a,g[1]=d,e[f]=g;else e[f]=d;e["#"+b]=d},c.loadClassNode=function(a){var b=a.name;if(!c.isClassDefined(b)&&!c.isClassExcluded(b)){var d=c.getClasspathFor(b);if(a.path=d,c.mappingPathNameNode(d,b,a),!c.loadedScripts[d])return c.loadScript(d,a.requiredBy),!0}return!1},c.runtimeKeyClass="java.lang.String",c.queueBe4KeyClazz=[],c.getJ2SLibBase=function(){var a=window["j2s.lib"];if(null!=a)return null==a.base&&(a.base="http://archive.java2script.org/"),a.base+("."==a.alias?"":(a.alias?a.alias:a.version?a.version:"1.0.0")+"/");for(var a=document.getElementsByTagName("SCRIPT"),b=0;b<a.length;b++){var d=a[b].src,e=d.indexOf("j2slib.z.js");if(-1!=e)return d.substring(0,e);if(e=d.indexOf("j2slibcore.z.js"),-1!=e)return d.substring(0,e);if(e=c.classpathMap["@java"],null!=e)return e;if(e=d.indexOf("java/lang/ClassLoader.js"),-1!=e)return d.substring(0,e)}return null},c.J2SLibBase=null,c.fastGetJ2SLibBase=function(){return null==c.J2SLibBase&&(c.J2SLibBase=c.getJ2SLibBase()),c.J2SLibBase},c.assurePackageClasspath=function(a){var b=window[a+".registered"];0!=b&&1!=b&&null==c.classpathMap["@"+a]&&(window[a+".registered"]=!1,b=c.fastGetJ2SLibBase(),null==b&&(b="j2s"),c.packageClasspath(a,b,!0))},c.loadClass=function(d,e,f,g){if("boolean"==typeof e)return a.evalType(d);if(c.assurePackageClasspath("java"),c.assurePackageClasspath("core"),(0==d.indexOf("org.eclipse.swt")||0==d.indexOf("$wt"))&&c.assurePackageClasspath("org.eclipse.swt"),0==d.indexOf("junit")&&c.assurePackageClasspath("junit"),c.keepOnLoading=!0,!f&&(0!=c.pkgRefCount&&d.lastIndexOf(".package")!=d.length-8||!c.isClassDefined(c.runtimeKeyClass)&&0!=d.indexOf("java.")))g=c.queueBe4KeyClazz,g[g.length]=[d,e];else if(c.isClassDefined(d)||c.isClassExcluded(d))null!=e&&c.isClassDefined(d)&&(d=c.findClass(d),null==d||d.status>=b.STATUS_OPTIONALS_LOADED)&&(g?window.setTimeout(e,25):e());else{var h=c.getClasspathFor(d),i=c.loadedScripts[h];if(g=c.classQueue,!i)for(f=g.length-1;f>=0;f--)(g[f].path==h||g[f].name==d)&&(i=!0);if(i){if(null!=e&&(i=c.findClass(d),null!=i))if(null==i.optionalsLoaded)i.optionalsLoaded=e;else if(e!=i.optionalsLoaded){var j=i.optionalsLoaded;i.optionalsLoaded=function(){j(),e()}}}else{i=null,null!=a.unloadedClasses[d]&&(i=c.findClass(d)),null==i&&(i=new b),i.name=d,i.path=h,c.mappingPathNameNode(h,d,i),i.optionalsLoaded=e,i.status=b.STATUS_KNOWN;var k=!1;for(f=g.length-1;f>=0;f--)if(g[f].status!=b.STATUS_OPTIONALS_LOADED){k=!0;break}if(h.lastIndexOf("package.js")==h.length-10){for(h=!1,f=g.length-1;f>=0;f--){if(d=g[f].name,d.lastIndexOf("package.js")==d.length-10){g[f+1]=i,h=!0;break}g[f+1]=g[f]}h||(g[0]=i)}else k&&(g[g.length]=i);k||(d=!1,null!=e&&(d=c.isLoadingEntryClass,c.isLoadingEntryClass=!0),c.addChildClassNode(c.clazzTreeRoot,i,1),c.loadScript(i.path),null!=e&&(c.isLoadingEntryClass=d))}}},c.loadJ2SApp=function(b,d,e){if(null!=b){var f=b;"$"==b.charAt(0)&&(f="org.eclipse.s"+b.substring(1));var g=-1;if(-1!=(g=f.indexOf("@"))&&(b=f.substring(g+1),c.setPrimaryFolder(b),f=f.substring(0,g),g=f.lastIndexOf("."),-1!=g&&(g=f.substring(0,g),c.packageClasspath(g,b))),null!=d&&d instanceof Array||(d=[]),null==e){var h=f,i=d;e=function(){a.evalType(h).main(i)}}else e=e(f,d);c.loadClass(f,e)}},c.loadJUnit=function(b,d){c.loadJ2SApp(b,d,function(b){return function(){c.loadClass("junit.textui.TestRunner",function(){junit.textui.TestRunner.run(a.evalType(b))})}})},c.runtimeLoaded=function(){if(0==c.pkgRefCount&&c.isClassDefined(c.runtimeKeyClass)){for(var a=c.queueBe4KeyClazz,b=0;b<a.length;b++)c.loadClass(a[b][0],a[b][1]);c.queueBe4KeyClazz=[]}},c.loadZJar=function(a,b){var d=b,e=b instanceof Array;e&&(d=b[b.length-1]),c.jarClasspath(a,e?b:[b]),b==c.runtimeKeyClass?c.loadClass(d,c.runtimeLoaded,!0):c.loadClass(d,null,!0)},c._nodeMap={},c._allNodes=[],c.addChildClassNode=function(a,b,d){var e=!1,f=null;for(1==d?(f=a.musts,b.requiredBy||(b.requiredBy=a),a.requires||(a.requires=[],a.requiresMap={}),a.requiresMap[b.name]||(a.requiresMap[b.name]=b,a.requires.push[b])):f=a.optionals,c._nodeMap[b.name]||(c._allNodes.push(b),c._nodeMap[b.name]=b),d=0;d<f.length;d++)if(f[d].name==b.name){e=!0;break}for(e||(f[f.length]=b,(0==b.name.indexOf("org.eclipse.swt")||0==b.name.indexOf("$wt"))&&(window["swt.lazy.loading.callback"]=c.swtLazyLoading,c.assurePackageClasspath("org.eclipse.swt")),c.isLoadingEntryClass&&0!=b.name.indexOf("java")&&0!=b.name.indexOf("net.sf.j2s.ajax")&&(c.besidesJavaPackage&&(c.isLoadingEntryClass=!1),c.besidesJavaPackage=!0)),e=!1,d=0;d<b.parents.length;d++)if(b.parents[d].name==a.name){e=!0;break}!e&&null!=a.name&&a!=c.clazzTreeRoot&&a!=b&&(b.parents[b.parents.length]=a)},c.swtLazyLoading=function(){c.lockQueueBe4SWT=!1;for(var a=c.queueBe4SWT,b=0;b<a.length;b++)c.tryToLoadNext(a[b]);c.queueBe4SWT=[]},c.removeFromArray=function(a,b){if(null==b||null==a)return!1;for(var c=0,d=0;d<b.length;d++)b[d]!==a&&(d>c&&(b[c]=b[d]),c++);return b.length=c,!1},c.destroyClassNode=function(a){var b=a.parents;if(null!=b)for(var d=0;d<b.length;d++)c.removeFromArray(a,b[d].musts)||c.removeFromArray(a,b[d].optionals)},c.unloadClassExt=function(a){if(null!=c.definedClasses&&(c.definedClasses[a]=!1),null!=c.classpathMap["#"+a]){var d=c.classpathMap["#"+a];c.classpathMap["#"+a]=null;for(var e=c.classpathMap["$"+d],f=!1,g=0;g<e.length;g++)if(e[g]==a){for(f=g;f<e.length-1;f++)e[f]=e[f+1];e.length--,f=!0;break}f&&(c.classpathMap["$"+d]=e)}d=c.findClass(a),null!=d&&(d.status=b.STATUS_KNOWN,c.loadedScripts[d.path]=!1),d=c.getClasspathFor(a),c.loadedScripts[d]=!1,c.innerLoadedScripts[d]&&(c.innerLoadedScripts[d]=!1),c.classUnloaded(a)},c.assureInnerClass=function(b,c){var e=b.__CLASS_NAME__;if(a.unloadedClasses[e]&&-1==e.indexOf("$")){var f=[],e=e+"$",g;for(g in a.unloadedClasses)null!=a.unloadedClasses[g]&&0==g.indexOf(e)&&(f[f.length]=g);if(0!=f.length&&(f=""+c,g=f.indexOf(e),-1!=g)){var j=f.indexOf('"',g+e.length);-1!=j&&(e=f.substring(g,j),null!=a.unloadedClasses[e]&&(g=f.indexOf("{",j),-1!=g&&(g++,j=f.indexOf("("+e+",",g+3),-1!=j&&(j=f.lastIndexOf("}",j-1),-1!=j&&(f=f.substring(g,j),eval(f),a.unloadedClasses[e]=null)))))}}}}(a,a._Loader,a._Node),a._LoaderProgressMonitor=function(){};var e=a._LoaderProgressMonitor;e.fadeOutTimer=null,e.fadeAlpha=0,e.monitorEl=null,e.lastScrollTop=0,e.bindingParent=null,e.DEFAULT_OPACITY=self.Jmol&&Jmol._j2sLoadMonitorOpacity?Jmol._j2sLoadMonitorOpacity:55,e.clearChildren=function(a){if(null!=a)for(var b=a.childNodes.length-1;b>=0;b--){var c=a.childNodes[b];if(null!=c){null!=c.childNodes&&0!=c.childNodes.length&&this.clearChildren(c);try{a.removeChild(c)}catch(d){}}}},e.setAlpha=function(a){null!=this.fadeOutTimer&&a==this.DEFAULT_OPACITY&&(window.clearTimeout(this.fadeOutTimer),this.fadeOutTimer=null),this.fadeAlpha=a,navigator.userAgent.toLowerCase(),this.monitorEl.style.filter="Alpha(Opacity="+a+")",this.monitorEl.style.opacity=a/100},e.hiddingOnMouseOver=function(){this.style.display="none"},e.attached=!1,e.cleanup=function(){e.monitorEl=null,e.bindingParent=null,e.attached=!1},e.createHandle=function(){var a=document.createElement("DIV");return a.id="clazzloader-status",a.style.cssText="position:absolute;bottom:4px;left:4px;padding:2px 8px;z-index:"+(window["j2s.lib"].monitorZIndex||1e4)+";background-color:#8e0000;color:yellow;font-family:Arial, sans-serif;font-size:10pt;white-space:nowrap;",a.onmouseover=this.hiddingOnMouseOver,this.monitorEl=a,null==this.bindingParent?document.body.appendChild(a):this.bindingParent.appendChild(a),a},e.fadeOut=function(){"none"!=this.monitorEl.style.display&&(this.fadeAlpha==this.DEFAULT_OPACITY?(this.fadeOutTimer=window.setTimeout(function(){e.fadeOut()},750),this.fadeAlpha-=5):0<=this.fadeAlpha-10?(this.setAlpha(this.fadeAlpha-10),this.fadeOutTimer=window.setTimeout(function(){e.fadeOut()},40)):this.monitorEl.style.display="none")},e.getFixedOffsetTop=function(){if(null!=this.bindingParent){var a=this.bindingParent;return a.scrollTop}var b=navigator.userAgent,a=document.body,c=a.parentNode,d=c.clientHeight,a=a.scrollTop+a.offsetTop,e=c.scrollTop+c.offsetTop;return-1==b.indexOf("Opera")&&document.all?0==d?a:e:-1!=b.indexOf("Gecko")?d==c.offsetHeight&&d==c.scrollHeight?a:e:a},e.showStatus=function(a,b){null==this.monitorEl&&(this.createHandle(),this.attached||(this.attached=!0)),this.clearChildren(this.monitorEl),this.monitorEl.appendChild(document.createTextNode(""+a)),"none"==this.monitorEl.style.display&&(this.monitorEl.style.display=""),this.setAlpha(this.DEFAULT_OPACITY);var c=this.getFixedOffsetTop();this.lastScrollTop!=c&&(this.lastScrollTop=c,this.monitorEl.style.bottom=this.lastScrollTop+4+"px"),b&&this.fadeOut()},null!=window.ClazzLoader&&(ClazzLoader.scriptLoading=function(a){e.showStatus("Loading "+a+"...")},ClazzLoader.scriptLoaded=function(a){e.showStatus(a+" loaded.",!0)},ClazzLoader.globalLoaded=function(){e.showStatus("Application loaded.",!0)},ClazzLoader.classUnloaded=function(a){e.showStatus("Class "+a+" is unloaded.",!0)},ClazzLoader.classReloaded=function(a){e.showStatus("Class "+a+" is reloaded.",!0)},m=navigator.userAgent.toLowerCase(),-1!=m.indexOf("msie")&&-1==m.indexOf("opera")&&ClazzLoader.setLoadingMode("script",5));var q=a.Console;q.maxTotalLines=1e4,q.setMaxTotalLines=function(a){q.maxTotalLines=0>=a?999999:a},q.maxLatency=40,q.setMaxLatency=function(a){q.maxLatency=0>=a?40:a},q.pinning=!1,q.enablePinning=function(a){q.pinning=a},q.linesCount=0,q.metLineBreak=!1,q.splitNeedFixed=2!="\n".split(/\n/).length,q.splitIntoLineByR=function(a){for(var b=[],c=0,d=-1;;){if(c=a.indexOf("\r",d+1),-1==c){b[b.length]=a.substring(d+1);break}if(b[b.length]=a.substring(d+1,c),d=c,d+1==a.length){b[b.length]="";break}}return b},q.splitIntoLines=function(a){var b=[];if(null==a)return b;for(var c=0,d=-1;;){var c=a.indexOf("\n",d+1),e=null;-1!=c?(e=c>0&&"\r"==a.charAt(c-1)?a.substring(d+1,c-1):a.substring(d+1,c),d=c):e=a.substring(d+1);for(var e=q.splitIntoLineByR(e),f=0;f<e.length;f++)b[b.length]=e[f];if(-1==c)break;if(d+1==a.length){b[b.length]="";break}}return b},q.createConsoleWindow=function(){var a=document.createElement("DIV");return a.style.cssText="font-family:monospace, Arial, sans-serif;",document.body.appendChild(a),a},q.consoleOutput=function(a,b){var c=window["j2s.lib"];if((c=c&&c.console)&&"string"==typeof c&&(c=document.getElementById(c)),!c)return!1;if(q.linesCount>q.maxTotalLines){for(var d=0;d<q.linesCount-q.maxTotalLines;d++)null!=c&&0<c.childNodes.length&&c.removeChild(c.childNodes[0]);q.linesCount=q.maxTotalLines}var e=!1;a="undefined"==typeof a?"":null==a?"null":""+a,0<a.length&&(d=a.charAt(a.length-1),"\n"==d?(a=1<a.length?"\r"==a.charAt(a.length-2)?a.substring(0,a.length-2):a.substring(0,a.length-1):"",e=!0):"\r"==d&&(a=a.substring(0,a.length-1),e=!0));var f=null;if(a=a.replace(/\t/g,q.c160),q.splitNeedFixed)try{f=q.splitIntoLines(a)}catch(g){window.popup(g.message)}else f=a.split(/\r\n|\r|\n/g);for(d=0;d<f.length;d++){var h=null;if(q.metLineBreak||0==q.linesCount||1>c.childNodes.length)h=document.createElement("DIV"),c.appendChild(h),h.style.whiteSpace="nowrap",q.linesCount++;else try{h=c.childNodes[c.childNodes.length-1]}catch(i){h=document.createElement("DIV"),c.appendChild(h),h.style.whiteSpace="nowrap",q.linesCount++}var j=document.createElement("SPAN");h.appendChild(j),j.style.whiteSpace="nowrap",null!=b&&(j.style.color=b),0==f[d].length&&(f[d]=String.fromCharCode(160)),j.appendChild(document.createTextNode(f[d])),q.pinning||(c.scrollTop+=100),q.metLineBreak=d!=f.length-1?!0:e}e=c.parentNode.className,!q.pinning&&null!=e&&-1!=e.indexOf("composite")&&(c.parentNode.scrollTop=c.parentNode.scrollHeight),q.lastOutputTime=(new Date).getTime()},q.clear=function(){try{q.metLineBreak=!0;var a=window["j2s.lib"],b=a&&a.console;if(b&&(b=document.getElementById(b))){for(var c=b.childNodes,d=c.length-1;d>=0;d--)b.removeChild(c[d]);q.linesCount=0}}catch(e){}},a.alert=function(a){q.consoleOutput(a+"\r\n")},q.c160=String.fromCharCode(160),q.c160+=q.c160+q.c160+q.c160,System.out.print=function(a){q.consoleOutput(a)},System.out.println=function(a){q.consoleOutput("undefined"==typeof a?"\r\n":null==a?"null\r\n":a+"\r\n")},System.err.__CLASS_NAME__="java.io.PrintStream",System.err.print=function(a){q.consoleOutput(a,"red")},System.err.println=function(a){q.consoleOutput("undefined"==typeof a?"\r\n":null==a?"null\r\n":a+"\r\n","red")},a.setConsoleDiv=function(a){window["j2s.lib"]&&(window["j2s.lib"].console=a)},a.binaryFolders=a._Loader.binaryFolders=[a._Loader.getJ2SLibBase()]}(Clazz))},___JmolDate="$Date: 2014-06-13 10:54:48 -0500 (Fri, 13 Jun 2014) $",___fullJmolProperties="src/org/jmol/viewer/Jmol.properties",___JmolVersion="14.2.0_2014.06.13",!function(a,b){"object"==typeof module&&"object"==typeof module.exports?module.exports=a.document?b(a,!0):function(a){if(!a.document)throw new Error("jQuery requires a window with a document");return b(a)}:b(a)}("undefined"!=typeof window?window:this,function(a,b){function c(a){var b=a.length,c=fb.type(a);return"function"===c||fb.isWindow(a)?!1:1===a.nodeType&&b?!0:"array"===c||0===b||"number"==typeof b&&b>0&&b-1 in a}function d(a,b,c){if(fb.isFunction(b))return fb.grep(a,function(a,d){return!!b.call(a,d,a)!==c});if(b.nodeType)return fb.grep(a,function(a){return a===b!==c});if("string"==typeof b){if(nb.test(b))return fb.filter(b,a,c);b=fb.filter(b,a)}return fb.grep(a,function(a){return fb.inArray(a,b)>=0!==c})}function e(a,b){do a=a[b];while(a&&1!==a.nodeType);return a}function f(a){var b=vb[a]={};return fb.each(a.match(ub)||[],function(a,c){b[c]=!0}),b}function g(){pb.addEventListener?(pb.removeEventListener("DOMContentLoaded",h,!1),a.removeEventListener("load",h,!1)):(pb.detachEvent("onreadystatechange",h),a.detachEvent("onload",h))}function h(){(pb.addEventListener||"load"===event.type||"complete"===pb.readyState)&&(g(),fb.ready())}function i(a,b,c){if(void 0===c&&1===a.nodeType){var d="data-"+b.replace(Ab,"-$1").toLowerCase();if(c=a.getAttribute(d),"string"==typeof c){try{c="true"===c?!0:"false"===c?!1:"null"===c?null:+c+""===c?+c:zb.test(c)?fb.parseJSON(c):c}catch(e){}fb.data(a,b,c)}else c=void 0}return c}function j(a){var b;for(b in a)if(("data"!==b||!fb.isEmptyObject(a[b]))&&"toJSON"!==b)return!1;return!0}function k(a,b,c,d){if(fb.acceptData(a)){var e,f,g=fb.expando,h=a.nodeType,i=h?fb.cache:a,j=h?a[g]:a[g]&&g;if(j&&i[j]&&(d||i[j].data)||void 0!==c||"string"!=typeof b)return j||(j=h?a[g]=W.pop()||fb.guid++:g),i[j]||(i[j]=h?{}:{toJSON:fb.noop}),("object"==typeof b||"function"==typeof b)&&(d?i[j]=fb.extend(i[j],b):i[j].data=fb.extend(i[j].data,b)),f=i[j],d||(f.data||(f.data={}),f=f.data),void 0!==c&&(f[fb.camelCase(b)]=c),"string"==typeof b?(e=f[b],null==e&&(e=f[fb.camelCase(b)])):e=f,e}}function l(a,b,c){if(fb.acceptData(a)){var d,e,f=a.nodeType,g=f?fb.cache:a,h=f?a[fb.expando]:fb.expando;if(g[h]){if(b&&(d=c?g[h]:g[h].data)){fb.isArray(b)?b=b.concat(fb.map(b,fb.camelCase)):b in d?b=[b]:(b=fb.camelCase(b),b=b in d?[b]:b.split(" ")),e=b.length;for(;e--;)delete d[b[e]];if(c?!j(d):!fb.isEmptyObject(d))return}(c||(delete g[h].data,j(g[h])))&&(f?fb.cleanData([a],!0):db.deleteExpando||g!=g.window?delete g[h]:g[h]=null)}}}function m(){return!0}function n(){return!1}function o(){try{return pb.activeElement}catch(a){}}function p(a){var b=Lb.split("|"),c=a.createDocumentFragment();if(c.createElement)for(;b.length;)c.createElement(b.pop());return c}function q(a,b){var c,d,e=0,f=typeof a.getElementsByTagName!==yb?a.getElementsByTagName(b||"*"):typeof a.querySelectorAll!==yb?a.querySelectorAll(b||"*"):void 0;if(!f)for(f=[],c=a.childNodes||a;null!=(d=c[e]);e++)!b||fb.nodeName(d,b)?f.push(d):fb.merge(f,q(d,b));return void 0===b||b&&fb.nodeName(a,b)?fb.merge([a],f):f}function r(a){Fb.test(a.type)&&(a.defaultChecked=a.checked)}function s(a,b){return fb.nodeName(a,"table")&&fb.nodeName(11!==b.nodeType?b:b.firstChild,"tr")?a.getElementsByTagName("tbody")[0]||a.appendChild(a.ownerDocument.createElement("tbody")):a}function t(a){return a.type=(null!==fb.find.attr(a,"type"))+"/"+a.type,a}function u(a){var b=Wb.exec(a.type);return b?a.type=b[1]:a.removeAttribute("type"),a}function v(a,b){for(var c,d=0;null!=(c=a[d]);d++)fb._data(c,"globalEval",!b||fb._data(b[d],"globalEval"))}function w(a,b){if(1===b.nodeType&&fb.hasData(a)){var c,d,e,f=fb._data(a),g=fb._data(b,f),h=f.events;if(h){delete g.handle,g.events={};for(c in h)for(d=0,e=h[c].length;e>d;d++)fb.event.add(b,c,h[c][d])}g.data&&(g.data=fb.extend({},g.data))}}function x(a,b){var c,d,e;if(1===b.nodeType){if(c=b.nodeName.toLowerCase(),!db.noCloneEvent&&b[fb.expando]){e=fb._data(b);for(d in e.events)fb.removeEvent(b,d,e.handle);b.removeAttribute(fb.expando)}"script"===c&&b.text!==a.text?(t(b).text=a.text,u(b)):"object"===c?(b.parentNode&&(b.outerHTML=a.outerHTML),db.html5Clone&&a.innerHTML&&!fb.trim(b.innerHTML)&&(b.innerHTML=a.innerHTML)):"input"===c&&Fb.test(a.type)?(b.defaultChecked=b.checked=a.checked,b.value!==a.value&&(b.value=a.value)):"option"===c?b.defaultSelected=b.selected=a.defaultSelected:("input"===c||"textarea"===c)&&(b.defaultValue=a.defaultValue)
}}function y(b,c){var d=fb(c.createElement(b)).appendTo(c.body),e=a.getDefaultComputedStyle?a.getDefaultComputedStyle(d[0]).display:fb.css(d[0],"display");return d.detach(),e}function z(a){var b=pb,c=ac[a];return c||(c=y(a,b),"none"!==c&&c||(_b=(_b||fb("<iframe frameborder='0' width='0' height='0'/>")).appendTo(b.documentElement),b=(_b[0].contentWindow||_b[0].contentDocument).document,b.write(),b.close(),c=y(a,b),_b.detach()),ac[a]=c),c}function A(a,b){return{get:function(){var c=a();return null!=c?c?void delete this.get:(this.get=b).apply(this,arguments):void 0}}}function B(a,b){if(b in a)return b;for(var c=b.charAt(0).toUpperCase()+b.slice(1),d=b,e=nc.length;e--;)if(b=nc[e]+c,b in a)return b;return d}function C(a,b){for(var c,d,e,f=[],g=0,h=a.length;h>g;g++)d=a[g],d.style&&(f[g]=fb._data(d,"olddisplay"),c=d.style.display,b?(f[g]||"none"!==c||(d.style.display=""),""===d.style.display&&Db(d)&&(f[g]=fb._data(d,"olddisplay",z(d.nodeName)))):f[g]||(e=Db(d),(c&&"none"!==c||!e)&&fb._data(d,"olddisplay",e?c:fb.css(d,"display"))));for(g=0;h>g;g++)d=a[g],d.style&&(b&&"none"!==d.style.display&&""!==d.style.display||(d.style.display=b?f[g]||"":"none"));return a}function D(a,b,c){var d=jc.exec(b);return d?Math.max(0,d[1]-(c||0))+(d[2]||"px"):b}function E(a,b,c,d,e){for(var f=c===(d?"border":"content")?4:"width"===b?1:0,g=0;4>f;f+=2)"margin"===c&&(g+=fb.css(a,c+Cb[f],!0,e)),d?("content"===c&&(g-=fb.css(a,"padding"+Cb[f],!0,e)),"margin"!==c&&(g-=fb.css(a,"border"+Cb[f]+"Width",!0,e))):(g+=fb.css(a,"padding"+Cb[f],!0,e),"padding"!==c&&(g+=fb.css(a,"border"+Cb[f]+"Width",!0,e)));return g}function F(a,b,c){var d=!0,e="width"===b?a.offsetWidth:a.offsetHeight,f=bc(a),g=db.boxSizing()&&"border-box"===fb.css(a,"boxSizing",!1,f);if(0>=e||null==e){if(e=cc(a,b,f),(0>e||null==e)&&(e=a.style[b]),ec.test(e))return e;d=g&&(db.boxSizingReliable()||e===a.style[b]),e=parseFloat(e)||0}return e+E(a,b,c||(g?"border":"content"),d,f)+"px"}function G(a,b,c,d,e){return new G.prototype.init(a,b,c,d,e)}function H(){return setTimeout(function(){oc=void 0}),oc=fb.now()}function I(a,b){var c,d={height:a},e=0;for(b=b?1:0;4>e;e+=2-b)c=Cb[e],d["margin"+c]=d["padding"+c]=a;return b&&(d.opacity=d.width=a),d}function J(a,b,c){for(var d,e=(uc[b]||[]).concat(uc["*"]),f=0,g=e.length;g>f;f++)if(d=e[f].call(c,b,a))return d}function K(a,b,c){var d,e,f,g,h,i,j,k,l=this,m={},n=a.style,o=a.nodeType&&Db(a),p=fb._data(a,"fxshow");c.queue||(h=fb._queueHooks(a,"fx"),null==h.unqueued&&(h.unqueued=0,i=h.empty.fire,h.empty.fire=function(){h.unqueued||i()}),h.unqueued++,l.always(function(){l.always(function(){h.unqueued--,fb.queue(a,"fx").length||h.empty.fire()})})),1===a.nodeType&&("height"in b||"width"in b)&&(c.overflow=[n.overflow,n.overflowX,n.overflowY],j=fb.css(a,"display"),k=z(a.nodeName),"none"===j&&(j=k),"inline"===j&&"none"===fb.css(a,"float")&&(db.inlineBlockNeedsLayout&&"inline"!==k?n.zoom=1:n.display="inline-block")),c.overflow&&(n.overflow="hidden",db.shrinkWrapBlocks()||l.always(function(){n.overflow=c.overflow[0],n.overflowX=c.overflow[1],n.overflowY=c.overflow[2]}));for(d in b)if(e=b[d],qc.exec(e)){if(delete b[d],f=f||"toggle"===e,e===(o?"hide":"show")){if("show"!==e||!p||void 0===p[d])continue;o=!0}m[d]=p&&p[d]||fb.style(a,d)}if(!fb.isEmptyObject(m)){p?"hidden"in p&&(o=p.hidden):p=fb._data(a,"fxshow",{}),f&&(p.hidden=!o),o?fb(a).show():l.done(function(){fb(a).hide()}),l.done(function(){var b;fb._removeData(a,"fxshow");for(b in m)fb.style(a,b,m[b])});for(d in m)g=J(o?p[d]:0,d,l),d in p||(p[d]=g.start,o&&(g.end=g.start,g.start="width"===d||"height"===d?1:0))}}function L(a,b){var c,d,e,f,g;for(c in a)if(d=fb.camelCase(c),e=b[d],f=a[c],fb.isArray(f)&&(e=f[1],f=a[c]=f[0]),c!==d&&(a[d]=f,delete a[c]),g=fb.cssHooks[d],g&&"expand"in g){f=g.expand(f),delete a[d];for(c in f)c in a||(a[c]=f[c],b[c]=e)}else b[d]=e}function M(a,b,c){var d,e,f=0,g=tc.length,h=fb.Deferred().always(function(){delete i.elem}),i=function(){if(e)return!1;for(var b=oc||H(),c=Math.max(0,j.startTime+j.duration-b),d=c/j.duration||0,f=1-d,g=0,i=j.tweens.length;i>g;g++)j.tweens[g].run(f);return h.notifyWith(a,[j,f,c]),1>f&&i?c:(h.resolveWith(a,[j]),!1)},j=h.promise({elem:a,props:fb.extend({},b),opts:fb.extend(!0,{specialEasing:{}},c),originalProperties:b,originalOptions:c,startTime:oc||H(),duration:c.duration,tweens:[],createTween:function(b,c){var d=fb.Tween(a,j.opts,b,c,j.opts.specialEasing[b]||j.opts.easing);return j.tweens.push(d),d},stop:function(b){var c=0,d=b?j.tweens.length:0;if(e)return this;for(e=!0;d>c;c++)j.tweens[c].run(1);return b?h.resolveWith(a,[j,b]):h.rejectWith(a,[j,b]),this}}),k=j.props;for(L(k,j.opts.specialEasing);g>f;f++)if(d=tc[f].call(j,a,k,j.opts))return d;return fb.map(k,J,j),fb.isFunction(j.opts.start)&&j.opts.start.call(a,j),fb.fx.timer(fb.extend(i,{elem:a,anim:j,queue:j.opts.queue})),j.progress(j.opts.progress).done(j.opts.done,j.opts.complete).fail(j.opts.fail).always(j.opts.always)}function N(a){return function(b,c){"string"!=typeof b&&(c=b,b="*");var d,e=0,f=b.toLowerCase().match(ub)||[];if(fb.isFunction(c))for(;d=f[e++];)"+"===d.charAt(0)?(d=d.slice(1)||"*",(a[d]=a[d]||[]).unshift(c)):(a[d]=a[d]||[]).push(c)}}function O(a,b,c,d){function e(h){var i;return f[h]=!0,fb.each(a[h]||[],function(a,h){var j=h(b,c,d);return"string"!=typeof j||g||f[j]?g?!(i=j):void 0:(b.dataTypes.unshift(j),e(j),!1)}),i}var f={},g=a===Sc;return e(b.dataTypes[0])||!f["*"]&&e("*")}function P(a,b){var c,d,e=fb.ajaxSettings.flatOptions||{};for(d in b)void 0!==b[d]&&((e[d]?a:c||(c={}))[d]=b[d]);return c&&fb.extend(!0,a,c),a}function Q(a,b,c){for(var d,e,f,g,h=a.contents,i=a.dataTypes;"*"===i[0];)i.shift(),void 0===e&&(e=a.mimeType||b.getResponseHeader("Content-Type"));if(e)for(g in h)if(h[g]&&h[g].test(e)){i.unshift(g);break}if(i[0]in c)f=i[0];else{for(g in c){if(!i[0]||a.converters[g+" "+i[0]]){f=g;break}d||(d=g)}f=f||d}return f?(f!==i[0]&&i.unshift(f),c[f]):void 0}function R(a,b,c,d){var e,f,g,h,i,j={},k=a.dataTypes.slice();if(k[1])for(g in a.converters)j[g.toLowerCase()]=a.converters[g];for(f=k.shift();f;)if(a.responseFields[f]&&(c[a.responseFields[f]]=b),!i&&d&&a.dataFilter&&(b=a.dataFilter(b,a.dataType)),i=f,f=k.shift())if("*"===f)f=i;else if("*"!==i&&i!==f){if(g=j[i+" "+f]||j["* "+f],!g)for(e in j)if(h=e.split(" "),h[1]===f&&(g=j[i+" "+h[0]]||j["* "+h[0]])){g===!0?g=j[e]:j[e]!==!0&&(f=h[0],k.unshift(h[1]));break}if(g!==!0)if(g&&a["throws"])b=g(b);else try{b=g(b)}catch(l){return{state:"parsererror",error:g?l:"No conversion from "+i+" to "+f}}}return{state:"success",data:b}}function S(a,b,c,d){var e;if(fb.isArray(b))fb.each(b,function(b,e){c||Wc.test(a)?d(a,e):S(a+"["+("object"==typeof e?b:"")+"]",e,c,d)});else if(c||"object"!==fb.type(b))d(a,b);else for(e in b)S(a+"["+e+"]",b[e],c,d)}function T(){try{return new a.XMLHttpRequest}catch(b){}}function U(){try{return new a.ActiveXObject("Microsoft.XMLHTTP")}catch(b){}}function V(a){return fb.isWindow(a)?a:9===a.nodeType?a.defaultView||a.parentWindow:!1}var W=[],X=W.slice,Y=W.concat,Z=W.push,$=W.indexOf,_={},ab=_.toString,bb=_.hasOwnProperty,cb="".trim,db={},eb="1.11.0",fb=function(a,b){return new fb.fn.init(a,b)},gb=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,hb=/^-ms-/,ib=/-([\da-z])/gi,jb=function(a,b){return b.toUpperCase()};fb.fn=fb.prototype={jquery:eb,constructor:fb,selector:"",length:0,toArray:function(){return X.call(this)},get:function(a){return null!=a?0>a?this[a+this.length]:this[a]:X.call(this)},pushStack:function(a){var b=fb.merge(this.constructor(),a);return b.prevObject=this,b.context=this.context,b},each:function(a,b){return fb.each(this,a,b)},map:function(a){return this.pushStack(fb.map(this,function(b,c){return a.call(b,c,b)}))},slice:function(){return this.pushStack(X.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(a){var b=this.length,c=+a+(0>a?b:0);return this.pushStack(c>=0&&b>c?[this[c]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:Z,sort:W.sort,splice:W.splice},fb.extend=fb.fn.extend=function(){var a,b,c,d,e,f,g=arguments[0]||{},h=1,i=arguments.length,j=!1;for("boolean"==typeof g&&(j=g,g=arguments[h]||{},h++),"object"==typeof g||fb.isFunction(g)||(g={}),h===i&&(g=this,h--);i>h;h++)if(null!=(e=arguments[h]))for(d in e)a=g[d],c=e[d],g!==c&&(j&&c&&(fb.isPlainObject(c)||(b=fb.isArray(c)))?(b?(b=!1,f=a&&fb.isArray(a)?a:[]):f=a&&fb.isPlainObject(a)?a:{},g[d]=fb.extend(j,f,c)):void 0!==c&&(g[d]=c));return g},fb.extend({expando:"jQuery"+(eb+Math.random()).replace(/\D/g,""),isReady:!0,error:function(a){throw new Error(a)},noop:function(){},isFunction:function(a){return"function"===fb.type(a)},isArray:Array.isArray||function(a){return"array"===fb.type(a)},isWindow:function(a){return null!=a&&a==a.window},isNumeric:function(a){return a-parseFloat(a)>=0},isEmptyObject:function(a){var b;for(b in a)return!1;return!0},isPlainObject:function(a){var b;if(!a||"object"!==fb.type(a)||a.nodeType||fb.isWindow(a))return!1;try{if(a.constructor&&!bb.call(a,"constructor")&&!bb.call(a.constructor.prototype,"isPrototypeOf"))return!1}catch(c){return!1}if(db.ownLast)for(b in a)return bb.call(a,b);for(b in a);return void 0===b||bb.call(a,b)},type:function(a){return null==a?a+"":"object"==typeof a||"function"==typeof a?_[ab.call(a)]||"object":typeof a},globalEval:function(b){b&&fb.trim(b)&&(a.execScript||function(b){a.eval.call(a,b)})(b)},camelCase:function(a){return a.replace(hb,"ms-").replace(ib,jb)},nodeName:function(a,b){return a.nodeName&&a.nodeName.toLowerCase()===b.toLowerCase()},each:function(a,b,d){var e,f=0,g=a.length,h=c(a);if(d){if(h)for(;g>f&&(e=b.apply(a[f],d),e!==!1);f++);else for(f in a)if(e=b.apply(a[f],d),e===!1)break}else if(h)for(;g>f&&(e=b.call(a[f],f,a[f]),e!==!1);f++);else for(f in a)if(e=b.call(a[f],f,a[f]),e===!1)break;return a},trim:cb&&!cb.call("﻿ ")?function(a){return null==a?"":cb.call(a)}:function(a){return null==a?"":(a+"").replace(gb,"")},makeArray:function(a,b){var d=b||[];return null!=a&&(c(Object(a))?fb.merge(d,"string"==typeof a?[a]:a):Z.call(d,a)),d},inArray:function(a,b,c){var d;if(b){if($)return $.call(b,a,c);for(d=b.length,c=c?0>c?Math.max(0,d+c):c:0;d>c;c++)if(c in b&&b[c]===a)return c}return-1},merge:function(a,b){for(var c=+b.length,d=0,e=a.length;c>d;)a[e++]=b[d++];if(c!==c)for(;void 0!==b[d];)a[e++]=b[d++];return a.length=e,a},grep:function(a,b,c){for(var d,e=[],f=0,g=a.length,h=!c;g>f;f++)d=!b(a[f],f),d!==h&&e.push(a[f]);return e},map:function(a,b,d){var e,f=0,g=a.length,h=c(a),i=[];if(h)for(;g>f;f++)e=b(a[f],f,d),null!=e&&i.push(e);else for(f in a)e=b(a[f],f,d),null!=e&&i.push(e);return Y.apply([],i)},guid:1,proxy:function(a,b){var c,d,e;return"string"==typeof b&&(e=a[b],b=a,a=e),fb.isFunction(a)?(c=X.call(arguments,2),d=function(){return a.apply(b||this,c.concat(X.call(arguments)))},d.guid=a.guid=a.guid||fb.guid++,d):void 0},now:function(){return+new Date},support:db}),fb.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(a,b){_["[object "+b+"]"]=b.toLowerCase()});var kb=function(a){function b(a,b,c,d){var e,f,g,h,i,j,l,o,p,q;if((b?b.ownerDocument||b:O)!==G&&F(b),b=b||G,c=c||[],!a||"string"!=typeof a)return c;if(1!==(h=b.nodeType)&&9!==h)return[];if(I&&!d){if(e=sb.exec(a))if(g=e[1]){if(9===h){if(f=b.getElementById(g),!f||!f.parentNode)return c;if(f.id===g)return c.push(f),c}else if(b.ownerDocument&&(f=b.ownerDocument.getElementById(g))&&M(b,f)&&f.id===g)return c.push(f),c}else{if(e[2])return _.apply(c,b.getElementsByTagName(a)),c;if((g=e[3])&&x.getElementsByClassName&&b.getElementsByClassName)return _.apply(c,b.getElementsByClassName(g)),c}if(x.qsa&&(!J||!J.test(a))){if(o=l=N,p=b,q=9===h&&a,1===h&&"object"!==b.nodeName.toLowerCase()){for(j=m(a),(l=b.getAttribute("id"))?o=l.replace(ub,"\\$&"):b.setAttribute("id",o),o="[id='"+o+"'] ",i=j.length;i--;)j[i]=o+n(j[i]);p=tb.test(a)&&k(b.parentNode)||b,q=j.join(",")}if(q)try{return _.apply(c,p.querySelectorAll(q)),c}catch(r){}finally{l||b.removeAttribute("id")}}}return v(a.replace(ib,"$1"),b,c,d)}function c(){function a(c,d){return b.push(c+" ")>y.cacheLength&&delete a[b.shift()],a[c+" "]=d}var b=[];return a}function d(a){return a[N]=!0,a}function e(a){var b=G.createElement("div");try{return!!a(b)}catch(c){return!1}finally{b.parentNode&&b.parentNode.removeChild(b),b=null}}function f(a,b){for(var c=a.split("|"),d=a.length;d--;)y.attrHandle[c[d]]=b}function g(a,b){var c=b&&a,d=c&&1===a.nodeType&&1===b.nodeType&&(~b.sourceIndex||W)-(~a.sourceIndex||W);if(d)return d;if(c)for(;c=c.nextSibling;)if(c===b)return-1;return a?1:-1}function h(a){return function(b){var c=b.nodeName.toLowerCase();return"input"===c&&b.type===a}}function i(a){return function(b){var c=b.nodeName.toLowerCase();return("input"===c||"button"===c)&&b.type===a}}function j(a){return d(function(b){return b=+b,d(function(c,d){for(var e,f=a([],c.length,b),g=f.length;g--;)c[e=f[g]]&&(c[e]=!(d[e]=c[e]))})})}function k(a){return a&&typeof a.getElementsByTagName!==V&&a}function l(){}function m(a,c){var d,e,f,g,h,i,j,k=S[a+" "];if(k)return c?0:k.slice(0);for(h=a,i=[],j=y.preFilter;h;){(!d||(e=jb.exec(h)))&&(e&&(h=h.slice(e[0].length)||h),i.push(f=[])),d=!1,(e=kb.exec(h))&&(d=e.shift(),f.push({value:d,type:e[0].replace(ib," ")}),h=h.slice(d.length));for(g in y.filter)!(e=ob[g].exec(h))||j[g]&&!(e=j[g](e))||(d=e.shift(),f.push({value:d,type:g,matches:e}),h=h.slice(d.length));if(!d)break}return c?h.length:h?b.error(a):S(a,i).slice(0)}function n(a){for(var b=0,c=a.length,d="";c>b;b++)d+=a[b].value;return d}function o(a,b,c){var d=b.dir,e=c&&"parentNode"===d,f=Q++;return b.first?function(b,c,f){for(;b=b[d];)if(1===b.nodeType||e)return a(b,c,f)}:function(b,c,g){var h,i,j=[P,f];if(g){for(;b=b[d];)if((1===b.nodeType||e)&&a(b,c,g))return!0}else for(;b=b[d];)if(1===b.nodeType||e){if(i=b[N]||(b[N]={}),(h=i[d])&&h[0]===P&&h[1]===f)return j[2]=h[2];if(i[d]=j,j[2]=a(b,c,g))return!0}}}function p(a){return a.length>1?function(b,c,d){for(var e=a.length;e--;)if(!a[e](b,c,d))return!1;return!0}:a[0]}function q(a,b,c,d,e){for(var f,g=[],h=0,i=a.length,j=null!=b;i>h;h++)(f=a[h])&&(!c||c(f,d,e))&&(g.push(f),j&&b.push(h));return g}function r(a,b,c,e,f,g){return e&&!e[N]&&(e=r(e)),f&&!f[N]&&(f=r(f,g)),d(function(d,g,h,i){var j,k,l,m=[],n=[],o=g.length,p=d||u(b||"*",h.nodeType?[h]:h,[]),r=!a||!d&&b?p:q(p,m,a,h,i),s=c?f||(d?a:o||e)?[]:g:r;if(c&&c(r,s,h,i),e)for(j=q(s,n),e(j,[],h,i),k=j.length;k--;)(l=j[k])&&(s[n[k]]=!(r[n[k]]=l));if(d){if(f||a){if(f){for(j=[],k=s.length;k--;)(l=s[k])&&j.push(r[k]=l);f(null,s=[],j,i)}for(k=s.length;k--;)(l=s[k])&&(j=f?bb.call(d,l):m[k])>-1&&(d[j]=!(g[j]=l))}}else s=q(s===g?s.splice(o,s.length):s),f?f(null,g,s,i):_.apply(g,s)})}function s(a){for(var b,c,d,e=a.length,f=y.relative[a[0].type],g=f||y.relative[" "],h=f?1:0,i=o(function(a){return a===b},g,!0),j=o(function(a){return bb.call(b,a)>-1},g,!0),k=[function(a,c,d){return!f&&(d||c!==C)||((b=c).nodeType?i(a,c,d):j(a,c,d))}];e>h;h++)if(c=y.relative[a[h].type])k=[o(p(k),c)];else{if(c=y.filter[a[h].type].apply(null,a[h].matches),c[N]){for(d=++h;e>d&&!y.relative[a[d].type];d++);return r(h>1&&p(k),h>1&&n(a.slice(0,h-1).concat({value:" "===a[h-2].type?"*":""})).replace(ib,"$1"),c,d>h&&s(a.slice(h,d)),e>d&&s(a=a.slice(d)),e>d&&n(a))}k.push(c)}return p(k)}function t(a,c){var e=c.length>0,f=a.length>0,g=function(d,g,h,i,j){var k,l,m,n=0,o="0",p=d&&[],r=[],s=C,t=d||f&&y.find.TAG("*",j),u=P+=null==s?1:Math.random()||.1,v=t.length;for(j&&(C=g!==G&&g);o!==v&&null!=(k=t[o]);o++){if(f&&k){for(l=0;m=a[l++];)if(m(k,g,h)){i.push(k);break}j&&(P=u)}e&&((k=!m&&k)&&n--,d&&p.push(k))}if(n+=o,e&&o!==n){for(l=0;m=c[l++];)m(p,r,g,h);if(d){if(n>0)for(;o--;)p[o]||r[o]||(r[o]=Z.call(i));r=q(r)}_.apply(i,r),j&&!d&&r.length>0&&n+c.length>1&&b.uniqueSort(i)}return j&&(P=u,C=s),p};return e?d(g):g}function u(a,c,d){for(var e=0,f=c.length;f>e;e++)b(a,c[e],d);return d}function v(a,b,c,d){var e,f,g,h,i,j=m(a);if(!d&&1===j.length){if(f=j[0]=j[0].slice(0),f.length>2&&"ID"===(g=f[0]).type&&x.getById&&9===b.nodeType&&I&&y.relative[f[1].type]){if(b=(y.find.ID(g.matches[0].replace(vb,wb),b)||[])[0],!b)return c;a=a.slice(f.shift().value.length)}for(e=ob.needsContext.test(a)?0:f.length;e--&&(g=f[e],!y.relative[h=g.type]);)if((i=y.find[h])&&(d=i(g.matches[0].replace(vb,wb),tb.test(f[0].type)&&k(b.parentNode)||b))){if(f.splice(e,1),a=d.length&&n(f),!a)return _.apply(c,d),c;break}}return B(a,j)(d,b,!I,c,tb.test(a)&&k(b.parentNode)||b),c}var w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N="sizzle"+-new Date,O=a.document,P=0,Q=0,R=c(),S=c(),T=c(),U=function(a,b){return a===b&&(E=!0),0},V="undefined",W=1<<31,X={}.hasOwnProperty,Y=[],Z=Y.pop,$=Y.push,_=Y.push,ab=Y.slice,bb=Y.indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(this[b]===a)return b;return-1},cb="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",db="[\\x20\\t\\r\\n\\f]",eb="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",fb=eb.replace("w","w#"),gb="\\["+db+"*("+eb+")"+db+"*(?:([*^$|!~]?=)"+db+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+fb+")|)|)"+db+"*\\]",hb=":("+eb+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+gb.replace(3,8)+")*)|.*)\\)|)",ib=new RegExp("^"+db+"+|((?:^|[^\\\\])(?:\\\\.)*)"+db+"+$","g"),jb=new RegExp("^"+db+"*,"+db+"*"),kb=new RegExp("^"+db+"*([>+~]|"+db+")"+db+"*"),lb=new RegExp("="+db+"*([^\\]'\"]*?)"+db+"*\\]","g"),mb=new RegExp(hb),nb=new RegExp("^"+fb+"$"),ob={ID:new RegExp("^#("+eb+")"),CLASS:new RegExp("^\\.("+eb+")"),TAG:new RegExp("^("+eb.replace("w","w*")+")"),ATTR:new RegExp("^"+gb),PSEUDO:new RegExp("^"+hb),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+db+"*(even|odd|(([+-]|)(\\d*)n|)"+db+"*(?:([+-]|)"+db+"*(\\d+)|))"+db+"*\\)|)","i"),bool:new RegExp("^(?:"+cb+")$","i"),needsContext:new RegExp("^"+db+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+db+"*((?:-\\d)?\\d*)"+db+"*\\)|)(?=[^-]|$)","i")},pb=/^(?:input|select|textarea|button)$/i,qb=/^h\d$/i,rb=/^[^{]+\{\s*\[native \w/,sb=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,tb=/[+~]/,ub=/'|\\/g,vb=new RegExp("\\\\([\\da-f]{1,6}"+db+"?|("+db+")|.)","ig"),wb=function(a,b,c){var d="0x"+b-65536;return d!==d||c?b:0>d?String.fromCharCode(d+65536):String.fromCharCode(d>>10|55296,1023&d|56320)};try{_.apply(Y=ab.call(O.childNodes),O.childNodes),Y[O.childNodes.length].nodeType}catch(xb){_={apply:Y.length?function(a,b){$.apply(a,ab.call(b))}:function(a,b){for(var c=a.length,d=0;a[c++]=b[d++];);a.length=c-1}}}x=b.support={},A=b.isXML=function(a){var b=a&&(a.ownerDocument||a).documentElement;return b?"HTML"!==b.nodeName:!1},F=b.setDocument=function(a){var b,c=a?a.ownerDocument||a:O,d=c.defaultView;return c!==G&&9===c.nodeType&&c.documentElement?(G=c,H=c.documentElement,I=!A(c),d&&d!==d.top&&(d.addEventListener?d.addEventListener("unload",function(){F()},!1):d.attachEvent&&d.attachEvent("onunload",function(){F()})),x.attributes=e(function(a){return a.className="i",!a.getAttribute("className")}),x.getElementsByTagName=e(function(a){return a.appendChild(c.createComment("")),!a.getElementsByTagName("*").length}),x.getElementsByClassName=rb.test(c.getElementsByClassName)&&e(function(a){return a.innerHTML="<div class='a'></div><div class='a i'></div>",a.firstChild.className="i",2===a.getElementsByClassName("i").length}),x.getById=e(function(a){return H.appendChild(a).id=N,!c.getElementsByName||!c.getElementsByName(N).length}),x.getById?(y.find.ID=function(a,b){if(typeof b.getElementById!==V&&I){var c=b.getElementById(a);return c&&c.parentNode?[c]:[]}},y.filter.ID=function(a){var b=a.replace(vb,wb);return function(a){return a.getAttribute("id")===b}}):(delete y.find.ID,y.filter.ID=function(a){var b=a.replace(vb,wb);return function(a){var c=typeof a.getAttributeNode!==V&&a.getAttributeNode("id");return c&&c.value===b}}),y.find.TAG=x.getElementsByTagName?function(a,b){return typeof b.getElementsByTagName!==V?b.getElementsByTagName(a):void 0}:function(a,b){var c,d=[],e=0,f=b.getElementsByTagName(a);if("*"===a){for(;c=f[e++];)1===c.nodeType&&d.push(c);return d}return f},y.find.CLASS=x.getElementsByClassName&&function(a,b){return typeof b.getElementsByClassName!==V&&I?b.getElementsByClassName(a):void 0},K=[],J=[],(x.qsa=rb.test(c.querySelectorAll))&&(e(function(a){a.innerHTML="<select t=''><option selected=''></option></select>",a.querySelectorAll("[t^='']").length&&J.push("[*^$]="+db+"*(?:''|\"\")"),a.querySelectorAll("[selected]").length||J.push("\\["+db+"*(?:value|"+cb+")"),a.querySelectorAll(":checked").length||J.push(":checked")}),e(function(a){var b=c.createElement("input");b.setAttribute("type","hidden"),a.appendChild(b).setAttribute("name","D"),a.querySelectorAll("[name=d]").length&&J.push("name"+db+"*[*^$|!~]?="),a.querySelectorAll(":enabled").length||J.push(":enabled",":disabled"),a.querySelectorAll("*,:x"),J.push(",.*:")})),(x.matchesSelector=rb.test(L=H.webkitMatchesSelector||H.mozMatchesSelector||H.oMatchesSelector||H.msMatchesSelector))&&e(function(a){x.disconnectedMatch=L.call(a,"div"),L.call(a,"[s!='']:x"),K.push("!=",hb)}),J=J.length&&new RegExp(J.join("|")),K=K.length&&new RegExp(K.join("|")),b=rb.test(H.compareDocumentPosition),M=b||rb.test(H.contains)?function(a,b){var c=9===a.nodeType?a.documentElement:a,d=b&&b.parentNode;return a===d||!(!d||1!==d.nodeType||!(c.contains?c.contains(d):a.compareDocumentPosition&&16&a.compareDocumentPosition(d)))}:function(a,b){if(b)for(;b=b.parentNode;)if(b===a)return!0;return!1},U=b?function(a,b){if(a===b)return E=!0,0;var d=!a.compareDocumentPosition-!b.compareDocumentPosition;return d?d:(d=(a.ownerDocument||a)===(b.ownerDocument||b)?a.compareDocumentPosition(b):1,1&d||!x.sortDetached&&b.compareDocumentPosition(a)===d?a===c||a.ownerDocument===O&&M(O,a)?-1:b===c||b.ownerDocument===O&&M(O,b)?1:D?bb.call(D,a)-bb.call(D,b):0:4&d?-1:1)}:function(a,b){if(a===b)return E=!0,0;var d,e=0,f=a.parentNode,h=b.parentNode,i=[a],j=[b];if(!f||!h)return a===c?-1:b===c?1:f?-1:h?1:D?bb.call(D,a)-bb.call(D,b):0;if(f===h)return g(a,b);for(d=a;d=d.parentNode;)i.unshift(d);for(d=b;d=d.parentNode;)j.unshift(d);for(;i[e]===j[e];)e++;return e?g(i[e],j[e]):i[e]===O?-1:j[e]===O?1:0},c):G},b.matches=function(a,c){return b(a,null,null,c)},b.matchesSelector=function(a,c){if((a.ownerDocument||a)!==G&&F(a),c=c.replace(lb,"='$1']"),!(!x.matchesSelector||!I||K&&K.test(c)||J&&J.test(c)))try{var d=L.call(a,c);if(d||x.disconnectedMatch||a.document&&11!==a.document.nodeType)return d}catch(e){}return b(c,G,null,[a]).length>0},b.contains=function(a,b){return(a.ownerDocument||a)!==G&&F(a),M(a,b)},b.attr=function(a,b){(a.ownerDocument||a)!==G&&F(a);var c=y.attrHandle[b.toLowerCase()],d=c&&X.call(y.attrHandle,b.toLowerCase())?c(a,b,!I):void 0;return void 0!==d?d:x.attributes||!I?a.getAttribute(b):(d=a.getAttributeNode(b))&&d.specified?d.value:null},b.error=function(a){throw new Error("Syntax error, unrecognized expression: "+a)},b.uniqueSort=function(a){var b,c=[],d=0,e=0;if(E=!x.detectDuplicates,D=!x.sortStable&&a.slice(0),a.sort(U),E){for(;b=a[e++];)b===a[e]&&(d=c.push(e));for(;d--;)a.splice(c[d],1)}return D=null,a},z=b.getText=function(a){var b,c="",d=0,e=a.nodeType;if(e){if(1===e||9===e||11===e){if("string"==typeof a.textContent)return a.textContent;for(a=a.firstChild;a;a=a.nextSibling)c+=z(a)}else if(3===e||4===e)return a.nodeValue}else for(;b=a[d++];)c+=z(b);return c},y=b.selectors={cacheLength:50,createPseudo:d,match:ob,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(a){return a[1]=a[1].replace(vb,wb),a[3]=(a[4]||a[5]||"").replace(vb,wb),"~="===a[2]&&(a[3]=" "+a[3]+" "),a.slice(0,4)},CHILD:function(a){return a[1]=a[1].toLowerCase(),"nth"===a[1].slice(0,3)?(a[3]||b.error(a[0]),a[4]=+(a[4]?a[5]+(a[6]||1):2*("even"===a[3]||"odd"===a[3])),a[5]=+(a[7]+a[8]||"odd"===a[3])):a[3]&&b.error(a[0]),a},PSEUDO:function(a){var b,c=!a[5]&&a[2];return ob.CHILD.test(a[0])?null:(a[3]&&void 0!==a[4]?a[2]=a[4]:c&&mb.test(c)&&(b=m(c,!0))&&(b=c.indexOf(")",c.length-b)-c.length)&&(a[0]=a[0].slice(0,b),a[2]=c.slice(0,b)),a.slice(0,3))}},filter:{TAG:function(a){var b=a.replace(vb,wb).toLowerCase();return"*"===a?function(){return!0}:function(a){return a.nodeName&&a.nodeName.toLowerCase()===b}},CLASS:function(a){var b=R[a+" "];return b||(b=new RegExp("(^|"+db+")"+a+"("+db+"|$)"))&&R(a,function(a){return b.test("string"==typeof a.className&&a.className||typeof a.getAttribute!==V&&a.getAttribute("class")||"")})},ATTR:function(a,c,d){return function(e){var f=b.attr(e,a);return null==f?"!="===c:c?(f+="","="===c?f===d:"!="===c?f!==d:"^="===c?d&&0===f.indexOf(d):"*="===c?d&&f.indexOf(d)>-1:"$="===c?d&&f.slice(-d.length)===d:"~="===c?(" "+f+" ").indexOf(d)>-1:"|="===c?f===d||f.slice(0,d.length+1)===d+"-":!1):!0}},CHILD:function(a,b,c,d,e){var f="nth"!==a.slice(0,3),g="last"!==a.slice(-4),h="of-type"===b;return 1===d&&0===e?function(a){return!!a.parentNode}:function(b,c,i){var j,k,l,m,n,o,p=f!==g?"nextSibling":"previousSibling",q=b.parentNode,r=h&&b.nodeName.toLowerCase(),s=!i&&!h;if(q){if(f){for(;p;){for(l=b;l=l[p];)if(h?l.nodeName.toLowerCase()===r:1===l.nodeType)return!1;o=p="only"===a&&!o&&"nextSibling"}return!0}if(o=[g?q.firstChild:q.lastChild],g&&s){for(k=q[N]||(q[N]={}),j=k[a]||[],n=j[0]===P&&j[1],m=j[0]===P&&j[2],l=n&&q.childNodes[n];l=++n&&l&&l[p]||(m=n=0)||o.pop();)if(1===l.nodeType&&++m&&l===b){k[a]=[P,n,m];break}}else if(s&&(j=(b[N]||(b[N]={}))[a])&&j[0]===P)m=j[1];else for(;(l=++n&&l&&l[p]||(m=n=0)||o.pop())&&((h?l.nodeName.toLowerCase()!==r:1!==l.nodeType)||!++m||(s&&((l[N]||(l[N]={}))[a]=[P,m]),l!==b)););return m-=e,m===d||m%d===0&&m/d>=0}}},PSEUDO:function(a,c){var e,f=y.pseudos[a]||y.setFilters[a.toLowerCase()]||b.error("unsupported pseudo: "+a);return f[N]?f(c):f.length>1?(e=[a,a,"",c],y.setFilters.hasOwnProperty(a.toLowerCase())?d(function(a,b){for(var d,e=f(a,c),g=e.length;g--;)d=bb.call(a,e[g]),a[d]=!(b[d]=e[g])}):function(a){return f(a,0,e)}):f}},pseudos:{not:d(function(a){var b=[],c=[],e=B(a.replace(ib,"$1"));return e[N]?d(function(a,b,c,d){for(var f,g=e(a,null,d,[]),h=a.length;h--;)(f=g[h])&&(a[h]=!(b[h]=f))}):function(a,d,f){return b[0]=a,e(b,null,f,c),!c.pop()}}),has:d(function(a){return function(c){return b(a,c).length>0}}),contains:d(function(a){return function(b){return(b.textContent||b.innerText||z(b)).indexOf(a)>-1}}),lang:d(function(a){return nb.test(a||"")||b.error("unsupported lang: "+a),a=a.replace(vb,wb).toLowerCase(),function(b){var c;do if(c=I?b.lang:b.getAttribute("xml:lang")||b.getAttribute("lang"))return c=c.toLowerCase(),c===a||0===c.indexOf(a+"-");while((b=b.parentNode)&&1===b.nodeType);return!1}}),target:function(b){var c=a.location&&a.location.hash;return c&&c.slice(1)===b.id},root:function(a){return a===H},focus:function(a){return a===G.activeElement&&(!G.hasFocus||G.hasFocus())&&!!(a.type||a.href||~a.tabIndex)},enabled:function(a){return a.disabled===!1},disabled:function(a){return a.disabled===!0},checked:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&!!a.checked||"option"===b&&!!a.selected},selected:function(a){return a.parentNode&&a.parentNode.selectedIndex,a.selected===!0},empty:function(a){for(a=a.firstChild;a;a=a.nextSibling)if(a.nodeType<6)return!1;return!0},parent:function(a){return!y.pseudos.empty(a)},header:function(a){return qb.test(a.nodeName)},input:function(a){return pb.test(a.nodeName)},button:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&"button"===a.type||"button"===b},text:function(a){var b;return"input"===a.nodeName.toLowerCase()&&"text"===a.type&&(null==(b=a.getAttribute("type"))||"text"===b.toLowerCase())},first:j(function(){return[0]}),last:j(function(a,b){return[b-1]}),eq:j(function(a,b,c){return[0>c?c+b:c]}),even:j(function(a,b){for(var c=0;b>c;c+=2)a.push(c);return a}),odd:j(function(a,b){for(var c=1;b>c;c+=2)a.push(c);return a}),lt:j(function(a,b,c){for(var d=0>c?c+b:c;--d>=0;)a.push(d);return a}),gt:j(function(a,b,c){for(var d=0>c?c+b:c;++d<b;)a.push(d);return a})}},y.pseudos.nth=y.pseudos.eq;for(w in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})y.pseudos[w]=h(w);for(w in{submit:!0,reset:!0})y.pseudos[w]=i(w);return l.prototype=y.filters=y.pseudos,y.setFilters=new l,B=b.compile=function(a,b){var c,d=[],e=[],f=T[a+" "];if(!f){for(b||(b=m(a)),c=b.length;c--;)f=s(b[c]),f[N]?d.push(f):e.push(f);f=T(a,t(e,d))}return f},x.sortStable=N.split("").sort(U).join("")===N,x.detectDuplicates=!!E,F(),x.sortDetached=e(function(a){return 1&a.compareDocumentPosition(G.createElement("div"))}),e(function(a){return a.innerHTML="<a href='#'></a>","#"===a.firstChild.getAttribute("href")})||f("type|href|height|width",function(a,b,c){return c?void 0:a.getAttribute(b,"type"===b.toLowerCase()?1:2)}),x.attributes&&e(function(a){return a.innerHTML="<input/>",a.firstChild.setAttribute("value",""),""===a.firstChild.getAttribute("value")})||f("value",function(a,b,c){return c||"input"!==a.nodeName.toLowerCase()?void 0:a.defaultValue}),e(function(a){return null==a.getAttribute("disabled")})||f(cb,function(a,b,c){var d;return c?void 0:a[b]===!0?b.toLowerCase():(d=a.getAttributeNode(b))&&d.specified?d.value:null}),b}(a);fb.find=kb,fb.expr=kb.selectors,fb.expr[":"]=fb.expr.pseudos,fb.unique=kb.uniqueSort,fb.text=kb.getText,fb.isXMLDoc=kb.isXML,fb.contains=kb.contains;var lb=fb.expr.match.needsContext,mb=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,nb=/^.[^:#\[\.,]*$/;fb.filter=function(a,b,c){var d=b[0];return c&&(a=":not("+a+")"),1===b.length&&1===d.nodeType?fb.find.matchesSelector(d,a)?[d]:[]:fb.find.matches(a,fb.grep(b,function(a){return 1===a.nodeType}))},fb.fn.extend({find:function(a){var b,c=[],d=this,e=d.length;if("string"!=typeof a)return this.pushStack(fb(a).filter(function(){for(b=0;e>b;b++)if(fb.contains(d[b],this))return!0}));for(b=0;e>b;b++)fb.find(a,d[b],c);return c=this.pushStack(e>1?fb.unique(c):c),c.selector=this.selector?this.selector+" "+a:a,c},filter:function(a){return this.pushStack(d(this,a||[],!1))},not:function(a){return this.pushStack(d(this,a||[],!0))},is:function(a){return!!d(this,"string"==typeof a&&lb.test(a)?fb(a):a||[],!1).length}});var ob,pb=a.document,qb=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,rb=fb.fn.init=function(a,b){var c,d;if(!a)return this;if("string"==typeof a){if(c="<"===a.charAt(0)&&">"===a.charAt(a.length-1)&&a.length>=3?[null,a,null]:qb.exec(a),!c||!c[1]&&b)return!b||b.jquery?(b||ob).find(a):this.constructor(b).find(a);if(c[1]){if(b=b instanceof fb?b[0]:b,fb.merge(this,fb.parseHTML(c[1],b&&b.nodeType?b.ownerDocument||b:pb,!0)),mb.test(c[1])&&fb.isPlainObject(b))for(c in b)fb.isFunction(this[c])?this[c](b[c]):this.attr(c,b[c]);return this}if(d=pb.getElementById(c[2]),d&&d.parentNode){if(d.id!==c[2])return ob.find(a);this.length=1,this[0]=d}return this.context=pb,this.selector=a,this}return a.nodeType?(this.context=this[0]=a,this.length=1,this):fb.isFunction(a)?"undefined"!=typeof ob.ready?ob.ready(a):a(fb):(void 0!==a.selector&&(this.selector=a.selector,this.context=a.context),fb.makeArray(a,this))};rb.prototype=fb.fn,ob=fb(pb);var sb=/^(?:parents|prev(?:Until|All))/,tb={children:!0,contents:!0,next:!0,prev:!0};fb.extend({dir:function(a,b,c){for(var d=[],e=a[b];e&&9!==e.nodeType&&(void 0===c||1!==e.nodeType||!fb(e).is(c));)1===e.nodeType&&d.push(e),e=e[b];return d},sibling:function(a,b){for(var c=[];a;a=a.nextSibling)1===a.nodeType&&a!==b&&c.push(a);return c}}),fb.fn.extend({has:function(a){var b,c=fb(a,this),d=c.length;return this.filter(function(){for(b=0;d>b;b++)if(fb.contains(this,c[b]))return!0})},closest:function(a,b){for(var c,d=0,e=this.length,f=[],g=lb.test(a)||"string"!=typeof a?fb(a,b||this.context):0;e>d;d++)for(c=this[d];c&&c!==b;c=c.parentNode)if(c.nodeType<11&&(g?g.index(c)>-1:1===c.nodeType&&fb.find.matchesSelector(c,a))){f.push(c);break}return this.pushStack(f.length>1?fb.unique(f):f)},index:function(a){return a?"string"==typeof a?fb.inArray(this[0],fb(a)):fb.inArray(a.jquery?a[0]:a,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(a,b){return this.pushStack(fb.unique(fb.merge(this.get(),fb(a,b))))
},addBack:function(a){return this.add(null==a?this.prevObject:this.prevObject.filter(a))}}),fb.each({parent:function(a){var b=a.parentNode;return b&&11!==b.nodeType?b:null},parents:function(a){return fb.dir(a,"parentNode")},parentsUntil:function(a,b,c){return fb.dir(a,"parentNode",c)},next:function(a){return e(a,"nextSibling")},prev:function(a){return e(a,"previousSibling")},nextAll:function(a){return fb.dir(a,"nextSibling")},prevAll:function(a){return fb.dir(a,"previousSibling")},nextUntil:function(a,b,c){return fb.dir(a,"nextSibling",c)},prevUntil:function(a,b,c){return fb.dir(a,"previousSibling",c)},siblings:function(a){return fb.sibling((a.parentNode||{}).firstChild,a)},children:function(a){return fb.sibling(a.firstChild)},contents:function(a){return fb.nodeName(a,"iframe")?a.contentDocument||a.contentWindow.document:fb.merge([],a.childNodes)}},function(a,b){fb.fn[a]=function(c,d){var e=fb.map(this,b,c);return"Until"!==a.slice(-5)&&(d=c),d&&"string"==typeof d&&(e=fb.filter(d,e)),this.length>1&&(tb[a]||(e=fb.unique(e)),sb.test(a)&&(e=e.reverse())),this.pushStack(e)}});var ub=/\S+/g,vb={};fb.Callbacks=function(a){a="string"==typeof a?vb[a]||f(a):fb.extend({},a);var b,c,d,e,g,h,i=[],j=!a.once&&[],k=function(f){for(c=a.memory&&f,d=!0,g=h||0,h=0,e=i.length,b=!0;i&&e>g;g++)if(i[g].apply(f[0],f[1])===!1&&a.stopOnFalse){c=!1;break}b=!1,i&&(j?j.length&&k(j.shift()):c?i=[]:l.disable())},l={add:function(){if(i){var d=i.length;!function f(b){fb.each(b,function(b,c){var d=fb.type(c);"function"===d?a.unique&&l.has(c)||i.push(c):c&&c.length&&"string"!==d&&f(c)})}(arguments),b?e=i.length:c&&(h=d,k(c))}return this},remove:function(){return i&&fb.each(arguments,function(a,c){for(var d;(d=fb.inArray(c,i,d))>-1;)i.splice(d,1),b&&(e>=d&&e--,g>=d&&g--)}),this},has:function(a){return a?fb.inArray(a,i)>-1:!(!i||!i.length)},empty:function(){return i=[],e=0,this},disable:function(){return i=j=c=void 0,this},disabled:function(){return!i},lock:function(){return j=void 0,c||l.disable(),this},locked:function(){return!j},fireWith:function(a,c){return!i||d&&!j||(c=c||[],c=[a,c.slice?c.slice():c],b?j.push(c):k(c)),this},fire:function(){return l.fireWith(this,arguments),this},fired:function(){return!!d}};return l},fb.extend({Deferred:function(a){var b=[["resolve","done",fb.Callbacks("once memory"),"resolved"],["reject","fail",fb.Callbacks("once memory"),"rejected"],["notify","progress",fb.Callbacks("memory")]],c="pending",d={state:function(){return c},always:function(){return e.done(arguments).fail(arguments),this},then:function(){var a=arguments;return fb.Deferred(function(c){fb.each(b,function(b,f){var g=fb.isFunction(a[b])&&a[b];e[f[1]](function(){var a=g&&g.apply(this,arguments);a&&fb.isFunction(a.promise)?a.promise().done(c.resolve).fail(c.reject).progress(c.notify):c[f[0]+"With"](this===d?c.promise():this,g?[a]:arguments)})}),a=null}).promise()},promise:function(a){return null!=a?fb.extend(a,d):d}},e={};return d.pipe=d.then,fb.each(b,function(a,f){var g=f[2],h=f[3];d[f[1]]=g.add,h&&g.add(function(){c=h},b[1^a][2].disable,b[2][2].lock),e[f[0]]=function(){return e[f[0]+"With"](this===e?d:this,arguments),this},e[f[0]+"With"]=g.fireWith}),d.promise(e),a&&a.call(e,e),e},when:function(a){var b,c,d,e=0,f=X.call(arguments),g=f.length,h=1!==g||a&&fb.isFunction(a.promise)?g:0,i=1===h?a:fb.Deferred(),j=function(a,c,d){return function(e){c[a]=this,d[a]=arguments.length>1?X.call(arguments):e,d===b?i.notifyWith(c,d):--h||i.resolveWith(c,d)}};if(g>1)for(b=new Array(g),c=new Array(g),d=new Array(g);g>e;e++)f[e]&&fb.isFunction(f[e].promise)?f[e].promise().done(j(e,d,f)).fail(i.reject).progress(j(e,c,b)):--h;return h||i.resolveWith(d,f),i.promise()}});var wb;fb.fn.ready=function(a){return fb.ready.promise().done(a),this},fb.extend({isReady:!1,readyWait:1,holdReady:function(a){a?fb.readyWait++:fb.ready(!0)},ready:function(a){if(a===!0?!--fb.readyWait:!fb.isReady){if(!pb.body)return setTimeout(fb.ready);fb.isReady=!0,a!==!0&&--fb.readyWait>0||(wb.resolveWith(pb,[fb]),fb.fn.trigger&&fb(pb).trigger("ready").off("ready"))}}}),fb.ready.promise=function(b){if(!wb)if(wb=fb.Deferred(),"complete"===pb.readyState)setTimeout(fb.ready);else if(pb.addEventListener)pb.addEventListener("DOMContentLoaded",h,!1),a.addEventListener("load",h,!1);else{pb.attachEvent("onreadystatechange",h),a.attachEvent("onload",h);var c=!1;try{c=null==a.frameElement&&pb.documentElement}catch(d){}c&&c.doScroll&&!function e(){if(!fb.isReady){try{c.doScroll("left")}catch(a){return setTimeout(e,50)}g(),fb.ready()}}()}return wb.promise(b)};var xb,yb="undefined";for(xb in fb(db))break;db.ownLast="0"!==xb,db.inlineBlockNeedsLayout=!1,fb(function(){var a,b,c=pb.getElementsByTagName("body")[0];c&&(a=pb.createElement("div"),a.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px",b=pb.createElement("div"),c.appendChild(a).appendChild(b),typeof b.style.zoom!==yb&&(b.style.cssText="border:0;margin:0;width:1px;padding:1px;display:inline;zoom:1",(db.inlineBlockNeedsLayout=3===b.offsetWidth)&&(c.style.zoom=1)),c.removeChild(a),a=b=null)}),function(){var a=pb.createElement("div");if(null==db.deleteExpando){db.deleteExpando=!0;try{delete a.test}catch(b){db.deleteExpando=!1}}a=null}(),fb.acceptData=function(a){var b=fb.noData[(a.nodeName+" ").toLowerCase()],c=+a.nodeType||1;return 1!==c&&9!==c?!1:!b||b!==!0&&a.getAttribute("classid")===b};var zb=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,Ab=/([A-Z])/g;fb.extend({cache:{},noData:{"applet ":!0,"embed ":!0,"object ":"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"},hasData:function(a){return a=a.nodeType?fb.cache[a[fb.expando]]:a[fb.expando],!!a&&!j(a)},data:function(a,b,c){return k(a,b,c)},removeData:function(a,b){return l(a,b)},_data:function(a,b,c){return k(a,b,c,!0)},_removeData:function(a,b){return l(a,b,!0)}}),fb.fn.extend({data:function(a,b){var c,d,e,f=this[0],g=f&&f.attributes;if(void 0===a){if(this.length&&(e=fb.data(f),1===f.nodeType&&!fb._data(f,"parsedAttrs"))){for(c=g.length;c--;)d=g[c].name,0===d.indexOf("data-")&&(d=fb.camelCase(d.slice(5)),i(f,d,e[d]));fb._data(f,"parsedAttrs",!0)}return e}return"object"==typeof a?this.each(function(){fb.data(this,a)}):arguments.length>1?this.each(function(){fb.data(this,a,b)}):f?i(f,a,fb.data(f,a)):void 0},removeData:function(a){return this.each(function(){fb.removeData(this,a)})}}),fb.extend({queue:function(a,b,c){var d;return a?(b=(b||"fx")+"queue",d=fb._data(a,b),c&&(!d||fb.isArray(c)?d=fb._data(a,b,fb.makeArray(c)):d.push(c)),d||[]):void 0},dequeue:function(a,b){b=b||"fx";var c=fb.queue(a,b),d=c.length,e=c.shift(),f=fb._queueHooks(a,b),g=function(){fb.dequeue(a,b)};"inprogress"===e&&(e=c.shift(),d--),e&&("fx"===b&&c.unshift("inprogress"),delete f.stop,e.call(a,g,f)),!d&&f&&f.empty.fire()},_queueHooks:function(a,b){var c=b+"queueHooks";return fb._data(a,c)||fb._data(a,c,{empty:fb.Callbacks("once memory").add(function(){fb._removeData(a,b+"queue"),fb._removeData(a,c)})})}}),fb.fn.extend({queue:function(a,b){var c=2;return"string"!=typeof a&&(b=a,a="fx",c--),arguments.length<c?fb.queue(this[0],a):void 0===b?this:this.each(function(){var c=fb.queue(this,a,b);fb._queueHooks(this,a),"fx"===a&&"inprogress"!==c[0]&&fb.dequeue(this,a)})},dequeue:function(a){return this.each(function(){fb.dequeue(this,a)})},clearQueue:function(a){return this.queue(a||"fx",[])},promise:function(a,b){var c,d=1,e=fb.Deferred(),f=this,g=this.length,h=function(){--d||e.resolveWith(f,[f])};for("string"!=typeof a&&(b=a,a=void 0),a=a||"fx";g--;)c=fb._data(f[g],a+"queueHooks"),c&&c.empty&&(d++,c.empty.add(h));return h(),e.promise(b)}});var Bb=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,Cb=["Top","Right","Bottom","Left"],Db=function(a,b){return a=b||a,"none"===fb.css(a,"display")||!fb.contains(a.ownerDocument,a)},Eb=fb.access=function(a,b,c,d,e,f,g){var h=0,i=a.length,j=null==c;if("object"===fb.type(c)){e=!0;for(h in c)fb.access(a,b,h,c[h],!0,f,g)}else if(void 0!==d&&(e=!0,fb.isFunction(d)||(g=!0),j&&(g?(b.call(a,d),b=null):(j=b,b=function(a,b,c){return j.call(fb(a),c)})),b))for(;i>h;h++)b(a[h],c,g?d:d.call(a[h],h,b(a[h],c)));return e?a:j?b.call(a):i?b(a[0],c):f},Fb=/^(?:checkbox|radio)$/i;!function(){var a=pb.createDocumentFragment(),b=pb.createElement("div"),c=pb.createElement("input");if(b.setAttribute("className","t"),b.innerHTML="  <link/><table></table><a href='/a'>a</a>",db.leadingWhitespace=3===b.firstChild.nodeType,db.tbody=!b.getElementsByTagName("tbody").length,db.htmlSerialize=!!b.getElementsByTagName("link").length,db.html5Clone="<:nav></:nav>"!==pb.createElement("nav").cloneNode(!0).outerHTML,c.type="checkbox",c.checked=!0,a.appendChild(c),db.appendChecked=c.checked,b.innerHTML="<textarea>x</textarea>",db.noCloneChecked=!!b.cloneNode(!0).lastChild.defaultValue,a.appendChild(b),b.innerHTML="<input type='radio' checked='checked' name='t'/>",db.checkClone=b.cloneNode(!0).cloneNode(!0).lastChild.checked,db.noCloneEvent=!0,b.attachEvent&&(b.attachEvent("onclick",function(){db.noCloneEvent=!1}),b.cloneNode(!0).click()),null==db.deleteExpando){db.deleteExpando=!0;try{delete b.test}catch(d){db.deleteExpando=!1}}a=b=c=null}(),function(){var b,c,d=pb.createElement("div");for(b in{submit:!0,change:!0,focusin:!0})c="on"+b,(db[b+"Bubbles"]=c in a)||(d.setAttribute(c,"t"),db[b+"Bubbles"]=d.attributes[c].expando===!1);d=null}();var Gb=/^(?:input|select|textarea)$/i,Hb=/^key/,Ib=/^(?:mouse|contextmenu)|click/,Jb=/^(?:focusinfocus|focusoutblur)$/,Kb=/^([^.]*)(?:\.(.+)|)$/;fb.event={global:{},add:function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q=fb._data(a);if(q){for(c.handler&&(i=c,c=i.handler,e=i.selector),c.guid||(c.guid=fb.guid++),(g=q.events)||(g=q.events={}),(k=q.handle)||(k=q.handle=function(a){return typeof fb===yb||a&&fb.event.triggered===a.type?void 0:fb.event.dispatch.apply(k.elem,arguments)},k.elem=a),b=(b||"").match(ub)||[""],h=b.length;h--;)f=Kb.exec(b[h])||[],n=p=f[1],o=(f[2]||"").split(".").sort(),n&&(j=fb.event.special[n]||{},n=(e?j.delegateType:j.bindType)||n,j=fb.event.special[n]||{},l=fb.extend({type:n,origType:p,data:d,handler:c,guid:c.guid,selector:e,needsContext:e&&fb.expr.match.needsContext.test(e),namespace:o.join(".")},i),(m=g[n])||(m=g[n]=[],m.delegateCount=0,j.setup&&j.setup.call(a,d,o,k)!==!1||(a.addEventListener?a.addEventListener(n,k,!1):a.attachEvent&&a.attachEvent("on"+n,k))),j.add&&(j.add.call(a,l),l.handler.guid||(l.handler.guid=c.guid)),e?m.splice(m.delegateCount++,0,l):m.push(l),fb.event.global[n]=!0);a=null}},remove:function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q=fb.hasData(a)&&fb._data(a);if(q&&(k=q.events)){for(b=(b||"").match(ub)||[""],j=b.length;j--;)if(h=Kb.exec(b[j])||[],n=p=h[1],o=(h[2]||"").split(".").sort(),n){for(l=fb.event.special[n]||{},n=(d?l.delegateType:l.bindType)||n,m=k[n]||[],h=h[2]&&new RegExp("(^|\\.)"+o.join("\\.(?:.*\\.|)")+"(\\.|$)"),i=f=m.length;f--;)g=m[f],!e&&p!==g.origType||c&&c.guid!==g.guid||h&&!h.test(g.namespace)||d&&d!==g.selector&&("**"!==d||!g.selector)||(m.splice(f,1),g.selector&&m.delegateCount--,l.remove&&l.remove.call(a,g));i&&!m.length&&(l.teardown&&l.teardown.call(a,o,q.handle)!==!1||fb.removeEvent(a,n,q.handle),delete k[n])}else for(n in k)fb.event.remove(a,n+b[j],c,d,!0);fb.isEmptyObject(k)&&(delete q.handle,fb._removeData(a,"events"))}},trigger:function(b,c,d,e){var f,g,h,i,j,k,l,m=[d||pb],n=bb.call(b,"type")?b.type:b,o=bb.call(b,"namespace")?b.namespace.split("."):[];if(h=k=d=d||pb,3!==d.nodeType&&8!==d.nodeType&&!Jb.test(n+fb.event.triggered)&&(n.indexOf(".")>=0&&(o=n.split("."),n=o.shift(),o.sort()),g=n.indexOf(":")<0&&"on"+n,b=b[fb.expando]?b:new fb.Event(n,"object"==typeof b&&b),b.isTrigger=e?2:3,b.namespace=o.join("."),b.namespace_re=b.namespace?new RegExp("(^|\\.)"+o.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,b.result=void 0,b.target||(b.target=d),c=null==c?[b]:fb.makeArray(c,[b]),j=fb.event.special[n]||{},e||!j.trigger||j.trigger.apply(d,c)!==!1)){if(!e&&!j.noBubble&&!fb.isWindow(d)){for(i=j.delegateType||n,Jb.test(i+n)||(h=h.parentNode);h;h=h.parentNode)m.push(h),k=h;k===(d.ownerDocument||pb)&&m.push(k.defaultView||k.parentWindow||a)}for(l=0;(h=m[l++])&&!b.isPropagationStopped();)b.type=l>1?i:j.bindType||n,f=(fb._data(h,"events")||{})[b.type]&&fb._data(h,"handle"),f&&f.apply(h,c),f=g&&h[g],f&&f.apply&&fb.acceptData(h)&&(b.result=f.apply(h,c),b.result===!1&&b.preventDefault());if(b.type=n,!e&&!b.isDefaultPrevented()&&(!j._default||j._default.apply(m.pop(),c)===!1)&&fb.acceptData(d)&&g&&d[n]&&!fb.isWindow(d)){k=d[g],k&&(d[g]=null),fb.event.triggered=n;try{d[n]()}catch(p){}fb.event.triggered=void 0,k&&(d[g]=k)}return b.result}},dispatch:function(a){a=fb.event.fix(a);var b,c,d,e,f,g=[],h=X.call(arguments),i=(fb._data(this,"events")||{})[a.type]||[],j=fb.event.special[a.type]||{};if(h[0]=a,a.delegateTarget=this,!j.preDispatch||j.preDispatch.call(this,a)!==!1){for(g=fb.event.handlers.call(this,a,i),b=0;(e=g[b++])&&!a.isPropagationStopped();)for(a.currentTarget=e.elem,f=0;(d=e.handlers[f++])&&!a.isImmediatePropagationStopped();)(!a.namespace_re||a.namespace_re.test(d.namespace))&&(a.handleObj=d,a.data=d.data,c=((fb.event.special[d.origType]||{}).handle||d.handler).apply(e.elem,h),void 0!==c&&(a.result=c)===!1&&(a.preventDefault(),a.stopPropagation()));return j.postDispatch&&j.postDispatch.call(this,a),a.result}},handlers:function(a,b){var c,d,e,f,g=[],h=b.delegateCount,i=a.target;if(h&&i.nodeType&&(!a.button||"click"!==a.type))for(;i!=this;i=i.parentNode||this)if(1===i.nodeType&&(i.disabled!==!0||"click"!==a.type)){for(e=[],f=0;h>f;f++)d=b[f],c=d.selector+" ",void 0===e[c]&&(e[c]=d.needsContext?fb(c,this).index(i)>=0:fb.find(c,this,null,[i]).length),e[c]&&e.push(d);e.length&&g.push({elem:i,handlers:e})}return h<b.length&&g.push({elem:this,handlers:b.slice(h)}),g},fix:function(a){if(a[fb.expando])return a;var b,c,d,e=a.type,f=a,g=this.fixHooks[e];for(g||(this.fixHooks[e]=g=Ib.test(e)?this.mouseHooks:Hb.test(e)?this.keyHooks:{}),d=g.props?this.props.concat(g.props):this.props,a=new fb.Event(f),b=d.length;b--;)c=d[b],a[c]=f[c];return a.target||(a.target=f.srcElement||pb),3===a.target.nodeType&&(a.target=a.target.parentNode),a.metaKey=!!a.metaKey,g.filter?g.filter(a,f):a},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(a,b){return null==a.which&&(a.which=null!=b.charCode?b.charCode:b.keyCode),a}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(a,b){var c,d,e,f=b.button,g=b.fromElement;return null==a.pageX&&null!=b.clientX&&(d=a.target.ownerDocument||pb,e=d.documentElement,c=d.body,a.pageX=b.clientX+(e&&e.scrollLeft||c&&c.scrollLeft||0)-(e&&e.clientLeft||c&&c.clientLeft||0),a.pageY=b.clientY+(e&&e.scrollTop||c&&c.scrollTop||0)-(e&&e.clientTop||c&&c.clientTop||0)),!a.relatedTarget&&g&&(a.relatedTarget=g===a.target?b.toElement:g),a.which||void 0===f||(a.which=1&f?1:2&f?3:4&f?2:0),a}},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==o()&&this.focus)try{return this.focus(),!1}catch(a){}},delegateType:"focusin"},blur:{trigger:function(){return this===o()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return fb.nodeName(this,"input")&&"checkbox"===this.type&&this.click?(this.click(),!1):void 0},_default:function(a){return fb.nodeName(a.target,"a")}},beforeunload:{postDispatch:function(a){void 0!==a.result&&(a.originalEvent.returnValue=a.result)}}},simulate:function(a,b,c,d){var e=fb.extend(new fb.Event,c,{type:a,isSimulated:!0,originalEvent:{}});d?fb.event.trigger(e,null,b):fb.event.dispatch.call(b,e),e.isDefaultPrevented()&&c.preventDefault()}},fb.removeEvent=pb.removeEventListener?function(a,b,c){a.removeEventListener&&a.removeEventListener(b,c,!1)}:function(a,b,c){var d="on"+b;a.detachEvent&&(typeof a[d]===yb&&(a[d]=null),a.detachEvent(d,c))},fb.Event=function(a,b){return this instanceof fb.Event?(a&&a.type?(this.originalEvent=a,this.type=a.type,this.isDefaultPrevented=a.defaultPrevented||void 0===a.defaultPrevented&&(a.returnValue===!1||a.getPreventDefault&&a.getPreventDefault())?m:n):this.type=a,b&&fb.extend(this,b),this.timeStamp=a&&a.timeStamp||fb.now(),void(this[fb.expando]=!0)):new fb.Event(a,b)},fb.Event.prototype={isDefaultPrevented:n,isPropagationStopped:n,isImmediatePropagationStopped:n,preventDefault:function(){var a=this.originalEvent;this.isDefaultPrevented=m,a&&(a.preventDefault?a.preventDefault():a.returnValue=!1)},stopPropagation:function(){var a=this.originalEvent;this.isPropagationStopped=m,a&&(a.stopPropagation&&a.stopPropagation(),a.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=m,this.stopPropagation()}},fb.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(a,b){fb.event.special[a]={delegateType:b,bindType:b,handle:function(a){var c,d=this,e=a.relatedTarget,f=a.handleObj;return(!e||e!==d&&!fb.contains(d,e))&&(a.type=f.origType,c=f.handler.apply(this,arguments),a.type=b),c}}}),db.submitBubbles||(fb.event.special.submit={setup:function(){return fb.nodeName(this,"form")?!1:void fb.event.add(this,"click._submit keypress._submit",function(a){var b=a.target,c=fb.nodeName(b,"input")||fb.nodeName(b,"button")?b.form:void 0;c&&!fb._data(c,"submitBubbles")&&(fb.event.add(c,"submit._submit",function(a){a._submit_bubble=!0}),fb._data(c,"submitBubbles",!0))})},postDispatch:function(a){a._submit_bubble&&(delete a._submit_bubble,this.parentNode&&!a.isTrigger&&fb.event.simulate("submit",this.parentNode,a,!0))},teardown:function(){return fb.nodeName(this,"form")?!1:void fb.event.remove(this,"._submit")}}),db.changeBubbles||(fb.event.special.change={setup:function(){return Gb.test(this.nodeName)?(("checkbox"===this.type||"radio"===this.type)&&(fb.event.add(this,"propertychange._change",function(a){"checked"===a.originalEvent.propertyName&&(this._just_changed=!0)}),fb.event.add(this,"click._change",function(a){this._just_changed&&!a.isTrigger&&(this._just_changed=!1),fb.event.simulate("change",this,a,!0)})),!1):void fb.event.add(this,"beforeactivate._change",function(a){var b=a.target;Gb.test(b.nodeName)&&!fb._data(b,"changeBubbles")&&(fb.event.add(b,"change._change",function(a){!this.parentNode||a.isSimulated||a.isTrigger||fb.event.simulate("change",this.parentNode,a,!0)}),fb._data(b,"changeBubbles",!0))})},handle:function(a){var b=a.target;return this!==b||a.isSimulated||a.isTrigger||"radio"!==b.type&&"checkbox"!==b.type?a.handleObj.handler.apply(this,arguments):void 0},teardown:function(){return fb.event.remove(this,"._change"),!Gb.test(this.nodeName)}}),db.focusinBubbles||fb.each({focus:"focusin",blur:"focusout"},function(a,b){var c=function(a){fb.event.simulate(b,a.target,fb.event.fix(a),!0)};fb.event.special[b]={setup:function(){var d=this.ownerDocument||this,e=fb._data(d,b);e||d.addEventListener(a,c,!0),fb._data(d,b,(e||0)+1)},teardown:function(){var d=this.ownerDocument||this,e=fb._data(d,b)-1;e?fb._data(d,b,e):(d.removeEventListener(a,c,!0),fb._removeData(d,b))}}}),fb.fn.extend({on:function(a,b,c,d,e){var f,g;if("object"==typeof a){"string"!=typeof b&&(c=c||b,b=void 0);for(f in a)this.on(f,b,c,a[f],e);return this}if(null==c&&null==d?(d=b,c=b=void 0):null==d&&("string"==typeof b?(d=c,c=void 0):(d=c,c=b,b=void 0)),d===!1)d=n;else if(!d)return this;return 1===e&&(g=d,d=function(a){return fb().off(a),g.apply(this,arguments)},d.guid=g.guid||(g.guid=fb.guid++)),this.each(function(){fb.event.add(this,a,d,c,b)})},one:function(a,b,c,d){return this.on(a,b,c,d,1)},off:function(a,b,c){var d,e;if(a&&a.preventDefault&&a.handleObj)return d=a.handleObj,fb(a.delegateTarget).off(d.namespace?d.origType+"."+d.namespace:d.origType,d.selector,d.handler),this;if("object"==typeof a){for(e in a)this.off(e,b,a[e]);return this}return(b===!1||"function"==typeof b)&&(c=b,b=void 0),c===!1&&(c=n),this.each(function(){fb.event.remove(this,a,c,b)})},trigger:function(a,b){return this.each(function(){fb.event.trigger(a,b,this)})},triggerHandler:function(a,b){var c=this[0];return c?fb.event.trigger(a,b,c,!0):void 0}});var Lb="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",Mb=/ jQuery\d+="(?:null|\d+)"/g,Nb=new RegExp("<(?:"+Lb+")[\\s/>]","i"),Ob=/^\s+/,Pb=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,Qb=/<([\w:]+)/,Rb=/<tbody/i,Sb=/<|&#?\w+;/,Tb=/<(?:script|style|link)/i,Ub=/checked\s*(?:[^=]|=\s*.checked.)/i,Vb=/^$|\/(?:java|ecma)script/i,Wb=/^true\/(.*)/,Xb=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,Yb={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:db.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},Zb=p(pb),$b=Zb.appendChild(pb.createElement("div"));Yb.optgroup=Yb.option,Yb.tbody=Yb.tfoot=Yb.colgroup=Yb.caption=Yb.thead,Yb.th=Yb.td,fb.extend({clone:function(a,b,c){var d,e,f,g,h,i=fb.contains(a.ownerDocument,a);if(db.html5Clone||fb.isXMLDoc(a)||!Nb.test("<"+a.nodeName+">")?f=a.cloneNode(!0):($b.innerHTML=a.outerHTML,$b.removeChild(f=$b.firstChild)),!(db.noCloneEvent&&db.noCloneChecked||1!==a.nodeType&&11!==a.nodeType||fb.isXMLDoc(a)))for(d=q(f),h=q(a),g=0;null!=(e=h[g]);++g)d[g]&&x(e,d[g]);if(b)if(c)for(h=h||q(a),d=d||q(f),g=0;null!=(e=h[g]);g++)w(e,d[g]);else w(a,f);return d=q(f,"script"),d.length>0&&v(d,!i&&q(a,"script")),d=h=e=null,f},buildFragment:function(a,b,c,d){for(var e,f,g,h,i,j,k,l=a.length,m=p(b),n=[],o=0;l>o;o++)if(f=a[o],f||0===f)if("object"===fb.type(f))fb.merge(n,f.nodeType?[f]:f);else if(Sb.test(f)){for(h=h||m.appendChild(b.createElement("div")),i=(Qb.exec(f)||["",""])[1].toLowerCase(),k=Yb[i]||Yb._default,h.innerHTML=k[1]+f.replace(Pb,"<$1></$2>")+k[2],e=k[0];e--;)h=h.lastChild;if(!db.leadingWhitespace&&Ob.test(f)&&n.push(b.createTextNode(Ob.exec(f)[0])),!db.tbody)for(f="table"!==i||Rb.test(f)?"<table>"!==k[1]||Rb.test(f)?0:h:h.firstChild,e=f&&f.childNodes.length;e--;)fb.nodeName(j=f.childNodes[e],"tbody")&&!j.childNodes.length&&f.removeChild(j);for(fb.merge(n,h.childNodes),h.textContent="";h.firstChild;)h.removeChild(h.firstChild);h=m.lastChild}else n.push(b.createTextNode(f));for(h&&m.removeChild(h),db.appendChecked||fb.grep(q(n,"input"),r),o=0;f=n[o++];)if((!d||-1===fb.inArray(f,d))&&(g=fb.contains(f.ownerDocument,f),h=q(m.appendChild(f),"script"),g&&v(h),c))for(e=0;f=h[e++];)Vb.test(f.type||"")&&c.push(f);return h=null,m},cleanData:function(a,b){for(var c,d,e,f,g=0,h=fb.expando,i=fb.cache,j=db.deleteExpando,k=fb.event.special;null!=(c=a[g]);g++)if((b||fb.acceptData(c))&&(e=c[h],f=e&&i[e])){if(f.events)for(d in f.events)k[d]?fb.event.remove(c,d):fb.removeEvent(c,d,f.handle);i[e]&&(delete i[e],j?delete c[h]:typeof c.removeAttribute!==yb?c.removeAttribute(h):c[h]=null,W.push(e))}}}),fb.fn.extend({text:function(a){return Eb(this,function(a){return void 0===a?fb.text(this):this.empty().append((this[0]&&this[0].ownerDocument||pb).createTextNode(a))},null,a,arguments.length)},append:function(){return this.domManip(arguments,function(a){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var b=s(this,a);b.appendChild(a)}})},prepend:function(){return this.domManip(arguments,function(a){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var b=s(this,a);b.insertBefore(a,b.firstChild)}})},before:function(){return this.domManip(arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this)})},after:function(){return this.domManip(arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this.nextSibling)})},remove:function(a,b){for(var c,d=a?fb.filter(a,this):this,e=0;null!=(c=d[e]);e++)b||1!==c.nodeType||fb.cleanData(q(c)),c.parentNode&&(b&&fb.contains(c.ownerDocument,c)&&v(q(c,"script")),c.parentNode.removeChild(c));return this},empty:function(){for(var a,b=0;null!=(a=this[b]);b++){for(1===a.nodeType&&fb.cleanData(q(a,!1));a.firstChild;)a.removeChild(a.firstChild);a.options&&fb.nodeName(a,"select")&&(a.options.length=0)}return this},clone:function(a,b){return a=null==a?!1:a,b=null==b?a:b,this.map(function(){return fb.clone(this,a,b)})},html:function(a){return Eb(this,function(a){var b=this[0]||{},c=0,d=this.length;if(void 0===a)return 1===b.nodeType?b.innerHTML.replace(Mb,""):void 0;if(!("string"!=typeof a||Tb.test(a)||!db.htmlSerialize&&Nb.test(a)||!db.leadingWhitespace&&Ob.test(a)||Yb[(Qb.exec(a)||["",""])[1].toLowerCase()])){a=a.replace(Pb,"<$1></$2>");try{for(;d>c;c++)b=this[c]||{},1===b.nodeType&&(fb.cleanData(q(b,!1)),b.innerHTML=a);b=0}catch(e){}}b&&this.empty().append(a)},null,a,arguments.length)},replaceWith:function(){var a=arguments[0];return this.domManip(arguments,function(b){a=this.parentNode,fb.cleanData(q(this)),a&&a.replaceChild(b,this)}),a&&(a.length||a.nodeType)?this:this.remove()},detach:function(a){return this.remove(a,!0)},domManip:function(a,b){a=Y.apply([],a);var c,d,e,f,g,h,i=0,j=this.length,k=this,l=j-1,m=a[0],n=fb.isFunction(m);if(n||j>1&&"string"==typeof m&&!db.checkClone&&Ub.test(m))return this.each(function(c){var d=k.eq(c);n&&(a[0]=m.call(this,c,d.html())),d.domManip(a,b)});if(j&&(h=fb.buildFragment(a,this[0].ownerDocument,!1,this),c=h.firstChild,1===h.childNodes.length&&(h=c),c)){for(f=fb.map(q(h,"script"),t),e=f.length;j>i;i++)d=h,i!==l&&(d=fb.clone(d,!0,!0),e&&fb.merge(f,q(d,"script"))),b.call(this[i],d,i);if(e)for(g=f[f.length-1].ownerDocument,fb.map(f,u),i=0;e>i;i++)d=f[i],Vb.test(d.type||"")&&!fb._data(d,"globalEval")&&fb.contains(g,d)&&(d.src?fb._evalUrl&&fb._evalUrl(d.src):fb.globalEval((d.text||d.textContent||d.innerHTML||"").replace(Xb,"")));h=c=null}return this}}),fb.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(a,b){fb.fn[a]=function(a){for(var c,d=0,e=[],f=fb(a),g=f.length-1;g>=d;d++)c=d===g?this:this.clone(!0),fb(f[d])[b](c),Z.apply(e,c.get());return this.pushStack(e)}});var _b,ac={};!function(){var a,b,c=pb.createElement("div"),d="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;padding:0;margin:0;border:0";c.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",a=c.getElementsByTagName("a")[0],a.style.cssText="float:left;opacity:.5",db.opacity=/^0.5/.test(a.style.opacity),db.cssFloat=!!a.style.cssFloat,c.style.backgroundClip="content-box",c.cloneNode(!0).style.backgroundClip="",db.clearCloneStyle="content-box"===c.style.backgroundClip,a=c=null,db.shrinkWrapBlocks=function(){var a,c,e,f;if(null==b){if(a=pb.getElementsByTagName("body")[0],!a)return;f="border:0;width:0;height:0;position:absolute;top:0;left:-9999px",c=pb.createElement("div"),e=pb.createElement("div"),a.appendChild(c).appendChild(e),b=!1,typeof e.style.zoom!==yb&&(e.style.cssText=d+";width:1px;padding:1px;zoom:1",e.innerHTML="<div></div>",e.firstChild.style.width="5px",b=3!==e.offsetWidth),a.removeChild(c),a=c=e=null}return b}}();var bc,cc,dc=/^margin/,ec=new RegExp("^("+Bb+")(?!px)[a-z%]+$","i"),fc=/^(top|right|bottom|left)$/;a.getComputedStyle?(bc=function(a){return a.ownerDocument.defaultView.getComputedStyle(a,null)},cc=function(a,b,c){var d,e,f,g,h=a.style;return c=c||bc(a),g=c?c.getPropertyValue(b)||c[b]:void 0,c&&(""!==g||fb.contains(a.ownerDocument,a)||(g=fb.style(a,b)),ec.test(g)&&dc.test(b)&&(d=h.width,e=h.minWidth,f=h.maxWidth,h.minWidth=h.maxWidth=h.width=g,g=c.width,h.width=d,h.minWidth=e,h.maxWidth=f)),void 0===g?g:g+""}):pb.documentElement.currentStyle&&(bc=function(a){return a.currentStyle},cc=function(a,b,c){var d,e,f,g,h=a.style;return c=c||bc(a),g=c?c[b]:void 0,null==g&&h&&h[b]&&(g=h[b]),ec.test(g)&&!fc.test(b)&&(d=h.left,e=a.runtimeStyle,f=e&&e.left,f&&(e.left=a.currentStyle.left),h.left="fontSize"===b?"1em":g,g=h.pixelLeft+"px",h.left=d,f&&(e.left=f)),void 0===g?g:g+""||"auto"}),!function(){function b(){var b,c,d=pb.getElementsByTagName("body")[0];d&&(b=pb.createElement("div"),c=pb.createElement("div"),b.style.cssText=j,d.appendChild(b).appendChild(c),c.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;position:absolute;display:block;padding:1px;border:1px;width:4px;margin-top:1%;top:1%",fb.swap(d,null!=d.style.zoom?{zoom:1}:{},function(){e=4===c.offsetWidth}),f=!0,g=!1,h=!0,a.getComputedStyle&&(g="1%"!==(a.getComputedStyle(c,null)||{}).top,f="4px"===(a.getComputedStyle(c,null)||{width:"4px"}).width),d.removeChild(b),c=d=null)}var c,d,e,f,g,h,i=pb.createElement("div"),j="border:0;width:0;height:0;position:absolute;top:0;left:-9999px",k="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;padding:0;margin:0;border:0";i.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",c=i.getElementsByTagName("a")[0],c.style.cssText="float:left;opacity:.5",db.opacity=/^0.5/.test(c.style.opacity),db.cssFloat=!!c.style.cssFloat,i.style.backgroundClip="content-box",i.cloneNode(!0).style.backgroundClip="",db.clearCloneStyle="content-box"===i.style.backgroundClip,c=i=null,fb.extend(db,{reliableHiddenOffsets:function(){if(null!=d)return d;var a,b,c,e=pb.createElement("div"),f=pb.getElementsByTagName("body")[0];return f?(e.setAttribute("className","t"),e.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",a=pb.createElement("div"),a.style.cssText=j,f.appendChild(a).appendChild(e),e.innerHTML="<table><tr><td></td><td>t</td></tr></table>",b=e.getElementsByTagName("td"),b[0].style.cssText="padding:0;margin:0;border:0;display:none",c=0===b[0].offsetHeight,b[0].style.display="",b[1].style.display="none",d=c&&0===b[0].offsetHeight,f.removeChild(a),e=f=null,d):void 0},boxSizing:function(){return null==e&&b(),e},boxSizingReliable:function(){return null==f&&b(),f},pixelPosition:function(){return null==g&&b(),g},reliableMarginRight:function(){var b,c,d,e;if(null==h&&a.getComputedStyle){if(b=pb.getElementsByTagName("body")[0],!b)return;c=pb.createElement("div"),d=pb.createElement("div"),c.style.cssText=j,b.appendChild(c).appendChild(d),e=d.appendChild(pb.createElement("div")),e.style.cssText=d.style.cssText=k,e.style.marginRight=e.style.width="0",d.style.width="1px",h=!parseFloat((a.getComputedStyle(e,null)||{}).marginRight),b.removeChild(c)}return h}})}(),fb.swap=function(a,b,c,d){var e,f,g={};for(f in b)g[f]=a.style[f],a.style[f]=b[f];e=c.apply(a,d||[]);for(f in b)a.style[f]=g[f];return e};var gc=/alpha\([^)]*\)/i,hc=/opacity\s*=\s*([^)]*)/,ic=/^(none|table(?!-c[ea]).+)/,jc=new RegExp("^("+Bb+")(.*)$","i"),kc=new RegExp("^([+-])=("+Bb+")","i"),lc={position:"absolute",visibility:"hidden",display:"block"},mc={letterSpacing:0,fontWeight:400},nc=["Webkit","O","Moz","ms"];fb.extend({cssHooks:{opacity:{get:function(a,b){if(b){var c=cc(a,"opacity");return""===c?"1":c}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":db.cssFloat?"cssFloat":"styleFloat"},style:function(a,b,c,d){if(a&&3!==a.nodeType&&8!==a.nodeType&&a.style){var e,f,g,h=fb.camelCase(b),i=a.style;if(b=fb.cssProps[h]||(fb.cssProps[h]=B(i,h)),g=fb.cssHooks[b]||fb.cssHooks[h],void 0===c)return g&&"get"in g&&void 0!==(e=g.get(a,!1,d))?e:i[b];if(f=typeof c,"string"===f&&(e=kc.exec(c))&&(c=(e[1]+1)*e[2]+parseFloat(fb.css(a,b)),f="number"),null!=c&&c===c&&("number"!==f||fb.cssNumber[h]||(c+="px"),db.clearCloneStyle||""!==c||0!==b.indexOf("background")||(i[b]="inherit"),!(g&&"set"in g&&void 0===(c=g.set(a,c,d)))))try{i[b]="",i[b]=c}catch(j){}}},css:function(a,b,c,d){var e,f,g,h=fb.camelCase(b);return b=fb.cssProps[h]||(fb.cssProps[h]=B(a.style,h)),g=fb.cssHooks[b]||fb.cssHooks[h],g&&"get"in g&&(f=g.get(a,!0,c)),void 0===f&&(f=cc(a,b,d)),"normal"===f&&b in mc&&(f=mc[b]),""===c||c?(e=parseFloat(f),c===!0||fb.isNumeric(e)?e||0:f):f
}}),fb.each(["height","width"],function(a,b){fb.cssHooks[b]={get:function(a,c,d){return c?0===a.offsetWidth&&ic.test(fb.css(a,"display"))?fb.swap(a,lc,function(){return F(a,b,d)}):F(a,b,d):void 0},set:function(a,c,d){var e=d&&bc(a);return D(a,c,d?E(a,b,d,db.boxSizing()&&"border-box"===fb.css(a,"boxSizing",!1,e),e):0)}}}),db.opacity||(fb.cssHooks.opacity={get:function(a,b){return hc.test((b&&a.currentStyle?a.currentStyle.filter:a.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":b?"1":""},set:function(a,b){var c=a.style,d=a.currentStyle,e=fb.isNumeric(b)?"alpha(opacity="+100*b+")":"",f=d&&d.filter||c.filter||"";c.zoom=1,(b>=1||""===b)&&""===fb.trim(f.replace(gc,""))&&c.removeAttribute&&(c.removeAttribute("filter"),""===b||d&&!d.filter)||(c.filter=gc.test(f)?f.replace(gc,e):f+" "+e)}}),fb.cssHooks.marginRight=A(db.reliableMarginRight,function(a,b){return b?fb.swap(a,{display:"inline-block"},cc,[a,"marginRight"]):void 0}),fb.each({margin:"",padding:"",border:"Width"},function(a,b){fb.cssHooks[a+b]={expand:function(c){for(var d=0,e={},f="string"==typeof c?c.split(" "):[c];4>d;d++)e[a+Cb[d]+b]=f[d]||f[d-2]||f[0];return e}},dc.test(a)||(fb.cssHooks[a+b].set=D)}),fb.fn.extend({css:function(a,b){return Eb(this,function(a,b,c){var d,e,f={},g=0;if(fb.isArray(b)){for(d=bc(a),e=b.length;e>g;g++)f[b[g]]=fb.css(a,b[g],!1,d);return f}return void 0!==c?fb.style(a,b,c):fb.css(a,b)},a,b,arguments.length>1)},show:function(){return C(this,!0)},hide:function(){return C(this)},toggle:function(a){return"boolean"==typeof a?a?this.show():this.hide():this.each(function(){Db(this)?fb(this).show():fb(this).hide()})}}),fb.Tween=G,G.prototype={constructor:G,init:function(a,b,c,d,e,f){this.elem=a,this.prop=c,this.easing=e||"swing",this.options=b,this.start=this.now=this.cur(),this.end=d,this.unit=f||(fb.cssNumber[c]?"":"px")},cur:function(){var a=G.propHooks[this.prop];return a&&a.get?a.get(this):G.propHooks._default.get(this)},run:function(a){var b,c=G.propHooks[this.prop];return this.pos=b=this.options.duration?fb.easing[this.easing](a,this.options.duration*a,0,1,this.options.duration):a,this.now=(this.end-this.start)*b+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),c&&c.set?c.set(this):G.propHooks._default.set(this),this}},G.prototype.init.prototype=G.prototype,G.propHooks={_default:{get:function(a){var b;return null==a.elem[a.prop]||a.elem.style&&null!=a.elem.style[a.prop]?(b=fb.css(a.elem,a.prop,""),b&&"auto"!==b?b:0):a.elem[a.prop]},set:function(a){fb.fx.step[a.prop]?fb.fx.step[a.prop](a):a.elem.style&&(null!=a.elem.style[fb.cssProps[a.prop]]||fb.cssHooks[a.prop])?fb.style(a.elem,a.prop,a.now+a.unit):a.elem[a.prop]=a.now}}},G.propHooks.scrollTop=G.propHooks.scrollLeft={set:function(a){a.elem.nodeType&&a.elem.parentNode&&(a.elem[a.prop]=a.now)}},fb.easing={linear:function(a){return a},swing:function(a){return.5-Math.cos(a*Math.PI)/2}},fb.fx=G.prototype.init,fb.fx.step={};var oc,pc,qc=/^(?:toggle|show|hide)$/,rc=new RegExp("^(?:([+-])=|)("+Bb+")([a-z%]*)$","i"),sc=/queueHooks$/,tc=[K],uc={"*":[function(a,b){var c=this.createTween(a,b),d=c.cur(),e=rc.exec(b),f=e&&e[3]||(fb.cssNumber[a]?"":"px"),g=(fb.cssNumber[a]||"px"!==f&&+d)&&rc.exec(fb.css(c.elem,a)),h=1,i=20;if(g&&g[3]!==f){f=f||g[3],e=e||[],g=+d||1;do h=h||".5",g/=h,fb.style(c.elem,a,g+f);while(h!==(h=c.cur()/d)&&1!==h&&--i)}return e&&(g=c.start=+g||+d||0,c.unit=f,c.end=e[1]?g+(e[1]+1)*e[2]:+e[2]),c}]};fb.Animation=fb.extend(M,{tweener:function(a,b){fb.isFunction(a)?(b=a,a=["*"]):a=a.split(" ");for(var c,d=0,e=a.length;e>d;d++)c=a[d],uc[c]=uc[c]||[],uc[c].unshift(b)},prefilter:function(a,b){b?tc.unshift(a):tc.push(a)}}),fb.speed=function(a,b,c){var d=a&&"object"==typeof a?fb.extend({},a):{complete:c||!c&&b||fb.isFunction(a)&&a,duration:a,easing:c&&b||b&&!fb.isFunction(b)&&b};return d.duration=fb.fx.off?0:"number"==typeof d.duration?d.duration:d.duration in fb.fx.speeds?fb.fx.speeds[d.duration]:fb.fx.speeds._default,(null==d.queue||d.queue===!0)&&(d.queue="fx"),d.old=d.complete,d.complete=function(){fb.isFunction(d.old)&&d.old.call(this),d.queue&&fb.dequeue(this,d.queue)},d},fb.fn.extend({fadeTo:function(a,b,c,d){return this.filter(Db).css("opacity",0).show().end().animate({opacity:b},a,c,d)},animate:function(a,b,c,d){var e=fb.isEmptyObject(a),f=fb.speed(b,c,d),g=function(){var b=M(this,fb.extend({},a),f);(e||fb._data(this,"finish"))&&b.stop(!0)};return g.finish=g,e||f.queue===!1?this.each(g):this.queue(f.queue,g)},stop:function(a,b,c){var d=function(a){var b=a.stop;delete a.stop,b(c)};return"string"!=typeof a&&(c=b,b=a,a=void 0),b&&a!==!1&&this.queue(a||"fx",[]),this.each(function(){var b=!0,e=null!=a&&a+"queueHooks",f=fb.timers,g=fb._data(this);if(e)g[e]&&g[e].stop&&d(g[e]);else for(e in g)g[e]&&g[e].stop&&sc.test(e)&&d(g[e]);for(e=f.length;e--;)f[e].elem!==this||null!=a&&f[e].queue!==a||(f[e].anim.stop(c),b=!1,f.splice(e,1));(b||!c)&&fb.dequeue(this,a)})},finish:function(a){return a!==!1&&(a=a||"fx"),this.each(function(){var b,c=fb._data(this),d=c[a+"queue"],e=c[a+"queueHooks"],f=fb.timers,g=d?d.length:0;for(c.finish=!0,fb.queue(this,a,[]),e&&e.stop&&e.stop.call(this,!0),b=f.length;b--;)f[b].elem===this&&f[b].queue===a&&(f[b].anim.stop(!0),f.splice(b,1));for(b=0;g>b;b++)d[b]&&d[b].finish&&d[b].finish.call(this);delete c.finish})}}),fb.each(["toggle","show","hide"],function(a,b){var c=fb.fn[b];fb.fn[b]=function(a,d,e){return null==a||"boolean"==typeof a?c.apply(this,arguments):this.animate(I(b,!0),a,d,e)}}),fb.each({slideDown:I("show"),slideUp:I("hide"),slideToggle:I("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(a,b){fb.fn[a]=function(a,c,d){return this.animate(b,a,c,d)}}),fb.timers=[],fb.fx.tick=function(){var a,b=fb.timers,c=0;for(oc=fb.now();c<b.length;c++)a=b[c],a()||b[c]!==a||b.splice(c--,1);b.length||fb.fx.stop(),oc=void 0},fb.fx.timer=function(a){fb.timers.push(a),a()?fb.fx.start():fb.timers.pop()},fb.fx.interval=13,fb.fx.start=function(){pc||(pc=setInterval(fb.fx.tick,fb.fx.interval))},fb.fx.stop=function(){clearInterval(pc),pc=null},fb.fx.speeds={slow:600,fast:200,_default:400},fb.fn.delay=function(a,b){return a=fb.fx?fb.fx.speeds[a]||a:a,b=b||"fx",this.queue(b,function(b,c){var d=setTimeout(b,a);c.stop=function(){clearTimeout(d)}})},function(){var a,b,c,d,e=pb.createElement("div");e.setAttribute("className","t"),e.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",a=e.getElementsByTagName("a")[0],c=pb.createElement("select"),d=c.appendChild(pb.createElement("option")),b=e.getElementsByTagName("input")[0],a.style.cssText="top:1px",db.getSetAttribute="t"!==e.className,db.style=/top/.test(a.getAttribute("style")),db.hrefNormalized="/a"===a.getAttribute("href"),db.checkOn=!!b.value,db.optSelected=d.selected,db.enctype=!!pb.createElement("form").enctype,c.disabled=!0,db.optDisabled=!d.disabled,b=pb.createElement("input"),b.setAttribute("value",""),db.input=""===b.getAttribute("value"),b.value="t",b.setAttribute("type","radio"),db.radioValue="t"===b.value,a=b=c=d=e=null}();var vc=/\r/g;fb.fn.extend({val:function(a){var b,c,d,e=this[0];return arguments.length?(d=fb.isFunction(a),this.each(function(c){var e;1===this.nodeType&&(e=d?a.call(this,c,fb(this).val()):a,null==e?e="":"number"==typeof e?e+="":fb.isArray(e)&&(e=fb.map(e,function(a){return null==a?"":a+""})),b=fb.valHooks[this.type]||fb.valHooks[this.nodeName.toLowerCase()],b&&"set"in b&&void 0!==b.set(this,e,"value")||(this.value=e))})):e?(b=fb.valHooks[e.type]||fb.valHooks[e.nodeName.toLowerCase()],b&&"get"in b&&void 0!==(c=b.get(e,"value"))?c:(c=e.value,"string"==typeof c?c.replace(vc,""):null==c?"":c)):void 0}}),fb.extend({valHooks:{option:{get:function(a){var b=fb.find.attr(a,"value");return null!=b?b:fb.text(a)}},select:{get:function(a){for(var b,c,d=a.options,e=a.selectedIndex,f="select-one"===a.type||0>e,g=f?null:[],h=f?e+1:d.length,i=0>e?h:f?e:0;h>i;i++)if(c=d[i],!(!c.selected&&i!==e||(db.optDisabled?c.disabled:null!==c.getAttribute("disabled"))||c.parentNode.disabled&&fb.nodeName(c.parentNode,"optgroup"))){if(b=fb(c).val(),f)return b;g.push(b)}return g},set:function(a,b){for(var c,d,e=a.options,f=fb.makeArray(b),g=e.length;g--;)if(d=e[g],fb.inArray(fb.valHooks.option.get(d),f)>=0)try{d.selected=c=!0}catch(h){d.scrollHeight}else d.selected=!1;return c||(a.selectedIndex=-1),e}}}}),fb.each(["radio","checkbox"],function(){fb.valHooks[this]={set:function(a,b){return fb.isArray(b)?a.checked=fb.inArray(fb(a).val(),b)>=0:void 0}},db.checkOn||(fb.valHooks[this].get=function(a){return null===a.getAttribute("value")?"on":a.value})});var wc,xc,yc=fb.expr.attrHandle,zc=/^(?:checked|selected)$/i,Ac=db.getSetAttribute,Bc=db.input;fb.fn.extend({attr:function(a,b){return Eb(this,fb.attr,a,b,arguments.length>1)},removeAttr:function(a){return this.each(function(){fb.removeAttr(this,a)})}}),fb.extend({attr:function(a,b,c){var d,e,f=a.nodeType;return a&&3!==f&&8!==f&&2!==f?typeof a.getAttribute===yb?fb.prop(a,b,c):(1===f&&fb.isXMLDoc(a)||(b=b.toLowerCase(),d=fb.attrHooks[b]||(fb.expr.match.bool.test(b)?xc:wc)),void 0===c?d&&"get"in d&&null!==(e=d.get(a,b))?e:(e=fb.find.attr(a,b),null==e?void 0:e):null!==c?d&&"set"in d&&void 0!==(e=d.set(a,c,b))?e:(a.setAttribute(b,c+""),c):void fb.removeAttr(a,b)):void 0},removeAttr:function(a,b){var c,d,e=0,f=b&&b.match(ub);if(f&&1===a.nodeType)for(;c=f[e++];)d=fb.propFix[c]||c,fb.expr.match.bool.test(c)?Bc&&Ac||!zc.test(c)?a[d]=!1:a[fb.camelCase("default-"+c)]=a[d]=!1:fb.attr(a,c,""),a.removeAttribute(Ac?c:d)},attrHooks:{type:{set:function(a,b){if(!db.radioValue&&"radio"===b&&fb.nodeName(a,"input")){var c=a.value;return a.setAttribute("type",b),c&&(a.value=c),b}}}}}),xc={set:function(a,b,c){return b===!1?fb.removeAttr(a,c):Bc&&Ac||!zc.test(c)?a.setAttribute(!Ac&&fb.propFix[c]||c,c):a[fb.camelCase("default-"+c)]=a[c]=!0,c}},fb.each(fb.expr.match.bool.source.match(/\w+/g),function(a,b){var c=yc[b]||fb.find.attr;yc[b]=Bc&&Ac||!zc.test(b)?function(a,b,d){var e,f;return d||(f=yc[b],yc[b]=e,e=null!=c(a,b,d)?b.toLowerCase():null,yc[b]=f),e}:function(a,b,c){return c?void 0:a[fb.camelCase("default-"+b)]?b.toLowerCase():null}}),Bc&&Ac||(fb.attrHooks.value={set:function(a,b,c){return fb.nodeName(a,"input")?void(a.defaultValue=b):wc&&wc.set(a,b,c)}}),Ac||(wc={set:function(a,b,c){var d=a.getAttributeNode(c);return d||a.setAttributeNode(d=a.ownerDocument.createAttribute(c)),d.value=b+="","value"===c||b===a.getAttribute(c)?b:void 0}},yc.id=yc.name=yc.coords=function(a,b,c){var d;return c?void 0:(d=a.getAttributeNode(b))&&""!==d.value?d.value:null},fb.valHooks.button={get:function(a,b){var c=a.getAttributeNode(b);return c&&c.specified?c.value:void 0},set:wc.set},fb.attrHooks.contenteditable={set:function(a,b,c){wc.set(a,""===b?!1:b,c)}},fb.each(["width","height"],function(a,b){fb.attrHooks[b]={set:function(a,c){return""===c?(a.setAttribute(b,"auto"),c):void 0}}})),db.style||(fb.attrHooks.style={get:function(a){return a.style.cssText||void 0},set:function(a,b){return a.style.cssText=b+""}});var Cc=/^(?:input|select|textarea|button|object)$/i,Dc=/^(?:a|area)$/i;fb.fn.extend({prop:function(a,b){return Eb(this,fb.prop,a,b,arguments.length>1)},removeProp:function(a){return a=fb.propFix[a]||a,this.each(function(){try{this[a]=void 0,delete this[a]}catch(b){}})}}),fb.extend({propFix:{"for":"htmlFor","class":"className"},prop:function(a,b,c){var d,e,f,g=a.nodeType;return a&&3!==g&&8!==g&&2!==g?(f=1!==g||!fb.isXMLDoc(a),f&&(b=fb.propFix[b]||b,e=fb.propHooks[b]),void 0!==c?e&&"set"in e&&void 0!==(d=e.set(a,c,b))?d:a[b]=c:e&&"get"in e&&null!==(d=e.get(a,b))?d:a[b]):void 0},propHooks:{tabIndex:{get:function(a){var b=fb.find.attr(a,"tabindex");return b?parseInt(b,10):Cc.test(a.nodeName)||Dc.test(a.nodeName)&&a.href?0:-1}}}}),db.hrefNormalized||fb.each(["href","src"],function(a,b){fb.propHooks[b]={get:function(a){return a.getAttribute(b,4)}}}),db.optSelected||(fb.propHooks.selected={get:function(a){var b=a.parentNode;return b&&(b.selectedIndex,b.parentNode&&b.parentNode.selectedIndex),null}}),fb.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){fb.propFix[this.toLowerCase()]=this}),db.enctype||(fb.propFix.enctype="encoding");var Ec=/[\t\r\n\f]/g;fb.fn.extend({addClass:function(a){var b,c,d,e,f,g,h=0,i=this.length,j="string"==typeof a&&a;if(fb.isFunction(a))return this.each(function(b){fb(this).addClass(a.call(this,b,this.className))});if(j)for(b=(a||"").match(ub)||[];i>h;h++)if(c=this[h],d=1===c.nodeType&&(c.className?(" "+c.className+" ").replace(Ec," "):" ")){for(f=0;e=b[f++];)d.indexOf(" "+e+" ")<0&&(d+=e+" ");g=fb.trim(d),c.className!==g&&(c.className=g)}return this},removeClass:function(a){var b,c,d,e,f,g,h=0,i=this.length,j=0===arguments.length||"string"==typeof a&&a;if(fb.isFunction(a))return this.each(function(b){fb(this).removeClass(a.call(this,b,this.className))});if(j)for(b=(a||"").match(ub)||[];i>h;h++)if(c=this[h],d=1===c.nodeType&&(c.className?(" "+c.className+" ").replace(Ec," "):"")){for(f=0;e=b[f++];)for(;d.indexOf(" "+e+" ")>=0;)d=d.replace(" "+e+" "," ");g=a?fb.trim(d):"",c.className!==g&&(c.className=g)}return this},toggleClass:function(a,b){var c=typeof a;return"boolean"==typeof b&&"string"===c?b?this.addClass(a):this.removeClass(a):this.each(fb.isFunction(a)?function(c){fb(this).toggleClass(a.call(this,c,this.className,b),b)}:function(){if("string"===c)for(var b,d=0,e=fb(this),f=a.match(ub)||[];b=f[d++];)e.hasClass(b)?e.removeClass(b):e.addClass(b);else(c===yb||"boolean"===c)&&(this.className&&fb._data(this,"__className__",this.className),this.className=this.className||a===!1?"":fb._data(this,"__className__")||"")})},hasClass:function(a){for(var b=" "+a+" ",c=0,d=this.length;d>c;c++)if(1===this[c].nodeType&&(" "+this[c].className+" ").replace(Ec," ").indexOf(b)>=0)return!0;return!1}}),fb.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(a,b){fb.fn[b]=function(a,c){return arguments.length>0?this.on(b,null,a,c):this.trigger(b)}}),fb.fn.extend({hover:function(a,b){return this.mouseenter(a).mouseleave(b||a)},bind:function(a,b,c){return this.on(a,null,b,c)},unbind:function(a,b){return this.off(a,null,b)},delegate:function(a,b,c,d){return this.on(b,a,c,d)},undelegate:function(a,b,c){return 1===arguments.length?this.off(a,"**"):this.off(b,a||"**",c)}});var Fc=fb.now(),Gc=/\?/,Hc=/(,)|(\[|{)|(}|])|"(?:[^"\\\r\n]|\\["\\\/bfnrt]|\\u[\da-fA-F]{4})*"\s*:?|true|false|null|-?(?!0\d)\d+(?:\.\d+|)(?:[eE][+-]?\d+|)/g;fb.parseJSON=function(b){if(a.JSON&&a.JSON.parse)return a.JSON.parse(b+"");var c,d=null,e=fb.trim(b+"");return e&&!fb.trim(e.replace(Hc,function(a,b,e,f){return c&&b&&(d=0),0===d?a:(c=e||b,d+=!f-!e,"")}))?Function("return "+e)():fb.error("Invalid JSON: "+b)},fb.parseXML=function(b){var c,d;if(!b||"string"!=typeof b)return null;try{a.DOMParser?(d=new DOMParser,c=d.parseFromString(b,"text/xml")):(c=new ActiveXObject("Microsoft.XMLDOM"),c.async="false",c.loadXML(b))}catch(e){c=void 0}return c&&c.documentElement&&!c.getElementsByTagName("parsererror").length||fb.error("Invalid XML: "+b),c};var Ic,Jc,Kc=/#.*$/,Lc=/([?&])_=[^&]*/,Mc=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,Nc=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Oc=/^(?:GET|HEAD)$/,Pc=/^\/\//,Qc=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,Rc={},Sc={},Tc="*/".concat("*");try{Jc=location.href}catch(Uc){Jc=pb.createElement("a"),Jc.href="",Jc=Jc.href}Ic=Qc.exec(Jc.toLowerCase())||[],fb.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Jc,type:"GET",isLocal:Nc.test(Ic[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Tc,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":fb.parseJSON,"text xml":fb.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(a,b){return b?P(P(a,fb.ajaxSettings),b):P(fb.ajaxSettings,a)},ajaxPrefilter:N(Rc),ajaxTransport:N(Sc),ajax:function(a,b){function c(a,b,c,d){var e,k,r,s,u,w=b;2!==t&&(t=2,h&&clearTimeout(h),j=void 0,g=d||"",v.readyState=a>0?4:0,e=a>=200&&300>a||304===a,c&&(s=Q(l,v,c)),s=R(l,s,v,e),e?(l.ifModified&&(u=v.getResponseHeader("Last-Modified"),u&&(fb.lastModified[f]=u),u=v.getResponseHeader("etag"),u&&(fb.etag[f]=u)),204===a||"HEAD"===l.type?w="nocontent":304===a?w="notmodified":(w=s.state,k=s.data,r=s.error,e=!r)):(r=w,(a||!w)&&(w="error",0>a&&(a=0))),v.status=a,v.statusText=(b||w)+"",e?o.resolveWith(m,[k,w,v]):o.rejectWith(m,[v,w,r]),v.statusCode(q),q=void 0,i&&n.trigger(e?"ajaxSuccess":"ajaxError",[v,l,e?k:r]),p.fireWith(m,[v,w]),i&&(n.trigger("ajaxComplete",[v,l]),--fb.active||fb.event.trigger("ajaxStop")))}"object"==typeof a&&(b=a,a=void 0),b=b||{};var d,e,f,g,h,i,j,k,l=fb.ajaxSetup({},b),m=l.context||l,n=l.context&&(m.nodeType||m.jquery)?fb(m):fb.event,o=fb.Deferred(),p=fb.Callbacks("once memory"),q=l.statusCode||{},r={},s={},t=0,u="canceled",v={readyState:0,getResponseHeader:function(a){var b;if(2===t){if(!k)for(k={};b=Mc.exec(g);)k[b[1].toLowerCase()]=b[2];b=k[a.toLowerCase()]}return null==b?null:b},getAllResponseHeaders:function(){return 2===t?g:null},setRequestHeader:function(a,b){var c=a.toLowerCase();return t||(a=s[c]=s[c]||a,r[a]=b),this},overrideMimeType:function(a){return t||(l.mimeType=a),this},statusCode:function(a){var b;if(a)if(2>t)for(b in a)q[b]=[q[b],a[b]];else v.always(a[v.status]);return this},abort:function(a){var b=a||u;return j&&j.abort(b),c(0,b),this}};if(o.promise(v).complete=p.add,v.success=v.done,v.error=v.fail,l.url=((a||l.url||Jc)+"").replace(Kc,"").replace(Pc,Ic[1]+"//"),l.type=b.method||b.type||l.method||l.type,l.dataTypes=fb.trim(l.dataType||"*").toLowerCase().match(ub)||[""],null==l.crossDomain&&(d=Qc.exec(l.url.toLowerCase()),l.crossDomain=!(!d||d[1]===Ic[1]&&d[2]===Ic[2]&&(d[3]||("http:"===d[1]?"80":"443"))===(Ic[3]||("http:"===Ic[1]?"80":"443")))),l.data&&l.processData&&"string"!=typeof l.data&&(l.data=fb.param(l.data,l.traditional)),O(Rc,l,b,v),2===t)return v;i=l.global,i&&0===fb.active++&&fb.event.trigger("ajaxStart"),l.type=l.type.toUpperCase(),l.hasContent=!Oc.test(l.type),f=l.url,l.hasContent||(l.data&&(f=l.url+=(Gc.test(f)?"&":"?")+l.data,delete l.data),l.cache===!1&&(l.url=Lc.test(f)?f.replace(Lc,"$1_="+Fc++):f+(Gc.test(f)?"&":"?")+"_="+Fc++)),l.ifModified&&(fb.lastModified[f]&&v.setRequestHeader("If-Modified-Since",fb.lastModified[f]),fb.etag[f]&&v.setRequestHeader("If-None-Match",fb.etag[f])),(l.data&&l.hasContent&&l.contentType!==!1||b.contentType)&&v.setRequestHeader("Content-Type",l.contentType),v.setRequestHeader("Accept",l.dataTypes[0]&&l.accepts[l.dataTypes[0]]?l.accepts[l.dataTypes[0]]+("*"!==l.dataTypes[0]?", "+Tc+"; q=0.01":""):l.accepts["*"]);for(e in l.headers)v.setRequestHeader(e,l.headers[e]);if(l.beforeSend&&(l.beforeSend.call(m,v,l)===!1||2===t))return v.abort();u="abort";for(e in{success:1,error:1,complete:1})v[e](l[e]);if(j=O(Sc,l,b,v)){v.readyState=1,i&&n.trigger("ajaxSend",[v,l]),l.async&&l.timeout>0&&(h=setTimeout(function(){v.abort("timeout")},l.timeout));try{t=1,j.send(r,c)}catch(w){if(!(2>t))throw w;c(-1,w)}}else c(-1,"No Transport");return v},getJSON:function(a,b,c){return fb.get(a,b,c,"json")},getScript:function(a,b){return fb.get(a,void 0,b,"script")}}),fb.each(["get","post"],function(a,b){fb[b]=function(a,c,d,e){return fb.isFunction(c)&&(e=e||d,d=c,c=void 0),fb.ajax({url:a,type:b,dataType:e,data:c,success:d})}}),fb.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(a,b){fb.fn[b]=function(a){return this.on(b,a)}}),fb._evalUrl=function(a){return fb.ajax({url:a,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})},fb.fn.extend({wrapAll:function(a){if(fb.isFunction(a))return this.each(function(b){fb(this).wrapAll(a.call(this,b))});if(this[0]){var b=fb(a,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&b.insertBefore(this[0]),b.map(function(){for(var a=this;a.firstChild&&1===a.firstChild.nodeType;)a=a.firstChild;return a}).append(this)}return this},wrapInner:function(a){return this.each(fb.isFunction(a)?function(b){fb(this).wrapInner(a.call(this,b))}:function(){var b=fb(this),c=b.contents();c.length?c.wrapAll(a):b.append(a)})},wrap:function(a){var b=fb.isFunction(a);return this.each(function(c){fb(this).wrapAll(b?a.call(this,c):a)})},unwrap:function(){return this.parent().each(function(){fb.nodeName(this,"body")||fb(this).replaceWith(this.childNodes)}).end()}}),fb.expr.filters.hidden=function(a){return a.offsetWidth<=0&&a.offsetHeight<=0||!db.reliableHiddenOffsets()&&"none"===(a.style&&a.style.display||fb.css(a,"display"))},fb.expr.filters.visible=function(a){return!fb.expr.filters.hidden(a)};var Vc=/%20/g,Wc=/\[\]$/,Xc=/\r?\n/g,Yc=/^(?:submit|button|image|reset|file)$/i,Zc=/^(?:input|select|textarea|keygen)/i;fb.param=function(a,b){var c,d=[],e=function(a,b){b=fb.isFunction(b)?b():null==b?"":b,d[d.length]=encodeURIComponent(a)+"="+encodeURIComponent(b)};if(void 0===b&&(b=fb.ajaxSettings&&fb.ajaxSettings.traditional),fb.isArray(a)||a.jquery&&!fb.isPlainObject(a))fb.each(a,function(){e(this.name,this.value)});else for(c in a)S(c,a[c],b,e);return d.join("&").replace(Vc,"+")},fb.fn.extend({serialize:function(){return fb.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var a=fb.prop(this,"elements");return a?fb.makeArray(a):this}).filter(function(){var a=this.type;return this.name&&!fb(this).is(":disabled")&&Zc.test(this.nodeName)&&!Yc.test(a)&&(this.checked||!Fb.test(a))}).map(function(a,b){var c=fb(this).val();return null==c?null:fb.isArray(c)?fb.map(c,function(a){return{name:b.name,value:a.replace(Xc,"\r\n")}}):{name:b.name,value:c.replace(Xc,"\r\n")}}).get()}}),fb.ajaxSettings.xhr=void 0!==a.ActiveXObject?function(){return!this.isLocal&&/^(get|post|head|put|delete|options)$/i.test(this.type)&&T()||U()}:T;var $c=0,_c={},ad=fb.ajaxSettings.xhr();a.ActiveXObject&&fb(a).on("unload",function(){for(var a in _c)_c[a](void 0,!0)}),db.cors=!!ad&&"withCredentials"in ad,ad=db.ajax=!!ad,ad&&fb.ajaxTransport(function(a){if(!a.crossDomain||db.cors){var b;return{send:function(c,d){var e,f=a.xhr(),g=++$c;if(f.open(a.type,a.url,a.async,a.username,a.password),a.xhrFields)for(e in a.xhrFields)f[e]=a.xhrFields[e];a.mimeType&&f.overrideMimeType&&f.overrideMimeType(a.mimeType),a.crossDomain||c["X-Requested-With"]||(c["X-Requested-With"]="XMLHttpRequest");for(e in c)void 0!==c[e]&&f.setRequestHeader(e,c[e]+"");f.send(a.hasContent&&a.data||null),b=function(c,e){var h,i,j;if(b&&(e||4===f.readyState))if(delete _c[g],b=void 0,f.onreadystatechange=fb.noop,e)4!==f.readyState&&f.abort();else{j={},h=f.status,"string"==typeof f.responseText&&(j.text=f.responseText);try{i=f.statusText}catch(k){i=""}h||!a.isLocal||a.crossDomain?1223===h&&(h=204):h=j.text?200:404}j&&d(h,i,j,f.getAllResponseHeaders())},a.async?4===f.readyState?setTimeout(b):f.onreadystatechange=_c[g]=b:b()},abort:function(){b&&b(void 0,!0)}}}}),fb.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(a){return fb.globalEval(a),a}}}),fb.ajaxPrefilter("script",function(a){void 0===a.cache&&(a.cache=!1),a.crossDomain&&(a.type="GET",a.global=!1)}),fb.ajaxTransport("script",function(a){if(a.crossDomain){var b,c=pb.head||fb("head")[0]||pb.documentElement;return{send:function(d,e){b=pb.createElement("script"),b.async=!0,a.scriptCharset&&(b.charset=a.scriptCharset),b.src=a.url,b.onload=b.onreadystatechange=function(a,c){(c||!b.readyState||/loaded|complete/.test(b.readyState))&&(b.onload=b.onreadystatechange=null,b.parentNode&&b.parentNode.removeChild(b),b=null,c||e(200,"success"))},c.insertBefore(b,c.firstChild)},abort:function(){b&&b.onload(void 0,!0)}}}});var bd=[],cd=/(=)\?(?=&|$)|\?\?/;fb.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var a=bd.pop()||fb.expando+"_"+Fc++;return this[a]=!0,a}}),fb.ajaxPrefilter("json jsonp",function(b,c,d){var e,f,g,h=b.jsonp!==!1&&(cd.test(b.url)?"url":"string"==typeof b.data&&!(b.contentType||"").indexOf("application/x-www-form-urlencoded")&&cd.test(b.data)&&"data");return h||"jsonp"===b.dataTypes[0]?(e=b.jsonpCallback=fb.isFunction(b.jsonpCallback)?b.jsonpCallback():b.jsonpCallback,h?b[h]=b[h].replace(cd,"$1"+e):b.jsonp!==!1&&(b.url+=(Gc.test(b.url)?"&":"?")+b.jsonp+"="+e),b.converters["script json"]=function(){return g||fb.error(e+" was not called"),g[0]},b.dataTypes[0]="json",f=a[e],a[e]=function(){g=arguments},d.always(function(){a[e]=f,b[e]&&(b.jsonpCallback=c.jsonpCallback,bd.push(e)),g&&fb.isFunction(f)&&f(g[0]),g=f=void 0}),"script"):void 0}),fb.parseHTML=function(a,b,c){if(!a||"string"!=typeof a)return null;"boolean"==typeof b&&(c=b,b=!1),b=b||pb;var d=mb.exec(a),e=!c&&[];return d?[b.createElement(d[1])]:(d=fb.buildFragment([a],b,e),e&&e.length&&fb(e).remove(),fb.merge([],d.childNodes))};var dd=fb.fn.load;fb.fn.load=function(a,b,c){if("string"!=typeof a&&dd)return dd.apply(this,arguments);var d,e,f,g=this,h=a.indexOf(" ");return h>=0&&(d=a.slice(h,a.length),a=a.slice(0,h)),fb.isFunction(b)?(c=b,b=void 0):b&&"object"==typeof b&&(f="POST"),g.length>0&&fb.ajax({url:a,type:f,dataType:"html",data:b}).done(function(a){e=arguments,g.html(d?fb("<div>").append(fb.parseHTML(a)).find(d):a)}).complete(c&&function(a,b){g.each(c,e||[a.responseText,b,a])}),this},fb.expr.filters.animated=function(a){return fb.grep(fb.timers,function(b){return a===b.elem}).length};var ed=a.document.documentElement;fb.offset={setOffset:function(a,b,c){var d,e,f,g,h,i,j,k=fb.css(a,"position"),l=fb(a),m={};"static"===k&&(a.style.position="relative"),h=l.offset(),f=fb.css(a,"top"),i=fb.css(a,"left"),j=("absolute"===k||"fixed"===k)&&fb.inArray("auto",[f,i])>-1,j?(d=l.position(),g=d.top,e=d.left):(g=parseFloat(f)||0,e=parseFloat(i)||0),fb.isFunction(b)&&(b=b.call(a,c,h)),null!=b.top&&(m.top=b.top-h.top+g),null!=b.left&&(m.left=b.left-h.left+e),"using"in b?b.using.call(a,m):l.css(m)}},fb.fn.extend({offset:function(a){if(arguments.length)return void 0===a?this:this.each(function(b){fb.offset.setOffset(this,a,b)});var b,c,d={top:0,left:0},e=this[0],f=e&&e.ownerDocument;return f?(b=f.documentElement,fb.contains(b,e)?(typeof e.getBoundingClientRect!==yb&&(d=e.getBoundingClientRect()),c=V(f),{top:d.top+(c.pageYOffset||b.scrollTop)-(b.clientTop||0),left:d.left+(c.pageXOffset||b.scrollLeft)-(b.clientLeft||0)}):d):void 0},position:function(){if(this[0]){var a,b,c={top:0,left:0},d=this[0];return"fixed"===fb.css(d,"position")?b=d.getBoundingClientRect():(a=this.offsetParent(),b=this.offset(),fb.nodeName(a[0],"html")||(c=a.offset()),c.top+=fb.css(a[0],"borderTopWidth",!0),c.left+=fb.css(a[0],"borderLeftWidth",!0)),{top:b.top-c.top-fb.css(d,"marginTop",!0),left:b.left-c.left-fb.css(d,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var a=this.offsetParent||ed;a&&!fb.nodeName(a,"html")&&"static"===fb.css(a,"position");)a=a.offsetParent;return a||ed})}}),fb.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(a,b){var c=/Y/.test(b);fb.fn[a]=function(d){return Eb(this,function(a,d,e){var f=V(a);return void 0===e?f?b in f?f[b]:f.document.documentElement[d]:a[d]:void(f?f.scrollTo(c?fb(f).scrollLeft():e,c?e:fb(f).scrollTop()):a[d]=e)},a,d,arguments.length,null)}}),fb.each(["top","left"],function(a,b){fb.cssHooks[b]=A(db.pixelPosition,function(a,c){return c?(c=cc(a,b),ec.test(c)?fb(a).position()[b]+"px":c):void 0})}),fb.each({Height:"height",Width:"width"},function(a,b){fb.each({padding:"inner"+a,content:b,"":"outer"+a},function(c,d){fb.fn[d]=function(d,e){var f=arguments.length&&(c||"boolean"!=typeof d),g=c||(d===!0||e===!0?"margin":"border");return Eb(this,function(b,c,d){var e;return fb.isWindow(b)?b.document.documentElement["client"+a]:9===b.nodeType?(e=b.documentElement,Math.max(b.body["scroll"+a],e["scroll"+a],b.body["offset"+a],e["offset"+a],e["client"+a])):void 0===d?fb.css(b,c,g):fb.style(b,c,d,g)},b,f?d:void 0,f,null)}})}),fb.fn.size=function(){return this.length},fb.fn.andSelf=fb.fn.addBack,"function"==typeof define&&define.amd&&define("jquery",[],function(){return fb});var fd=a.jQuery,gd=a.$;return fb.noConflict=function(b){return a.$===fb&&(a.$=gd),b&&a.jQuery===fb&&(a.jQuery=fd),fb},typeof b===yb&&(a.jQuery=a.$=fb),fb}),function(a){function b(b){if("string"==typeof b.data&&(b.data={keys:b.data}),b.data&&b.data.keys&&"string"==typeof b.data.keys){var c=b.handler,d=b.data.keys.toLowerCase().split(" "),e=["text","password","number","email","url","range","date","month","week","time","datetime","datetime-local","search","color","tel"];b.handler=function(b){if(this===b.target||!(/textarea|select/i.test(b.target.nodeName)||a.inArray(b.target.type,e)>-1)){var f=a.hotkeys.specialKeys[b.keyCode],g=String.fromCharCode(b.which).toLowerCase(),h="",i={};a.each(["alt","ctrl","meta","shift"],function(a,c){b[c+"Key"]&&f!==c&&(h+=c+"+")}),h=h.replace("alt+ctrl+meta+shift","hyper"),f&&(i[h+f]=!0),g&&(i[h+g]=!0,i[h+a.hotkeys.shiftNums[g]]=!0,"shift+"===h&&(i[a.hotkeys.shiftNums[g]]=!0));for(var j=0,k=d.length;k>j;j++)if(i[d[j]])return c.apply(this,arguments)}}}}a.hotkeys={version:"0.8",specialKeys:{8:"backspace",9:"tab",10:"return",13:"return",16:"shift",17:"ctrl",18:"alt",19:"pause",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"del",59:";",61:"=",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",106:"*",107:"+",109:"-",110:".",111:"/",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",144:"numlock",145:"scroll",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},shiftNums:{"`":"~",1:"!",2:"@",3:"#",4:"$",5:"%",6:"^",7:"&",8:"*",9:"(",0:")","-":"_","=":"+",";":": ","'":'"',",":"<",".":">","/":"?","\\":"|"}},a.each(["keydown","keyup","keypress"],function(){a.event.special[this]={add:b}})}(this.jQuery);var Detector={canvas:!!window.CanvasRenderingContext2D,webgl:function(){try{return!!window.WebGLRenderingContext&&!!document.createElement("canvas").getContext("experimental-webgl")}catch(a){return!1}}(),workers:!!window.Worker,fileapi:window.File&&window.FileReader&&window.FileList&&window.Blob,getWebGLErrorMessage:function(){var a="Your browser supports WebGL";return this.webgl||(a=window.WebGLRenderingContext?'Your graphics card does not seem to support <a class="link" href="http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation">WebGL</a>. Find out how to get it <a class="link" href="http://get.webgl.org/">here</a>.':'Your browser does not seem to support <a class="link" href="http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation">WebGL</a>. Find out how to get it <a class="link" href="http://get.webgl.org/">here</a>.'),a}};!function(){function a(a,e,f,g){a[b](d+e,"wheel"==c?f:function(a){!a&&(a=window.event);var b={originalEvent:a,target:a.target||a.srcElement,type:"wheel",deltaMode:"MozMousePixelScroll"==a.type?0:1,deltaX:0,delatZ:0,preventDefault:function(){a.preventDefault?a.preventDefault():a.returnValue=!1}};return"mousewheel"==c?(b.deltaY=-1/40*a.wheelDelta,a.wheelDeltaX&&(b.deltaX=-1/40*a.wheelDeltaX)):b.deltaY=a.detail,f(b)},g||!1)}var b,c,d="";window.addEventListener?b="addEventListener":(b="attachEvent",d="on"),void 0!==document.onmousewheel&&(c="mousewheel");try{WheelEvent("wheel"),c="wheel"}catch(e){}c||(c="DOMMouseScroll"),window.addWheelListener=function(b,d,e){a(b,c,d,e),"DOMMouseScroll"==c&&a(b,"MozMousePixelScroll",d,e)},jQuery.fn.jMouseWheel=function(a){return this.each(function(){window.addWheelListener(this,a,!0)
})}}(jQuery),function(a){for(var b,c,d={},e=function(){},f="memory".split(","),g="assert,clear,count,debug,dir,dirxml,error,exception,group,groupCollapsed,groupEnd,info,log,markTimeline,profile,profileEnd,table,time,timeEnd,timeStamp,trace,warn".split(",");b=f.pop();)a[b]=a[b]||d;for(;c=g.pop();)a[c]=a[c]||e}(this.console=this.console||{}),Array.prototype.each=function(a,b){for(var c=0,d=this.length>>>0;d>c;c++)if(c in this&&a.call(b,this[c],c,this)===!1)return},Array.prototype.clone=function(){return Array.prototype.slice.call(this,0)},Array.prototype.find=function(){var a;return this.each(function(b,c){return iterator.call(context,b,c,this)?(a=b,!1):!0},this),a},Array.prototype.findAll=function(){var a=[];return this.each(function(b,c){iterator.call(context,b,c,this)&&a.push(b)},this),a},window.util||(util={});var EventMap={mousemove:"mousemove",mousedown:"mousedown",mouseup:"mouseup"};if(Array.prototype.swap=function(a,b){var c=this[a];this[a]=this[b],this[b]=c},util.each=function(a,b,c){util.assert(!util.isNullOrUndefined(a),"array must be defined");for(var d=0;d<a.length;++d)b.call(c,a[d],d)},util.map_each=function(a,b,c){util.assert(!util.isNullOrUndefined(a),"map must be defined");for(var d in a)b.call(c,d,a[d])},util.find=function(a,b,c){for(var d=0;d<a.length;++d)if(b.call(c,a[d],d))return d;return-1},util.findAll=function(a,b,c){for(var d=[],e=0;e<a.length;++e)b.call(c,a[e],e)&&d.push(a[e]);return d},util.array=function(a){for(var b=[],c=a.length;--c>=0;)b[c]=a[c];return b},util.isEmpty=function(a){for(var b in a)return!1;return!0},util.stopEventPropagation=function(a){if("stopPropagation"in a)a.stopPropagation();else{if(!("cancelBubble"in a))throw Error("Browser unrecognized");a.cancelBubble=!0}},util.preventDefault=function(a){return"preventDefault"in a&&a.preventDefault(),Prototype.Browser.IE&&(a.returnValue=!1,a.keyCode=0),!1},util.setElementTextContent=function(a,b){if("textContent"in a)a.textContent=b;else{if(!("innerText"in a))throw Error("Browser unrecognized");a.innerText=b}},util.getElementTextContent=function(a){if("textContent"in a)return a.textContent;if("innerText"in a)return a.innerText;throw Error("Browser unrecognized")},util.stringPadded=function(a,b,c){a+="";for(var d="";a.length+d.length<b;)d+=" ";return c?a+d:d+a},util.idList=function(a){var b=[];for(var c in a)b.push(c);return b},util.mapArray=function(a,b){for(var c=[],d=0;d<a.length;++d)c.push(b[a[d]]);return c},util.arrayMax=function(a){return Math.max.apply(Math,a)},util.arrayMin=function(a){return Math.min.apply(Math,a)},util.map=function(a,b,c){for(var d=[],e=0;e<a.length;++e)d.push(b.call(c,a[e]));return d},util.apply=function(a,b){for(var c=0;c<a.length;++c)a[c]=b(a[c])},util.isUndefined=function(a){return"undefined"==typeof a},util.ifDef=function(a,b,c,d){a[c]=util.isUndefined(b[c])?d:b[c]},util.ifDefList=function(a,b,c,d){a[c]=util.isUndefined(b[c])||null===b[c]?d:util.array(b[c])},util.identityMap=function(a){for(var b={},c=0;c<a.length;++c)b[a[c]]=a[c];return b},util.strip=function(a){return a.replace(/\s*$/,"").replace(/^\s*/,"")},util.stripRight=function(a){return a.replace(/\s*$/,"")},util.stripQuotes=function(a){return'"'===a[0]&&'"'===a[a.length-1]?a.substr(1,a.length-2):a},util.paddedFloat=function(a,b,c){var d=a.toFixed(c).replace(",",".");if(d.length>b)throw new Error("number does not fit");return util.stringPadded(d,b)},util.paddedInt=function(a,b){var c=a.toFixed(0);if(c.length>b)throw new Error("number does not fit");return util.stringPadded(c,b)},util.arrayAddIfMissing=function(a,b){for(var c=0;c<a.length;++c)if(a[c]===b)return!1;return a.push(b),!0},util.assert=function(a,b){if(!a)throw new Error(b?"Assertion failed: "+b:"Assertion failed")},util.isNull=function(a){return null===a},util.isNullOrUndefined=function(a){return util.isUndefined(a)||util.isNull(a)},util.arrayRemoveByValue=function(a,b){util.assert(!util.isUndefined(a)&&!util.isNull(a),"array must be defined");for(var c=a.indexOf(b),d=0;c>=0;)a.splice(c,1),d+=1,c=a.indexOf(b);return d},util.listNextRotate=function(a,b){return a[(a.indexOf(b)+1)%a.length]},util.isArray=function(a){return"[object Array]"===Object.prototype.toString.call(a)},window.util||(util={}),util.assertDefined=function(a){util.assert(!util.isNullOrUndefined(a))},util.Vec2=function(a,b){if(0==arguments.length)this.x=0,this.y=0;else if(1==arguments.length)this.x=parseFloat(a.x),this.y=parseFloat(a.y);else{if(2!=arguments.length)throw"util.Vec2(): invalid arguments";this.x=parseFloat(a),this.y=parseFloat(b)}},util.Vec2.ZERO=new util.Vec2(0,0),util.Vec2.UNIT=new util.Vec2(1,1),util.Vec2.segmentIntersection=function(a,b,c,d){var e=(a.x-c.x)*(b.y-c.y)-(a.y-c.y)*(b.x-c.x),f=(a.x-d.x)*(b.y-d.y)-(a.y-d.y)*(b.x-d.x),g=(c.x-a.x)*(d.y-a.y)-(c.y-a.y)*(d.x-a.x),h=(c.x-b.x)*(d.y-b.y)-(c.y-b.y)*(d.x-b.x);return 0>=e*f&&0>=g*h},util.Vec2.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},util.Vec2.prototype.equals=function(a){return util.assertDefined(a),this.x==a.x&&this.y==a.y},util.Vec2.prototype.add=function(a){return util.assertDefined(a),new util.Vec2(this.x+a.x,this.y+a.y)},util.Vec2.prototype.add_=function(a){util.assertDefined(a),this.x+=a.x,this.y+=a.y},util.Vec2.prototype.sub=function(a){return util.assertDefined(a),new util.Vec2(this.x-a.x,this.y-a.y)},util.Vec2.prototype.scaled=function(a){return util.assertDefined(a),new util.Vec2(this.x*a,this.y*a)},util.Vec2.prototype.negated=function(){return new util.Vec2(-this.x,-this.y)},util.Vec2.prototype.yComplement=function(a){return a=a||0,new util.Vec2(this.x,a-this.y)},util.Vec2.prototype.addScaled=function(a,b){return util.assertDefined(a),util.assertDefined(b),new util.Vec2(this.x+a.x*b,this.y+a.y*b)},util.Vec2.prototype.normalized=function(){return this.scaled(1/this.length())},util.Vec2.prototype.normalize=function(){var a=this.length();return 1e-6>a?!1:(this.x/=a,this.y/=a,!0)},util.Vec2.prototype.turnLeft=function(){return new util.Vec2(-this.y,this.x)},util.Vec2.prototype.coordStr=function(){return this.x.toString()+" , "+this.y.toString()},util.Vec2.prototype.toString=function(){return"("+this.x.toFixed(2)+","+this.y.toFixed(2)+")"},util.Vec2.dist=function(a,b){return util.assertDefined(a),util.assertDefined(b),util.Vec2.diff(a,b).length()},util.Vec2.max=function(a,b){return util.assertDefined(a),util.assertDefined(b),new util.Vec2(Math.max(a.x,b.x),Math.max(a.y,b.y))},util.Vec2.min=function(a,b){return util.assertDefined(a),util.assertDefined(b),new util.Vec2(Math.min(a.x,b.x),Math.min(a.y,b.y))},util.Vec2.prototype.max=function(a){return util.assertDefined(a),new util.Vec2.max(this,a)},util.Vec2.prototype.min=function(a){return util.assertDefined(a),new util.Vec2.min(this,a)},util.Vec2.prototype.ceil=function(){return new util.Vec2(Math.ceil(this.x),Math.ceil(this.y))},util.Vec2.prototype.floor=function(){return new util.Vec2(Math.floor(this.x),Math.floor(this.y))},util.Vec2.sum=function(a,b){return util.assertDefined(a),util.assertDefined(b),new util.Vec2(a.x+b.x,a.y+b.y)},util.Vec2.dot=function(a,b){return util.assertDefined(a),util.assertDefined(b),a.x*b.x+a.y*b.y},util.Vec2.cross=function(a,b){return util.assertDefined(a),util.assertDefined(b),a.x*b.y-a.y*b.x},util.Vec2.prototype.rotate=function(a){util.assertDefined(a);var b=Math.sin(a),c=Math.cos(a);return this.rotateSC(b,c)},util.Vec2.prototype.rotateSC=function(a,b){return util.assertDefined(a),util.assertDefined(b),new util.Vec2(this.x*b-this.y*a,this.x*a+this.y*b)},util.Vec2.angle=function(a,b){return util.assertDefined(a),util.assertDefined(b),Math.atan2(util.Vec2.cross(a,b),util.Vec2.dot(a,b))},util.Vec2.prototype.oxAngle=function(){return Math.atan2(this.y,this.x)},util.Vec2.diff=function(a,b){return util.assertDefined(a),util.assertDefined(b),new util.Vec2(a.x-b.x,a.y-b.y)},util.Vec2.lc=function(){for(var a=new util.Vec2,b=0;b<arguments.length/2;++b)a=a.addScaled(arguments[2*b],arguments[2*b+1]);return a},util.Vec2.lc2=function(a,b,c,d){return util.assertDefined(a),util.assertDefined(c),util.assertDefined(b),util.assertDefined(d),new util.Vec2(a.x*b+c.x*d,a.y*b+c.y*d)},util.Vec2.centre=function(a,b){return new util.Vec2.lc2(a,.5,b,.5)},util.Box2Abs=function(){1==arguments.length&&"min"in arguments[0]&&"max"in arguments[0]&&(this.p0=arguments[0].min,this.p1=arguments[0].max),2==arguments.length&&arguments[0]instanceof util.Vec2&&arguments[1]instanceof util.Vec2?(this.p0=arguments[0],this.p1=arguments[1]):4==arguments.length?(this.p0=new util.Vec2(arguments[0],arguments[1]),this.p1=new util.Vec2(arguments[2],arguments[3])):0==arguments.length?(this.p0=new util.Vec2,this.p1=new util.Vec2):new Error("util.Box2Abs constructor only accepts 4 numbers or 2 vectors or no arguments!")},util.Box2Abs.prototype.toString=function(){return this.p0.toString()+" "+this.p1.toString()},util.Box2Abs.fromRelBox=function(a){return util.assertDefined(a),new util.Box2Abs(a.x,a.y,a.x+a.width,a.y+a.height)},util.Box2Abs.prototype.clone=function(){return new util.Box2Abs(this.p0,this.p1)},util.Box2Abs.union=function(a,b){return util.assertDefined(a),util.assertDefined(b),new util.Box2Abs(util.Vec2.min(a.p0,b.p0),util.Vec2.max(a.p1,b.p1))},util.Box2Abs.prototype.extend=function(a,b){return util.assertDefined(a),b=b||a,new util.Box2Abs(this.p0.sub(a),this.p1.add(b))},util.Box2Abs.prototype.include=function(a){return util.assertDefined(a),new util.Box2Abs(this.p0.min(a),this.p1.max(a))},util.Box2Abs.prototype.contains=function(a,b){return b=(b||0)-0,util.assertDefined(a),a.x>=this.p0.x-b&&a.x<=this.p1.x+b&&a.y>=this.p0.y-b&&a.y<=this.p1.y+b},util.Box2Abs.prototype.translate=function(a){return util.assertDefined(a),new util.Box2Abs(this.p0.add(a),this.p1.add(a))},util.Box2Abs.prototype.transform=function(a,b){return util.assert(!util.isNullOrUndefined(a)),new util.Box2Abs(a.call(b,this.p0),a.call(b,this.p1))},util.Box2Abs.prototype.sz=function(){return this.p1.sub(this.p0)},util.Box2Abs.prototype.centre=function(){return util.Vec2.centre(this.p0,this.p1)},util.Box2Abs.prototype.pos=function(){return this.p0},util.Vec2.shiftRayBox=function(a,b,c){util.assertDefined(a),util.assertDefined(b),util.assertDefined(c);var d=[c.p0,new util.Vec2(c.p1.x,c.p0.y),c.p1,new util.Vec2(c.p0.x,c.p1.y)],e=d.map(function(b){return b.sub(a)});b=b.normalized();for(var f=e.map(function(a){return util.Vec2.cross(a,b)}),g=e.map(function(a){return util.Vec2.dot(a,b)}),h=-1,i=-1,j=0;4>j;++j)f[j]>0?(0>h||g[h]<g[j])&&(h=j):(0>i||g[i]<g[j])&&(i=j);if(0>i||0>h)return 0;var k,l;return g[h]>g[i]?(k=i,l=h):(k=h,l=i),g[k]+Math.abs(f[k])*(g[l]-g[k])/(Math.abs(f[k])+Math.abs(f[l]))},window.util||(util={}),util.Set={empty:function(){return{}},single:function(a){var b={};return util.Set.add(b,a),b},size:function(a){var b=0;for(var c in a)a[c]!==Object.prototype[c]&&b++;return b},contains:function(a,b){return"undefined"!=typeof a[b]&&a[b]!==Object.prototype[b]},subset:function(a,b){for(var c in a)if(a[c]!==Object.prototype[c]&&b[c]!==a[c])return!1;return!0},intersection:function(a,b){var c={};for(var d in a)a[d]!==Object.prototype[d]&&b[d]===a[d]&&util.Set.add(c,d);return c},disjoint:function(a,b){for(var c in a)if(a[c]!==Object.prototype[c]&&b[c]===a[c])return!1;return!0},eq:function(a,b){return util.Set.subset(a,b)&&util.Set.subset(b,a)},each:function(a,b,c){for(var d in a)a[d]!==Object.prototype[d]&&b.call(c,a[d])},filter:function(a,b,c){var d={};for(var e in a)a[e]!==Object.prototype[e]&&b.call(c,a[e])&&(d[a[e]]=a[e]);return d},pick:function(a){for(var b in a)if(a[b]!==Object.prototype[b])return a[b];return null},list:function(a){var b=[];for(var c in a)a[c]!==Object.prototype[c]&&b.push(a[c]);return b},add:function(a,b){a[b]=b},mergeIn:function(a,b){util.Set.each(b,function(b){util.Set.add(a,b)})},remove:function(a,b){var c=a[b];return delete a[b],c},clone:function(a){var b={};return util.Set.mergeIn(b,a),b},fromList:function(a){var b={};if(a)for(var c=0;c<a.length;++c)b[a[c]-0]=a[c]-0;return b},keySetInt:function(a){var b={};return a.each(function(a){b[a-0]=a-0}),b},find:function(a,b,c){for(var d in a)if(a[d]!==Object.prototype[d]&&b.call(c,a[d]))return d;return null}},window.util||(util={}),util.Map=function(a){if("undefined"!=typeof a&&a.constructor!==Object)throw Error("Passed object is not an instance of 'Object'!");this._obj=a||{},this._count=0},util.Map.prototype.each=function(a,b){for(var c in this._obj){var d=parseInt(c),e=this._obj[c];isNaN(d)||(c=d),a.call(b,c,e)}},util.Map.prototype.map=function(a,b){var c=new util.Map;return this.each(function(d,e){c.set(d,a.call(b,d,e))},this),c},util.Map.prototype.find=function(a,b){for(var c in this._obj){var d=parseInt(c),e=this._obj[c];if(isNaN(d)||(c=d),a.call(b,c,e))return c}},util.Map.prototype.findAll=function(a,b){var c=[];for(var d in this._obj){var e=parseInt(d),f=this._obj[d];isNaN(e)||(d=e),a.call(b,d,f)&&c.push(d)}return c},util.Map.prototype.keys=function(){var a=[];for(var b in this._obj)a.push(b);return a},util.Map.prototype.ikeys=function(){var a=[];for(var b in this._obj)a.push(b-0);return a},util.Map.prototype.set=function(a,b){if(this._count+=("undefined"!=typeof b?1:0)-("undefined"!=typeof this._obj[a]?1:0),"undefined"==typeof b){var c=this._obj[a];return delete this._obj[a],c}return this._obj[a]=b},util.Map.prototype.get=function(a){return this._obj[a]!==Object.prototype[a]?this._obj[a]:void 0},util.Map.prototype.has=function(a){return this._obj[a]!==Object.prototype[a]},util.Map.prototype.unset=function(a){return this.set(a,void 0)},util.Map.prototype.update=function(a){for(var b in a)this.set(b,a[b])},util.Map.prototype.clear=function(){this._obj={},this._count=0},util.Map.prototype.count=function(){return this._count},util.Map.prototype.idList=function(){return util.idList(this._obj)},util.Map.prototype.keyOf=function(a){for(var b in this._obj)if(this._obj[b]===a)return b},!window.util||!util.Map)throw new Error("Map should be defined first");if(util.Pool=function(){this._map=new util.Map,this._nextId=0},util.Pool.prototype.newId=function(){return this._nextId++},util.Pool.prototype.add=function(a){var b=this._nextId++;return this._map.set(b,a),b},util.Pool.prototype.set=function(a,b){this._map.set(a,b)},util.Pool.prototype.get=function(a){return this._map.get(a)},util.Pool.prototype.has=function(a){return this._map.has(a)},util.Pool.prototype.remove=function(a){return this._map.unset(a)},util.Pool.prototype.clear=function(){this._map.clear()},util.Pool.prototype.keys=function(){return this._map.keys()},util.Pool.prototype.ikeys=function(){return this._map.ikeys()},util.Pool.prototype.each=function(a,b){this._map.each(a,b)},util.Pool.prototype.map=function(a,b){return this._map.map(a,b)},util.Pool.prototype.find=function(a,b){return this._map.find(a,b)},util.Pool.prototype.count=function(){return this._map.count()},util.Pool.prototype.keyOf=function(a){return this._map.keyOf(a)},!window.util||!util.Vec2)throw new Error("Vec2 should be defined first");if(window.chem||(chem={}),chem.Element=function(a,b,c,d,e,f,g){this.label=a,this.period=b,this.group=c,this.putHydrogenOnTheLeft=d,this.color=e||"#000000",this.labelColor=rgbToHex(rgbRescale(hexToRGB(this.color),150)),this.xpos=g||c,this.ypos=f||b;var h=("0x"+this.color.substring(1,3)-0)/255,i=("0x"+this.color.substring(3,5)-0)/255,j=("0x"+this.color.substring(5,7)-0)/255,k=.299*h+.587*i+.114*j;k>.6&&(h*=.6/k,i*=.6/k,j*=.6/k),h=Math.ceil(Math.min(255*h,255)).toString(16),i=Math.ceil(Math.min(255*i,255)).toString(16),j=Math.ceil(Math.min(255*j,255)).toString(16),h=1==h.length?"0"+h:h,i=1==i.length?"0"+i:i,j=1==j.length?"0"+j:j,this.color="#"+h+i+j},chem.Element.elements=new util.Map({1:new chem.Element("H",1,1,!1,"#000000",1,1),2:new chem.Element("He",1,8,!1,"#d9ffff",1,18),3:new chem.Element("Li",2,1,!1,"#cc80ff",2,1),4:new chem.Element("Be",2,2,!1,"#c2ff00",2,2),5:new chem.Element("B",2,3,!1,"#ffb5b5",2,13),6:new chem.Element("C",2,4,!1,"#000000",2,14),7:new chem.Element("N",2,5,!1,"#304ff7",2,15),8:new chem.Element("O",2,6,!0,"#ff0d0d",2,16),9:new chem.Element("F",2,7,!0,"#8fe04f",2,17),10:new chem.Element("Ne",2,8,!1,"#b3e3f5",2,18),11:new chem.Element("Na",3,1,!1,"#ab5cf2",3,1),12:new chem.Element("Mg",3,2,!1,"#8aff00",3,2),13:new chem.Element("Al",3,3,!1,"#bfa6a6",3,13),14:new chem.Element("Si",3,4,!1,"#f0c7a1",3,14),15:new chem.Element("P",3,5,!1,"#ff8000",3,15),16:new chem.Element("S",3,6,!0,"#d9a61a",3,16),17:new chem.Element("Cl",3,7,!0,"#1fd01f",3,17),18:new chem.Element("Ar",3,8,!1,"#80d1e3",3,18),19:new chem.Element("K",4,1,!1,"#8f40d4",4,1),20:new chem.Element("Ca",4,2,!1,"#3dff00",4,2),21:new chem.Element("Sc",4,3,!1,"#e6e6e6",4,3),22:new chem.Element("Ti",4,4,!1,"#bfc2c7",4,4),23:new chem.Element("V",4,5,!1,"#a6a6ab",4,5),24:new chem.Element("Cr",4,6,!1,"#8a99c7",4,6),25:new chem.Element("Mn",4,7,!1,"#9c7ac7",4,7),26:new chem.Element("Fe",4,8,!1,"#e06633",4,8),27:new chem.Element("Co",4,8,!1,"#f08fa1",4,9),28:new chem.Element("Ni",4,8,!1,"#4fd14f",4,10),29:new chem.Element("Cu",4,1,!1,"#c78033",4,11),30:new chem.Element("Zn",4,2,!1,"#7d80b0",4,12),31:new chem.Element("Ga",4,3,!1,"#c28f8f",4,13),32:new chem.Element("Ge",4,4,!1,"#668f8f",4,14),33:new chem.Element("As",4,5,!1,"#bd80e3",4,15),34:new chem.Element("Se",4,6,!0,"#ffa100",4,16),35:new chem.Element("Br",4,7,!0,"#a62929",4,17),36:new chem.Element("Kr",4,8,!1,"#5cb8d1",4,18),37:new chem.Element("Rb",5,1,!1,"#702eb0",5,1),38:new chem.Element("Sr",5,2,!1,"#00ff00",5,2),39:new chem.Element("Y",5,3,!1,"#94ffff",5,3),40:new chem.Element("Zr",5,4,!1,"#94e0e0",5,4),41:new chem.Element("Nb",5,5,!1,"#73c2c9",5,5),42:new chem.Element("Mo",5,6,!1,"#54b5b5",5,6),43:new chem.Element("Tc",5,7,!1,"#3b9e9e",5,7),44:new chem.Element("Ru",5,8,!1,"#248f8f",5,8),45:new chem.Element("Rh",5,8,!1,"#0a7d8c",5,9),46:new chem.Element("Pd",5,8,!1,"#006985",5,10),47:new chem.Element("Ag",5,1,!1,"#bfbfbf",5,11),48:new chem.Element("Cd",5,2,!1,"#ffd98f",5,12),49:new chem.Element("In",5,3,!1,"#a67573",5,13),50:new chem.Element("Sn",5,4,!1,"#668080",5,14),51:new chem.Element("Sb",5,5,!1,"#9e63b5",5,15),52:new chem.Element("Te",5,6,!1,"#d47a00",5,16),53:new chem.Element("I",5,7,!0,"#940094",5,17),54:new chem.Element("Xe",5,8,!1,"#429eb0",5,18),55:new chem.Element("Cs",6,1,!1,"#57178f",6,1),56:new chem.Element("Ba",6,2,!1,"#00c900",6,2),57:new chem.Element("La",6,3,!1,"#70d4ff",6,3),58:new chem.Element("Ce",6,3,!1,"#ffffc7",8,4),59:new chem.Element("Pr",6,3,!1,"#d9ffc7",8,5),60:new chem.Element("Nd",6,3,!1,"#c7ffc7",8,6),61:new chem.Element("Pm",6,3,!1,"#a3ffc7",8,7),62:new chem.Element("Sm",6,3,!1,"#8fffc7",8,8),63:new chem.Element("Eu",6,3,!1,"#61ffc7",8,9),64:new chem.Element("Gd",6,3,!1,"#45ffc7",8,10),65:new chem.Element("Tb",6,3,!1,"#30ffc7",8,11),66:new chem.Element("Dy",6,3,!1,"#1fffc7",8,12),67:new chem.Element("Ho",6,3,!1,"#00ff9c",8,13),68:new chem.Element("Er",6,3,!1,"#00e675",8,14),69:new chem.Element("Tm",6,3,!1,"#00d452",8,15),70:new chem.Element("Yb",6,3,!1,"#00bf38",8,16),71:new chem.Element("Lu",6,3,!1,"#00ab24",8,17),72:new chem.Element("Hf",6,4,!1,"#4dc2ff",6,4),73:new chem.Element("Ta",6,5,!1,"#4da6ff",6,5),74:new chem.Element("W",6,6,!1,"#2194d6",6,6),75:new chem.Element("Re",6,7,!1,"#267dab",6,7),76:new chem.Element("Os",6,8,!1,"#266696",6,8),77:new chem.Element("Ir",6,8,!1,"#175487",6,9),78:new chem.Element("Pt",6,8,!1,"#d1d1e0",6,10),79:new chem.Element("Au",6,1,!1,"#ffd124",6,11),80:new chem.Element("Hg",6,2,!1,"#b8b8d1",6,12),81:new chem.Element("Tl",6,3,!1,"#a6544d",6,13),82:new chem.Element("Pb",6,4,!1,"#575961",6,14),83:new chem.Element("Bi",6,5,!1,"#9e4fb5",6,15),84:new chem.Element("Po",6,6,!1,"#ab5c00",6,16),85:new chem.Element("At",6,7,!1,"#754f45",6,17),86:new chem.Element("Rn",6,8,!1,"#428296",6,18),87:new chem.Element("Fr",7,1,!1,"#420066",7,1),88:new chem.Element("Ra",7,2,!1,"#007d00",7,2),89:new chem.Element("Ac",7,3,!1,"#70abfa",7,3),90:new chem.Element("Th",7,3,!1,"#00baff",9,4),91:new chem.Element("Pa",7,3,!1,"#00a1ff",9,5),92:new chem.Element("U",7,3,!1,"#008fff",9,6),93:new chem.Element("Np",7,3,!1,"#0080ff",9,7),94:new chem.Element("Pu",7,3,!1,"#006bff",9,8),95:new chem.Element("Am",7,3,!1,"#545cf2",9,9),96:new chem.Element("Cm",7,3,!1,"#785ce3",9,10),97:new chem.Element("Bk",7,3,!1,"#8a4fe3",9,11),98:new chem.Element("Cf",7,3,!1,"#a136d4",9,12),99:new chem.Element("Es",7,3,!1,"#b31fd4",9,13),100:new chem.Element("Fm",7,3,!1,"#000000",9,14),101:new chem.Element("Md",7,3,!1,"#000000",9,15),102:new chem.Element("No",7,3,!1,"#000000",9,16),103:new chem.Element("Lr",7,3,!1,"#000000",9,17),104:new chem.Element("Rf",7,4,!1,"#4dc2ff",7,4),105:new chem.Element("Db",7,5,!1,"#4da6ff",7,5),106:new chem.Element("Sg",7,6,!1,"#2194d6",7,6),107:new chem.Element("Bh",7,7,!1,"#267dab",7,7),108:new chem.Element("Hs",7,8,!1,"#266696",7,8),109:new chem.Element("Mt",7,8,!1,"#175487",7,9),110:new chem.Element("Ds",7,8,!1,"#d1d1e0",7,10),111:new chem.Element("Rg",7,1,!1,"#ffd124",7,11),112:new chem.Element("Cn",7,2,!1,"#b8b8d1",7,12)}),chem.Element.labelMap=null,chem.Element.getElementByLabel=function(a){return this.labelMap||(this.labelMap={},this.elements.each(function(a,b){this.labelMap[b.label]=a-0},this)),this.labelMap.hasOwnProperty(a)?this.labelMap[a]:null},!window.chem||!util.Vec2||!util.Pool)throw new Error("Vec2, Pool should be defined first");if(chem.Struct=function(){this.atoms=new util.Pool,this.bonds=new util.Pool,this.sgroups=new util.Pool,this.halfBonds=new util.Map,this.loops=new util.Pool,this.isChiral=!1,this.isReaction=!1,this.rxnArrows=new util.Pool,this.rxnPluses=new util.Pool,this.frags=new util.Pool,this.rgroups=new util.Map,this.name="",this.sGroupForest=new chem.SGroupForest(this)},chem.Struct.prototype.hasRxnProps=function(){return this.atoms.find(function(a,b){return b.hasRxnProps()},this)>=0||this.bonds.find(function(a,b){return b.hasRxnProps()},this)>=0},chem.Struct.prototype.hasRxnArrow=function(){return this.rxnArrows.count()>0},chem.Struct.prototype.addRxnArrowIfNecessary=function(){var a=!this.hasRxnArrow()&&this.hasRxnProps();return a&&this.rxnArrows.add(new chem.Struct.RxnArrow),a},chem.Struct.prototype.getSGroupsInAtomSet=function(a){var b=new Hash;util.each(a,function(a){var c=util.Set.list(this.atoms.get(a).sgs);c.each(function(a){var c=b.get(a);util.isUndefined(c)?c=1:c++,b.set(a,c)},this)},this);var c=[];return b.each(function(a){var b=parseInt(a.key),d=this.sgroups.get(b),e=chem.SGroup.getAtoms(this,d);a.value==e.length&&c.push(b)},this),c},chem.Struct.prototype.isBlank=function(){return 0==this.atoms.count()&&0==this.rxnArrows.count()&&0==this.rxnPluses.count()&&!this.isChiral},chem.Struct.prototype.toLists=function(){var a={},b=[];this.atoms.each(function(c,d){a[c]=b.length,b.push(d)});var c=[];return this.bonds.each(function(b,d){var e=new chem.Struct.Bond(d);e.begin=a[d.begin],e.end=a[d.end],c.push(e)}),{atoms:b,bonds:c}},chem.Struct.prototype.clone=function(a,b,c,d){var e=new chem.Struct;return this.mergeInto(e,a,b,c,!1,d)},chem.Struct.prototype.getScaffold=function(){var a=util.Set.empty();return this.atoms.each(function(b){util.Set.add(a,b)},this),this.rgroups.each(function(b,c){c.frags.each(function(b,c){this.atoms.each(function(b,d){d.fragment==c&&util.Set.remove(a,b)},this)},this)},this),this.clone(a)},chem.Struct.prototype.getFragmentIds=function(a){var b=util.Set.empty();return this.atoms.each(function(c,d){d.fragment==a&&util.Set.add(b,c)},this),b},chem.Struct.prototype.getFragment=function(a){return this.clone(this.getFragmentIds(a))},chem.Struct.prototype.mergeInto=function(a,b,c,d,e,f){b=b||util.Set.keySetInt(this.atoms),c=c||util.Set.keySetInt(this.bonds),c=util.Set.filter(c,function(a){var c=this.bonds.get(a);return util.Set.contains(b,c.begin)&&util.Set.contains(b,c.end)},this);var g={};this.atoms.each(function(a,c){util.Set.contains(b,a)&&(g[c.fragment]=1)});var h={};this.frags.each(function(b,c){g[b]&&(h[b]=a.frags.add(c.clone()))}),this.rgroups.each(function(b,c){var d=e;if(d||(c.frags.each(function(a,b){g[b]&&(d=!0)}),d)){var f=a.rgroups.get(b);f?c.frags.each(function(a,b){g[b]&&f.frags.add(h[b])}):a.rgroups.set(b,c.clone(h))}}),("undefined"==typeof f||null===f)&&(f={}),this.atoms.each(function(c,d){util.Set.contains(b,c)&&(f[c]=a.atoms.add(d.clone(h)))});var i={};return this.bonds.each(function(b,d){util.Set.contains(c,b)&&(i[b]=a.bonds.add(d.clone(f)))}),this.sgroups.each(function(c,d){var e;for(e=0;e<d.atoms.length;++e)if(!util.Set.contains(b,d.atoms[e]))return;d=chem.SGroup.clone(d,f,i);var g=a.sgroups.add(d);for(d.id=g,e=0;e<d.atoms.length;++e)util.Set.add(a.atoms.get(d.atoms[e]).sgs,g);a.sGroupForest.insert(d.id)}),a.isChiral=this.isChiral,d||(a.isReaction=this.isReaction,this.rxnArrows.each(function(b,c){a.rxnArrows.add(c.clone())}),this.rxnPluses.each(function(b,c){a.rxnPluses.add(c.clone())})),a},chem.Struct.prototype.findBondId=function(a,b){var c=-1;return this.bonds.find(function(d,e){return e.begin==a&&e.end==b||e.begin==b&&e.end==a?(c=d,!0):!1},this),c},chem.Struct.ATOM={RADICAL:{NONE:0,SINGLET:1,DOUPLET:2,TRIPLET:3}},chem.Struct.radicalElectrons=function(a){if(a-=0,a==chem.Struct.ATOM.RADICAL.NONE)return 0;if(a==chem.Struct.ATOM.RADICAL.DOUPLET)return 1;if(a==chem.Struct.ATOM.RADICAL.SINGLET||a==chem.Struct.ATOM.RADICAL.TRIPLET)return 2;throw new Error("Unknown radical value")},chem.Struct.BOND={TYPE:{SINGLE:1,DOUBLE:2,TRIPLE:3,AROMATIC:4,SINGLE_OR_DOUBLE:5,SINGLE_OR_AROMATIC:6,DOUBLE_OR_AROMATIC:7,ANY:8},STEREO:{NONE:0,UP:1,EITHER:4,DOWN:6,CIS_TRANS:3},TOPOLOGY:{EITHER:0,RING:1,CHAIN:2},REACTING_CENTER:{NOT_CENTER:-1,UNMARKED:0,CENTER:1,UNCHANGED:2,MADE_OR_BROKEN:4,ORDER_CHANGED:8,MADE_OR_BROKEN_AND_CHANGED:12}},chem.Struct.FRAGMENT={NONE:0,REACTANT:1,PRODUCT:2,AGENT:3},chem.Struct.Atom=function(a){var b=chem.Struct.Atom.attrGetDefault;if(!(a&&"label"in a))throw new Error("Label must be specified!");this.label=a.label,this.fragment=util.isUndefined(a.fragment)?-1:a.fragment,util.ifDef(this,a,"isotope",b("isotope")),util.ifDef(this,a,"radical",b("radical")),util.ifDef(this,a,"charge",b("charge")),util.ifDef(this,a,"rglabel",b("rglabel")),util.ifDef(this,a,"attpnt",b("attpnt")),util.ifDef(this,a,"explicitValence",b("explicitValence")),this.valence=0,this.implicitH=0,this.pp=util.isUndefined(a.pp)?new util.Vec2:new util.Vec2(a.pp),this.sgs={},util.ifDef(this,a,"ringBondCount",b("ringBondCount")),util.ifDef(this,a,"substitutionCount",b("substitutionCount")),util.ifDef(this,a,"unsaturatedAtom",b("unsaturatedAtom")),util.ifDef(this,a,"hCount",b("hCount")),util.ifDef(this,a,"aam",b("aam")),util.ifDef(this,a,"invRet",b("invRet")),util.ifDef(this,a,"exactChangeFlag",b("exactChangeFlag")),util.ifDef(this,a,"rxnFragmentType",-1),this.atomList=util.isUndefined(a.atomList)||null==a.atomList?null:new chem.Struct.AtomList(a.atomList),this.neighbors=[],this.badConn=!1},chem.Struct.Atom.getAttrHash=function(a){var b=new Hash;for(var c in chem.Struct.Atom.attrlist)"undefined"!=typeof a[c]&&b.set(c,a[c]);return b},chem.Struct.Atom.attrGetDefault=function(a){if(a in chem.Struct.Atom.attrlist)return chem.Struct.Atom.attrlist[a];throw new Error("Attribute unknown")},chem.Struct.Atom.attrlist={label:"C",isotope:0,radical:0,charge:0,explicitValence:-1,ringBondCount:0,substitutionCount:0,unsaturatedAtom:0,hCount:0,atomList:null,invRet:0,exactChangeFlag:0,rglabel:null,attpnt:null,aam:0},chem.Struct.Atom.prototype.clone=function(a){var b=new chem.Struct.Atom(this);return a&&this.fragment in a&&(b.fragment=a[this.fragment]),b},chem.Struct.Atom.prototype.isQuery=function(){return null!=this.atomList||"A"==this.label||this.attpnt||this.hCount},chem.Struct.Atom.prototype.pureHydrogen=function(){return"H"==this.label&&0==this.isotope},chem.Struct.Atom.prototype.isPlainCarbon=function(){return"C"==this.label&&0==this.isotope&&0==this.radical&&0==this.charge&&this.explicitValence<0&&0==this.ringBondCount&&0==this.substitutionCount&&0==this.unsaturatedAtom&&0==this.hCount&&!this.atomList},chem.Struct.Atom.prototype.isPseudo=function(){return!this.atomList&&!this.rglabel&&!chem.Element.getElementByLabel(this.label)},chem.Struct.Atom.prototype.hasRxnProps=function(){return!(!this.invRet&&!this.exactChangeFlag&&util.isNull(this.attpnt)&&!this.aam)},chem.Struct.AtomList=function(a){if(!(a&&"notList"in a&&"ids"in a))throw new Error("'notList' and 'ids' must be specified!");this.notList=a.notList,this.ids=a.ids},chem.Struct.AtomList.prototype.labelList=function(){for(var a=[],b=0;b<this.ids.length;++b)a.push(chem.Element.elements.get(this.ids[b]).label);return a},chem.Struct.AtomList.prototype.label=function(){var a="["+this.labelList().join(",")+"]";return this.notList&&(a="!"+a),a},chem.Struct.AtomList.prototype.equals=function(a){return this.notList==a.notList&&(this.ids||[]).sort().toString()==(a.ids||[]).sort().toString()},chem.Struct.Bond=function(a){if(!(a&&"begin"in a&&"end"in a&&"type"in a))throw new Error("'begin', 'end' and 'type' properties must be specified!");this.begin=a.begin,this.end=a.end,this.type=a.type,util.ifDef(this,a,"stereo",chem.Struct.BOND.STEREO.NONE),util.ifDef(this,a,"topology",chem.Struct.BOND.TOPOLOGY.EITHER),util.ifDef(this,a,"reactingCenterStatus",0),this.hb1=null,this.hb2=null,this.len=0,this.center=new util.Vec2,this.sb=0,this.sa=0,this.angle=0},chem.Struct.Bond.attrlist={type:chem.Struct.BOND.TYPE.SINGLE,stereo:chem.Struct.BOND.STEREO.NONE,topology:chem.Struct.BOND.TOPOLOGY.EITHER,reactingCenterStatus:0},chem.Struct.Bond.getAttrHash=function(a){var b=new Hash;for(var c in chem.Struct.Bond.attrlist)"undefined"!=typeof a[c]&&b.set(c,a[c]);return b},chem.Struct.Bond.attrGetDefault=function(a){if(a in chem.Struct.Bond.attrlist)return chem.Struct.Bond.attrlist[a];throw new Error("Attribute unknown")},chem.Struct.Bond.prototype.hasRxnProps=function(){return!!this.reactingCenterStatus},chem.Struct.Bond.prototype.getCenter=function(a){var b=a.atoms.get(this.begin).pp,c=a.atoms.get(this.end).pp;return util.Vec2.lc2(b,.5,c,.5)},chem.Struct.Bond.prototype.getDir=function(a){var b=a.atoms.get(this.begin).pp,c=a.atoms.get(this.end).pp;return c.sub(b).normalized()},chem.Struct.Bond.prototype.clone=function(a){var b=new chem.Struct.Bond(this);return a&&(b.begin=a[b.begin],b.end=a[b.end]),b},chem.Struct.Bond.prototype.findOtherEnd=function(a){if(a==this.begin)return this.end;if(a==this.end)return this.begin;throw new Error("Bond end not found")},chem.HalfBond=function(a,b,c){if(3!=arguments.length)throw new Error("Invalid parameter number!");this.begin=a-0,this.end=b-0,this.bid=c-0,this.dir=new util.Vec2,this.norm=new util.Vec2,this.ang=0,this.p=new util.Vec2,this.loop=-1,this.contra=-1,this.next=-1,this.leftSin=0,this.leftCos=0,this.leftNeighbor=0,this.rightSin=0,this.rightCos=0,this.rightNeighbor=0},chem.Struct.prototype.initNeighbors=function(){this.atoms.each(function(a,b){b.neighbors=[]}),this.bonds.each(function(a,b){var c=this.atoms.get(b.begin),d=this.atoms.get(b.end);c.neighbors.push(b.hb1),d.neighbors.push(b.hb2)},this)},chem.Struct.prototype.bondInitHalfBonds=function(a,b){b=b||this.bonds.get(a),b.hb1=2*a,b.hb2=2*a+1,this.halfBonds.set(b.hb1,new chem.HalfBond(b.begin,b.end,a)),this.halfBonds.set(b.hb2,new chem.HalfBond(b.end,b.begin,a));var c=this.halfBonds.get(b.hb1),d=this.halfBonds.get(b.hb2);c.contra=b.hb2,d.contra=b.hb1},chem.Struct.prototype.halfBondUpdate=function(a){var b=this.halfBonds.get(a),c=this.atoms.get(b.begin).pp,d=this.atoms.get(b.end).pp,e=util.Vec2.diff(d,c).normalized();b.dir=util.Vec2.dist(d,c)>1e-4?e:new util.Vec2(1,0),b.norm=b.dir.turnLeft(),b.ang=b.dir.oxAngle(),b.loop<0&&(b.loop=-1)},chem.Struct.prototype.initHalfBonds=function(){this.halfBonds.clear(),this.bonds.each(this.bondInitHalfBonds,this)},chem.Struct.prototype.setHbNext=function(a,b){this.halfBonds.get(this.halfBonds.get(a).contra).next=b},chem.Struct.prototype.halfBondSetAngle=function(a,b){var c=this.halfBonds.get(a),d=this.halfBonds.get(b);d.rightCos=c.leftCos=util.Vec2.dot(d.dir,c.dir),d.rightSin=c.leftSin=util.Vec2.cross(d.dir,c.dir),c.leftNeighbor=b,d.rightNeighbor=a},chem.Struct.prototype.atomAddNeighbor=function(a){var b=this.halfBonds.get(a),c=this.atoms.get(b.begin),d=0;
for(d=0;d<c.neighbors.length&&!(this.halfBonds.get(c.neighbors[d]).ang>b.ang);++d);c.neighbors.splice(d,0,a);var e=c.neighbors[(d+1)%c.neighbors.length],f=c.neighbors[(d+c.neighbors.length-1)%c.neighbors.length];this.setHbNext(f,a),this.setHbNext(a,e),this.halfBondSetAngle(a,f),this.halfBondSetAngle(e,a)},chem.Struct.prototype.atomSortNeighbors=function(a){var b=this.atoms.get(a),c=this;b.neighbors=b.neighbors.sort(function(a,b){return c.halfBonds.get(a).ang-c.halfBonds.get(b).ang},this);var d;for(d=0;d<b.neighbors.length;++d)this.halfBonds.get(this.halfBonds.get(b.neighbors[d]).contra).next=b.neighbors[(d+1)%b.neighbors.length];for(d=0;d<b.neighbors.length;++d)this.halfBondSetAngle(b.neighbors[(d+1)%b.neighbors.length],b.neighbors[d])},chem.Struct.prototype.sortNeighbors=function(a){util.each(a,function(a){this.atomSortNeighbors(a)},this)},chem.Struct.prototype.atomUpdateHalfBonds=function(a){for(var b=this.atoms.get(a).neighbors,c=0;c<b.length;++c){var d=b[c];this.halfBondUpdate(d),this.halfBondUpdate(this.halfBonds.get(d).contra)}},chem.Struct.prototype.updateHalfBonds=function(a){util.each(a,function(a){this.atomUpdateHalfBonds(a)},this)},chem.Struct.prototype.sGroupsRecalcCrossBonds=function(){this.sgroups.each(function(a,b){b.xBonds=[],b.neiAtoms=[]},this),this.bonds.each(function(a,b){var c=this.atoms.get(b.begin),d=this.atoms.get(b.end);util.Set.each(c.sgs,function(c){if(!util.Set.contains(d.sgs,c)){var e=this.sgroups.get(c);e.xBonds.push(a),util.arrayAddIfMissing(e.neiAtoms,b.end)}},this),util.Set.each(d.sgs,function(d){if(!util.Set.contains(c.sgs,d)){var e=this.sgroups.get(d);e.xBonds.push(a),util.arrayAddIfMissing(e.neiAtoms,b.begin)}},this)},this)},chem.Struct.prototype.sGroupDelete=function(a){for(var b=this.sgroups.get(a),c=0;c<b.atoms.length;++c)util.Set.remove(this.atoms.get(b.atoms[c]).sgs,a);this.sGroupForest.remove(a),this.sgroups.remove(a)},chem.Struct.itemSetPos=function(a,b){a.pp=b},chem.Struct.prototype._itemSetPos=function(a,b,c,d){chem.Struct.itemSetPos(this[a].get(b),c,d)},chem.Struct.prototype._atomSetPos=function(a,b,c){this._itemSetPos("atoms",a,b,c)},chem.Struct.prototype._rxnPlusSetPos=function(a,b,c){this._itemSetPos("rxnPluses",a,b,c)},chem.Struct.prototype._rxnArrowSetPos=function(a,b,c){this._itemSetPos("rxnArrows",a,b,c)},chem.Struct.prototype.getCoordBoundingBox=function(a){var b=null,c=function(a){b?(b.min=util.Vec2.min(b.min,a),b.max=util.Vec2.max(b.max,a)):b={min:a,max:a}},d="undefined"==typeof a;return this.atoms.each(function(b,e){(d||util.Set.contains(a,b))&&c(e.pp)}),d&&(this.rxnPluses.each(function(a,b){c(b.pp)}),this.rxnArrows.each(function(a,b){c(b.pp)})),!b&&d&&(b={min:new util.Vec2(0,0),max:new util.Vec2(1,1)}),b},chem.Struct.prototype.getCoordBoundingBoxObj=function(){var a=null,b=function(b){a?(a.min=util.Vec2.min(a.min,b),a.max=util.Vec2.max(a.max,b)):a={min:new util.Vec2(b),max:new util.Vec2(b)}};return this.atoms.each(function(a,c){b(c.pp)}),a},chem.Struct.prototype.getBondLengthData=function(){var a=0,b=0;return this.bonds.each(function(c,d){a+=util.Vec2.dist(this.atoms.get(d.begin).pp,this.atoms.get(d.end).pp),b++},this),{cnt:b,totalLength:a}},chem.Struct.prototype.getAvgBondLength=function(){var a=this.getBondLengthData();return a.cnt>0?a.totalLength/a.cnt:-1},chem.Struct.prototype.getAvgClosestAtomDistance=function(){var a,b,c,d=0,e=0,f=this.atoms.keys();for(b=0;b<f.length;++b){for(a=-1,c=0;c<f.length;++c)c!=b&&(e=util.Vec2.dist(this.atoms.get(f[c]).pp,this.atoms.get(f[b]).pp),(0>a||a>e)&&(a=e));d+=a}return f.length>0?d/f.length:-1},chem.Struct.prototype.checkBondExists=function(a,b){var c=!1;return this.bonds.each(function(d,e){(e.begin==a&&e.end==b||e.end==a&&e.begin==b)&&(c=!0)},this),c},chem.Loop=function(a,b,c){this.hbs=a,this.dblBonds=0,this.aromatic=!0,this.convex=c||!1,util.each(a,function(a){var c=b.bonds.get(b.halfBonds.get(a).bid);c.type!=chem.Struct.BOND.TYPE.AROMATIC&&(this.aromatic=!1),c.type==chem.Struct.BOND.TYPE.DOUBLE&&this.dblBonds++},this)},chem.Struct.RxnPlus=function(a){a=a||{},this.pp=a.pp?new util.Vec2(a.pp):new util.Vec2},chem.Struct.RxnPlus.prototype.clone=function(){return new chem.Struct.RxnPlus(this)},chem.Struct.RxnArrow=function(a){a=a||{},this.pp=a.pp?new util.Vec2(a.pp):new util.Vec2},chem.Struct.RxnArrow.prototype.clone=function(){return new chem.Struct.RxnArrow(this)},chem.Struct.prototype.findConnectedComponent=function(a){for(var b={},c=[a],d=util.Set.empty();c.length>0;)(function(){var a=c.pop();b[a]=1,util.Set.add(d,a);for(var e=this.atoms.get(a),f=0;f<e.neighbors.length;++f){var g=this.halfBonds.get(e.neighbors[f]).end;util.Set.contains(d,g)||c.push(g)}}).apply(this);return d},chem.Struct.prototype.findConnectedComponents=function(a){this.halfBonds.count()||(this.initHalfBonds(),this.initNeighbors(),this.updateHalfBonds(this.atoms.keys()),this.sortNeighbors(this.atoms.keys()));var b={};this.atoms.each(function(a){b[a]=-1},this);var c=[];return this.atoms.each(function(d,e){if((a||e.fragment<0)&&b[d]<0){var f=this.findConnectedComponent(d);c.push(f),util.Set.each(f,function(a){b[a]=1},this)}},this),c},chem.Struct.prototype.markFragment=function(a){var b=this.frags.add(new chem.Struct.Fragment);util.Set.each(a,function(a){this.atoms.get(a).fragment=b},this)},chem.Struct.prototype.markFragmentByAtomId=function(a){this.markFragment(this.findConnectedComponent(a))},chem.Struct.prototype.markFragments=function(){for(var a=this.findConnectedComponents(),b=0;b<a.length;++b)this.markFragment(a[b])},chem.Struct.Fragment=function(){},chem.Struct.Fragment.prototype.clone=function(){return new chem.Struct.Fragment},chem.Struct.Fragment.getAtoms=function(a,b){var c=[];return a.atoms.each(function(a,d){d.fragment==b&&c.push(a)},this),c},chem.Struct.RGroup=function(a){a=a||{},this.frags=new util.Pool,this.resth=a.resth||!1,this.range=a.range||"",this.ifthen=a.ifthen||0},chem.Struct.RGroup.prototype.getAttrs=function(){return{resth:this.resth,range:this.range,ifthen:this.ifthen}},chem.Struct.RGroup.findRGroupByFragment=function(a,b){var c;return a.each(function(a,d){util.isUndefined(d.frags.keyOf(b))||(c=a)}),c},chem.Struct.RGroup.prototype.clone=function(a){var b=new chem.Struct.RGroup(this);return this.frags.each(function(c,d){b.frags.add(a?a[d]:d)}),b},chem.Struct.prototype.scale=function(a){1!=a&&(this.atoms.each(function(b,c){c.pp=c.pp.scaled(a)},this),this.rxnPluses.each(function(b,c){c.pp=c.pp.scaled(a)},this),this.rxnArrows.each(function(b,c){c.pp=c.pp.scaled(a)},this),this.sgroups.each(function(b,c){c.pp=c.pp?c.pp.scaled(a):null},this))},chem.Struct.prototype.rescale=function(){var a=this.getAvgBondLength();0>a&&!this.isReaction&&(a=this.getAvgClosestAtomDistance()),.001>a&&(a=1);var b=1/a;this.scale(b)},chem.Struct.prototype.loopHasSelfIntersections=function(a){for(var b=0;b<a.length;++b)for(var c=this.halfBonds.get(a[b]),d=this.atoms.get(c.begin).pp,e=this.atoms.get(c.end).pp,f=util.Set.fromList([c.begin,c.end]),g=b+2;g<a.length;++g){var h=this.halfBonds.get(a[g]);if(!util.Set.contains(f,h.begin)&&!util.Set.contains(f,h.end)){var i=this.atoms.get(h.begin).pp,j=this.atoms.get(h.end).pp;if(util.Vec2.segmentIntersection(d,e,i,j))return!0}}return!1},chem.Struct.prototype.partitionLoop=function(a){var b=[],c=!0;a:for(;c;){for(var d={},e=0;e<a.length;++e){var f=a[e],g=this.halfBonds.get(f).begin,h=this.halfBonds.get(f).end;if(h in d){var i=d[h],j=a.slice(i,e+1);b.push(j),e<a.length&&a.splice(i,e-i+1);continue a}d[g]=e}c=!1,b.push(a)}return b},chem.Struct.prototype.halfBondAngle=function(a,b){var c=this.halfBonds.get(a),d=this.halfBonds.get(b);return Math.atan2(util.Vec2.cross(c.dir,d.dir),util.Vec2.dot(c.dir,d.dir))},chem.Struct.prototype.loopIsConvex=function(a){for(var b=0;b<a.length;++b){var c=this.halfBondAngle(a[b],a[(b+1)%a.length]);if(c>0)return!1}return!0},chem.Struct.prototype.loopIsInner=function(a){for(var b=2*Math.PI,c=0;c<a.length;++c){var d=a[c],e=a[(c+1)%a.length],f=this.halfBonds.get(e),g=this.halfBondAngle(d,e);b+=f.contra==a[c]?Math.PI:g}return Math.abs(b)<Math.PI},chem.Struct.prototype.findLoops=function(){var a,b,c,d,e=[],f=util.Set.empty();return this.halfBonds.each(function(g,h){if(-1==h.loop)for(a=g,b=0,c=[];b<=this.halfBonds.count();a=this.halfBonds.get(a).next,++b){if(b>0&&a==g){var i=this.partitionLoop(c);util.each(i,function(a){this.loopIsInner(a)&&!this.loopHasSelfIntersections(a)?(d=util.arrayMin(a),this.loops.set(d,new chem.Loop(a,this,this.loopIsConvex(a)))):d=-2,util.each(a,function(a){this.halfBonds.get(a).loop=d,util.Set.add(f,this.halfBonds.get(a).bid)},this),d>=0&&e.push(d)},this);break}c.push(a)}},this),{newLoops:e,bondsToMark:util.Set.list(f)}},chem.Struct.prototype.prepareLoopStructure=function(){this.initHalfBonds(),this.initNeighbors(),this.updateHalfBonds(this.atoms.keys()),this.sortNeighbors(this.atoms.keys()),this.findLoops()},chem.Struct.prototype.atomAddToSGroup=function(a,b){chem.SGroup.addAtom(this.sgroups.get(a),b),util.Set.add(this.atoms.get(b).sgs,a)},!window.chem||!util.Vec2||!chem.Struct)throw new Error("Vec2 and Molecule should be defined first");if("undefined"==typeof String.prototype.trim&&(String.prototype.trim=function(){return String(this).replace(/^\s+|\s+$/g,"")}),isUndefined=function(a){return util.isUndefined(a)},chem.Molfile=function(){},chem.Molfile.loadRGroupFragments=!0,chem.Molfile.parseDecimalInt=function(a){var b=parseInt(a,10);return isNaN(b)?0:b},chem.Molfile.partitionLine=function(a,b,c){for(var d=[],e=0,f=0;e<b.length;++e)d.push(a.slice(f,f+b[e])),c&&f++,f+=b[e];return d},chem.Molfile.partitionLineFixed=function(a,b,c){for(var d=[],e=0;e<a.length;e+=b)d.push(a.slice(e,e+b)),c&&e++;return d},chem.Molfile.parseCTFile=function(a){var b=null;return b=0==a[0].search("\\$RXN")?chem.Molfile.parseRxn(a):chem.Molfile.parseMol(a),b.initHalfBonds(),b.initNeighbors(),b.markFragments(),b},chem.Molfile.fmtInfo={bondTypeMap:{1:chem.Struct.BOND.TYPE.SINGLE,2:chem.Struct.BOND.TYPE.DOUBLE,3:chem.Struct.BOND.TYPE.TRIPLE,4:chem.Struct.BOND.TYPE.AROMATIC,5:chem.Struct.BOND.TYPE.SINGLE_OR_DOUBLE,6:chem.Struct.BOND.TYPE.SINGLE_OR_AROMATIC,7:chem.Struct.BOND.TYPE.DOUBLE_OR_AROMATIC,8:chem.Struct.BOND.TYPE.ANY},bondStereoMap:{0:chem.Struct.BOND.STEREO.NONE,1:chem.Struct.BOND.STEREO.UP,4:chem.Struct.BOND.STEREO.EITHER,6:chem.Struct.BOND.STEREO.DOWN,3:chem.Struct.BOND.STEREO.CIS_TRANS},v30bondStereoMap:{0:chem.Struct.BOND.STEREO.NONE,1:chem.Struct.BOND.STEREO.UP,2:chem.Struct.BOND.STEREO.EITHER,3:chem.Struct.BOND.STEREO.DOWN},bondTopologyMap:{0:chem.Struct.BOND.TOPOLOGY.EITHER,1:chem.Struct.BOND.TOPOLOGY.RING,2:chem.Struct.BOND.TOPOLOGY.CHAIN},countsLinePartition:[3,3,3,3,3,3,3,3,3,3,3,6],atomLinePartition:[10,10,10,1,3,2,3,3,3,3,3,3,3,3,3,3,3],bondLinePartition:[3,3,3,3,3,3,3],atomListHeaderPartition:[3,1,1,4,1,1],atomListHeaderLength:11,atomListHeaderItemLength:4,chargeMap:[0,3,2,1,0,-1,-2,-3],valenceMap:[void 0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,0],implicitHydrogenMap:[void 0,0,1,2,3,4],v30atomPropMap:{CHG:"charge",RAD:"radical",MASS:"isotope",VAL:"explicitValence",HCOUNT:"hCount",INVRET:"invRet",SUBST:"substitutionCount",UNSAT:"unsaturatedAtom",RBCNT:"ringBondCount"},rxnItemsPartition:[3,3,3]},chem.Molfile.parseAtomLine=function(a){var b=chem.Molfile,c=b.partitionLine(a,b.fmtInfo.atomLinePartition),d={pp:new util.Vec2(parseFloat(c[0]),-parseFloat(c[1])),label:c[4].trim(),explicitValence:b.fmtInfo.valenceMap[b.parseDecimalInt(c[10])],massDifference:b.parseDecimalInt(c[5]),charge:b.fmtInfo.chargeMap[b.parseDecimalInt(c[6])],hCount:b.parseDecimalInt(b.parseDecimalInt(c[8])),stereoCare:0!=b.parseDecimalInt(c[9]),aam:b.parseDecimalInt(c[14]),invRet:b.parseDecimalInt(c[15]),exactChangeFlag:0!=b.parseDecimalInt(c[16])};return new chem.Struct.Atom(d)},chem.Molfile.stripV30=function(a){if("M  V30 "!=a.slice(0,7))throw Error("Prefix invalid");return a.slice(7)},chem.Molfile.parseAtomLineV3000=function(a){var b,c,d,e,f,g=chem.Molfile;b=g.spaceparsplit(a);var h={pp:new util.Vec2(parseFloat(b[2]),-parseFloat(b[3])),aam:b[5].trim()},i=b[1].trim();if('"'==i.charAt(0)&&'"'==i.charAt(i.length-1)&&(i=i.substr(1,i.length-2)),"]"==i.charAt(i.length-1)){i=i.substr(0,i.length-1);var j={};if(j.notList=!1,"NOT ["==i.substr(0,5))j.notList=!0,i=i.substr(5);else{if("["!=i.charAt(0))throw"Error: atom list expected, found '"+i+"'";i=i.substr(1)}j.ids=g.labelsListToIds(i.split(",")),h.atomList=new chem.Struct.AtomList(j),h.label="L#"}else h.label=i;for(b.splice(0,6),f=0;f<b.length;++f)if(c=g.splitonce(b[f],"="),d=c[0],e=c[1],d in g.fmtInfo.v30atomPropMap){var k=g.parseDecimalInt(e);if("VAL"==d){if(0==k)continue;-1==k&&(k=0)}h[g.fmtInfo.v30atomPropMap[d]]=k}else if("RGROUPS"==d){e=e.trim().substr(1,e.length-2);var l=e.split(" ").slice(1);h.rglabel=0;for(var m=0;m<l.length;++m)h.rglabel|=1<<l[m]-1}else"ATTCHPT"==d&&(h.attpnt=e.trim()-0);return new chem.Struct.Atom(h)},chem.Molfile.parseBondLineV3000=function(a){var b,c,d,e,f,g=chem.Molfile;b=g.spaceparsplit(a);var h={begin:g.parseDecimalInt(b[2])-1,end:g.parseDecimalInt(b[3])-1,type:g.fmtInfo.bondTypeMap[g.parseDecimalInt(b[1])]};for(b.splice(0,4),f=0;f<b.length;++f)c=g.splitonce(b[f],"="),d=c[0],e=c[1],"CFG"==d?(h.stereo=g.fmtInfo.v30bondStereoMap[g.parseDecimalInt(e)],h.type==chem.Struct.BOND.TYPE.DOUBLE&&h.stereo==chem.Struct.BOND.STEREO.EITHER&&(h.stereo=chem.Struct.BOND.STEREO.CIS_TRANS)):"TOPO"==d?h.topology=g.fmtInfo.bondTopologyMap[g.parseDecimalInt(e)]:"RXCTR"==d?h.reactingCenterStatus=g.parseDecimalInt(e):"STBOX"==d&&(h.stereoCare=g.parseDecimalInt(e));return new chem.Struct.Bond(h)},chem.Molfile.parseBondLine=function(a){var b=chem.Molfile,c=b.partitionLine(a,b.fmtInfo.bondLinePartition),d={begin:b.parseDecimalInt(c[0])-1,end:b.parseDecimalInt(c[1])-1,type:b.fmtInfo.bondTypeMap[b.parseDecimalInt(c[2])],stereo:b.fmtInfo.bondStereoMap[b.parseDecimalInt(c[3])],topology:b.fmtInfo.bondTopologyMap[b.parseDecimalInt(c[5])],reactingCenterStatus:b.parseDecimalInt(c[6])};return new chem.Struct.Bond(d)},chem.Molfile.parseAtomListLine=function(a){for(var b=chem.Molfile,c=b.partitionLine(a,b.fmtInfo.atomListHeaderPartition),d=b.parseDecimalInt(c[0])-1,e="T"==c[2].trim(),f=b.parseDecimalInt(c[4].trim()),g=a.slice(b.fmtInfo.atomListHeaderLength),h=[],i=b.fmtInfo.atomListHeaderItemLength,j=0;f>j;++j)h[j]=b.parseDecimalInt(g.slice(j*i,(j+1)*i-1));return{aid:d,atomList:new chem.Struct.AtomList({notList:e,ids:h})}},chem.Molfile.readKeyValuePairs=function(a,b){for(var c=chem.Molfile,d={},e=c.partitionLineFixed(a,3,!0),f=c.parseDecimalInt(e[0]),g=0;f>g;++g)d[c.parseDecimalInt(e[2*g+1])-1]=b?e[2*g+2].trim():c.parseDecimalInt(e[2*g+2]);return d},chem.Molfile.readKeyMultiValuePairs=function(a,b){for(var c=chem.Molfile,d=[],e=c.partitionLineFixed(a,3,!0),f=c.parseDecimalInt(e[0]),g=0;f>g;++g)d.push([c.parseDecimalInt(e[2*g+1])-1,b?e[2*g+2].trim():c.parseDecimalInt(e[2*g+2])]);return d},chem.Molfile.labelsListToIds=function(a){for(var b=[],c=0;c<a.length;++c)b.push(chem.Element.getElementByLabel(a[c].trim()));return b},chem.Molfile.parsePropertyLineAtomList=function(a,b){var c=chem.Molfile,d=c.parseDecimalInt(a[1])-1,e=c.parseDecimalInt(a[2]),f="T"==a[4].trim(),g=c.labelsListToIds(b.slice(0,e)),h={};return h[d]=new chem.Struct.AtomList({notList:f,ids:g}),h},chem.Molfile.initSGroup=function(a,b){var c=chem.Molfile,d=c.readKeyValuePairs(b,!0);for(var e in d){var f=d[e];if(!(f in chem.SGroup.TYPES))throw new Error("Unsupported S-group type");var g=new chem.SGroup(f);g.number=e,a[e]=g}},chem.Molfile.applySGroupProp=function(a,b,c,d,e){var f=chem.Molfile,g=f.readKeyValuePairs(c,!d);for(var h in g)(e?a[h]:a[h].data)[b]=g[h]},chem.Molfile.toIntArray=function(a){for(var b=chem.Molfile,c=[],d=0;d<a.length;++d)c[d]=b.parseDecimalInt(a[d]);return c},chem.Molfile.applySGroupArrayProp=function(a,b,c,d){var e=chem.Molfile,f=e.parseDecimalInt(c.slice(1,4))-1,g=e.parseDecimalInt(c.slice(4,8)),h=e.toIntArray(e.partitionLineFixed(c.slice(8),3,!0));if(h.length!=g)throw new Error("File format invalid");d&&util.apply(h,function(a){return a+d}),a[f][b]=a[f][b].concat(h)},chem.Molfile.applyDataSGroupName=function(a,b){a.data.fieldName=b},chem.Molfile.applyDataSGroupQuery=function(a,b){a.data.query=b},chem.Molfile.applyDataSGroupQueryOp=function(a,b){a.data.queryOp=b},chem.Molfile.applyDataSGroupDesc=function(a,b){var c=chem.Molfile,d=c.partitionLine(b,[4,31,2,20,2,3],!1),e=c.parseDecimalInt(d[0])-1,f=d[1].trim(),g=d[2].trim(),h=d[3].trim(),i=d[4].trim(),j=d[5].trim(),k=a[e];k.data.fieldType=g,k.data.fieldName=f,k.data.units=h,k.data.query=i,k.data.queryOp=j},chem.Molfile.applyDataSGroupInfo=function(a,b){var c=chem.Molfile,d=c.partitionLine(b,[10,10,4,1,1,1,3,3,3,3,2,3,2],!1),e=parseFloat(d[0]),f=parseFloat(d[1]),g="A"==d[3].trim(),h="A"==d[4].trim(),i="U"==d[5].trim(),j=d[7].trim();j="ALL"==j?-1:c.parseDecimalInt(j);var k=d[10].trim(),l=c.parseDecimalInt(d[11].trim());a.pp=new util.Vec2(e,-f),a.data.attached=g,a.data.absolute=h,a.data.showUnits=i,a.data.nCharsToDisplay=j,a.data.tagChar=k,a.data.daspPos=l},chem.Molfile.applyDataSGroupInfoLine=function(a,b){var c=chem.Molfile,d=c.parseDecimalInt(b.substr(0,4))-1,e=a[d];c.applyDataSGroupInfo(e,b.substr(5))},chem.Molfile.applyDataSGroupData=function(a,b,c){a.data.fieldValue=(a.data.fieldValue||"")+b,c&&(a.data.fieldValue=util.stripRight(a.data.fieldValue),a.data.fieldValue.startsWith('"')&&a.data.fieldValue.endsWith('"')&&(a.data.fieldValue=a.data.fieldValue.substr(1,a.data.fieldValue.length-2)),a.data.fieldValue+="\n")},chem.Molfile.applyDataSGroupDataLine=function(a,b,c){var d=chem.Molfile,e=d.parseDecimalInt(b.substr(0,5))-1,f=b.substr(5),g=a[e];d.applyDataSGroupData(g,f,c)},chem.Molfile.parsePropertyLines=function(a,b,c,d,e,f){for(var g=chem.Molfile,h=new util.Map;d>c;){var i=b[c];if("A"==i.charAt(0))h.get("label")||h.set("label",new util.Map),h.get("label").set(g.parseDecimalInt(i.slice(3,6))-1,b[++c]);else if("M"==i.charAt(0)){var j=i.slice(3,6),k=i.slice(6);if("END"==j)break;if("CHG"==j)h.get("charge")||h.set("charge",new util.Map),h.get("charge").update(g.readKeyValuePairs(k));else if("RAD"==j)h.get("radical")||h.set("radical",new util.Map),h.get("radical").update(g.readKeyValuePairs(k));else if("ISO"==j)h.get("isotope")||h.set("isotope",new util.Map),h.get("isotope").update(g.readKeyValuePairs(k));else if("RBC"==j)h.get("ringBondCount")||h.set("ringBondCount",new util.Map),h.get("ringBondCount").update(g.readKeyValuePairs(k));else if("SUB"==j)h.get("substitutionCount")||h.set("substitutionCount",new util.Map),h.get("substitutionCount").update(g.readKeyValuePairs(k));else if("UNS"==j)h.get("unsaturatedAtom")||h.set("unsaturatedAtom",new util.Map),h.get("unsaturatedAtom").update(g.readKeyValuePairs(k));else if("RGP"==j){h.get("rglabel")||h.set("rglabel",new util.Map);for(var l=h.get("rglabel"),m=g.readKeyMultiValuePairs(k),n=0;n<m.length;n++){var o=m[n];l.set(o[0],(l.get(o[0])||0)|1<<o[1]-1)}}else if("LOG"==j){k=k.slice(4);var p=g.parseDecimalInt(k.slice(0,3).trim()),q=g.parseDecimalInt(k.slice(4,7).trim()),r=g.parseDecimalInt(k.slice(8,11).trim()),s=k.slice(12).trim(),t={};q>0&&(t.ifthen=q),t.resth=1==r,t.range=s,f[p]=t}else if("APO"==j)h.get("attpnt")||h.set("attpnt",new util.Map),h.get("attpnt").update(g.readKeyValuePairs(k));else if("ALS"==j){h.get("atomList")||h.set("atomList",new util.Map);var u=g.parsePropertyLineAtomList(g.partitionLine(k,[1,3,3,1,1,1]),g.partitionLineFixed(k.slice(10),4,!1));h.get("atomList").update(u),h.get("label")||h.set("label",new util.Map);for(var v in u)h.get("label").set(v,"L#")}else if("STY"==j)g.initSGroup(e,k);else if("SST"==j)g.applySGroupProp(e,"subtype",k);else if("SLB"==j)g.applySGroupProp(e,"label",k,!0);else if("SPL"==j)g.applySGroupProp(e,"parent",k,!0,!0);else if("SCN"==j)g.applySGroupProp(e,"connectivity",k);else if("SAL"==j)g.applySGroupArrayProp(e,"atoms",k,-1);else if("SBL"==j)g.applySGroupArrayProp(e,"bonds",k,-1);else if("SPA"==j)g.applySGroupArrayProp(e,"patoms",k,-1);else if("SMT"==j){var w=g.parseDecimalInt(k.slice(0,4))-1;e[w].data.subscript=k.slice(4).trim()}else"SDT"==j?g.applyDataSGroupDesc(e,k):"SDD"==j?g.applyDataSGroupInfoLine(e,k):"SCD"==j?g.applyDataSGroupDataLine(e,k,!1):"SED"==j&&g.applyDataSGroupDataLine(e,k,!0)}++c}return h},chem.Molfile.applyAtomProp=function(a,b,c){b.each(function(b,d){a.get(b)[c]=d})},chem.Molfile.parseCTabV2000=function(a,b){var c,d=new chem.Struct,e=chem.Molfile,f=e.parseDecimalInt(b[0]),g=e.parseDecimalInt(b[1]),h=e.parseDecimalInt(b[2]);d.isChiral=0!=e.parseDecimalInt(b[4]);var i=e.parseDecimalInt(b[5]),j=e.parseDecimalInt(b[10]),k=0,l=a.slice(k,k+f);k+=f;var m=a.slice(k,k+g);k+=g;var n=a.slice(k,k+h);k+=h+i;var o=l.map(e.parseAtomLine);for(c=0;c<o.length;++c)d.atoms.add(o[c]);var p=m.map(e.parseBondLine);for(c=0;c<p.length;++c)d.bonds.add(p[c]);var q=n.map(e.parseAtomListLine);util.each(q,function(a){d.atoms.get(a.aid).atomList=a.atomList,d.atoms.get(a.aid).label="L#"});var r={},s={},t=e.parsePropertyLines(d,a,k,Math.min(a.length,k+j),r,s);t.each(function(a,b){e.applyAtomProp(d.atoms,b,a)});var u,v={};for(u in r){var w=r[u];if("DAT"===w.type&&0===w.atoms.length){var x=r[u].parent;if(x>=0){var y=r[x-1];"GEN"===y.type&&(w.atoms=util.array(y.atoms))}}}for(u in r)chem.SGroup.addGroup(d,r[u],v);var z=[];for(u in r)chem.SGroup.filter(d,r[u],v),0!=r[u].atoms.length||r[u].allAtoms||z.push(u);for(c=0;c<z.length;++c)d.sGroupForest.remove(z[c]),d.sgroups.remove(z[c]);for(var A in s)d.rgroups.set(A,new chem.Struct.RGroup(s[A]));return d},chem.Molfile.spaceparsplit=function(a){var b,c,d=[],e=0,f=-1,g=a.toArray(),h=!1;for(c=0;c<a.length;++c)b=g[c],"("==b?e++:")"==b&&e--,'"'==b&&(h=!h),h||" "!=g[c]||0!=e||(c>f+1&&d.push(a.slice(f+1,c)),f=c);return c>f+1&&d.push(a.slice(f+1,c)),f=c,d},chem.Molfile.splitonce=function(a,b){var c=a.indexOf(b);return[a.slice(0,c),a.slice(c+1)]},chem.Molfile.splitSGroupDef=function(a){for(var b=[],c=0,d=!1,e=0;e<a.length;++e){var f=a.charAt(e);'"'==f?d=!d:d||("("==f?c++:")"==f?c--:" "==f&&0==c&&(b.push(a.slice(0,e)),a=a.slice(e+1).trim(),e=0))}if(0!=c)throw"Brace balance broken. S-group properies invalid!";return a.length>0&&b.push(a.trim()),b},chem.Molfile.parseBracedNumberList=function(a,b){if(!a)return null;var c=[];a=a.trim(),a=a.substr(1,a.length-2);var d=a.split(" ");b=b||0;for(var e=1;e<d.length;++e)c.push(d[e]-0+b);return c},chem.Molfile.v3000parseCollection=function(a,b,c){for(c++;"M  V30 END COLLECTION"!=b[c].trim();)c++;return c++,c},chem.Molfile.v3000parseSGroup=function(a,b,c,d,e){var f=chem.Molfile,g="";for(e++;e<b.length;){if(g=f.stripV30(b[e++]).trim(),"END SGROUP"==g.trim())return e;for(;"-"==g.charAt(g.length-1);)g=(g.substr(0,g.length-1)+f.stripV30(b[e++])).trim();var h=f.splitSGroupDef(g),i=h[1],j=new chem.SGroup(i);j.number=h[0]-0,j.type=i,j.label=h[2]-0,c[j.number]=j;for(var k={},l=3;l<h.length;++l){var m=f.splitonce(h[l],"=");if(2!=m.length)throw"A record of form AAA=BBB or AAA=(...) expected, got '"+h[l]+"'";var n=m[0];n in k||(k[n]=[]),k[n].push(m[1])}j.atoms=f.parseBracedNumberList(k.ATOMS[0],-1),k.PATOMS&&(j.patoms=f.parseBracedNumberList(k.PATOMS[0],-1)),j.bonds=k.BONDS?f.parseBracedNumberList(k.BONDS[0],-1):[];var o=k.BRKXYZ;if(j.brkxyz=[],o)for(var p=0;p<o.length;++p)j.brkxyz.push(f.parseBracedNumberList(o[p]));k.MULT&&(j.data.subscript=k.MULT[0]-0),k.LABEL&&(j.data.subscript=k.LABEL[0].trim()),k.CONNECT&&(j.data.connectivity=k.CONNECT[0].toLowerCase()),k.FIELDDISP&&f.applyDataSGroupInfo(j,util.stripQuotes(k.FIELDDISP[0])),k.FIELDDATA&&f.applyDataSGroupData(j,k.FIELDDATA[0],!0),k.FIELDNAME&&f.applyDataSGroupName(j,k.FIELDNAME[0]),k.QUERYTYPE&&f.applyDataSGroupQuery(j,k.QUERYTYPE[0]),k.QUERYOP&&f.applyDataSGroupQueryOp(j,k.QUERYOP[0]),chem.SGroup.addGroup(a,j,d)}throw new Error("S-group declaration incomplete.")},chem.Molfile.parseCTabV3000=function(a,b){var c=new chem.Struct,d=chem.Molfile,e=0;if("M  V30 BEGIN CTAB"!=a[e++].trim())throw Error("CTAB V3000 invalid");if("M  V30 COUNTS"!=a[e].slice(0,13))throw Error("CTAB V3000 invalid");var f=a[e].slice(14).split(" ");if(c.isChiral=1==d.parseDecimalInt(f[4]),e++,"M  V30 BEGIN ATOM"==a[e].trim()){e++;for(var g;e<a.length&&(g=d.stripV30(a[e++]).trim(),"END ATOM"!=g);){for(;"-"==g.charAt(g.length-1);)g=(g.substring(0,g.length-1)+d.stripV30(a[e++])).trim();c.atoms.add(d.parseAtomLineV3000(g))}if("M  V30 BEGIN BOND"==a[e].trim())for(e++;e<a.length&&(g=d.stripV30(a[e++]).trim(),"END BOND"!=g);){for(;"-"==g.charAt(g.length-1);)g=(g.substring(0,g.length-1)+d.stripV30(a[e++])).trim();c.bonds.add(d.parseBondLineV3000(g))}for(var h={},i={};"M  V30 END CTAB"!=a[e].trim();)if("M  V30 BEGIN COLLECTION"==a[e].trim())e=d.v3000parseCollection(c,a,e);else{if("M  V30 BEGIN SGROUP"!=a[e].trim())throw Error("CTAB V3000 invalid");e=d.v3000parseSGroup(c,a,h,i,e)}}if("M  V30 END CTAB"!=a[e++].trim())throw Error("CTAB V3000 invalid");return b||d.readRGroups3000(c,a.slice(e)),c},chem.Molfile.readRGroups3000=function(a,b){for(var c={},d={},e=0,f=chem.Molfile;e<b.length&&0==b[e].search("M  V30 BEGIN RGROUP");){var g=b[e++].split(" ").pop();for(c[g]=[],d[g]={};;){var h=b[e].trim();if(0!=h.search("M  V30 RLOGIC")){if("M  V30 BEGIN CTAB"!=h)throw Error("CTAB V3000 invalid");for(var i=0;i<b.length&&"M  V30 END CTAB"!=b[e+i].trim();++i);var j=b.slice(e,e+i+1),k=this.parseCTabV3000(j,!0);if(c[g].push(k),e=e+i+1,"M  V30 END RGROUP"==b[e].trim()){e++;break}}else{h=h.slice(13);var l=h.trim().split(/\s+/g),m=f.parseDecimalInt(l[0]),n=f.parseDecimalInt(l[1]),o=l.slice(2).join(" "),p={};m>0&&(p.ifthen=m),p.resth=1==n,p.range=o,d[g]=p,e++}}}for(var q in c)for(var r=0;r<c[q].length;++r){var s=c[q][r];s.rgroups.set(q,new chem.Struct.RGroup(d[q]));var t=s.frags.add(new chem.Struct.Fragment);s.rgroups.get(q).frags.add(t),s.atoms.each(function(a,b){b.fragment=t}),s.mergeInto(a)}},chem.Molfile.parseMol=function(a){if(0==a[0].search("\\$MDL"))return this.parseRg2000(a);var b=this.parseCTab(a.slice(3));return b.name=a[0].trim(),b},chem.Molfile.parseCTab=function(a){var b=chem.Molfile,c=b.partitionLine(a[0],b.fmtInfo.countsLinePartition),d=c[11].trim();if(a=a.slice(1),"V2000"==d)return this.parseCTabV2000(a,c);if("V3000"==d)return this.parseCTabV3000(a,!chem.Molfile.loadRGroupFragments);throw Error("Molfile version unknown: "+d)},chem.MolfileSaver=function(a){this.molecule=null,this.molfile=null,this.v3000=a||!1},chem.MolfileSaver.prototype.prepareSGroups=function(a){var b=this.molecule,c=(b.sgroups,[]);if(util.each(this.molecule.sGroupForest.getSGroupsBFS().reverse(),function(d){var e=b.sgroups.get(d);try{e.prepareForSaving(b)}catch(f){if(ui.forwardExceptions)throw f;if(!a||"number"!=typeof f.id)throw f;c.push(f.id)}},this),c.length>0)throw new Error(c.length.toString()+" invalid S-groups were detected. They will be omitted.");for(var d=0;d<c.length;++d)b.sGroupDelete(c[d]);return b},chem.MolfileSaver.getComponents=function(a){var b=a.findConnectedComponents(!0),c=[],d=null;a.rxnArrows.each(function(a,b){d=b.pp.x}),a.rxnPluses.each(function(a,b){c.push(b.pp.x)}),null!=d&&c.push(d),c.sort(function(a,b){return a-b});var e,f=[];for(e=0;e<b.length;++e){for(var g=a.getCoordBoundingBox(b[e]),h=util.Vec2.lc2(g.min,.5,g.max,.5),i=0;h.x>c[i];)++i;f[i]=f[i]||{},util.Set.mergeIn(f[i],b[e])}var j=[],k=[],l=[];for(e=0;e<f.length;++e)f[e]?(g=a.getCoordBoundingBox(f[e]),h=util.Vec2.lc2(g.min,.5,g.max,.5),h.x<d?k.push(f[e]):l.push(f[e])):j.push("");return{reactants:k,products:l}},chem.MolfileSaver.prototype.getCTab=function(a,b){return this.molecule=a.clone(),this.molfile="",this.writeCTab2000(b),this.molfile},chem.MolfileSaver.prototype.saveMolecule=function(a,b,c){if(this.reaction=a.rxnArrows.count()>0,a.rxnArrows.count()>1)throw new Error("Reaction may not contain more than one arrow");if(this.molfile="",this.reaction){if(a.rgroups.count()>0)throw new Error("Unable to save the structure - reactions with r-groups are not supported at the moment");var d=chem.MolfileSaver.getComponents(a),e=d.reactants,f=d.products,g=e.concat(f);this.molfile="$RXN\n\n\n\n"+util.paddedInt(e.length,3)+util.paddedInt(f.length,3)+util.paddedInt(0,3)+"\n";for(var h=0;h<g.length;++h){var i=new chem.MolfileSaver(!1),j=a.clone(g[h],null,!0),k=i.saveMolecule(j,!1,!0);this.molfile+="$MOL\n"+k}return this.molfile}if(a.rgroups.count()>0){if(!c){var l=new chem.MolfileSaver(!1).getCTab(a.getScaffold(),a.rgroups);return this.molfile="$MDL  REV  1\n$MOL\n$HDR\n\n\n\n$END HDR\n",this.molfile+="$CTAB\n"+l+"$END CTAB\n",a.rgroups.each(function(b,c){this.molfile+="$RGP\n",this.writePaddedNumber(b,3),this.molfile+="\n",c.frags.each(function(b,c){var d=new chem.MolfileSaver(!1).getCTab(a.getFragment(c));this.molfile+="$CTAB\n"+d+"$END CTAB\n"},this),this.molfile+="$END RGP\n"},this),this.molfile+="$END MOL\n",this.molfile}a=a.getScaffold()}return this.molecule=a.clone(),this.prepareSGroups(b),this.writeHeader(),this.writeCTab2000(),this.molfile},chem.MolfileSaver.prototype.writeHeader=function(){var a=new Date;this.writeCR(),this.writeWhiteSpace(2),this.write("Ketcher"),this.writeWhiteSpace(),this.writeCR((a.getMonth()+1).toPaddedString(2)+a.getDate().toPaddedString(2)+(a.getFullYear()%100).toPaddedString(2)+a.getHours().toPaddedString(2)+a.getMinutes().toPaddedString(2)+"2D 1   1.00000     0.00000     0"),this.writeCR()},chem.MolfileSaver.prototype.write=function(a){this.molfile+=a},chem.MolfileSaver.prototype.writeCR=function(a){0==arguments.length&&(a=""),this.molfile+=a+"\n"},chem.MolfileSaver.prototype.writeWhiteSpace=function(a){0==arguments.length&&(a=1),a.times(function(){this.write(" ")},this)},chem.MolfileSaver.prototype.writePadded=function(a,b){this.write(a),this.writeWhiteSpace(b-a.length)},chem.MolfileSaver.prototype.writePaddedNumber=function(a,b){var c=(a-0).toString();this.writeWhiteSpace(b-c.length),this.write(c)},chem.MolfileSaver.prototype.writePaddedFloat=function(a,b,c){this.write(util.paddedFloat(a,b,c))},chem.MolfileSaver.prototype.writeCTab2000Header=function(){this.writePaddedNumber(this.molecule.atoms.count(),3),this.writePaddedNumber(this.molecule.bonds.count(),3),this.writePaddedNumber(0,3),this.writeWhiteSpace(3),this.writePaddedNumber(this.molecule.isChiral?1:0,3),this.writePaddedNumber(0,3),this.writeWhiteSpace(12),this.writePaddedNumber(999,3),this.writeCR(" V2000")},chem.MolfileSaver.prototype.writeCTab2000=function(a){this.writeCTab2000Header(),this.mapping={};var b=1,c=[],d=[];for(this.molecule.atoms.each(function(a,e){this.writePaddedFloat(e.pp.x,10,4),this.writePaddedFloat(-e.pp.y,10,4),this.writePaddedFloat(0,10,4),this.writeWhiteSpace();var f=e.label;null!=e.atomList?(f="L",c.push(a)):null==chem.Element.getElementByLabel(f)&&-1==["A","Q","X","*","R#"].indexOf(f)&&(f="C",d.push(a)),this.writePadded(f,3),this.writePaddedNumber(0,2),this.writePaddedNumber(0,3),this.writePaddedNumber(0,3),isUndefined(e.hCount)&&(e.hCount=0),this.writePaddedNumber(e.hCount,3),isUndefined(e.stereoCare)&&(e.stereoCare=0),this.writePaddedNumber(e.stereoCare,3),this.writePaddedNumber(e.explicitValence<0?0:0==e.explicitValence?15:e.explicitValence,3),this.writePaddedNumber(0,3),this.writePaddedNumber(0,3),this.writePaddedNumber(0,3),isUndefined(e.aam)&&(e.aam=0),this.writePaddedNumber(e.aam,3),isUndefined(e.invRet)&&(e.invRet=0),this.writePaddedNumber(e.invRet,3),isUndefined(e.exactChangeFlag)&&(e.exactChangeFlag=0),this.writePaddedNumber(e.exactChangeFlag,3),this.writeCR(),this.mapping[a]=b,b++},this),this.bondMapping={},b=1,this.molecule.bonds.each(function(a,c){this.bondMapping[a]=b++,this.writePaddedNumber(this.mapping[c.begin],3),this.writePaddedNumber(this.mapping[c.end],3),this.writePaddedNumber(c.type,3),isUndefined(c.stereo)&&(c.stereo=0),this.writePaddedNumber(c.stereo,3),this.writeWhiteSpace(3),isUndefined(c.topology)&&(c.topology=0),this.writePaddedNumber(c.topology,3),isUndefined(c.reactingCenterStatus)&&(c.reactingCenterStatus=0),this.writePaddedNumber(c.reactingCenterStatus,3),this.writeCR()},this);d.length>0;)this.write("A  "),this.writePaddedNumber(d[0]+1,3),this.writeCR(),this.writeCR(this.molecule.atoms.get(d[0]).label),d.splice(0,1);var e=new Array,f=new Array,g=new Array,h=new Array,i=new Array,j=new Array,k=new Array,l=new Array,m=new Array;
this.molecule.atoms.each(function(a,b){if(0!=b.charge&&e.push([a,b.charge]),0!=b.isotope&&f.push([a,b.isotope]),0!=b.radical&&g.push([a,b.radical]),null!=b.rglabel&&"R#"==b.label)for(var c=0;32>c;c++)b.rglabel&1<<c&&h.push([a,c+1]);null!=b.attpnt&&j.push([a,b.attpnt]),0!=b.ringBondCount&&k.push([a,b.ringBondCount]),0!=b.substitutionCount&&m.push([a,b.substitutionCount]),0!=b.unsaturatedAtom&&l.push([a,b.unsaturatedAtom])}),a&&a.each(function(a,b){if(b.resth||b.ifthen>0||b.range.length>0){var c="  1 "+util.paddedInt(a,3)+" "+util.paddedInt(b.ifthen,3)+" "+util.paddedInt(b.resth?1:0,3)+"   "+b.range;i.push(c)}});var n=function(a,b){for(;b.length>0;){for(var c=new Array;b.length>0&&c.length<8;)c.push(b[0]),b.splice(0,1);this.write(a),this.writePaddedNumber(c.length,3),util.each(c,function(a){this.writeWhiteSpace(),this.writePaddedNumber(this.mapping[a[0]],3),this.writeWhiteSpace(),this.writePaddedNumber(a[1],3)},this),this.writeCR()}};n.call(this,"M  CHG",e),n.call(this,"M  ISO",f),n.call(this,"M  RAD",g),n.call(this,"M  RGP",h);for(var o=0;o<i.length;++o)this.write("M  LOG"+i[o]+"\n");if(n.call(this,"M  APO",j),n.call(this,"M  RBC",k),n.call(this,"M  SUB",m),n.call(this,"M  UNS",l),c.length>0)for(o=0;o<c.length;++o){var p=c[o],q=this.molecule.atoms.get(p).atomList;this.write("M  ALS"),this.writePaddedNumber(p+1,4),this.writePaddedNumber(q.ids.length,3),this.writeWhiteSpace(),this.write(q.notList?"T":"F");for(var r=q.labelList(),s=0;s<r.length;++s)this.writeWhiteSpace(),this.writePadded(r[s],3);this.writeCR()}var t={},u=1,v={},w=this.molecule.sGroupForest.getSGroupsBFS();util.each(w,function(a){v[u]=a,t[a]=u++},this);for(var x=1;u>x;++x){var y=v[x],z=this.molecule.sgroups.get(y);this.write("M  STY"),this.writePaddedNumber(1,3),this.writeWhiteSpace(1),this.writePaddedNumber(x,3),this.writeWhiteSpace(1),this.writePadded(z.type,3),this.writeCR(),this.write("M  SLB"),this.writePaddedNumber(1,3),this.writeWhiteSpace(1),this.writePaddedNumber(x,3),this.writeWhiteSpace(1),this.writePaddedNumber(x,3),this.writeCR();var A=this.molecule.sGroupForest.parent.get(y);if(A>=0&&(this.write("M  SPL"),this.writePaddedNumber(1,3),this.writeWhiteSpace(1),this.writePaddedNumber(x,3),this.writeWhiteSpace(1),this.writePaddedNumber(t[A],3),this.writeCR()),"SRU"==z.type&&z.data.connectivity){var B="";B+=" ",B+=util.stringPadded(x.toString(),3),B+=" ",B+=util.stringPadded(z.data.connectivity,3,!0),this.write("M  SCN"),this.writePaddedNumber(1,3),this.write(B.toUpperCase()),this.writeCR()}"SRU"==z.type&&(this.write("M  SMT "),this.writePaddedNumber(x,3),this.writeWhiteSpace(),this.write(z.data.subscript||"n"),this.writeCR()),this.writeCR(z.saveToMolfile(this.molecule,t,this.mapping,this.bondMapping))}this.writeCR("M  END")},chem.Molfile.parseRxn=function(a){var b=chem.Molfile,c=a[0].trim().split(" ");return c.length>1&&"V3000"==c[1]?b.parseRxn3000(a):b.parseRxn2000(a)},chem.Molfile.parseRxn2000=function(a){var b=chem.Molfile;a=a.slice(4);var c=b.partitionLine(a[0],b.fmtInfo.rxnItemsPartition),d=c[0]-0,e=c[1]-0,f=c[2]-0;a=a.slice(1);for(var g=[];a.length>0&&"$MOL"==a[0].substr(0,4);){a=a.slice(1);for(var h=0;h<a.length&&"$MOL"!=a[h].substr(0,4);)h++;g.push(chem.Molfile.parseMol(a.slice(0,h))),a=a.slice(h)}return b.rxnMerge(g,d,e,f)},chem.Molfile.parseRxn3000=function(a){var b=chem.Molfile;a=a.slice(4);for(var c=a[0].split(/\s+/g).slice(3),d=c[0]-0,e=c[1]-0,f=c.length>2?c[2]-0:0,g=function(a){util.assert(a,"CTab format invalid")},h=function(b){for(var c=b;c<a.length;++c)if("M  V30 END CTAB"==a[c].trim())return c;g(!1)},i=function(b){for(var c=b;c<a.length;++c)if("M  V30 END RGROUP"==a[c].trim())return c;g(!1)},j=[],k=[],l=null,m=[],n=0;n<a.length;++n){var o=a[n].trim();if(o.startsWith("M  V30 COUNTS"));else{if("M  END"==o)break;if("M  V30 BEGIN PRODUCT"==o)g(null==l),l=k;else if("M  V30 END PRODUCT"==o)g(l===k),l=null;else if("M  V30 BEGIN REACTANT"==o)g(null==l),l=j;else if("M  V30 END REACTANT"==o)g(l===j),l=null;else if(o.startsWith("M  V30 BEGIN RGROUP")){g(null==l);var p=i(n);m.push(a.slice(n,p+1)),n=p}else{if("M  V30 BEGIN CTAB"!=o)throw new Error("Line unrecognized: "+o);var p=h(n);l.push(a.slice(n,p+1)),n=p}}}for(var q=[],r=j.concat(k),p=0;p<r.length;++p){var s=chem.Molfile.parseCTabV3000(r[p],c);q.push(s)}var t=b.rxnMerge(q,d,e,f);return b.readRGroups3000(t,function(a){for(var b=[],c=0;c<a.length;++c)b=b.concat(a[c]);return b}(m)),t},chem.Molfile.rxnMerge=function(a,b,c){var d,e=(chem.Molfile,new chem.Struct),f=[],g=[],h=[],i=[],j=[],k=[],l={cnt:0,totalLength:0};for(d=0;d<a.length;++d){var m=a[d],n=m.getBondLengthData();l.cnt+=n.cnt,l.totalLength+=n.totalLength}var o=1/(0==l.cnt?1:l.totalLength/l.cnt);for(d=0;d<a.length;++d)m=a[d],m.scale(o);for(d=0;d<a.length;++d){m=a[d];var p=m.getCoordBoundingBoxObj();if(p){var q=b>d?chem.Struct.FRAGMENT.REACTANT:b+c>d?chem.Struct.FRAGMENT.PRODUCT:chem.Struct.FRAGMENT.AGENT;q==chem.Struct.FRAGMENT.REACTANT?(f.push(p),i.push(m)):q==chem.Struct.FRAGMENT.AGENT?(g.push(p),j.push(m)):q==chem.Struct.FRAGMENT.PRODUCT&&(h.push(p),k.push(m)),m.atoms.each(function(a,b){b.rxnFragmentType=q})}}var r=0,s=function(a,b,c,d,e){var f=new util.Vec2(d-c.min.x,e?1-c.min.y:-(c.min.y+c.max.y)/2);return b.atoms.each(function(a,b){b.pp.add_(f)}),b.sgroups.each(function(a,b){b.pp&&b.pp.add_(f)}),c.min.add_(f),c.max.add_(f),b.mergeInto(a),c.max.x-c.min.x};for(d=0;d<i.length;++d)r+=s(e,i[d],f[d],r,!1)+2;for(r+=2,d=0;d<j.length;++d)r+=s(e,j[d],g[d],r,!0)+2;for(r+=2,d=0;d<k.length;++d)r+=s(e,k[d],h[d],r,!1)+2;var t,u,v,w,x=null,y=null;for(d=0;d<f.length-1;++d)t=f[d],u=f[d+1],v=(t.max.x+u.min.x)/2,w=(t.max.y+t.min.y+u.max.y+u.min.y)/4,e.rxnPluses.add(new chem.Struct.RxnPlus({pp:new util.Vec2(v,w)}));for(d=0;d<f.length;++d)0==d?(x={},x.max=new util.Vec2(f[d].max),x.min=new util.Vec2(f[d].min)):(x.max=util.Vec2.max(x.max,f[d].max),x.min=util.Vec2.min(x.min,f[d].min));for(d=0;d<h.length-1;++d)t=h[d],u=h[d+1],v=(t.max.x+u.min.x)/2,w=(t.max.y+t.min.y+u.max.y+u.min.y)/4,e.rxnPluses.add(new chem.Struct.RxnPlus({pp:new util.Vec2(v,w)}));for(d=0;d<h.length;++d)0==d?(y={},y.max=new util.Vec2(h[d].max),y.min=new util.Vec2(h[d].min)):(y.max=util.Vec2.max(y.max,h[d].max),y.min=util.Vec2.min(y.min,h[d].min));if(t=x,u=y,t||u){var z=t?new util.Vec2(t.max.x,(t.max.y+t.min.y)/2):null,A=u?new util.Vec2(u.min.x,(u.max.y+u.min.y)/2):null,B=3;z||(z=new util.Vec2(A.x-B,A.y)),A||(A=new util.Vec2(z.x+B,z.y)),e.rxnArrows.add(new chem.Struct.RxnArrow({pp:util.Vec2.lc2(z,.5,A,.5)}))}else e.rxnArrows.add(new chem.Struct.RxnArrow({pp:new util.Vec2(0,0)}));return e.isReaction=!0,e},chem.Molfile.rgMerge=function(a,b){var c=new chem.Struct;a.mergeInto(c,null,null,!1,!0);for(var d in b)for(var e=0;e<b[d].length;++e){var f=b[d][e];f.rgroups.set(d,new chem.Struct.RGroup);var g=f.frags.add(new chem.Struct.Fragment);f.rgroups.get(d).frags.add(g),f.atoms.each(function(a,b){b.fragment=g}),f.mergeInto(c)}return c},chem.Molfile.parseRg2000=function(a){var b=chem.Molfile;if(a=a.slice(7),"$CTAB"!=a[0].trim())throw new Error("RGFile format invalid");for(var c=1;"$"!=a[c].charAt(0);)c++;if("$END CTAB"!=a[c].trim())throw new Error("RGFile format invalid");var d=a.slice(1,c);a=a.slice(c+1);for(var e={};;){if(0==a.length)throw new Error("Unexpected end of file");var f=a[0].trim();if("$END MOL"==f){a=a.slice(1);break}if("$RGP"!=f)throw new Error("RGFile format invalid");var g=a[1].trim()-0;for(e[g]=[],a=a.slice(2);;){if(0==a.length)throw new Error("Unexpected end of file");if(f=a[0].trim(),"$END RGP"==f){a=a.slice(1);break}if("$CTAB"!=f)throw new Error("RGFile format invalid");for(c=1;"$"!=a[c].charAt(0);)c++;if("$END CTAB"!=a[c].trim())throw new Error("RGFile format invalid");e[g].push(a.slice(1,c)),a=a.slice(c+1)}}var h=chem.Molfile.parseCTab(d),i={};if(chem.Molfile.loadRGroupFragments)for(var j in e){i[j]=[];for(var k=0;k<e[j].length;++k)i[j].push(chem.Molfile.parseCTab(e[j][k]))}return b.rgMerge(h,i)},!window.chem||!util.Vec2||!util.Pool)throw new Error("Vec2, Pool should be defined first");if(chem.SGroup=function(a){if(!(a&&a in chem.SGroup.TYPES))throw new Error("Invalid or unsupported s-group type");this.type=a,this.id=-1,chem.SGroup.equip(this,a),this.label=-1,this.bracketBox=null,this.bracketDir=new util.Vec2(1,0),this.areas=[],this.highlight=!1,this.highlighting=null,this.selected=!1,this.selectionPlate=null,this.atoms=[],this.patoms=[],this.bonds=[],this.xBonds=[],this.neiAtoms=[],this.pp=null,this.data={mul:1,connectivity:"ht",name:"",subscript:"n",attached:!1,absolute:!0,showUnits:!1,nCharsToDisplay:-1,tagChar:"",daspPos:1,fieldType:"F",fieldName:"",fieldValue:"",units:"",query:"",queryOp:""}},chem.SGroup.prototype.getAttr=function(a){return this.data[a]},chem.SGroup.prototype.getAttrs=function(){var a={};for(var b in this.data)a[b]=this.data[b];return a},chem.SGroup.prototype.setAttr=function(a,b){var c=this.data[a];return this.data[a]=b,c},chem.SGroup.prototype.checkAttr=function(a,b){return this.data[a]==b},chem.SGroup.equip=function(a,b){var c=chem.SGroup.TYPES[b];for(var d in c)a[d]=c[d]},chem.SGroup.numberArrayToString=function(a,b){for(var c=util.stringPadded(a.length,3),d=0;d<a.length;++d)c+=" "+util.stringPadded(b[a[d]],3);return c},chem.SGroup.addGroup=function(a,b,c){b.id=a.sgroups.add(b),b.postLoad(a,c);for(var d=0;d<b.atoms.length;++d)a.atoms.has(b.atoms[d])&&util.Set.add(a.atoms.get(b.atoms[d]).sgs,b.id);return a.sGroupForest.insert(b.id),b.id},chem.SGroup.bracketsToMolfile=function(a,b,c){var d=[],e=[],f=util.Set.fromList(b.atoms);chem.SGroup.getCrossBonds(d,e,a,f),chem.SGroup.bracketPos(b,null,a,e);for(var g=b.bracketBox,h=b.bracketDir,i=h.rotateSC(1,0),j=chem.SGroup.getBracketParameters(a,e,f,g,h,i,null,b.id),k=[],l=0;l<j.length;++l){for(var m=j[l],n=m.c.addScaled(m.n,-.5*m.h).yComplement(),o=m.c.addScaled(m.n,.5*m.h).yComplement(),p="M  SDI "+c+util.paddedInt(4,3),q=[n.x,n.y,o.x,o.y],r=0;r<q.length;++r)p+=util.paddedFloat(q[r],10,4);k.push(p)}return k},chem.SGroup.filterAtoms=function(a,b){for(var c=[],d=0;d<a.length;++d){var e=a[d];c.push("number"!=typeof b[e]?e:b[e]>=0?b[e]:-1)}return c},chem.SGroup.removeNegative=function(a){for(var b=[],c=0;c<a.length;++c)a[c]>=0&&b.push(a[c]);return b},chem.SGroup.filter=function(a,b,c){b.atoms=chem.SGroup.removeNegative(chem.SGroup.filterAtoms(b.atoms,c))},chem.SGroup.clone=function(a,b){var c=new chem.SGroup(a.type);for(var d in a.data)c.data[d]=a.data[d];return c.atoms=util.mapArray(a.atoms,b),c.pp=a.pp,c.bracketBox=a.bracketBox,c.patoms=null,c.bonds=null,c.allAtoms=a.allAtoms,c},chem.SGroup.addAtom=function(a,b){a.atoms.push(b)},chem.SGroup.removeAtom=function(a,b){for(var c=0;c<a.atoms.length;++c)if(a.atoms[c]===b)return void a.atoms.splice(c,1);throw new Error("The atom is not found in the given s-group")},chem.SGroup.getCrossBonds=function(a,b,c,d){c.bonds.each(function(c,e){util.Set.contains(d,e.begin)&&util.Set.contains(d,e.end)?util.isNull(a)||a.push(c):(util.Set.contains(d,e.begin)||util.Set.contains(d,e.end))&&(util.isNull(b)||b.push(c))},this)},chem.SGroup.bracketPos=function(a,b,c,d){var e=a.atoms;if(d&&2===d.length){var f=c.bonds.get(d[0]),g=c.bonds.get(d[1]),h=f.getCenter(c),i=g.getCenter(c);a.bracketDir=util.Vec2.diff(i,h).normalized()}else a.bracketDir=new util.Vec2(1,0);var j=a.bracketDir,k=j.rotateSC(1,0),l=null,m=[];util.each(e,function(a){var d=c.atoms.get(a),e=b?b.ctab.atoms.get(a).visel.boundingBox:null,f=new util.Vec2(d.pp);if(util.isNull(e)){e=new util.Box2Abs(f,f);var g=new util.Vec2(.05*3,.05*3);e=e.extend(g,g)}else e=e.translate((b.offset||new util.Vec2).negated()).transform(b.scaled2obj,b);m.push(e)},this),util.each(c.sGroupForest.children.get(a.id),function(a){var c=b?b.ctab.sgroups.get(a).visel.boundingBox:null;util.isNull(c)||(c=c.translate((b.offset||new util.Vec2).negated()).transform(b.scaled2obj,b),m.push(c))},this),util.each(m,function(a){var b=null;util.each([a.p0.x,a.p1.x],function(c){util.each([a.p0.y,a.p1.y],function(a){var d=new util.Vec2(c,a),e=new util.Vec2(util.Vec2.dot(d,j),util.Vec2.dot(d,k));b=util.isNull(b)?new util.Box2Abs(e,e):b.include(e)},this)},this),l=util.isNull(l)?b:util.Box2Abs.union(l,b)},this);var n=new util.Vec2(.2,.4);util.isNull(l)||(l=l.extend(n,n)),a.bracketBox=l},chem.SGroup.drawBrackets=function(a,b,c,d,e,f,g,h,i,j,k){for(var l=chem.SGroup.getBracketParameters(b.ctab.molecule,d,e,f,g,h,b,c.id),m=-1,n=0;n<l.length;++n){var o=l[n],p=chem.SGroup.drawBracket(b,b.paper,b.styles,o.d,o.n,o.c,o.w,o.h);a.push(p),(0>m||l[m].d.x<o.d.x||l[m].d.x==o.d.x&&l[m].d.y>o.d.y)&&(m=n)}var q=l[m],r=function(c,d){var e=b.ps(q.c.addScaled(q.n,d*q.h)),f=b.paper.text(e.x,e.y,c).attr({font:b.settings.font,"font-size":b.settings.fontszsub});k&&f.attr(k);var g=util.Box2Abs.fromRelBox(rnd.relBox(f.getBBox())),h=Math.max(util.Vec2.shiftRayBox(e,q.d.negated(),g),3)+2;f.translateAbs(h*q.d.x,h*q.d.y),a.push(f)};i&&r(i,.5),j&&r(j,-.5)},chem.SGroup.drawBracket=function(a,b,c,d,e,f,g,h){g=g||.25,h=h||1;var i=f.addScaled(e,-.5*h),j=f.addScaled(e,.5*h),k=i.addScaled(d,-g),l=j.addScaled(d,-g);return i=a.obj2scaled(i),j=a.obj2scaled(j),k=a.obj2scaled(k),l=a.obj2scaled(l),b.path("M {0}, {1} L {2} , {3} L {4} , {5} L {6} , {7}",k.x,k.y,i.x,i.y,j.x,j.y,l.x,l.y).attr(c.sgroupBracketStyle)},chem.SGroup.getBracketParameters=function(a,b,c,d,e,f,g,h){var i=function(a,b,c,d){this.c=a,this.d=b,this.n=b.rotateSC(1,0),this.w=c,this.h=d},j=[];return b.length<2?!function(){e=e||new util.Vec2(1,0),f=f||e.rotateSC(1,0);var a=Math.min(.25,.3*d.sz().x),b=util.Vec2.lc2(e,d.p0.x,f,.5*(d.p0.y+d.p1.y)),c=util.Vec2.lc2(e,d.p1.x,f,.5*(d.p0.y+d.p1.y)),g=d.sz().y;j.push(new i(b,e.negated(),a,g),new i(c,e,a,g))}():2===b.length?!function(){var c=a.bonds.get(b[0]),d=a.bonds.get(b[1]),e=c.getCenter(a),f=d.getCenter(a),k=-1,l=-1,m=-1,n=-1,o=util.Vec2.centre(e,f),p=util.Vec2.diff(f,e).normalized(),q=p.negated(),r=p.rotateSC(1,0),s=r.negated();util.each(a.sGroupForest.children.get(h),function(a){var b=g?g.ctab.sgroups.get(a).visel.boundingBox:null;util.isNull(b)||(b=b.translate((g.offset||new util.Vec2).negated()).transform(g.scaled2obj,g),k=Math.max(k,util.Vec2.shiftRayBox(e,q,b)),l=Math.max(l,util.Vec2.shiftRayBox(f,p,b)),m=Math.max(m,util.Vec2.shiftRayBox(o,r,b)),n=Math.max(n,util.Vec2.shiftRayBox(o,s,b)))},this),k=Math.max(k+.2,0),l=Math.max(l+.2,0),m=Math.max(Math.max(m,n)+.1,0);var t=.25,u=1.5+m;j.push(new i(e.addScaled(q,k),q,t,u),new i(f.addScaled(p,l),p,t,u))}():!function(){for(var d=0;d<b.length;++d){var e=a.bonds.get(b[d]),f=e.getCenter(a),g=util.Set.contains(c,e.begin)?e.getDir(a):e.getDir(a).negated();j.push(new i(f,g,.2,1))}}(),j},chem.SGroup.getObjBBox=function(a,b){if(0==a.length)throw new Error("Atom list is empty");for(var c=b.atoms.get(a[0]).pp,d=new util.Box2Abs(c,c),e=1;e<a.length;++e){var f=a[e],g=b.atoms.get(f),h=g.pp;d=d.include(h)}return d},chem.SGroup.makeAtomBondLines=function(a,b,c,d){if(!c)return[];for(var e=[],f=0;f<Math.floor((c.length+14)/15);++f){for(var g=Math.min(c.length-15*f,15),h="M  "+a+" "+b+" "+util.paddedInt(g,2),i=0;g>i;++i)h+=" "+util.paddedInt(d[c[15*f+i]],3);e.push(h)}return e},chem.SGroup.getAtoms=function(a,b){if(!b.allAtoms)return b.atoms;var c=[];return a.atoms.each(function(a){c.push(a)}),c},chem.SGroup.getBonds=function(a,b){var c=chem.SGroup.getAtoms(a,b),d=[];return a.bonds.each(function(a,b){c.indexOf(b.begin)>=0&&c.indexOf(b.end)>=0&&d.push(a)}),d},chem.SGroup.GroupMul={draw:function(a){var b=a.render,c=b.paper.set(),d=[],e=[],f=util.Set.fromList(this.atoms);chem.SGroup.getCrossBonds(d,e,a.molecule,f),chem.SGroup.bracketPos(this,b,a.molecule,e);var g=this.bracketBox,h=this.bracketDir,i=h.rotateSC(1,0);return this.areas=[g],chem.SGroup.drawBrackets(c,b,this,e,f,g,h,i,this.data.mul),c},saveToMolfile:function(a,b,c,d){var e=util.stringPadded(b[this.id],3),f=[];f=f.concat(chem.SGroup.makeAtomBondLines("SAL",e,util.idList(this.atomSet),c)),f=f.concat(chem.SGroup.makeAtomBondLines("SPA",e,util.idList(this.parentAtomSet),c)),f=f.concat(chem.SGroup.makeAtomBondLines("SBL",e,this.bonds,d));var g="M  SMT "+e+" "+this.data.mul;return f.push(g),f=f.concat(chem.SGroup.bracketsToMolfile(a,this,e)),f.join("\n")},prepareForSaving:function(a){var b;this.atoms.sort(),this.atomSet=util.Set.fromList(this.atoms),this.parentAtomSet=util.Set.clone(this.atomSet);var c=[],d=[];if(a.bonds.each(function(a,b){util.Set.contains(this.parentAtomSet,b.begin)&&util.Set.contains(this.parentAtomSet,b.end)?c.push(a):(util.Set.contains(this.parentAtomSet,b.begin)||util.Set.contains(this.parentAtomSet,b.end))&&d.push(a)},this),0!=d.length&&2!=d.length)throw{id:this.id,"error-type":"cross-bond-number",message:"Unsupported cross-bonds number"};var e=-1,f=-1,g=null;if(2==d.length){var h=a.bonds.get(d[0]);e=util.Set.contains(this.parentAtomSet,h.begin)?h.begin:h.end;var i=a.bonds.get(d[1]);f=util.Set.contains(this.parentAtomSet,i.begin)?i.begin:i.end,g=i}var j=null,k=e,l=[];for(b=0;b<this.data.mul-1;++b)if(j={},util.each(this.atoms,function(b){var c=a.atoms.get(b),d=a.atoms.add(new chem.Struct.Atom(c));l.push(d),this.atomSet[d]=1,j[b]=d},this),util.each(c,function(b){var c=a.bonds.get(b),d=new chem.Struct.Bond(c);d.begin=j[d.begin],d.end=j[d.end],a.bonds.add(d)},this),null!=g){var m=new chem.Struct.Bond(g);m.begin=k,m.end=j[f],a.bonds.add(m),k=j[e]}if(util.each(l,function(b){util.each(a.sGroupForest.getPathToRoot(this.id).reverse(),function(c){a.atomAddToSGroup(c,b)},this)},this),k>=0){var n=a.bonds.get(d[0]);n.begin==e?n.begin=k:n.end=k}this.bonds=d},postLoad:function(a,b){this.data.mul=this.data.subscript-0;var c={};this.atoms=chem.SGroup.filterAtoms(this.atoms,b),this.patoms=chem.SGroup.filterAtoms(this.patoms,b);for(var d=1;d<this.data.mul;++d)for(var e=0;e<this.patoms.length;++e){var f=this.atoms[d*this.patoms.length+e];if(!(0>f)){if(this.patoms[e]<0)throw new Error("parent atom missing");c[f]=this.patoms[e]}}this.patoms=chem.SGroup.removeNegative(this.patoms);var g=util.identityMap(this.patoms),h=[];a.bonds.each(function(a,b){var d=b.begin in c,e=b.end in c;d&&e||d&&b.end in g||e&&b.begin in g?h.push(a):d?b.begin=c[b.begin]:e&&(b.end=c[b.end])},this);for(var i=0;i<h.length;++i)a.bonds.remove(h[i]);for(var j in c)a.atoms.remove(j),b[j]=-1;this.atoms=this.patoms,this.patoms=null}},chem.SGroup.GroupSru={draw:function(a){var b=a.render,c=b.paper.set(),d=[],e=[],f=util.Set.fromList(this.atoms);chem.SGroup.getCrossBonds(d,e,a.molecule,f),chem.SGroup.bracketPos(this,b,a.molecule,e);var g=this.bracketBox,h=this.bracketDir,i=h.rotateSC(1,0);this.areas=[g];var j=this.data.connectivity||"eu";"ht"==j&&(j="");var k=this.data.subscript||"n";return chem.SGroup.drawBrackets(c,b,this,e,f,g,h,i,k,j),c},saveToMolfile:function(a,b,c,d){var e=util.stringPadded(b[this.id],3),f=[];return f=f.concat(chem.SGroup.makeAtomBondLines("SAL",e,this.atoms,c)),f=f.concat(chem.SGroup.makeAtomBondLines("SBL",e,this.bonds,d)),f=f.concat(chem.SGroup.bracketsToMolfile(a,this,e)),f.join("\n")},prepareForSaving:function(a){var b=[];if(a.bonds.each(function(c,d){var e=a.atoms.get(d.begin),f=a.atoms.get(d.end);(util.Set.contains(e.sgs,this.id)&&!util.Set.contains(f.sgs,this.id)||util.Set.contains(f.sgs,this.id)&&!util.Set.contains(e.sgs,this.id))&&b.push(c)},this),0!=b.length&&2!=b.length)throw{id:this.id,"error-type":"cross-bond-number",message:"Unsupported cross-bonds number"};this.bonds=b},postLoad:function(){this.data.connectivity=(this.data.connectivity||"EU").strip().toLowerCase()}},chem.SGroup.GroupSup={draw:function(a){var b=a.render,c=b.paper.set(),d=[],e=[],f=util.Set.fromList(this.atoms);chem.SGroup.getCrossBonds(d,e,a.molecule,f),chem.SGroup.bracketPos(this,b,a.molecule,e);var g=this.bracketBox,h=this.bracketDir,i=h.rotateSC(1,0);return this.areas=[g],chem.SGroup.drawBrackets(c,b,this,e,f,g,h,i,this.data.name,null,{"font-style":"italic"}),c},saveToMolfile:function(a,b,c,d){var e=util.stringPadded(b[this.id],3),f=[];return f=f.concat(chem.SGroup.makeAtomBondLines("SAL",e,this.atoms,c)),f=f.concat(chem.SGroup.makeAtomBondLines("SBL",e,this.bonds,d)),this.data.name&&""!=this.data.name&&f.push("M  SMT "+e+" "+this.data.name),f.join("\n")},prepareForSaving:function(a){var b=[];a.bonds.each(function(c,d){var e=a.atoms.get(d.begin),f=a.atoms.get(d.end);(util.Set.contains(e.sgs,this.id)&&!util.Set.contains(f.sgs,this.id)||util.Set.contains(f.sgs,this.id)&&!util.Set.contains(e.sgs,this.id))&&b.push(c)},this),this.bonds=b},postLoad:function(){this.data.name=(this.data.subscript||"").strip(),this.data.subscript=""}},chem.SGroup.GroupGen={draw:function(a){var b=a.render,c=(b.settings,b.styles,b.paper),d=c.set(),e=[],f=[],g=util.Set.fromList(this.atoms);chem.SGroup.getCrossBonds(e,f,a.molecule,g),chem.SGroup.bracketPos(this,b,a.molecule,f);var h=this.bracketBox,i=this.bracketDir,j=i.rotateSC(1,0);return this.areas=[h],chem.SGroup.drawBrackets(d,b,this,f,g,h,i,j),d},saveToMolfile:function(a,b,c,d){var e=util.stringPadded(b[this.id],3),f=[];return f=f.concat(chem.SGroup.makeAtomBondLines("SAL",e,this.atoms,c)),f=f.concat(chem.SGroup.makeAtomBondLines("SBL",e,this.bonds,d)),f=f.concat(chem.SGroup.bracketsToMolfile(a,this,e)),f.join("\n")},prepareForSaving:function(){},postLoad:function(){}},chem.SGroup.getMassCentre=function(a,b){for(var c=new util.Vec2,d=0;d<b.length;++d)c=c.addScaled(a.atoms.get(b[d]).pp,1/b.length);return c},chem.SGroup.setPos=function(a,b,c){b.pp=c},chem.SGroup.GroupDat={showValue:function(a,b,c,d){var e=a.text(b.x,b.y,c.data.fieldValue).attr({font:d.font,"font-size":d.fontsz});return e},draw:function(a){var b,c=a.render,d=c.settings,e=c.paper,f=e.set(),g=chem.SGroup.getAtoms(a,this);chem.SGroup.bracketPos(this,c,a.molecule),this.areas=this.bracketBox?[this.bracketBox]:[],null==this.pp&&chem.SGroup.setPos(a,this,this.bracketBox.p1.add(new util.Vec2(.5,.5)));var h=this.pp.scaled(d.scaleFactor);if(this.data.attached)for(b=0;b<g.length;++b){var i=a.atoms.get(g[b]),j=c.ps(i.a.pp),k=i.visel.boundingBox;null!=k&&(j.x=Math.max(j.x,k.p1.x)),j.x+=d.lineWidth;var l=this.showValue(e,j,this,d),m=rnd.relBox(l.getBBox());l.translateAbs(.5*m.width,-.3*m.height),f.push(l);var n=util.Box2Abs.fromRelBox(rnd.relBox(l.getBBox()));n=n.transform(c.scaled2obj,c),this.areas.push(n)}else{var o=this.showValue(e,h,this,d),p=rnd.relBox(o.getBBox());o.translateAbs(.5*p.width,-.5*p.height),f.push(o);var q=util.Box2Abs.fromRelBox(rnd.relBox(o.getBBox()));this.dataArea=q.transform(c.scaled2obj,c),a.sgroupData.has(this.id)||a.sgroupData.set(this.id,new rnd.ReDataSGroupData(this))}return f},saveToMolfile:function(a,b,c){var d=util.stringPadded(b[this.id],3),e=this.data,f=this.pp;e.absolute||(f=f.sub(chem.SGroup.getMassCentre(a,this.atoms)));var g=[];g=g.concat(chem.SGroup.makeAtomBondLines("SAL",d,this.atoms,c));var h="M  SDT "+d+" "+util.stringPadded(e.fieldName,30,!0)+util.stringPadded(e.fieldType,2)+util.stringPadded(e.units,20,!0)+util.stringPadded(e.query,2)+util.stringPadded(e.queryOp,3);g.push(h);var i="M  SDD "+d+" "+util.paddedFloat(f.x,10,4)+util.paddedFloat(-f.y,10,4)+"    "+(e.attached?"A":"D")+(e.absolute?"A":"R")+(e.showUnits?"U":" ")+"   "+(e.nCharnCharsToDisplay>=0?util.paddedInt(e.nCharnCharsToDisplay,3):"ALL")+"  1   "+util.stringPadded(e.tagChar,1)+"  "+util.paddedInt(e.daspPos,1)+"  ";return g.push(i),e.fieldValue.replace(/[\r\n|\n|\r]*$/,"").split(/\r\n|\n|\r/).each(function(a){for(var b=69;a.length>b;)g.push("M  SCD "+d+" "+a.slice(0,b)),a=a.slice(69);g.push("M  SED "+d+" "+util.stringPadded(a,b,!0))},this),g.join("\n")},prepareForSaving:function(a){this.atoms=chem.SGroup.getAtoms(a,this)},postLoad:function(a){var b=this.atoms.length==a.atoms.count();this.data.absolute||(this.pp=this.pp.add(chem.SGroup.getMassCentre(a,this.atoms))),!b||"MDLBG_FRAGMENT_STEREO"!=this.data.fieldName&&"MDLBG_FRAGMENT_COEFFICIENT"!=this.data.fieldName&&"MDLBG_FRAGMENT_CHARGE"!=this.data.fieldName||(this.atoms=[],this.allAtoms=!0)}},chem.SGroup.TYPES={MUL:chem.SGroup.GroupMul,SRU:chem.SGroup.GroupSru,SUP:chem.SGroup.GroupSup,DAT:chem.SGroup.GroupDat,GEN:chem.SGroup.GroupGen},chem.SGroupForest=function(a){this.parent=new util.Map,this.children=new util.Map,this.children.set(-1,[]),this.molecule=a},chem.SGroupForest.prototype.getSGroupsBFS=function(){var a=[],b=[],c=-1;for(b=util.array(this.children.get(-1));b.length>0;){var c=b.shift();b=b.concat(this.children.get(c)),a.push(c)}return a},chem.SGroupForest.prototype.getAtomSets=function(){return this.molecule.sgroups.map(function(a,b){return util.Set.fromList(b.atoms)})},chem.SGroupForest.prototype.getAtomSetRelations=function(a,b,c){var d=new util.Map,e=new util.Map,c=this.getAtomSets();c.unset(a),c.each(function(a,c){e.set(a,util.Set.subset(b,c)),d.set(a,util.Set.subset(c,b)&&!util.Set.eq(c,b))},this);var f=c.findAll(function(a){return e.get(a)?util.find(this.children.get(a),function(a){return e.get(a)},this)>=0?!1:!0:!1},this);util.assert(f.length<=1);var g=c.findAll(function(a){return d.get(a)&&!d.get(this.parent.get(a))},this);return{children:g,parent:0===f.length?-1:f[0]}},chem.SGroupForest.prototype.getPathToRoot=function(a){for(var b=[],c=a;c>=0;c=this.parent.get(c))util.assert(b.indexOf(c)<0,"SGroupForest: loop detected"),b.push(c);return b},chem.SGroupForest.prototype.validate=function(){var a=this.getAtomSets();this.molecule.sgroups.each(function(a){this.getPathToRoot(a)},this);var b=!0;return this.parent.each(function(c,d){d>=0&&!util.Set.subset(a.get(c),a.get(d))&&(b=!1)},this),this.children.each(function(c){for(var d=this.children.get(c),e=0;e<d.length;++e)for(var f=e+1;f<d.length;++f)util.Set.disjoint(a.get(d[e]),a.get(d[f]))||(b=!1)},this),b},chem.SGroupForest.prototype.insert=function(a,b,c){util.assert(!this.parent.has(a),"sgid already present in the forest"),util.assert(!this.children.has(a),"sgid already present in the forest"),util.assert(this.validate(),"s-group forest invalid");var d=this.getAtomSets(),e=util.Set.fromList(this.molecule.sgroups.get(a).atoms);if(util.isUndefined(b)||util.isUndefined(c)){var f=this.getAtomSetRelations(a,e,d);b=f.parent,c=f.children}return util.each(c,function(b){util.assert(1===util.arrayRemoveByValue(this.children.get(this.parent.get(b)),b)),this.parent.set(b,a)},this),this.children.set(a,c),this.parent.set(a,b),this.children.get(b).push(a),util.assert(this.validate(),"s-group forest invalid"),{parent:b,children:c}},chem.SGroupForest.prototype.remove=function(a){util.assert(this.parent.has(a),"sgid is not in the forest"),util.assert(this.children.has(a),"sgid is not in the forest"),util.assert(this.validate(),"s-group forest invalid");var b=this.parent.get(a);util.each(this.children.get(a),function(a){this.parent.set(a,b),this.children.get(b).push(a)},this),util.assert(1===util.arrayRemoveByValue(this.children.get(b),a)),this.children.unset(a),this.parent.unset(a),util.assert(this.validate(),"s-group forest invalid")},!window.chem||!chem.Struct)throw new Error("Include MolData.js first");if(chem.Struct.prototype.calcConn=function(a){for(var b=0,c=this.atoms.get(a),d=!1,e=0;e<c.neighbors.length;++e){var f=this.halfBonds.get(c.neighbors[e]),g=this.bonds.get(f.bid);switch(g.type){case chem.Struct.BOND.TYPE.SINGLE:b+=1;break;case chem.Struct.BOND.TYPE.DOUBLE:b+=2;break;case chem.Struct.BOND.TYPE.TRIPLE:b+=3;break;case chem.Struct.BOND.TYPE.AROMATIC:b+=1,d=!0;break;default:return-1}}return d&&(b+=1),b},chem.Struct.Atom.prototype.calcValence=function(a){var b=this,c=b.charge,d=b.label;if(b.isQuery())return this.implicitH=0,!0;var e=chem.Element.getElementByLabel(d);if(null==e)return this.implicitH=0,!0;var f=chem.Element.elements.get(e).group,g=chem.Struct.radicalElectrons(b.radical),h=a,i=0,j=Math.abs(c);return 1==f?("H"==d||"Li"==d||"Na"==d||"K"==d||"Rb"==d||"Cs"==d||"Fr"==d)&&(h=1,i=1-g-a-j):3==f?"B"==d||"Al"==d||"Ga"==d||"In"==d?-1==c?(h=4,i=4-g-a):(h=3,i=3-g-a-j):"Tl"==d&&(-1==c?2>=g+a?(h=2,i=2-g-a):(h=4,i=4-g-a):-2==c?3>=g+a?(h=3,i=3-g-a):(h=5,i=5-g-a):1>=g+a+j?(h=1,i=1-g-a-j):(h=3,i=3-g-a-j)):4==f?"C"==d||"Si"==d||"Ge"==d?(h=4,i=4-g-a-j):("Sn"==d||"Pb"==d)&&(2>=a+g+j?(h=2,i=2-g-a-j):(h=4,i=4-g-a-j)):5==f?"N"==d||"P"==d?1==c?(h=4,i=4-g-a):2==c?(h=3,i=3-g-a):"N"==d||3>=g+a+j?(h=3,i=3-g-a-j):(h=5,i=5-g-a-j):("Bi"==d||"Sb"==d||"As"==d)&&(1==c?2>=g+a&&"As"!=d?(h=2,i=2-g-a):(h=4,i=4-g-a):2==c?(h=3,i=3-g-a):3>=g+a?(h=3,i=3-g-a-j):(h=5,i=5-g-a-j)):6==f?"O"==d?c>=1?(h=3,i=3-g-a):(h=2,i=2-g-a-j):"S"==d||"Se"==d||"Po"==d?1==c?3>=a?(h=3,i=3-g-a):(h=5,i=5-g-a):2>=a+g+j?(h=2,i=2-g-a-j):4>=a+g+j?(h=4,i=4-g-a-j):(h=6,i=6-g-a-j):"Te"==d&&(-1==c?2>=a&&(h=2,i=2-g-a-j):(0==c||2==c)&&(2>=a?(h=2,i=2-g-a-j):4>=a?(h=4,i=4-g-a-j):0==c&&6>=a?(h=6,i=6-g-a-j):i=-1)):7==f&&("F"==d?(h=1,i=1-g-a-j):("Cl"==d||"Br"==d||"I"==d||"At"==d)&&(1==c?2>=a?(h=2,i=2-g-a):(3==a||5==a||a>=7)&&(i=-1):0==c&&(1>=a?(h=1,i=1-g-a):2==a||4==a||6==a?1==g?(h=a,i=0):i=-1:a>7&&(i=-1)))),this.valence=h,this.implicitH=i,this.implicitH<0?(this.valence=a,this.implicitH=0,this.badConn=!0,!1):!0},chem.Struct.Atom.prototype.calcValenceMinusHyd=function(a){var b=this,c=b.charge,d=b.label,e=chem.Element.getElementByLabel(d);if(null==e)throw new Error("Element "+d+" unknown");if(0>e)return this.implicitH=0,null;var f=chem.Element.elements.get(e).group,g=chem.Struct.radicalElectrons(b.radical);if(3==f){if(("B"==d||"Al"==d||"Ga"==d||"In"==d)&&-1==c&&4>=g+a)return g+a}else if(5==f){if("N"==d||"P"==d){if(1==c)return g+a;if(2==c)return g+a}else if("Sb"==d||"Bi"==d||"As"==d){if(1==c)return g+a;if(2==c)return g+a}}else if(6==f){if("O"==d){if(c>=1)return g+a}else if(("S"==d||"Se"==d||"Po"==d)&&1==c)return g+a}else if(7==f&&("Cl"==d||"Br"==d||"I"==d||"At"==d)&&1==c)return g+a;return g+a+Math.abs(c)},chem.Struct.prototype.calcImplicitHydrogen=function(a){var b=this.calcConn(a),c=this.atoms.get(a);if(c.badConn=!1,0>b||c.isQuery())return void(c.implicitH=0);if(c.explicitValence>=0){var d=chem.Element.getElementByLabel(c.label);c.implicitH=0,null!=d&&(c.implicitH=c.explicitValence-c.calcValenceMinusHyd(b),c.implicitH<0&&(c.implicitH=0,c.badConn=!0))}else c.calcValence(b)},!window.chem||!chem.Struct)throw new Error("Molecule should be defined first");if(chem.Dfs=function(a,b,c,d){this.molecule=a,this.atom_data=b,this.components=c,this.nComponentsInReactants=-1,this.nReactants=d,this.vertices=new Array(this.molecule.atoms.count()),this.molecule.atoms.each(function(a){this.vertices[a]=new chem.Dfs.VertexDesc},this),this.edges=new Array(this.molecule.bonds.count()),this.molecule.bonds.each(function(a){this.edges[a]=new chem.Dfs.EdgeDesc},this),this.v_seq=new Array},chem.Dfs.VertexDesc=function(){this.dfs_state=0,this.parent_vertex=0,this.parent_edge=0,this.branches=0},chem.Dfs.EdgeDesc=function(){this.opening_cycles=0,this.closing_cycle=0},chem.Dfs.SeqElem=function(a,b,c){this.idx=a,this.parent_vertex=b,this.parent_edge=c},chem.Dfs.prototype.walk=function(){for(var a,b,c=new Array,d=0,e=0;;){if(c.length<1){for(var f=-1,g=function(a){return 0==this.vertices[a].dfs_state?(f=a,!0):!1};d<this.components.length&&-1==f;)f=util.Set.find(this.components[d],g,this),null===f&&(f=-1,d++,d==this.nReactants&&(this.nComponentsInReactants=e));if(-1>f&&this.molecule.atoms.find(g,this),-1==f)break;this.vertices[f].parent_vertex=-1,this.vertices[f].parent_edge=-1,c.push(f),e++}var h=c.pop(),i=this.vertices[h].parent_vertex,j=new chem.Dfs.SeqElem(h,i,this.vertices[h].parent_edge);this.v_seq.push(j),this.vertices[h].dfs_state=2;var k=this.atom_data[h];for(a=0;a<k.neighbours.length;a++){var l=k.neighbours[a].aid,m=k.neighbours[a].bid;if(l!=i)if(2==this.vertices[l].dfs_state){for(this.edges[m].closing_cycle=1,b=h;-1!=b&&this.vertices[b].parent_vertex!=l;)b=this.vertices[b].parent_vertex;if(-1==b)throw new Error("Cycle unwind error");this.edges[this.vertices[b].parent_edge].opening_cycles++,this.vertices[h].branches++,j=new chem.Dfs.SeqElem(l,h,m),this.v_seq.push(j)}else{if(1==this.vertices[l].dfs_state){if(b=c.indexOf(l),-1==b)throw new Error("Internal: removing vertex from stack");c.splice(b,1);var n=this.vertices[l].parent_vertex;n>=0&&this.vertices[n].branches--}this.vertices[h].branches++,this.vertices[l].parent_vertex=h,this.vertices[l].parent_edge=m,this.vertices[l].dfs_state=1,c.push(l)}}}},chem.Dfs.prototype.edgeClosingCycle=function(a){return 0!=this.edges[a].closing_cycle
},chem.Dfs.prototype.numBranches=function(a){return this.vertices[a].branches},chem.Dfs.prototype.numOpeningCycles=function(a){return this.edges[a].opening_cycles},chem.Dfs.prototype.toString=function(){var a="";return this.v_seq.each(function(b){a+=b.idx+" -> "}),a+="*"},!window.chem||!chem.Struct)throw new Error("Vec2 and Molecule should be defined first");if(chem.CisTrans=function(a,b,c){this.molecule=a,this.bonds=new util.Map,this.getNeighbors=b,this.context=c},chem.CisTrans.PARITY={NONE:0,CIS:1,TRANS:2},chem.CisTrans.prototype.each=function(a,b){this.bonds.each(a,b)},chem.CisTrans.prototype.getParity=function(a){return this.bonds.get(a).parity},chem.CisTrans.prototype.getSubstituents=function(a){return this.bonds.get(a).substituents},chem.CisTrans.prototype.sameside=function(a,b,c,d){var e=util.Vec2.diff(a,b),f=new util.Vec2(-e.y,e.x);if(!f.normalize())return 0;var g=util.Vec2.diff(c,a),h=util.Vec2.diff(d,b);if(!g.normalize())return 0;if(!h.normalize())return 0;var i=util.Vec2.dot(g,f),j=util.Vec2.dot(h,f);return Math.abs(i)<.001||Math.abs(j)<.001?0:i*j>0?1:-1},chem.CisTrans.prototype._sameside=function(a,b,c,d){return this.sameside(this.molecule.atoms.get(a).pp,this.molecule.atoms.get(b).pp,this.molecule.atoms.get(c).pp,this.molecule.atoms.get(d).pp)},chem.CisTrans.prototype._sortSubstituents=function(a){var b=this.molecule.atoms.get(a[0]).pureHydrogen(),c=a[1]<0||this.molecule.atoms.get(a[1]).pureHydrogen(),d=this.molecule.atoms.get(a[2]).pureHydrogen(),e=a[3]<0||this.molecule.atoms.get(a[3]).pureHydrogen();return b&&c?!1:d&&e?!1:(c?a[1]=-1:b?(a[0]=a[1],a[1]=-1):a[0]>a[1]&&a.swap(0,1),e?a[3]=-1:d?(a[2]=a[3],a[3]=-1):a[2]>a[3]&&a.swap(2,3),!0)},chem.CisTrans.prototype.isGeomStereoBond=function(a,b){var c=this.molecule.bonds.get(a);if(c.type!=chem.Struct.BOND.TYPE.DOUBLE)return!1;var d=this.molecule.atoms.get(c.begin).label,e=this.molecule.atoms.get(c.end).label;if("C"!=d&&"N"!=d&&"Si"!=d&&"Ge"!=d)return!1;if("C"!=e&&"N"!=e&&"Si"!=e&&"Ge"!=e)return!1;var f=this.getNeighbors.call(this.context,c.begin),g=this.getNeighbors.call(this.context,c.end);if(f.length<2||f.length>3||g.length<2||g.length>3)return!1;b[0]=-1,b[1]=-1,b[2]=-1,b[3]=-1;var h,i;for(h=0;h<f.length;h++)if(i=f[h],i.bid!=a){if(this.molecule.bonds.get(i.bid).type!=chem.Struct.BOND.TYPE.SINGLE)return!1;-1==b[0]?b[0]=i.aid:b[1]=i.aid}for(h=0;h<g.length;h++)if(i=g[h],i.bid!=a){if(this.molecule.bonds.get(i.bid).type!=chem.Struct.BOND.TYPE.SINGLE)return!1;-1==b[2]?b[2]=i.aid:b[3]=i.aid}return-1!=b[1]&&-1!=this._sameside(c.begin,c.end,b[0],b[1])?!1:-1!=b[3]&&-1!=this._sameside(c.begin,c.end,b[2],b[3])?!1:!0},chem.CisTrans.prototype.build=function(a){this.molecule.bonds.each(function(b,c){var d=this.bonds.set(b,{parity:0,substituents:new Array(4)});if((!util.isArray(a)||!a[b])&&this.isGeomStereoBond(b,d.substituents)&&this._sortSubstituents(d.substituents)){var e=this._sameside(c.begin,c.end,d.substituents[0],d.substituents[2]);1==e?d.parity=chem.CisTrans.PARITY.CIS:-1==e&&(d.parity=chem.CisTrans.PARITY.TRANS)}},this)},!window.chem||!chem.Struct)throw new Error("Vec2 and Molecule should be defined first");if(chem.Stereocenters=function(a,b,c){this.molecule=a,this.atoms=new util.Map,this.getNeighbors=b,this.context=c},chem.Stereocenters.prototype.each=function(a,b){this.atoms.each(a,b)},chem.Stereocenters.prototype.buildFromBonds=function(a){var b=this.molecule.atoms,c=this.molecule.bonds,d=util.Set.empty();if(b.each(function(a){var e=this.getNeighbors.call(this.context,a);if(2!=e.length)return!1;var f=e[0],g=e[1];if(util.find([a,f.aid,g.aid],function(a){return["C","Si"].indexOf(b.get(a).label)<0},this)>=0)return!1;if(util.find([f.bid,g.bid],function(a){return c.get(a).type!=chem.Struct.BOND.TYPE.DOUBLE},this)>=0)return!1;var h=util.findAll(this.getNeighbors.call(this.context,f.aid),function(b){return b.aid!=a},this),i=util.findAll(this.getNeighbors.call(this.context,g.aid),function(b){return b.aid!=a},this);return h.length<1||h.length>2||i.length<1||i.length>2?!1:util.find(h.concat(i),function(a){return c.get(a.bid).type!=chem.Struct.BOND.TYPE.SINGLE},this)>=0?!1:util.find(h.concat(i),function(a){return c.get(a.bid).stereo==chem.Struct.BOND.STEREO.EITHER},this)>=0?!1:(util.Set.add(d,f.aid),void util.Set.add(d,g.aid))},this),util.Set.size(d)>0)throw new Error("This structure may contain allenes, which cannot be represented in the SMILES notation. Relevant stereo-information will be discarded.");b.each(function(b){if(!util.Set.contains(d,b)){var c=this.getNeighbors.call(this.context,b),e=!1;util.find(c,function(a){var c=this.molecule.bonds.get(a.bid);return c.type!=chem.Struct.BOND.TYPE.SINGLE||c.begin!=b||c.stereo!=chem.Struct.BOND.STEREO.UP&&c.stereo!=chem.Struct.BOND.STEREO.DOWN?!1:(e=!0,!0)},this),e&&this._buildOneCenter(a?b:b)}},this)},chem.Stereocenters.allowed_stereocenters=[{elem:"C",charge:0,degree:3,n_double_bonds:0,implicit_degree:4},{elem:"C",charge:0,degree:4,n_double_bonds:0,implicit_degree:4},{elem:"Si",charge:0,degree:3,n_double_bonds:0,implicit_degree:4},{elem:"Si",charge:0,degree:4,n_double_bonds:0,implicit_degree:4},{elem:"N",charge:1,degree:3,n_double_bonds:0,implicit_degree:4},{elem:"N",charge:1,degree:4,n_double_bonds:0,implicit_degree:4},{elem:"N",charge:0,degree:3,n_double_bonds:0,implicit_degree:3},{elem:"S",charge:0,degree:4,n_double_bonds:2,implicit_degree:4},{elem:"S",charge:1,degree:3,n_double_bonds:0,implicit_degree:3},{elem:"S",charge:0,degree:3,n_double_bonds:1,implicit_degree:3},{elem:"P",charge:0,degree:3,n_double_bonds:0,implicit_degree:3},{elem:"P",charge:1,degree:4,n_double_bonds:0,implicit_degree:4},{elem:"P",charge:0,degree:4,n_double_bonds:1,implicit_degree:4}],chem.Stereocenters.prototype._buildOneCenter=function(a){var b=this.molecule.atoms.get(a),c=this.getNeighbors.call(this.context,a),d=c.length,e=-1,f={group:0,type:0,pyramid:new Array(4)},g=0,h=new Array(4),i=0,j=0;f.pyramid[0]=-1,f.pyramid[1]=-1,f.pyramid[2]=-1,f.pyramid[3]=-1;var k=0;if(d>4)throw new Error("Stereocenter with "+d+" bonds are not supported");if(c.each(function(a){var c=this.molecule.atoms.get(a.aid),d=this.molecule.bonds.get(a.bid);if(h[g]={edge_idx:a.bid,nei_idx:a.aid,rank:a.aid,vec:util.Vec2.diff(c.pp,b.pp).yComplement()},c.pureHydrogen()?(k++,h[g].rank=1e4):"H"==c.label&&(h[g].rank=5e3),!h[g].vec.normalize())throw new Error("Zero bond length");if(d.type==chem.Struct.BOND.TYPE.TRIPLE)throw new Error("Non-single bonds not allowed near stereocenter");if(d.type==chem.Struct.BOND.TYPE.AROMATIC)throw new Error("Aromatic bonds not allowed near stereocenter");d.type==chem.Struct.BOND.TYPE.DOUBLE&&j++,g++},this),util.find(chem.Stereocenters.allowed_stereocenters,function(a){return a.elem==b.label&&a.charge==b.charge&&a.degree==d&&a.n_double_bonds==j?(e=a.implicit_degree,!0):!1},this),-1==e)throw new Error("Unknown stereocenter configuration: "+b.label+", charge "+b.charge+", "+d+" bonds ("+j+" double)");if(4==d&&k>1)throw new Error(k+" hydrogens near stereocenter");if(3==d&&4==e&&k>0)throw new Error("Has hydrogen(s) besides implicit hydrogen near stereocenter");if(4==d){h[0].rank>h[1].rank&&h.swap(0,1),h[1].rank>h[2].rank&&h.swap(1,2),h[2].rank>h[3].rank&&h.swap(2,3),h[1].rank>h[2].rank&&h.swap(1,2),h[0].rank>h[1].rank&&h.swap(0,1),h[1].rank>h[2].rank&&h.swap(1,2);var l=-1,m=-1,n=-1,o=-1,p=0;for(g=0;4>g;g++){var q=this._getBondStereo(a,h[g].edge_idx);if(q==chem.Struct.BOND.STEREO.UP||q==chem.Struct.BOND.STEREO.DOWN){l=g,p=q;break}}if(-1==l)throw new Error("None of 4 bonds going from stereocenter is stereobond");var r,s;if(-1==m&&(r=chem.Stereocenters._xyzzy(h[l].vec,h[(l+1)%4].vec,h[(l+2)%4].vec),s=chem.Stereocenters._xyzzy(h[l].vec,h[(l+1)%4].vec,h[(l+3)%4].vec),(r+s==3||r+s==12)&&(m=(l+1)%4,n=(l+2)%4,o=(l+3)%4)),-1==m&&(r=chem.Stereocenters._xyzzy(h[l].vec,h[(l+2)%4].vec,h[(l+1)%4].vec),s=chem.Stereocenters._xyzzy(h[l].vec,h[(l+2)%4].vec,h[(l+3)%4].vec),(r+s==3||r+s==12)&&(m=(l+2)%4,n=(l+1)%4,o=(l+3)%4)),-1==m&&(r=chem.Stereocenters._xyzzy(h[l].vec,h[(l+3)%4].vec,h[(l+1)%4].vec),s=chem.Stereocenters._xyzzy(h[l].vec,h[(l+3)%4].vec,h[(l+2)%4].vec),(r+s==3||r+s==12)&&(m=(l+3)%4,n=(l+2)%4,o=(l+1)%4)),-1==m)throw new Error("Internal error: can not find opposite bond");if(p==chem.Struct.BOND.STEREO.UP&&this._getBondStereo(a,h[m].edge_idx)==chem.Struct.BOND.STEREO.DOWN)throw new Error("Stereo types of the opposite bonds mismatch");if(p==chem.Struct.BOND.STEREO.DOWN&&this._getBondStereo(a,h[m].edge_idx)==chem.Struct.BOND.STEREO.UP)throw new Error("Stereo types of the opposite bonds mismatch");if(p==this._getBondStereo(a,h[n].edge_idx))throw new Error("Stereo types of non-opposite bonds match");if(p==this._getBondStereo(a,h[o].edge_idx))throw new Error("Stereo types of non-opposite bonds match");i=3==l||3==m?p:p==chem.Struct.BOND.STEREO.UP?chem.Struct.BOND.STEREO.DOWN:chem.Struct.BOND.STEREO.UP,z=chem.Stereocenters._sign(h[0].vec,h[1].vec,h[2].vec),i==chem.Struct.BOND.STEREO.UP&&z>0||i==chem.Struct.BOND.STEREO.DOWN&&0>z?(f.pyramid[0]=h[0].nei_idx,f.pyramid[1]=h[1].nei_idx,f.pyramid[2]=h[2].nei_idx):(f.pyramid[0]=h[0].nei_idx,f.pyramid[1]=h[2].nei_idx,f.pyramid[2]=h[1].nei_idx),f.pyramid[3]=h[3].nei_idx}else if(3==d){h[0].rank>h[1].rank&&h.swap(0,1),h[1].rank>h[2].rank&&h.swap(1,2),h[0].rank>h[1].rank&&h.swap(0,1);var t=this._getBondStereo(a,h[0].edge_idx),u=this._getBondStereo(a,h[1].edge_idx),v=this._getBondStereo(a,h[2].edge_idx),w=0,x=0;if(w+=t==chem.Struct.BOND.STEREO.UP?1:0,w+=u==chem.Struct.BOND.STEREO.UP?1:0,w+=v==chem.Struct.BOND.STEREO.UP?1:0,x+=t==chem.Struct.BOND.STEREO.DOWN?1:0,x+=u==chem.Struct.BOND.STEREO.DOWN?1:0,x+=v==chem.Struct.BOND.STEREO.DOWN?1:0,4==e){if(3==w)throw new Error("All 3 bonds up near stereoatom");if(3==x)throw new Error("All 3 bonds down near stereoatom");if(0==w&&0==x)throw new Error("No up/down bonds near stereoatom -- indefinite case");if(1==w&&1==x)throw new Error("One bond up, one bond down -- indefinite case");if(p=0,2==w)i=chem.Struct.BOND.STEREO.DOWN;else if(2==x)i=chem.Struct.BOND.STEREO.UP;else{for(l=-1,n=-1,o=-1,g=0;3>g;g++)if(A=this._getBondStereo(a,h[g].edge_idx),A==chem.Struct.BOND.STEREO.UP||A==chem.Struct.BOND.STEREO.DOWN){l=g,p=A,n=(g+1)%3,o=(g+2)%3;break}if(-1==l)throw new Error("Internal error: can not find up or down bond");var y=chem.Stereocenters._xyzzy(h[n].vec,h[o].vec,h[l].vec);if(3==y||4==y)throw new Error("Degenerate case for 3 bonds near stereoatom");i=1==y?p:p==chem.Struct.BOND.STEREO.UP?chem.Struct.BOND.STEREO.DOWN:chem.Struct.BOND.STEREO.UP}var z=chem.Stereocenters._sign(h[0].vec,h[1].vec,h[2].vec);i==chem.Struct.BOND.STEREO.UP&&z>0||i==chem.Struct.BOND.STEREO.DOWN&&0>z?(f.pyramid[0]=h[0].nei_idx,f.pyramid[1]=h[1].nei_idx,f.pyramid[2]=h[2].nei_idx):(f.pyramid[0]=h[0].nei_idx,f.pyramid[1]=h[2].nei_idx,f.pyramid[2]=h[1].nei_idx),f.pyramid[3]=-1}else{var A;if(x>0&&w>0)throw new Error("One bond up, one bond down -- indefinite case");if(0==x&&0==w)throw new Error("No up-down bonds attached to stereocenter");A=w>0?1:-1,(1==chem.Stereocenters._xyzzy(h[0].vec,h[1].vec,h[2].vec)||1==chem.Stereocenters._xyzzy(h[0].vec,h[2].vec,h[1].vec)||1==chem.Stereocenters._xyzzy(h[2].vec,h[1].vec,h[0].vec))&&(A=-A),z=chem.Stereocenters._sign(h[0].vec,h[1].vec,h[2].vec),z==A?(f.pyramid[0]=h[0].nei_idx,f.pyramid[1]=h[2].nei_idx,f.pyramid[2]=h[1].nei_idx):(f.pyramid[0]=h[0].nei_idx,f.pyramid[1]=h[1].nei_idx,f.pyramid[2]=h[2].nei_idx),f.pyramid[3]=-1}}this.atoms.set(a,f)},chem.Stereocenters.prototype._getBondStereo=function(a,b){var c=this.molecule.bonds.get(b);return a!=c.begin?0:c.stereo},chem.Stereocenters._xyzzy=function(a,b,c){var d=.001,e=util.Vec2.cross(a,b),f=util.Vec2.dot(a,b),g=util.Vec2.cross(a,c),h=util.Vec2.dot(a,c);if(Math.abs(e)<d){if(Math.abs(g)<d)throw new Error("Degenerate case -- bonds overlap");return g>0?4:8}return-d*d>e*g?2:f>h?2:1},chem.Stereocenters._sign=function(a,b,c){var d=(a.x-c.x)*(b.y-c.y)-(a.y-c.y)*(b.x-c.x),e=.001;if(d>e)return 1;if(-e>d)return-1;throw new Error("Degenerate triangle")},chem.Stereocenters.isPyramidMappingRigid=function(a){var b=a.clone(),c=!0;return b[0]>b[1]&&(b.swap(0,1),c=!c),b[1]>b[2]&&(b.swap(1,2),c=!c),b[2]>b[3]&&(b.swap(2,3),c=!c),b[1]>b[2]&&(b.swap(1,2),c=!c),b[0]>b[1]&&(b.swap(0,1),c=!c),b[1]>b[2]&&(b.swap(1,2),c=!c),c},!window.chem||!chem.Struct)throw new Error("Vec2 and Molecule should be defined first");if(chem.SmilesSaver=function(){this.smiles="",this._written_atoms=new Array,this._written_components=0,this.ignore_errors=!1},chem.SmilesSaver._Atom=function(a){this.neighbours=new Array,this.aromatic=!1,this.lowercase=!1,this.chirality=0,this.branch_cnt=0,this.paren_written=!1,this.h_count=a,this.parent=-1},chem.SmilesSaver.prototype.isBondInRing=function(a){if(util.isUndefined(this.inLoop)||util.isNull(this.inLoop))throw new Error("Init this.inLoop prior to calling this method");return this.inLoop[a]},chem.SmilesSaver.prototype.saveMolecule=function(a,b){var c,d,e;util.isUndefined(b)||(this.ignore_errors=b),a=a.clone(),a.sgroups.each(function(b,c){if("MUL"==c.type)try{c.prepareForSaving(a)}catch(d){throw{message:"Bad s-group ("+d.message+")"}}else if(!this.ignore_errors)throw new Error("SMILES data format doesn't support s-groups")},this),this.atoms=new Array(a.atoms.count()),a.atoms.each(function(a,b){this.atoms[a]=new chem.SmilesSaver._Atom(b.implicitH)},this);var f=["B","C","N","O","P","S","Se","As"];a.bonds.each(function(b,c){c.type==chem.Struct.BOND.TYPE.AROMATIC&&(this.atoms[c.begin].aromatic=!0,-1!=f.indexOf(a.atoms.get(c.begin).label)&&(this.atoms[c.begin].lowercase=!0),this.atoms[c.end].aromatic=!0,-1!=f.indexOf(a.atoms.get(c.end).label)&&(this.atoms[c.end].lowercase=!0)),this.atoms[c.begin].neighbours.push({aid:c.end,bid:b}),this.atoms[c.end].neighbours.push({aid:c.begin,bid:b})},this),this.inLoop=function(){a.prepareLoopStructure();var b=util.Set.empty();a.loops.each(function(c,d){d.hbs.length<=6&&util.Set.mergeIn(b,util.Set.fromList(util.map(d.hbs,function(b){return a.halfBonds.get(b).bid},this)))},this);var c={};return util.Set.each(b,function(a){c[a]=1},this),c}(),this._touched_cistransbonds=0,this._markCisTrans(a);var g=chem.MolfileSaver.getComponents(a),h=g.reactants.concat(g.products),i=new chem.Dfs(a,this.atoms,h,g.reactants.length);for(i.walk(),util.each(this.atoms,function(a){a.neighbours=[]},this),c=0;c<i.v_seq.length;c++){var j=i.v_seq[c],k=j.idx,l=j.parent_edge,m=j.parent_vertex;if(l>=0){var n=this.atoms[k],o=i.numOpeningCycles(l);for(d=0;o>d;d++)this.atoms[m].neighbours.push({aid:-1,bid:-1});if(i.edgeClosingCycle(l)){for(e=0;e<n.neighbours.length;e++)if(-1==n.neighbours[e].aid){n.neighbours[e].aid=m,n.neighbours[e].bid=l;break}if(e==n.neighbours.length)throw new Error("Internal: can not put closing bond to its place")}else n.neighbours.push({aid:m,bid:l}),n.parent=m;this.atoms[m].neighbours.push({aid:k,bid:l})}}try{var p=new chem.Stereocenters(a,function(a){return this.atoms[a].neighbours},this);p.buildFromBonds(this.ignore_errors),p.each(function(a,b){var c=-1;-1==b.pyramid[3]&&(c=3);var f=new Array(4),g=0,h=this.atoms[a];if(-1!=h.parent)for(e=0;4>e;e++)if(b.pyramid[e]==h.parent){f[g++]=e;break}for(-1!=c&&(f[g++]=c),d=0;d!=h.neighbours.length;d++)if(h.neighbours[d].aid!=h.parent)for(e=0;4>e;e++)if(h.neighbours[d].aid==b.pyramid[e]){if(g>=4)throw new Error("Internal: pyramid overflow");f[g++]=e;break}if(4==g)g=f[0],f[0]=f[1],f[1]=f[2],f[2]=f[3],f[3]=g;else if(3!=g)throw new Error("Cannot calculate chirality");this.atoms[a].chirality=chem.Stereocenters.isPyramidMappingRigid(f)?1:2},this)}catch(q){throw new Error(q.message)}var r=new Array;r.push(0);var s=!0;for(c=0;c<i.v_seq.length;c++){j=i.v_seq[c],k=j.idx,l=j.parent_edge,m=j.parent_vertex;var t=!0;if(m>=0){for(i.numBranches(m)>1&&this.atoms[m].branch_cnt>0&&this.atoms[m].paren_written&&(this.smiles+=")"),o=i.numOpeningCycles(l),d=0;o>d;d++){for(e=1;e<r.length&&-1!=r[e];e++);e==r.length?r.push(m):r[e]=m,this._writeCycleNumber(e)}if(m>=0){var u=i.numBranches(m);if(u>1&&this.atoms[m].branch_cnt<u-1&&(i.edgeClosingCycle(l)?this.atoms[m].paren_written=!1:(this.smiles+="(",this.atoms[m].paren_written=!0)),this.atoms[m].branch_cnt++,this.atoms[m].branch_cnt>u)throw new Error("Unexpected branch")}var v=a.bonds.get(l),w=!0,x=0;if(v.type==chem.Struct.BOND.TYPE.SINGLE&&(x=this._calcBondDirection(a,l,m)),1==x&&k==v.end||2==x&&k==v.begin?this.smiles+="/":2==x&&k==v.end||1==x&&k==v.begin?this.smiles+="\\":v.type==chem.Struct.BOND.TYPE.ANY?this.smiles+="~":v.type==chem.Struct.BOND.TYPE.DOUBLE?this.smiles+="=":v.type==chem.Struct.BOND.TYPE.TRIPLE?this.smiles+="#":v.type!=chem.Struct.BOND.TYPE.AROMATIC||this.atoms[v.begin].lowercase&&this.atoms[v.end].lowercase&&this.isBondInRing(l)?v.type==chem.Struct.BOND.TYPE.SINGLE&&this.atoms[v.begin].aromatic&&this.atoms[v.end].aromatic?this.smiles+="-":w=!1:this.smiles+=":",i.edgeClosingCycle(l)){for(d=1;d<r.length&&r[d]!=k;d++);if(d==r.length)throw new Error("Cycle number not found");this._writeCycleNumber(d),r[d]=-1,t=!1}}else s||(this.smiles+=this._written_components==i.nComponentsInReactants?">>":"."),s=!1,this._written_components++;t&&(this._writeAtom(a,k,this.atoms[k].aromatic,this.atoms[k].lowercase,this.atoms[k].chirality),this._written_atoms.push(j.idx))}return this.comma=!1,this._writeRadicals(a),this.comma&&(this.smiles+="|"),this.smiles},chem.SmilesSaver.prototype._writeCycleNumber=function(a){if(a>0&&10>a)this.smiles+=a;else if(a>=10&&100>a)this.smiles+="%"+a;else{if(!(a>=100&&1e3>a))throw new Error("Bad cycle number: "+a);this.smiles+="%%"+a}},chem.SmilesSaver.prototype._writeAtom=function(a,b,c,d,e){var f=a.atoms.get(b),g=!1,h=-1,i=0;if("A"==f.label)return void(this.smiles+="*");if("R"==f.label||"R#"==f.label)return void(this.smiles+="[*]");i=f.aam,"C"!=f.label&&"P"!=f.label&&"N"!=f.label&&"S"!=f.label&&"O"!=f.label&&"Cl"!=f.label&&"F"!=f.label&&"Br"!=f.label&&"B"!=f.label&&"I"!=f.label&&(g=!0),(f.explicitValence>=0||0!=f.radical||e>0||c&&"C"!=f.label&&"O"!=f.label||c&&"C"==f.label&&this.atoms[b].neighbours.length<3&&0==this.atoms[b].h_count)&&(h=this.atoms[b].h_count);var j=f.label;if(f.atomList&&!f.atomList.notList?(j=f.atomList.label(),g=!1):f.isPseudo()||f.atomList&&f.atomList.notList?(j="*",g=!0):(e||0!=f.charge||f.isotope>0||h>=0||i>0)&&(g=!0),g&&(-1==h&&(h=this.atoms[b].h_count),this.smiles+="["),f.isotope>0&&(this.smiles+=f.isotope),this.smiles+=d?j.toLowerCase():j,e>0&&(this.smiles+=1==e?"@":"@@",f.implicitH>1))throw new Error(f.implicitH+" implicit H near stereocenter");"H"!=f.label&&(h>1||0==h&&!g?this.smiles+="H"+h:1==h&&(this.smiles+="H")),f.charge>1?this.smiles+="+"+f.charge:f.charge<-1?this.smiles+=f.charge:1==f.charge?this.smiles+="+":-1==f.charge&&(this.smiles+="-"),i>0&&(this.smiles+=":"+i),g&&(this.smiles+="]")},chem.SmilesSaver.prototype._markCisTrans=function(a){this.cis_trans=new chem.CisTrans(a,function(a){return this.atoms[a].neighbours},this),this.cis_trans.build(),this._dbonds=new Array(a.bonds.count()),a.bonds.each(function(a){this._dbonds[a]={ctbond_beg:-1,ctbond_end:-1,saved:0}},this),this.cis_trans.each(function(b,c){var d=a.bonds.get(b);if(0!=c.parity&&!this.isBondInRing(b)){var e=this.atoms[d.begin].neighbours,f=this.atoms[d.end].neighbours,g=!0,h=!0;if(util.each(e,function(c){c.bid!=b&&a.bonds.get(c.bid).type==chem.Struct.BOND.TYPE.SINGLE&&(g=!1)},this),util.each(f,function(c){c.bid!=b&&a.bonds.get(c.bid).type==chem.Struct.BOND.TYPE.SINGLE&&(h=!1)},this),g||h)return;util.each(e,function(c){c.bid!=b&&(a.bonds.get(c.bid).begin==d.begin?this._dbonds[c.bid].ctbond_beg=b:this._dbonds[c.bid].ctbond_end=b)},this),util.each(f,function(c){c.bid!=b&&(a.bonds.get(c.bid).begin==d.end?this._dbonds[c.bid].ctbond_beg=b:this._dbonds[c.bid].ctbond_end=b)},this)}},this)},chem.SmilesSaver.prototype._updateSideBonds=function(a,b){var c=a.bonds.get(b),d=this.cis_trans.getSubstituents(b),e=this.cis_trans.getParity(b),f=[-1,-1,-1,-1];f[0]=a.findBondId(d[0],c.begin),-1!=d[1]&&(f[1]=a.findBondId(d[1],c.begin)),f[2]=a.findBondId(d[2],c.end),-1!=d[3]&&(f[3]=a.findBondId(d[3],c.end));var g=0,h=0,i=0,j=0;if(0!=this._dbonds[f[0]].saved&&(1==this._dbonds[f[0]].saved&&a.bonds.get(f[0]).begin==c.begin||2==this._dbonds[f[0]].saved&&a.bonds.get(f[0]).end==c.begin?g++:h++),-1!=f[1]&&0!=this._dbonds[f[1]].saved&&(2==this._dbonds[f[1]].saved&&a.bonds.get(f[1]).begin==c.begin||1==this._dbonds[f[1]].saved&&a.bonds.get(f[1]).end==c.begin?g++:h++),0!=this._dbonds[f[2]].saved&&(1==this._dbonds[f[2]].saved&&a.bonds.get(f[2]).begin==c.end||2==this._dbonds[f[2]].saved&&a.bonds.get(f[2]).end==c.end?i++:j++),-1!=f[3]&&0!=this._dbonds[f[3]].saved&&(2==this._dbonds[f[3]].saved&&a.bonds.get(f[3]).begin==c.end||1==this._dbonds[f[3]].saved&&a.bonds.get(f[3]).end==c.end?i++:j++),e==chem.CisTrans.PARITY.CIS?(g+=i,h+=j):(g+=j,h+=i),g>0&&h>0)throw new Error("Incompatible cis-trans configuration");return 0==g&&0==h?!1:(g>0&&(this._dbonds[f[0]].saved=a.bonds.get(f[0]).begin==c.begin?1:2,-1!=f[1]&&(this._dbonds[f[1]].saved=a.bonds.get(f[1]).begin==c.begin?2:1),this._dbonds[f[2]].saved=a.bonds.get(f[2]).begin==c.end==(e==chem.CisTrans.PARITY.CIS)?1:2,-1!=f[3]&&(this._dbonds[f[3]].saved=a.bonds.get(f[3]).begin==c.end==(e==chem.CisTrans.PARITY.CIS)?2:1)),h>0&&(this._dbonds[f[0]].saved=a.bonds.get(f[0]).begin==c.begin?2:1,-1!=f[1]&&(this._dbonds[f[1]].saved=a.bonds.get(f[1]).begin==c.begin?1:2),this._dbonds[f[2]].saved=a.bonds.get(f[2]).begin==c.end==(e==chem.CisTrans.PARITY.CIS)?2:1,-1!=f[3]&&(this._dbonds[f[3]].saved=a.bonds.get(f[3]).begin==c.end==(e==chem.CisTrans.PARITY.CIS)?1:2)),!0)},chem.SmilesSaver.prototype._calcBondDirection=function(a,b,c){var d;if(-1==this._dbonds[b].ctbond_beg&&-1==this._dbonds[b].ctbond_end)return 0;if(a.bonds.get(b).type!=chem.Struct.BOND.TYPE.SINGLE)throw new Error("Internal: directed bond type "+a.bonds.get(b).type);for(;;){if(d=0,this.cis_trans.each(function(b,c){0==c.parity||this.isBondInRing(b)||this._updateSideBonds(a,b)&&d++},this),d==this._touched_cistransbonds)break;this._touched_cistransbonds=d}return 0==this._dbonds[b].saved&&(this._dbonds[b].saved=c==a.bonds.get(b).begin?1:2),this._dbonds[b].saved},chem.SmilesSaver.prototype._writeRadicals=function(a){var b,c,d=new Array(this._written_atoms.length);for(b=0;b<this._written_atoms.length;b++)if(!d[b]){var e=a.atoms.get(this._written_atoms[b]).radical;if(0!=e)for(this.comma?this.smiles+=",":(this.smiles+=" |",this.comma=!0),this.smiles+=e==chem.Struct.ATOM.RADICAL.SINGLET?"^3:":e==chem.Struct.ATOM.RADICAL.DOUPLET?"^1:":"^4:",this.smiles+=b,c=b+1;c<this._written_atoms.length;c++)a.atoms.get(this._written_atoms[c]).radical==e&&(d[c]=!0,this.smiles+=","+c)}},!window.chem||!chem.Struct)throw new Error("chem.Molecule should be defined first");chem.InChiSaver=function(){},chem.InChiSaver.prototype.saveMolecule=function(a){var b="",c=null;if(ui.standalone)throw{message:"InChI is not supported in the standalone mode"};if(0!==a.rgroups.count())throw new Error("R-group fragments are not supported and will be discarded");if(a=a.getScaffold(),0===a.atoms.count())return b;a=a.clone(),a.sgroups.each(function(a,b){if("MUL"!==b.type)throw{message:"InChi data format doesn't support s-groups"}},this);var d=(new chem.MolfileSaver).saveMolecule(a);if(new Ajax.Request(ui.api_path+"getinchi",{method:"post",asynchronous:!1,parameters:{moldata:d},onComplete:function(a){a.responseText.startsWith("Ok.")?b=a.responseText.split("\n")[1]:c=a.responseText.startsWith("Error.")?{message:a.responseText.split("\n")[1]}:{message:"Unexpected server message ("+a.responseText+")"}}}),c)throw c;return b};var MolEdit_AtomColors={H:"#000000",He:"#849b9b",Li:"#c87efa",Be:"#82ab00",B:"#c38a8a",C:"#000000",N:"#304ff7",O:"#ff0d0d",F:"#6dab3c",Ne:"#7b9ca8",Na:"#ab5cf2",Mg:"#61b400",Al:"#a79191",Si:"#b09276",P:"#ff8000",S:"#c39517",Cl:"#1dc51d",Ar:"#63a2b0",K:"#8f40d4",Ca:"#2fc300",Sc:"#969696",Ti:"#94969a",V:"#96969a",Cr:"#8796c3",Mn:"#9c7ac7",Fe:"#e06633",Co:"#db8293",Ni:"#45b645",Cu:"#c78033",Zn:"#7d80b0",Ga:"#bd8c8c",Ge:"#668f8f",As:"#bd80e3",Se:"#e28f00",Br:"#a62929",Kr:"#53a6bc",Rb:"#702eb0",Sr:"#00d000",Y:"#5fa4a4",Zr:"#6ba2a2",Nb:"#61a4a9",Mo:"#4ea9a9",Tc:"#3b9e9e",Ru:"#248f8f",Rh:"#0a7d8c",Pd:"#006985",Ag:"#969696",Cd:"#ae9462",In:"#a67573",Sn:"#668080",Sb:"#9e63b5",Te:"#d47a00",I:"#940094",Xe:"#429eb0",Cs:"#57178f",Ba:"#00c900",La:"#57a4c5",Ce:"#989877",Pr:"#869d7b",Nd:"#7da07d",Pm:"#69a581",Sm:"#5ea883",Eu:"#43b089",Gd:"#31b48d",Tb:"#23b890",Dy:"#17bb92",Ho:"#00c578",Er:"#00c765",Tm:"#00c94e",Yb:"#00bf38",Lu:"#00ab24",Hf:"#42a8dc",Ta:"#4ba2f9",W:"#2194d6",Re:"#267dab",Os:"#266696",Ir:"#175487",Pt:"#9595a0",Au:"#b9981a",Hg:"#9595a9",Tl:"#a6544d",Pb:"#575961",Bi:"#9e4fb5",Po:"#ab5c00",At:"#754f45",Rn:"#428296",Fr:"#420066",Ra:"#007d00",Ac:"#669ce4",Th:"#00b8fc",Pa:"#00a1ff",U:"#008fff",Np:"#0080ff",Pu:"#006bff",Am:"#545cf2",Cm:"#785ce3",Bk:"#8a4fe3",Cf:"#a136d4",Es:"#b31fd4",Fm:"#B31FBA",Md:"#B30DA6",No:"#BD0D87",Lr:"#C70066",Rf:"#CC0059",Db:"#D1004F",Sg:"#D90045",Bh:"#E00038",Hs:"#E6002E",Mt:"#EB0026",Ds:"#9595a0",Rg:"#b9981a",Cn:"#9595a9"},Elements={"*":0,H:1,He:2,Li:3,Be:4,B:5,C:6,N:7,O:8,F:9,Ne:10,Na:11,Mg:12,Al:13,Si:14,P:15,S:16,Cl:17,Ar:18,K:19,Ca:20,Sc:21,Ti:22,V:23,Cr:24,Mn:25,Fe:26,Co:27,Ni:28,Cu:29,Zn:30,Ga:31,Ge:32,As:33,Se:34,Br:35,Kr:36,Rb:37,Sr:38,Y:39,Zr:40,Nb:41,Mo:42,Tc:43,Ru:44,Rh:45,Pd:46,Ag:47,Cd:48,In:49,Sn:50,Sb:51,Te:52,I:53,Xe:54,Cs:55,Ba:56,Hf:72,Ta:73,W:74,Re:75,Os:76,Ir:77,Pt:78,Au:79,Hg:80,Tl:81,Pb:82,Bi:83,Po:84,At:85,Rn:86,Fr:87,Ra:88,Rf:104,Db:105,Sg:106,Bh:107,Hs:108,Mt:109,Ds:110,Rg:111,Cn:112,Uut:113,Fl:114,Uup:115,Lv:116,Uus:117,Uuo:118,La:57,Ce:58,Pr:59,Nd:60,Pm:61,Sm:62,Eu:63,Gd:64,Tb:65,Dy:66,Ho:67,Er:68,Tm:69,Yb:70,Lu:71,Ac:89,Th:90,Pa:91,U:92,Np:93,Pu:94,Am:95,Cm:96,Bk:97,Cf:98,Es:99,Fm:100,Md:101,No:102,Lr:103},ElementNames=[];for(var el in Elements)ElementNames[Elements[el]]=el;var M_CE=1,M_AR=2,M_RNG=32,M_WK=1<<31,M_EXPLICT_QFM=64,M_APO=128,M_BO_UP=64,M_BO_DW=128,M_BO_TREE=256,M_BO_SLASH=512,M_BO_BSLASH=1024,HYB_SP1=1,HYB_SP2=2,HYB_SP3=3,CHI_R=1,CHI_S=2,STEREO_LABEL=["","(R)","(S)","(RS)"],E_BOTY_NL=0,E_BOTY_SI=1,E_BOTY_DD=2,E_BOTY_TR=3,E_BOTY_AR=4,E_BOTY_SD=5,E_BOTY_SA=6,E_BOTY_DA=7,E_BOTY_AH=8,E_BOTY_DS=9,E_BOCYTY_AH=0,E_BOCYTY_RN=1,E_BOCYTY_CN=2,ALS_NOOP=0,ALS_HIAND=1,ALS_OR=2,ALS_LOAND=3,ALS_NOT=4,MINVOL=.01,ATOM_DISPLAY_RS=1,MODE_NORMAL=0,MODE_ZOOM=1,MODE_ZROT=2,MODE_RECT_SEL=3,MODE_LASSO_SEL=4,MODE_DRAG_ATOMS=5,MODE_CHAIN=6,TO_RAD=.017453292519943,TO_DEG=57.29577951308232,rotateAroundImage=new Image;rotateAroundImage.src="src/img/action/rotate.svg",Array.prototype.map=function(a){for(var b=new Array(this.length),c=0;c<this.length;c++)b[c]=a(this[c]);return b},Array.prototype.forEach=function(a){for(var b=0;b<this.length;b++)a(this[b])},Array.prototype.fill=function(a){for(var b=0;b<this.length;b++)this[b]=a},Array.prototype.sub=function(a,b){for(var c=new Array(b),d=0;b>d;d++)c[d]=this[d+a];return c},Array.prototype.unique=function(){for(var a=[],b=0;b<this.length;b++)(0==a.length||a[a.length-1]!=this[b])&&a.push(this[b]);return a},WMatrix.prototype.translate=function(a,b,c){return this.mvm[12]+=a*this.mvm[0]+b*this.mvm[4]+c*this.mvm[8],this.mvm[13]+=a*this.mvm[1]+b*this.mvm[5]+c*this.mvm[9],this.mvm[14]+=a*this.mvm[2]+b*this.mvm[6]+c*this.mvm[10],this.mvm[15]+=a*this.mvm[3]+b*this.mvm[7]+c*this.mvm[11],this},WMatrix.prototype.rotateZ=function(a,b){var c;return c=this.mvm[0],this.mvm[0]=c*a+this.mvm[4]*b,this.mvm[4]=-c*b+this.mvm[4]*a,c=this.mvm[1],this.mvm[1]=c*a+this.mvm[5]*b,this.mvm[5]=-c*b+this.mvm[5]*a,c=this.mvm[2],this.mvm[2]=c*a+this.mvm[6]*b,this.mvm[6]=-c*b+this.mvm[6]*a,c=this.mvm[3],this.mvm[3]=c*a+this.mvm[7]*b,this.mvm[7]=-c*b+this.mvm[7]*a,this},WMatrix.prototype.rotateZAroundPoint=function(a,b,c){return this.translate(a,b,0).rotateZ(Math.cos(c),Math.sin(c)).translate(-a,-b,0)},WMatrix.prototype.map=function(a){var b=a.x*this.mvm[0]+a.y*this.mvm[4]+this.mvm[12],c=a.x*this.mvm[1]+a.y*this.mvm[5]+this.mvm[13];return{x:b,y:c,z:0}},Chemical.prototype.processChemical=function(){this.calcConnectivity(),this.assignHyb(),this.findRings(),this.assignCIP(),this.assignChirality()},Chemical.prototype.centerPoint=function(){return{x:(this.minx+this.maxx)/2,y:(this.miny+this.maxy)/2,z:0}},Chemical.prototype.calcConnectivity=function(){for(var a=0;a<this.atoms.length;a++)this.atoms[a].bo=[],this.atoms[a].ty=[],this.atoms[a].conn=0,this.atoms[a].nHyd=0,"undefined"==typeof this.atoms[a].qfm&&(this.atoms[a].qfm=0),"undefined"==typeof this.atoms[a].ms&&(this.atoms[a].ms=0);for(var a=0;a<this.bonds.length;a++){var b=this.bonds[a];"undefined"==typeof b.ms&&(b.ms=0);var c=b.ty;b.ms&M_AR&&(c|=4),this.atoms[b.fr].conn+=b.ty,this.atoms[b.to].conn+=b.ty,c|=b.ms&(M_RNG|M_BO_UP|M_BO_DW),this.atoms[b.fr].bo.push(b.to),this.atoms[b.fr].ty.push(c),this.atoms[b.to].bo.push(b.fr),this.atoms[b.to].ty.push(c),1==this.atoms[b.fr].cd&&this.atoms[b.to].nHyd++,1==this.atoms[b.to].cd&&this.atoms[b.fr].nHyd++}this.calcBox();for(var a=0;a<this.atoms.length;a++)this.atoms[a].conn=Math.floor(this.atoms[a].conn)},Chemical.prototype.calcBox=function(){this.minx=this.miny=Number.MAX_VALUE,this.maxx=this.maxy=-Number.MAX_VALUE;for(var a=0;a<this.atoms.length;a++){var b=this.atoms[a];this.minx=Math.min(b.x,this.minx),this.miny=Math.min(b.y,this.miny),this.maxx=Math.max(b.x,this.maxx),this.maxy=Math.max(b.y,this.maxy)}},Chemical.prototype.nbo_all=function(a){return a.bo.length+this.H(a)-a.nHyd},Chemical.prototype.calc_qfm=function(a){var b=function(a){return 5==a?-1:1},c=a.conn-this.V(a);return c>=0?c*b(a.cd):0},Chemical.prototype.get_qfm=function(a){return a.ms&M_EXPLICT_QFM?a.qfm:this.calc_qfm(a)},Chemical.prototype.H=function(a){if(1==a.cd)return 0;var b=this.V(a);if(0==b)return 0;var c=b-a.conn+a.qfm+a.nHyd;return 0>c?0:c},Chemical.prototype.V=function(a){switch(a.cd){case 8:return 2;case 7:return a.conn<=4?3:5;case 5:return a.conn<=4?3:5;case 6:return 4;case 34:case 16:return a.conn<=3?2:a.conn<=5?4:6;case 33:case 15:return a.conn<=4?3:a.conn<=6?5:6;case 14:return 4;case 17:return a.conn<=2?1:a.conn<=4?3:a.conn<=6?5:7;case 9:return 1;case 35:return a.conn<=2?1:a.conn<=4?3:a.conn<=6?5:7;case 53:return a.conn<=2?1:a.conn<=4?3:a.conn<=6?5:7;default:return a.conn}},Chemical.prototype.findPathToRoot=function(a,b,c){b.length=0,c.fill(!1);for(var d=a;null!=d.pv;)b.push(d.at),c[d.at]=!0,d=d.pv;b.push(d.at),c[d.at]=!0},Chemical.prototype.findShortestPath=function(a,b){for(var c=new Array,d=new Array,e=new Array,f=this.atoms.length,g=0;g<this.atoms.length;g++)c[g]=Number.MAX_VALUE,e[g]=-1,d[g]=g;for(c[a]=0;f>0;){for(var h=Number.MAX_VALUE,i=-1,g=0;g<c.length;g++)-1!=d[g]&&c[g]<h&&(h=c[g],i=g);if(-1==i)break;d[i]=-1,f--;for(var g=0;g<this.atoms[i].bo.length;g++){var j=c[i]+1,k=this.atoms[i].bo[g];j<c[k]&&(c[k]=j,e[k]=i)}}for(var l=new Array,m=b;-1!=e[m];)l.splice(0,0,m),m=e[m];return l},Chemical.prototype.treeFromAtom=function(a,b,c,d,e){var f=Array(2);f[0]=Array(),f[1]=Array();var g=0,h=1;d[b]={at:b,pv:c},f[g].push(d[b]);for(var i=0;f[g].length;){f[h].length=0;for(var j=0;j<f[g].length;j++){n=f[g][j],b=n.at;for(var k=0;k<this.atoms[b].bo.length;k++){var l=this.atoms[b].bo[k];e[l]||l==b||(e[l]=!0,d[l]={at:l,pv:n},f[h].push(d[l]))}}if(i++,i>=a)break;g=1-g,h=1-h}},Chemical.prototype.findRingFromBond=function(a,b){var c=this.atoms.length,d=new Array(c);d.fill(null);var e=new Array(c);e.fill(null);var f=new Array(c);f.fill(!1);var g=new Array(c);g.fill(!1),f[a.fr]=!0,g[a.to]=!0,g[a.fr]=!0,f[a.to]=!0,this.treeFromAtom(90,a.fr,null,d,f),this.treeFromAtom(90,a.to,null,e,g);for(var h,i,j=[],k=[],l=0;c>l;l++)if(null!=(h=d[l])&&null!=(i=e[d[l].at])){this.findPathToRoot(h,j,f),this.findPathToRoot(i,k,g);for(var m=0,n=0;n<f.length;n++)f[n]&&g[n]&&m++;if(1==m){var o=new Array(c);o.fill(0),j.forEach(function(a){o[a]=1}),k.forEach(function(a){o[a]=1});for(var p=!1,n=0;n<b.length;n++)if(0==cmp_rng(b[n],o)){p=!0;break}p||b.push(o)}}},Chemical.prototype.findRings=function(){var a=this,b=this.atoms.length,c=Array(b);c.fill(0);var d=[];this.rings.length=0,this.atoms.forEach(function(a){a.ms&=~(M_AR|M_RNG)}),this.bonds.forEach(function(a){a.ms&=~(M_AR|M_RNG)});for(var e=function(a){for(var b=0,c=0;c<a.length;c++)b+=a[c];
return b},f=function(a,b){for(var c=0;c<a.length;c++)a[c]&=b[c]},g=function(a,b){for(var c=0;c<a.length;c++)a[c]|=b[c]},h=function(a,b){for(var c=0;c<a.length;c++)if(a[c]!=b[c])return!1;return!0},i=new Array(this.bonds.length),j=new Array(b),k=0;k<this.bonds.length;k++){var l=this.bonds[k];l.ms&=~M_BO_TREE,i[k]={pbo:l,w:Math.min(this.atoms[l.to].bo.length,this.atoms[l.fr].bo.length)}}i.sort(function(a,b){return b.w-a.w});for(var k=0;b>k;k++)j[k]=k;for(var k=0;k<i.length;k++){var l=i[k].pbo;if(j[l.fr]!=j[l.to]){for(var m=Math.min(j[l.fr],j[l.to]),n=Math.max(j[l.fr],j[l.to]),o=0;b>o;o++)j[o]==n&&(j[o]=m);l.ms|=M_BO_TREE}}for(var p=0,k=0;k<this.bonds.length;k++){var l=this.bonds[k];l.ms&M_BO_TREE||(this.findRingFromBond(l,d),p++)}if(p<d.length){d.sort(function(a,b){return e(b)-e(a)});for(var q=new Array(b),k=d.length-1;k>=0;k--){q.fill(0);for(var o=0;o<d.length;o++)k!=o&&e(d[o])<=e(d[k])&&g(q,d[o]);if(f(q,d[k]),h(q,d[k])&&d.splice(k,1),d.length==p)break}}for(var k=0;k<d.length;k++)this.bonds.forEach(function(b){d[k][b.fr]&&d[k][b.to]&&(b.ms|=M_RNG,a.atoms[b.fr].ms|=M_RNG,a.atoms[b.to].ms|=M_RNG)});this.calcConnectivity();var r=new Array(d.length);for(r.fill(!1);;){for(var s=!1,k=0;k<d.length;k++)if(!r[k]){for(var t=[],o=0;o<d[k].length;o++)d[k][o]&&t.push(o);for(var u=0,o=0;o<t.length;o++){for(var v=this.atoms[t[o]],w=!1,x=0,y=0;y<v.bo.length;y++){var z=7&v.ty[y];if(-1!=t.indexOf(v.bo[y]))x+=4&z?1.5:3&z;else if((3&z)>=2&&!(v.ty[y]&M_RNG)){w=!0;break}}if(w)break;switch(v.cd){case 6:if(3!=x&&2.5!=x){w=!0;break}u+=1;break;case 7:case 15:if(3==x)u+=1;else{if(2!=x||5!=t.length){w=!0;break}u+=2}break;case 8:case 16:if(2!=x||5!=t.length){w=!0;break}u+=2}if(w)break}!w&&u>2&&(u-2)%4==0&&(this.bonds.forEach(function(b){d[k][b.fr]&&d[k][b.to]&&(b.ms|=M_AR,a.atoms[b.fr].ms|=M_AR,a.atoms[b.to].ms|=M_AR)}),r[k]=!0,s=!0,this.calcConnectivity())}if(!s)break}for(var k=0;k<d.length;k++){for(var t=[],o=0;o<d[k].length;o++)d[k][o]&&t.push(o);this.rings.push(t)}},Chemical.prototype.atomsInTheSameRing=function(a,b){var c,d;c=Number.MAX_VALUE,d=-1;for(var e=0;e<this.rings.length;e++)-1!=this.rings[e].indexOf(a)&&-1!=this.rings[e].indexOf(b)&&this.rings[e].length<c&&(d=e,c=this.rings[e].length);return d},Chemical.prototype.reassign_priorities=function(a,b){var c,d,e,f,g,h;for(c=0,d=a.length-1,h=0,e=c;d>=e;){for(b++,f=e;d>=f&&0==cmp_pri_lex(a[e],a[f]);)f++;for(f>d?f=d:f--,g=e;f>=g;g++)a[g].set(b);e=f+=1}},Chemical.prototype.assignHyb=function(){for(var a=this.atoms.length,b=0;a>b;b++){var c=this.atoms[b],d=0,e=0,f=0,g=0,h=0,i=0,j=0,k=0;if(c.ms&M_AR)c.hyb=HYB_SP2;else{for(var l=0;l<c.ty.length;l++){var m=c.ty[l],n=this.atoms[c.bo[l]];if(7==c.cd||8==c.cd||16==c.cd)for(var o=0;o<n.ty.length;o++)if(n.bo[o]!=b){var p=n.ty[o],q=n.bo[o];!(2==(15&p)||3==(15&p)||4&p)||1!=(15&m)||6!=n.cd&&7!=n.cd&&8!=n.cd||(3!=(15&p)&&h++,g++),1==(15&m)&&1==(15&p)&&6==n.cd&&8==q.cd&&1==q.bo.length&&i++,1!=(15&m)||2!=(15&p)||6!=n.cd||8!=q.cd&&16!=q.cd||k++}2==(15&m)?(1==c.bo.length&&j++,d++):3==(15&m)?e++:1==(15&m)&&8==n.cd&&1==n.bo.length&&f++}if(this.nbo_all(c)>3)c.hyb=HYB_SP3;else switch(c.cd){case 6:case 14:c.hyb=1==e||2==d&&2==c.bo.length?HYB_SP1:f>1?HYB_SP2:1==d?HYB_SP2:HYB_SP3;break;case 7:c.hyb=1==e||2==d&&2==c.bo.length?HYB_SP1:g>=1?HYB_SP2:1==d?HYB_SP2:HYB_SP3;break;case 8:c.hyb=1==e?HYB_SP1:1==i&&1==c.bo.length?HYB_SP2:h>=1?HYB_SP2:1==d?HYB_SP2:HYB_SP3;break;case 15:case 16:c.hyb=1==j&&1==c.bo.length?HYB_SP2:g>=1&&2==c.bo.length?HYB_SP2:HYB_SP3;break;default:c.hyb=0}}}},Chemical.prototype.assignChirality=function(){for(var a=function(a){var b,c,d,e,f;return b=vector(a[0].pat,a[1].pat),c=vector(a[0].pat,a[2].pat),d=vector(a[0].pat,a[3].pat),e=vemul(b,c),f=scmul(e,d)},b=function(a){return a&M_BO_DW?-1:a&M_BO_UP?1:0},c=0;c<this.atoms.length;c++){var d=this.atoms[c];if(d.eo=0,d.peo=0,!(3!=d.hyb||d.bo.length<=2||4!=this.nbo_all(d))){for(var e=[],f=0,g=0;g<d.bo.length;g++)e[e.length]={pat:this.atoms[d.bo[g]],eo:d.ty[g]&(M_BO_UP|M_BO_DW),rng:d.ty[g]&M_RNG,nu:d.bo[g]+1},f+=e[g].eo;e.sort(function(a,b){return b.pat.ou-a.pat.ou});for(var h=!0,g=0;g<e.length-1;g++)if(e[g].pat.ou==e[g+1].pat.ou){h=!1;break}if(h)if(0!=f){3==e.length&&(e[e.length]={pat:d,eo:0,rng:0,nu:Number.MAX_VALUE});for(var g=0;g<e.length;g++)e[g].pat.z=.3*b(e[g].eo);var i=a(e);d.eo=0>i?CHI_S:CHI_R,e.sort(function(a,b){return a.nu-b.nu});var i=a(e);d.peo=0>i?2:1;for(var g=0;g<e.length;g++)e[g].pat.z=0}else d.eo=CHI_S|CHI_R}}},Chemical.prototype.assignCIP=function(){for(var a=new Array(this.atoms.length),b=0;b<this.atoms.length;b++)this.atoms[b].ou=0,a[b]={pat:this.atoms[b],atnum:b,p:[this.atoms[b].cd],set:function(a){this.p=[a],this.pat.ou=a},sort:function(){if(this.p.length>2){var a=this.p.sub(1,this.p.length-1);a.sort(function(a,b){return b>a?1:a>b?-1:0}),a.unshift(this.p[0]),this.p=a}}};a.sort(cmp_pri_lex),this.reassign_priorities(a,0);for(var b,c,d,e=this.atoms.length;;){var f,g,h;for(d=100;;){for(h=num_uniq_cip(a),f=g=0;e>f;){for(;e>g&&0==cmp_pri_lex(a[f],a[g]);)g++;if(g==e?g=e-1:g--,g!=f)for(b=f;g>=b;b++){var i=a[b].pat;for(c=0;c<i.bo.length;c++){var j=this.atoms[i.bo[c]];if(1!=j.cd)switch(15&i.ty[c]){case 3:a[b].p.push(j.ou);case 2:a[b].p.push(j.ou),a[b].p.push(j.ou);break;case 5:case 6:case 4:a[b].p.push(1.5*j.ou);break;default:a[b].p.push(j.ou)}}a[b].sort()}f=g+=1}if(a.sort(cmp_pri_lex),this.reassign_priorities(a,0),h==num_uniq_cip(a))break}this.reassign_priorities(a,0);break}},Chemical.prototype.mapAtom=function(a){for(var b=[],c=0;c<this.atoms.length;c++){var d=a(this.atoms[c],c);null!=d&&b.push(d)}return b},Chemical.prototype.bondLength=function(){return this.bonds.length>0?vectorLength(vesub(this.atoms[this.bonds[0].fr],this.atoms[this.bonds[0].to])):1.4},Chemical.prototype.moveAtoms=function(a,b){for(var c=0;c<a.length;c++)vecpy(this.atoms[a[c]],veadd(this.atoms[a[c]],b))},Chemical.prototype.updateAtomSelection=function(a){for(var b=0;b<this.atoms.length;b++){var c=this.atoms[b];testPolyInclusion(c,a)?c.ms|=M_CE:c.ms&=~M_CE}for(var b=0;b<this.bonds.length;b++){var d=this.bonds[b],c=vemulby(veadd(this.atoms[d.fr],this.atoms[d.to]),.5);testPolyInclusion(c,a)?d.ms|=M_CE:d.ms&=~M_CE}},Chemical.prototype.rotateAtomsVector=function(a,b,c,d){if(-1!=d&&1==a.length)return void vecpy(this.atoms[a[0]],this.atoms[d]);if(0!=a.length){var e=vector(b,this.atoms[a[0]]);1==a.length&&vectorLength(e)!=this.bondLength()&&(e=vectorSetLength(e,this.bondLength()),vecpy(this.atoms[a[0]],veadd(b,e)));var f=Math.acos(scmul(e,c)/(vectorLength(e)*vectorLength(c)));f=12*Math.round(f*TO_DEG/12)*TO_RAD,this.rotateAtomsAround(a,b,f*vemulZSign(e,c))}},Chemical.prototype.rotateAtomsAround=function(a,b,c){for(var d=(new WMatrix).rotateZAroundPoint(b.x,b.y,c),e=0;e<a.length;e++){var f=d.map(this.atoms[a[e]]);this.atoms[a[e]].x=f.x,this.atoms[a[e]].y=f.y}this.calcBox()},Chemical.prototype.setBondLength=function(a){if(this.bonds.length){var b=vectorLength(vector(this.atoms[this.bonds[0].fr],this.atoms[this.bonds[0].to]));if(!(Math.abs(1-a/b)<.1)){var c=a/b;this.atoms.forEach(function(a){vecpy(a,vemulby(a,c))})}}},Chemical.prototype.expHydrogenToImp=function(){for(var a=[],b=0;b<this.atoms.length;b++)"undefined"==typeof this.atoms[b].atts&&(this.atoms[b].atts={}),"undefined"==typeof this.atoms[b].atts.H&&(this.atoms[b].atts.H=0),1==this.atoms[b].cd&&a.push(b);for(var b=0;b<this.bonds.length;b++){var c=this.bonds[b];1==this.atoms[c.fr].cd&&this.atoms[c.to].atts.H++,1==this.atoms[c.to].cd&&this.atoms[c.fr].atts.H++}return this.removeAtoms(a),this},Chemical.prototype.apoFromSelection=function(){var a=[],b=this;this.atoms.forEach(function(a){a.ms&=~M_WK}),this.bonds.forEach(function(a){a.ms&M_CE&&(b.atoms[a.fr].ms|=M_WK,b.atoms[a.to].ms|=M_WK)});for(var c=0;c<this.bonds.length;c++){var d=this.bonds[c];this.atoms[d.fr].ms&(M_CE|M_WK)&&!(this.atoms[d.to].ms&(M_CE|M_WK))?a.push(d.fr):!(this.atoms[d.fr].ms&(M_CE|M_WK))&&this.atoms[d.to].ms&(M_CE|M_WK)&&a.push(d.to)}return a.sort(function(a,b){return a-b}).unique()},Chemical.prototype.makeAtom=function(a){return this.atoms.push({x:0,y:0,z:0,cd:a,ms:0}),this.processChemical(),this},Chemical.prototype.makeBond=function(a,b){var c=1.2;return this.atoms=[],this.bonds=[],this.atoms.push({x:0,y:0,z:0,cd:6,ms:0}),this.atoms.push({x:c,y:1.2*Math.tan(a*TO_RAD),z:0,cd:6,ms:0}),this.bonds.push({fr:0,to:1,ty:b,ms:0}),this.processChemical(),this},Chemical.prototype.makeMacroCycle=function(a){var b=this.bonds.length?vectorLength(vector(this.atoms[this.bonds[0].fr],this.atoms[this.bonds[0].to])):1.2;this.atoms=[],this.bonds=[];var c=60*TO_RAD,d={x:b,y:0,z:0},e={x:0,y:0,z:0},a=32;sz=a%2==0?(a-2)/2:(a-3)/2;for(var f=[],g=0;sz-1>g;g++)f.push(g%2?-1:1);f.push(f[f.length-1]),f.push(0),f.push(f[f.length-2]),f.push(f[f.length-1]);for(var g=0;sz-3>g;g++)f.push(-f[f.length-1]);for(var g=0;a>g;g++){var h={x:e.x,y:e.y,z:e.z,cd:6,ms:0,bo:[],ty:[]};this.atoms[this.atoms.length]=h,g&&(this.bonds[this.bonds.length]={fr:g-1,to:g,ty:1,ms:0});var i=(new WMatrix).rotateZAroundPoint(0,0,c*f[g%f.length]);vecpy(d,i.map(d)),e=veadd(e,d)}return this.processChemical(),this},Chemical.prototype.makeRing=function(a,b){var c=this.bonds.length?vectorLength(vector(this.atoms[this.bonds[0].fr],this.atoms[this.bonds[0].to])):1.2,d=Math.sin(Math.PI/a),e=c/(2*d);this.atoms=[],this.bonds=[];for(var f=0,g=0;a>g;g++){var h={x:e*Math.sin(2*g*Math.PI/a),y:e*Math.cos(2*g*Math.PI/a),z:0,cd:6,ms:0,bo:[],ty:[]};this.atoms[this.atoms.length]=h,g&&(this.bonds[this.bonds.length]={fr:g-1,to:g,ty:b?f+1:1,ms:0},f=1-f)}return this.bonds.push({fr:0,to:this.bonds.length,ty:b?f+1:1,ms:0}),this.processChemical(),this},Chemical.prototype.atProp=function(a,b){return"undefined"!=typeof a.atts&&"undefined"!=typeof a.atts[b]&&a.atts[b]?a.atts[b]+1:0},Chemical.prototype.toMol=function(){var a,b=new Date,c=0;a=sprintf("%s  MOLSOFT %02d%02d%02d%02d%02d2D\n\n","\n",b.getMonth()+1,b.getDate(),b.getFullYear()%100,b.getHours(),b.getMinutes()),a+=sprintf("%3d%3d%3d  0%3d%3d  0  0  0  0999 V2000%s",this.atoms.length,this.bonds.length,0,c,0,"\n");for(var d=0;d<this.atoms.length;d++){var e=this.atoms[d],f=ElementNames[e.cd];1==f.length&&(f+=" "),a+=sprintf("%10.4f%10.4f%10.4f %-3s%2d%3d%3d%3d%s",e.x,e.y,0,f,0,0,e.peo,this.atProp(e,"H",0),"\n")}for(var d=0;d<this.bonds.length;d++){var g=this.bonds[d],h=(g.ms&(M_BO_UP|M_BO_DW))==M_BO_UP?1:(g.ms&(M_BO_UP|M_BO_DW))==M_BO_DW?6:0;a+=sprintf("%3d%3d%3d%3d%s",g.fr+1,g.to+1,g.ty,h,"\n")}for(var i="",j=0,d=0;d<this.atoms.length;d++)(q=this.get_qfm(this.atoms[d]))&&(i+=sprintf(" %3d %3d",d+1,q),j++);j&&(a+=sprintf("M  CHG%3d%s\n",j,i));for(var d=0;d<this.atoms.length;d++)if(this.atoms[d].hasOwnProperty("atts")){var e=this.atoms[d],f="";for(var k in e.atts)e.atts.hasOwnProperty(k)&&(f.length&&(f+=";"),f+=k+e.atts[k]);f.length&&(a+=sprintf("M  ZLS %d [%s;%s]\n",d+1,ElementNames[e.cd],f))}return a+="M  END\n"},Chemical.prototype.parseMol=function(a){var b=[],c=[],d=a.split("\n");if(d.length>4){for(var e=parseInt(d[3].substring(0,3)),f=parseInt(d[3].substring(3,6)),g=4,h=0;e>h;h++)b[b.length]={x:parseFloat(d[g+h].substring(0,10)),y:parseFloat(d[g+h].substring(10,20)),z:parseFloat(d[g+h].substring(20,30)),cd:Elements[d[g+h].substring(31,33).replace(/\s+$/,"")],ms:0,qfm:0,bo:[],ty:[]};g+=e;for(var h=0;f>h;h++){c[c.length]={fr:parseInt(d[g+h].substring(0,3))-1,to:parseInt(d[g+h].substring(3,6))-1,ty:parseInt(d[g+h].substring(6,9)),ms:0};var i=parseInt(d[g+h].substring(9,12));1==i?c[c.length-1].ms|=M_BO_UP:6==i&&(c[c.length-1].ms|=M_BO_DW)}g+=f,h=0;for(var h=0;g+h<d.length;h++)if(d[g+h].match(/M  ZLS/))for(var j=d[g+h].substring(7).split(/[ ]+/g),k=0;k<j.length;k++){var l=parseInt(j[k])-1;if(!(0>l||l>=b.length)){for(var m,n={},o=/([^\[\];]+);?/g;m=o.exec(j[k+1]);)m[1]in Elements?b[l].cd=Elements[m[1]]:m[1].match(/[DHR][0-9]+/)&&(n[m[1].substring(0,1)]=parseInt(m[1].substring(1)));count_properties(n)>0&&(b[l].atts=n)}}else if(d[g+h].match(/M  CHG/))for(var j=d[g+h].substring(7).trim().split(/[ ]+/g),k=1;k<j.length-1;k+=2){var p=parseInt(j[k]),q=parseInt(j[k+1]);1>l||l>e||(b[p-1].ms|=M_EXPLICT_QFM,b[p-1].qfm|=q)}}return this.atoms=b,this.bonds=c,this.setBondLength(1.2),this.processChemical(),this},Chemical.prototype.parseString=function(a,b){-1!=a.indexOf("M  END")?(this.parseMol(a),"function"==typeof b&&b()):this.parseSmiles(a,b)},Chemical.prototype.removeAtoms=function(a){for(var b=new Array(this.atoms.length),c=0;c<a.length;c++)b[a[c]]=-1;for(var d=0,c=0;c<b.length;c++)-1!=b[c]&&(b[c]=d++);for(var c=0;c<this.bonds.length;)-1==b[this.bonds[c].fr]||-1==b[this.bonds[c].to]?this.bonds.splice(c,1):(this.bonds[c].fr=b[this.bonds[c].fr],this.bonds[c].to=b[this.bonds[c].to],c++);a.sort(function(a,b){return a-b});for(var c=a.length-1;c>=0;c--)this.atoms.splice(a[c],1);this.processChemical()},Chemical.prototype.removeBonds=function(a){a.sort(function(a,b){return a-b});for(var b=a.length-1;b>=0;b--)this.bonds.splice(a[b],1);this.processChemical()},Chemical.prototype.findClosestBond=function(a){for(var b=-1,c=0;c<this.bonds.length;c++){var d=vemulby(veadd(this.atoms[this.bonds[c].fr],this.atoms[this.bonds[c].to]),.5);if(vectorLength(vector(d,a))<=.5){b=c;break}}return b},Chemical.prototype.findClosestAtom=function(a){for(var b=-1,c=0;c<this.atoms.length;c++)if(vectorLength(vector(this.atoms[c],a))<=.5){b=c;break}return b},Chemical.prototype.getSelectedAtoms=function(a){for(var b=[],c=0;c<this.atoms.length;c++)this.atoms[c].ms&a&&b.push(c);return b},Chemical.prototype.findClosestAtomLong=function(a){if(0==this.atoms.length)return-1;for(var b,c=0,d=vectorLength(vector(this.atoms[0],a)),e=1;e<this.atoms.length;e++)(b=vectorLength(vector(this.atoms[e],a)))<d&&(d=b,c=e);return c},Chemical.prototype.hasCollisions=function(a){for(var b=0;b<this.atoms.length;b++)if(b!=a&&vectorLength(vector(this.atoms[a],this.atoms[b]))<=.2)return!0;return!1},Chemical.prototype.gravitateCollisions=function(){var a=[],b=new Array(this.atoms.length);b.fill(-1);for(var c=0;c<this.atoms.length;c++)for(var d=c+1;d<this.atoms.length;d++)vectorLength(vector(this.atoms[c],this.atoms[d]))<=.2&&(b[d]=c,a.push(d));if(a.length>0){a.sort(function(a,b){return a-b});for(var e=[],d=0,c=0;c<this.atoms.length;c++)-1==b[c]&&(e[c]=d++);for(var c=0;c<this.bonds.length;c++)-1!=b[this.bonds[c].fr]?-1!=b[this.bonds[c].to]?(this.bonds.splice(c,1),c--):(this.bonds[c].fr=e[b[this.bonds[c].fr]],this.bonds[c].to=e[this.bonds[c].to]):-1!=b[this.bonds[c].to]?(this.bonds[c].to=e[b[this.bonds[c].to]],this.bonds[c].fr=e[this.bonds[c].fr]):(this.bonds[c].to=e[this.bonds[c].to],this.bonds[c].fr=e[this.bonds[c].fr]);for(var c=a.length-1;c>=0;c--)this.atoms.splice(a[c],1);return this.processChemical(),!0}return!1},Chemical.prototype.bondToggle=function(a,b){var c=this.bonds[a],d=c.ms;if(c.ms&=~(M_BO_UP|M_BO_DW),4==b){c.ty=1,c.ms|=d&M_BO_UP?M_BO_DW:M_BO_UP;var e=this.atoms[c.fr],f=this.atoms[c.to];if(1==e.bo.length&&f.bo.length>1){var g=c.fr;c.fr=c.to,c.to=g}else if(!e.eo&&f.eo){var g=c.fr;c.fr=c.to,c.to=g}}else if(-1!=b&&1!=b||d&(M_BO_UP|M_BO_DW))c.ty=b;else{var h=2;!(this.atoms[c.fr].ms&M_RNG)&&!(this.atoms[c.to].ms&M_RNG)&&this.atoms[c.fr].bo.length<=2&&this.atoms[c.to].bo.length<=2&&(h=3),c.ty=c.ty%h+1}this.processChemical()},Chemical.prototype.chargeAtom=function(a){var b=this.atoms[a];switch(b.tmp="undefined"==typeof b.tmp?0:(b.tmp+1)%5,b.tmp){case 0:case 1:b.ms|=M_EXPLICT_QFM,b.qfm=b.tmp+1;break;case 2:b.ms&=~M_EXPLICT_QFM,b.qfm=this.calc_qfm(b);break;case 3:case 4:b.ms|=M_EXPLICT_QFM;var c=b.tmp-2;c>this.V(b)-b.conn&&(b.tmp+=c-this.V(b)+b.conn-1,c=this.V(b)-b.conn),b.qfm=-c}},Chemical.prototype.changeAtom=function(a,b,c){var d=this.atoms[a];-1!=b&&(d.cd=b),d.atts=c,this.processChemical()},Chemical.prototype.neibVector2=function(a,b){var c=vector(a,this.atoms[a.bo[0]]),d=vector(a,this.atoms[a.bo[1]]);return vectorSetLength(vemulby(veadd(c,d),b),vectorLength(c))},Chemical.prototype.ringCenter=function(a){for(var b={x:0,y:0,z:0},c=0;c<this.rings[a].length;c++)b=veadd(b,this.atoms[this.rings[a][c]]);return vemulby(b,1/this.rings[a].length)},Chemical.prototype.bondOrtho=function(a,b,c,d){var e=this.atoms[a],f=this.atoms[b];if(1==e.bo.length&&1==f.bo.length||3==c){var g=vectorSetLength(vector(e,f),d);return{x:-g.y,y:g.x,z:0}}var h=this.atomsInTheSameRing(a,b);if(-1!=h){var g=vector(e,f),i=vector(vemulby(veadd(e,f),.5),this.ringCenter(h));return vectorSetLength(i,d)}var j=-1;if(e.bo.length>1){for(var k=0;k<e.bo.length;k++)if(e.bo[k]!=b&&-1!=this.atomsInTheSameRing(e.bo[k],b)){j=e.bo[k];break}if(-1==j)for(var k=0;k<e.bo.length;k++)if(e.bo[k]!=b){j=e.bo[k];break}}else{for(var k=0;k<f.bo.length;k++)if(f.bo[k]!=a&&-1!=this.atomsInTheSameRing(f.bo[k],a)){j=f.bo[k];break}if(-1==j)for(var k=0;k<f.bo.length;k++)if(f.bo[k]!=a){j=f.bo[k];break}}var l=this.atoms[j],m=vector(e,f),n=vector(f,l),g=vemul(vemul(m,n),m);return vectorSetLength(g,d)},Chemical.prototype.placeFragment=function(a,b){var c=this;b=clone_object(b);var d=vesub(a,b.centerPoint()),e=this.atoms.length;b.atoms.forEach(function(a){vecpy(a,veadd(a,d)),c.atoms.push(a)}),b.bonds.forEach(function(a){c.bonds.push({fr:a.fr+e,to:a.to+e,ty:a.ty,ms:0})}),this.processChemical()},Chemical.prototype.connectToBond=function(a,b){var c=this,d=this.bonds[a],e=0,f=6==b.atoms.length&&b.atoms[0].ms&M_AR;if(b=clone_object(b),f){for(var g=0;g<b.bonds.length;g++)if(b.bonds[g].ty==d.ty){e=g;break}if(d.ms&M_AR&&1==b.bonds[e].ty)for(var h=0,g=1;5>=g;g++)b.bonds[(e+g)%b.bonds.length].ty=h+1,h=1-h}var i=b.bonds[e],j=vemulby(this.bondOrtho(d.fr,d.to,1,1),-1),k=vemulby(veadd(this.atoms[d.fr],this.atoms[d.to]),.5),l=b.bondOrtho(i.fr,i.to,1,1),m=vemulby(veadd(b.atoms[i.fr],b.atoms[i.to]),.5),n=Math.acos(Math.max(-1,Math.min(1,scmul(j,l)/(vectorLength(j)*vectorLength(l)))))*vemulZSign(l,j),o=vesub(k,m),p=(new WMatrix).rotateZAroundPoint(k.x,k.y,n),q=this.atoms.length;b.atoms.forEach(function(a){vecpy(a,p.map(veadd(a,o))),c.atoms.push(clone_object(a))}),b.bonds.forEach(function(a){c.bonds.push({fr:a.fr+q,to:a.to+q,ty:a.ty,ms:0})}),this.gravitateCollisions()||this.processChemical()},Chemical.prototype.chainTo=function(a,b,c,d){var e,f=this.atoms[a],g=vector(f,d);if(0==f.bo.length){var h={x:1.2,y:0,z:0},i=Math.acos(scmul(h,g)/(vectorLength(h)*vectorLength(g)))*vemulZSign(h,g);i=12*Math.round(i*TO_DEG/12)*TO_RAD,h.x=1.2*Math.cos(i),h.y=1.2*Math.sin(i),e=veadd(f,h)}else{var j=this.atoms[f.bo[0]],h=vector(j,f);e=veadd(f,h),e=(new WMatrix).rotateZAroundPoint(f.x,f.y,-vemulZSign(h,vector(d,j))*Math.PI/3).map(e)}var k={x:e.x,y:e.y,z:0,cd:6,bo:[],ty:[]};return this.atoms.push(k),this.bonds.push({fr:a,to:this.atoms.length-1,ty:b,ms:0}),this.processChemical(),this.atoms.length-1},Chemical.prototype.connectTo=function(a,b,c,d){var e=this,f=this.atoms[a],g=null;if(3==b&&1!=f.bo.length)return[];var h=null;if(null!=c){c=clone_object(c),h=c.atoms[d],2==f.bo.length&&2==h.bo.length&&(g=veadd(h,c.neibVector2(h,-1)),h={x:g.x,y:g.y,z:0,cd:6,bo:[],ty:[]},c.atoms.push(h),c.bonds.push({fr:d,to:c.atoms.length-1,ty:1,ms:0}),d=c.atoms.length-1,c.calcConnectivity(),h=c.atoms[d]);var i;switch(f.bo.length){case 0:i={x:1.2,y:0,z:0};break;case 1:i=vector(f,this.atoms[f.bo[0]]);break;case 2:i=this.neibVector2(f,-1);break;default:return[]}var j;switch(h.bo.length){case 0:j={x:1.2,y:0,z:0};break;case 1:j=vector(h,c.atoms[h.bo[0]]);break;case 2:j=c.neibVector2(h,-1);break;default:return[]}var k=Math.acos(scmul(j,i)/(vectorLength(j)*vectorLength(i)))*vemulZSign(j,i),l=[],m=vesub(f,h),n=(new WMatrix).rotateZAroundPoint(f.x,f.y,k),o=this.atoms.length,p=[],q=0;return c.atoms.forEach(function(b){vecpy(b,n.map(veadd(b,m))),b!=h?(p[q]=o,l.push(o++),e.atoms.push(clone_object(b))):p[q]=a,q++}),c.bonds.forEach(function(a){e.bonds.push({fr:p[a.fr],to:p[a.to],ty:a.ty,ms:0})}),this.processChemical(),l}switch(f.bo.length){case 0:g=veadd(f,{x:1.2,y:0,z:0});break;case 1:var r=this.atoms[f.bo[0]],j=vector(r,f);if(3==b||2==b&&2==f.ty[0])g=veadd(f,j);else if(2==r.bo.length){var q=r.bo[0]==a?r.bo[1]:r.bo[0];g=veadd(f,vector(this.atoms[q],r))}else g=veadd(f,j),g=(new WMatrix).rotateZAroundPoint(f.x,f.y,Math.PI/3).map(g);break;case 2:var s=vector(f,this.atoms[f.bo[0]]),t=vector(f,this.atoms[f.bo[1]]);g=veadd(f,vectorSetLength(vemulby(veadd(s,t),-1),vectorLength(s)));break;default:for(var u=0,v=-1,w=-1,q=0;q<f.bo.length;q++)for(var s=vector(f,this.atoms[f.bo[q]]),x=0;x<f.bo.length;x++)if(q!=x){for(var t=vector(f,this.atoms[f.bo[x]]),y=Math.acos(scmul(s,t)/(vectorLength(s)*vectorLength(t))),j=veadd(s,t),z=!0,A=0;A<f.bo.length;A++)if(A!=q&&A!=x){var B=vector(f,this.atoms[f.bo[A]]),C=Math.acos(scmul(s,B)/(vectorLength(s)*vectorLength(B))),D=Math.acos(scmul(t,B)/(vectorLength(t)*vectorLength(B)));if(Math.abs(C+D-y)<=.001){z=!1;break}}if(!z)continue;y>u&&(u=y,v=q,w=x)}if(-1!=v&&-1!=w){var s=vector(f,this.atoms[f.bo[v]]),t=vector(f,this.atoms[f.bo[w]]);g=veadd(f,vectorSetLength(veadd(s,t),vectorLength(s)))}}if(null!=g){var E={x:g.x,y:g.y,z:0,cd:6,bo:[],ty:[]};this.atoms.push(E);var F=0;return 4==b&&(b=1,F=M_BO_UP),this.bonds.push({fr:a,to:this.atoms.length-1,ty:b,ms:F}),this.processChemical(),[this.atoms.length-1]}return[]};var Rings=[(new Chemical).makeRing(6,!0),(new Chemical).makeRing(3,!1),(new Chemical).makeRing(4,!1),(new Chemical).makeRing(5,!1),(new Chemical).makeRing(6,!1),(new Chemical).makeRing(7,!1)];ChemicalView.prototype.resize=function(){this.canvas.width=this.parent.width()*this.scaleFactor,this.canvas.height=this.parent.height()*this.scaleFactor,jQuery(this.canvas).css({width:this.parent.width(),height:this.parent.height()}),this.updateZoom=!0,this.drawMol()},ChemicalView.prototype.setElement=function(a){this.activeTool.id="me-elements",this.activeTool.toolType="atom",this.activeTool.cd=a},ChemicalView.prototype.showStatus=function(){},ChemicalView.prototype.clearStatus=function(){},ChemicalView.prototype.addTool=function(a,b,c){var d=jQuery("#"+b);return d.data("toolType",a),d.on("mousedown",c),d},ChemicalView.prototype.addToolBond=function(a,b,c){var d=this.addTool("bond",b,c);return d.data("ty",a),d},ChemicalView.prototype.addToolAtom=function(a,b,c){var d=this.addTool("atom",b,c);return d.data("cd",a),d},ChemicalView.prototype.toolButtonClicked=function(a){void 0!==a&&((this.activeTool||{id:""}).id==a.id?(jQuery("#me-move").addClass("selected"),this.activeTool={id:"me-move",toolType:"move"}):(this.activeTool={},this.activeTool.id=a.id,a=jQuery(a),this.activeTool.toolType=a.data("toolType"),a.data("ty")&&(this.activeTool.ty=a.data("ty")),a.data("cd")&&(this.activeTool.cd=a.data("cd")),"eraser"==this.activeTool.toolType&&(this.undoPush(),this.chem.removeAtoms(this.getSelectedAtoms()),this.h_bond=this.h_atom=-1,this.changed())))},ChemicalView.prototype.changed=function(a){void 0===this.onChanged||a||this.onChanged(),this.undoStack.length>0?jQuery("#me-undo").removeClass("disabled"):jQuery("#me-undo").addClass("disabled"),this.redoStack.length>0?jQuery("#me-redo").removeClass("disabled"):jQuery("#me-redo").addClass("disabled")},ChemicalView.prototype.isEmpty=function(){return 0==this.chem.atoms.length},ChemicalView.prototype.undoPush=function(a){this.undoStack.push(clone_object(this.chem)),this.changed(a)},ChemicalView.prototype.loadMOL=function(a){this.undoPush(),this.chem=(new Chemical).parseMol(a),this.last_atom_length=this.chem.atoms.length,this.updateZoom=!0,this.drawMol()},ChemicalView.prototype.getMOL=function(){return this.chem.toMol()},ChemicalView.prototype.clearMol=function(){this.undoPush(),this.chem=new Chemical,this.drawMol(),this.changed()},ChemicalView.prototype.undo=function(){this.undoStack.length>0&&(this.redoStack.push(clone_object(this.chem)),this.chem=this.undoStack.pop(),this.h_atom=this.h_bond=-1,this.drawMol(),this.changed())},ChemicalView.prototype.undoSimple=function(){this.undoStack.length>0&&(this.chem=this.undoStack.pop(),this.h_atom=this.h_bond=-1)},ChemicalView.prototype.redo=function(){this.redoStack.length>0&&(this.undoStack.push(clone_object(this.chem)),this.chem=this.redoStack.pop(),this.drawMol(),this.changed())},ChemicalView.prototype.removeImplicitHydrogen=function(){function a(a,b){for(var c=0;c<this.chem.bonds.length;c++)if(this.chem.bonds[c].fr==a&&this.chem.bonds[c].to==b||this.chem.bonds[c].fr==b&&this.chem.bonds[c].to==a)return this.chem.bonds[c]}function b(a){for(var b=0;b<this.chem.rings.length;b++)if(-1!=this.chem.rings[b].indexOf(a)&&this.chem.rings[b].length<Number.MAX_VALUE)return!0;return!1}for(var c=[],d=0;d<this.chem.bonds.length;d++){var e=this.chem.bonds[d],f=1==this.chem.atoms[e.fr].cd?e.fr:1==this.chem.atoms[e.to].cd?e.to:-1,g=6==this.chem.atoms[e.fr].cd?e.fr:6==this.chem.atoms[e.to].cd?e.to:-1;if(-1!=f&&-1!=g&&!(e.ms&M_BO_UP||e.ms&M_BO_DW)){for(var h=!1,i=!1,j=this.chem.atoms[g],k=0;k<j.bo.length;k++){var l=a.call(this,g,j.bo[k]);6!=this.chem.atoms[j.bo[k]].cd&&1!=this.chem.atoms[j.bo[k]].cd&&1!=l.ty&&(h=!0),(l.ms&M_BO_UP||l.ms&M_BO_DW)&&(i=!0)}if(h&&!b.call(this,g)||i)continue;c.push(1==this.chem.atoms[e.fr].cd?e.fr:e.to)}}this.undoPush(),this.chem.removeAtoms(c),this.h_bond=this.h_atom=-1,this.updateZoom=!0,this.drawMol()},ChemicalView.prototype.deselectAll=function(){for(var a=0;a<this.chem.atoms.length;a++)this.chem.atoms[a].ms&=~M_CE},ChemicalView.prototype.wtos=function(a){return{x:a.x*this.kfc+this.dx,y:-a.y*this.kfc+this.dy,z:0}},ChemicalView.prototype.stow=function(a){return{x:(a.x-this.dx)/this.kfc,y:(this.dy-a.y)/this.kfc,z:0}},ChemicalView.prototype.stowd=function(a){return{x:a.x/this.kfc,y:-a.y/this.kfc,z:0}},ChemicalView.prototype.bondRect=function(a){var b=this.chem.atoms[a.fr],c=this.chem.atoms[a.to],d=vectorSetLength(vector(b,c),.2),e=vectorSetLength(vector(b,c),.2);return e={x:-e.y,y:e.x,z:0},[veadd(veadd(b,e),d),veadd(veadd(c,e),vemulby(d,-1)),veadd(veadd(c,vemulby(e,-1)),vemulby(d,-1)),veadd(veadd(b,vemulby(e,-1)),d)]},ChemicalView.prototype.atomRect=function(a,b){var c=this.wtos(a);return{x:c.x-b/2,y:c.y-b/2,w:b,h:b}},ChemicalView.prototype.bondOrtho=function(a,b,c,d){return this.chem.bondOrtho(a,b,c,d)},ChemicalView.prototype.moveTo=function(a){var b=this.wtos(a);this.ctx.moveTo(b.x,b.y)},ChemicalView.prototype.lineTo=function(a){var b=this.wtos(a);this.ctx.lineTo(b.x,b.y)},ChemicalView.prototype.drawLine=function(a,b){var c=this.wtos(a),d=this.wtos(b);this.ctx.moveTo(c.x,c.y),this.ctx.lineTo(d.x,d.y)},ChemicalView.prototype.onKeyPress=function(a){var b=a.charCode?a.charCode:a.keyCode,c=String.fromCharCode(b);if(46==b||8==b){var d=this.chem.getSelectedAtoms(M_CE);0==d.length&&-1!=this.h_atom&&(d=[this.h_atom]),d.length&&(this.undoPush(),this.chem.removeAtoms(d),this.changed(),this.drawMol())}else if(-1!=this.h_atom)c in Elements&&(this.undoPush(),this.chem.changeAtom(this.h_atom,Elements[c],{}),this.changed(),this.drawMol());else if(-1!=this.h_bond){var e=-1,f=0,g=this.chem.bonds[this.h_bond];switch(b){case 189:e=1,f=0;break;case 187:e=2,f=0;break;case 51:g.ms&M_RNG||(e=3,f=0);break;case 85:1==g.ty&&(e=1,f=M_BO_UP);break;case 68:1==g.ty&&(e=1,f=M_BO_DW)}-1!=e&&(this.undoPush(),g.ty=e,g.ms=g.ms&~(M_BO_UP|M_BO_DW)|f,this.chem.processChemical(),this.changed(),this.drawMol())}},ChemicalView.prototype.getDragAtoms=function(){if(-1==this.h_atom)return[];if(this.chem.atoms[this.h_atom].ms&M_CE){for(var a=[this.h_atom],b=0;b<this.chem.atoms.length;b++)b!=this.h_atom&&this.chem.atoms[b].ms&M_CE&&a.push(b);return a}return[this.h_atom]},ChemicalView.prototype.getSelectedAtoms=function(){for(var a=[],b=0;b<this.chem.atoms.length;b++)this.chem.atoms[b].ms&M_CE&&a.push(b);return a},ChemicalView.prototype.atomLabel=function(a){var b="",c=this.chem.get_qfm(a),d=this.atomDislayMask&ATOM_DISPLAY_RS&&a.eo;if((6!=a.cd||0==a.bo.length||c||d||a.hasOwnProperty("atts")&&count_properties(a.atts))&&(b=ElementNames[a.cd],c&&(b+=(1==Math.abs(c)?"":Math.abs(c).toString())+(0>c?"-":"+")),d&&(b+=STEREO_LABEL[a.eo]),a.hasOwnProperty("atts")))for(var e in a.atts)a.atts.hasOwnProperty(e)&&(b+=";",b+=e,b+=a.atts[e]);return b},ChemicalView.prototype.updateKfc=function(a,b){this.kfc=a.maxx-a.minx!=0&&a.maxy-a.miny!=0?Math.min(40,(this.canvas.width-2*b)/(a.maxx-a.minx),(this.canvas.height-2*b)/(a.maxy-a.miny)):40;var c=(a.maxx-a.minx)*this.kfc,d=(a.maxy-a.miny)*this.kfc;this.dx=-a.minx*this.kfc+(this.canvas.width-c)/2,this.dy=a.maxy*this.kfc+(this.canvas.height-d)/2,this.updateZoom=!1},ChemicalView.prototype.drawMol=function(){var a=14*this.scaleFactor;if(this.chemIsReady){if(this.ctx=this.canvas.getContext("2d"),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.ctx.fillStyle="white",this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height),this.ctx.lineWidth=1.5,this.updateZoom&&this.updateKfc(this.chem,16),this.ctx.font="bold "+a+"px Arial",this.mode==MODE_CHAIN&&null!=this.chem.atoms[this.connectToAtom]&&this.chem.atoms[this.connectToAtom].bo[0]>=0){var b=this.chem.atoms.length-this.newCount,c=.25*vector(this.wtos(this.chem.atoms[this.chem.atoms[this.connectToAtom].bo[0]]),this.wtos(this.chem.atoms[this.connectToAtom])).x,d=.25*vector(this.wtos(this.chem.atoms[this.chem.atoms[this.connectToAtom].bo[0]]),this.wtos(this.chem.atoms[this.connectToAtom])).y;this.ctx.fillStyle="#000000",this.ctx.fillText(this.chem.atoms.length-b,this.wtos(this.chem.atoms[this.connectToAtom]).x+c,this.wtos(this.chem.atoms[this.connectToAtom]).y+d)}for(var e=0;e<this.chem.atoms.length;e++){var f=this.chem.atoms[e],g=this.wtos(f);f.ms&M_CE&&(this.ctx.fillStyle="#b2ffb2",this.ctx.beginPath(),this.ctx.arc(g.x,g.y,1.4/6*this.kfc,0,2*Math.PI),this.ctx.fill());var h;if(this.ctx.textBaseline="middle",this.ctx.textAlign="center",(h=this.atomLabel(f)).length){var i=MolEdit_AtomColors[ElementNames[f.cd]];"undefined"==typeof i&&(i="#000000"),this.ctx.strokeStyle=i,this.ctx.fillStyle=i,this.ctx.fillText(h,g.x,g.y)}this.h_atom==e&&(r=this.atomRect(f,10),this.ctx.save(),this.ctx.lineWidth=this.hoverStyle.width,this.ctx.strokeStyle=this.hoverStyle.color,this.ctx.lineJoin=this.hoverStyle.join,this.ctx.lineCap=this.hoverStyle.cap,this.ctx.strokeRect(r.x,r.y,r.w,r.h),this.ctx.restore())}if(null!=this.rotateAroundPoint&&(!this.activeTool||"eraser"!=this.activeTool.toolType)){var j=this.wtos(this.rotateAroundPoint);this.ctx.drawImage(rotateAroundImage,j.x-rotateAroundImage.width/2,j.y-rotateAroundImage.height/2)}if(this.drawSelectedBonds)for(var e=0;e<this.chem.bonds.length;e++){var k=this.chem.bonds[e];if(k.ms&M_CE){var g=this.wtos(vemulby(veadd(this.chem.atoms[k.fr],this.chem.atoms[k.to]),.5));this.ctx.fillStyle="#b2ffb2",this.ctx.beginPath(),this.ctx.arc(g.x,g.y,1.4/6*this.kfc,0,2*Math.PI),this.ctx.fill()}}this.ctx.strokeStyle="#1a1a1a",this.ctx.fillStyle="#000000",this.ctx.beginPath();for(var e=0;e<this.chem.bonds.length;e++){var l,k=this.chem.bonds[e],m=xyz(this.chem.atoms[k.fr]),n=xyz(this.chem.atoms[k.to]);switch(this.atomLabel(this.chem.atoms[k.fr]).length&&(l=vectorSetLength(vector(m,n),.75*a/this.kfc),m=veadd(m,l)),this.atomLabel(this.chem.atoms[k.to]).length&&(l=vectorSetLength(vector(n,m),.75*a/this.kfc),n=veadd(n,l)),k.ty){case 2:var o=this.bondOrtho(k.fr,k.to,k.ty,.25);if(1==this.chem.atoms[k.fr].bo.length||1==this.chem.atoms[k.to].bo.length)this.drawLine(veadd(m,vemulby(o,-.5)),veadd(n,vemulby(o,-.5))),this.drawLine(veadd(m,vemulby(o,.5)),veadd(n,vemulby(o,.5)));else{this.drawLine(m,n);var p=vectorSetLength(vector(m,n),.2);this.drawLine(veadd(veadd(m,o),p),veadd(veadd(n,o),vemulby(p,-1)))}break;case 3:this.drawLine(m,n);var o=this.bondOrtho(k.fr,k.to,k.ty,.15),p=vectorSetLength(vector(m,n),.2);this.drawLine(veadd(veadd(m,o),p),veadd(veadd(n,o),vemulby(p,-1))),o=vemulby(o,-1),this.drawLine(veadd(veadd(m,o),p),veadd(veadd(n,o),vemulby(p,-1)));break;default:if(k.ms&M_BO_UP){this.ctx.closePath(),this.ctx.stroke();var o=this.bondOrtho(k.fr,k.to,3,.2);this.ctx.beginPath(),this.moveTo(m),this.lineTo(veadd(n,o)),this.lineTo(veadd(n,vemulby(o,-1))),this.lineTo(m),this.ctx.closePath(),this.ctx.fill(),this.ctx.beginPath()}else if(k.ms&M_BO_DW)for(var q=vector(m,n),s=vectorLength(q),t=Math.round(this.kfc/17.5*5*(s/1.2)),u=s/t,v=vectorSetLength(vector(n,m),u),o=this.bondOrtho(k.fr,k.to,3,.2),w=xyz(n),x=0;t>x;x++){var y=vemulby(o,1-x/t);this.drawLine(veadd(w,vemulby(y,.9)),veadd(w,vemulby(y,-.9))),w=veadd(w,v)
}else this.drawLine(m,n)}}if(this.ctx.closePath(),this.ctx.stroke(),-1!=this.h_bond){this.ctx.beginPath();for(var k=this.chem.bonds[this.h_bond],z=this.bondRect(k),x=0;x<z.length;x++)this.drawLine(z[x],z[(x+1)%z.length]);this.ctx.save(),this.ctx.lineWidth=this.hoverStyle.width,this.ctx.strokeStyle=this.hoverStyle.color,this.ctx.lineJoin=this.hoverStyle.join,this.ctx.lineCap=this.hoverStyle.cap,this.ctx.stroke(),this.ctx.restore()}if(this.lassoPath.length>0){this.ctx.fillStyle="rgba(100, 100, 100, 0.5)",this.ctx.strokeStyle="#000000",this.ctx.beginPath();for(var e=0;e<this.lassoPath.length;e++)e||this.ctx.moveTo(this.lassoPath[e].x,this.lassoPath[e].y),this.ctx.lineTo(this.lassoPath[(e+1)%this.lassoPath.length].x,this.lassoPath[(e+1)%this.lassoPath.length].y);this.ctx.closePath(),this.ctx.fill()}}};var Rings=[(new Chemical).makeRing(6,!0),(new Chemical).makeRing(3,!1),(new Chemical).makeRing(4,!1),(new Chemical).makeRing(5,!1),(new Chemical).makeRing(6,!1),(new Chemical).makeRing(7,!1)];ChemicalView.prototype.canSelect=function(){return-1==this.h_atom&&-1==this.h_bond&&(!this.activeTool||"chain"!=this.activeTool.toolType)&&this.chem.atoms.length>0&&"atom"!=this.activeTool.toolType},ChemicalView.prototype.getMousePos=function(a,b){var c=this.canvas.getBoundingClientRect();return{x:((b?a.touches[0].clientX:a.clientX)-c.left)*this.scaleFactor,y:((b?a.touches[0].clientY:a.clientY)-c.top)*this.scaleFactor,z:0}},ChemicalView.prototype.getMousePosArr=function(a){for(var b=this.canvas.getBoundingClientRect(),c=[],d=0;d<a.targetTouches.length;d++)c.push({x:(a.touches[d].clientX-b.left)*this.scaleFactor,y:(a.touches[d].clientY-b.top)*this.scaleFactor,z:0});return c},ChemicalView.prototype.onMouseDown=function(a,b){var c=this;if(this.button=0,b&&a.targetTouches.length>1)return void(this.lastPosArr=this.getMousePosArr(a));"undefined"!=typeof a.button&&(this.button=a.button);var d=this.getMousePos(a,b);switch(this.newCount=0,this.mode=MODE_NORMAL,this.button){case 2:break;case 1:this.lastPos=this.endPos=d;break;case 0:if(this.h_atom=this.chem.findClosestAtom(this.stow(d)),this.h_bond=-1,-1==this.h_atom&&(this.h_bond=this.chem.findClosestBond(this.stow(d))),-1==this.h_atom&&-1==this.h_bond&&d.x<=.05*this.canvas.width)return this.lastPos=this.endPos=d,void(this.mode=MODE_ZOOM);if(this.canSelect())return this.mode=this.selectType,this.h_atom=-1,this.lastPos=this.endPos=d,void(this.lassoPath=[]);if(this.activeTool&&"chain"==this.activeTool.toolType&&(this.mode=MODE_CHAIN,this.lastPos=d),-1!=this.h_atom){var e=this.chem.atoms[this.h_atom];if(!this.activeTool||e.ms&M_CE||"atom"!=this.activeTool.toolType)if(!this.activeTool||e.ms&M_CE||-1==this.activeTool.toolType.indexOf("charge"))!this.activeTool||e.ms&M_CE||"bond"!=this.activeTool.toolType?this.activeTool&&"chain"==this.activeTool.toolType?(this.undoPush(),this.lastPos=d,this.h_atom=this.chem.findClosestAtomLong(this.stow(d)),this.connectToAtom=this.h_atom):!this.activeTool||e.ms&M_CE||"frag"!=this.activeTool.toolType.substr(0,4)?this.activeTool&&"eraser"==this.activeTool.toolType?(this.undoPush(),this.chem.removeAtoms(this.getDragAtoms()),this.h_bond=this.h_atom=-1,this.changed()):(this.undoPush(!0),this.lastPos=d,this.mode=MODE_DRAG_ATOMS,this.dragAtoms=this.getDragAtoms()):(this.undoPush(),this.lastPos=d,this.connectToAtom=this.h_atom,this.dragAtoms=this.chem.connectTo(this.h_atom,this.activeTool.ty,Rings[parseInt(this.activeTool.toolType.substr(5,1))],0)):(this.undoPush(),this.lastPos=d,this.connectToAtom=this.h_atom,this.dragAtoms=this.chem.connectTo(this.h_atom,this.activeTool.ty,null,-1));else{this.undoPush();var f=this.chem.atoms[this.h_atom];f.ms|=M_EXPLICT_QFM,f.qfm+="add"==this.activeTool.toolType.substr(7)?1:-1,this.changed()}else{this.undoPush();var g={};"undefined"!=typeof this.activeTool.panel&&(g=this.activeTool.panel.getSearchAtts()),this.chem.changeAtom(this.h_atom,null==this.activeTool.cd?-1:Elements[this.activeTool.cd],g),this.changed()}this.drawMol()}else if(-1!=this.h_bond)this.activeTool&&"bond"==this.activeTool.toolType?(this.undoPush(),this.chem.bondToggle(this.h_bond,this.activeTool.ty)):this.activeTool&&"frag"==this.activeTool.toolType.substr(0,4)?(this.undoPush(),this.chem.connectToBond(this.h_bond,Rings[parseInt(this.activeTool.toolType.substr(5,1))]),this.changed()):this.activeTool&&"eraser"==this.activeTool.toolType?(this.undoPush(),this.chem.removeBonds([this.h_bond]),this.h_bond=this.h_atom=-1,this.changed()):(this.undoPush(),this.lastPos=d,this.dragAtoms=[],this.chem.bonds[this.h_bond].ms&M_CE?(this.chem.bonds.forEach(function(a){a.ms&M_CE&&c.dragAtoms.push(a.fr),a.ms&M_CE&&c.dragAtoms.push(a.to)}),this.mode=MODE_DRAG_ATOMS,this.dragAtoms=this.dragAtoms.sort(function(a,b){return a-b}).unique()):(this.dragAtoms=[this.chem.bonds[this.h_bond].fr,this.chem.bonds[this.h_bond].to],this.mode=MODE_DRAG_ATOMS)),this.drawMol();else if("frag"==this.activeTool.toolType.substr(0,4)||"bond"==this.activeTool.toolType||"atom"==this.activeTool.toolType||"chain"==this.activeTool.toolType){var h=0==this.chem.atoms.length&&0==this.dx&&0==this.dy,i=null;"frag"==this.activeTool.toolType.substr(0,4)?i=Rings[parseInt(this.activeTool.toolType.substr(5,1))]:"bond"==this.activeTool.toolType?i=(new Chemical).makeBond(0,this.activeTool.ty):"atom"==this.activeTool.toolType&&null!=this.activeTool.cd?i=(new Chemical).makeAtom(Elements[this.activeTool.cd]):"chain"==this.activeTool.toolType&&(i=(new Chemical).makeAtom(6)),null!=i&&(this.undoPush(),h&&this.updateKfc(i,16),this.chem.placeFragment(this.stow(d),i),"chain"==this.activeTool.toolType&&(this.connectToAtom=this.chem.atoms.length-1),this.changed(),this.drawMol())}}},ChemicalView.prototype.onMouseMove=function(a,b){-1!=this.button&&a.preventDefault();var c=this;if(b&&a.targetTouches.length>1){if(-1==this.button)return;var d=this.getMousePosArr(a);return d.length==this.lastPosArr.length&&this.multiTouch(this.lastPosArr,d),void(this.lastPosArr=d)}var d=this.getMousePos(a,b),e=this.chem.findClosestAtom(this.stow(d)),f=0;if(null!=this.lastPos&&(f=Math.max(Math.abs(d.y-this.lastPos.y),Math.abs(d.x-this.lastPos.x))),1==this.button)return f>1&&(this.dx+=d.x-this.lastPos.x,this.dy+=d.y-this.lastPos.y,this.updateZoom=!1,this.drawMol()),void(this.lastPos=d);if(this.mode==MODE_ZOOM&&Math.abs(d.y-this.lastPos.y)>5){var g=this.wtos(this.chem.centerPoint());this.kfc*=d.y<this.lastPos.y?1.02:.98;var h=this.wtos(this.chem.centerPoint());return this.dx+=g.x-h.x,this.dy+=g.y-h.y,this.lastPos=d,this.updateZoom=!1,void this.drawMol()}if(this.mode==MODE_DRAG_ATOMS){if(4>=f)return;if(null!=this.rotateAroundPoint){var i=vector(this.rotateAroundPoint,this.stow(d));if(vectorLength(vector(this.rotateAroundPoint,this.chem.atoms[this.h_atom]))<.001)return;if(vectorLength(i)<.001)return;this.chem.rotateAtomsVector(this.dragAtoms,this.rotateAroundPoint,i,-1)}else this.chem.moveAtoms(this.dragAtoms,this.stowd(vesub(d,this.lastPos)));return this.lastPos=d,void this.drawMol()}if(this.mode==MODE_RECT_SEL){if(4>=f)return;return this.endPos=d,this.lassoPath=[{x:Math.min(this.lastPos.x,this.endPos.x),y:Math.max(this.lastPos.y,this.endPos.y)},{x:Math.max(this.lastPos.x,this.endPos.x),y:Math.max(this.lastPos.y,this.endPos.y)},{x:Math.max(this.lastPos.x,this.endPos.x),y:Math.min(this.lastPos.y,this.endPos.y)},{x:Math.min(this.lastPos.x,this.endPos.x),y:Math.min(this.lastPos.y,this.endPos.y)}],this.chem.updateAtomSelection(this.lassoPath.map(function(a){return c.stow(a)})),void this.drawMol()}if(this.mode==MODE_LASSO_SEL&&-1==this.h_atom&&null!=this.lastPos)return void((!this.lassoPath.length||vectorLength(vector(d,this.lassoPath[this.lassoPath.length-1]))>8)&&(this.lassoPath.push(d),this.chem.updateAtomSelection(this.lassoPath.map(function(a){return c.stow(a)})),this.drawMol()));if(this.mode==MODE_CHAIN){if(4>=f)return;if(this.endPos=d,this.atomHold=-1,-1==this.connectToAtom)return;var j=this.connectToAtom,k=this.chem.atoms[j].bo.length,l=k?this.chem.atoms[j].bo[0]:-1,m=null==this.canDraw?!0:!1,n=vector(this.stow(this.lastPos),this.stow(d)),o=-1!=l?vector(this.chem.atoms[l],this.chem.atoms[j]):n,p=Math.acos(scmul(n,o)/(vectorLength(o)*vectorLength(n))),q=this.chem.findClosestAtomLong(this.stow(d)),r=vectorLength(vector(this.stow(d),this.chem.atoms[-1==l?j:l])),s=vectorLength(vector(this.stow(d),this.chem.atoms[j]));if(this.chem.atoms.length>1&&0==this.newCount)for(var t,u=vector(this.chem.atoms[j],this.stow(d)),v=0;v<this.chem.atoms[j].bo.length;v++)if(t=vector(this.chem.atoms[j],this.chem.atoms[this.chem.atoms[j].bo[v]]),angleBetween(t,u)<60)return;if(this.showStatus("Press <b>Alt</b> and move mouse to other atom to close the loop"),s>1.2&&r>1.2&&!this.chem.hasCollisions(j)&&m)if(0==this.newCount&&(this.atomHold=this.connectToAtom),a.altKey){if(-1!=e&&e!=j){var w=clone_object(this.chem.atoms[e]);this.chem.atoms.push(w),this.chem.bonds.push({fr:j,to:this.chem.atoms.length-1,ty:1,ms:0}),this.connectToAtom=this.chem.atoms.length-1,this.chem.processChemical(),this.newCount++,this.lastPos=d}}else{this.chem.chainTo(j,1,this.stow(this.lastPos),this.stow(d));var x=this.chem.atoms[this.connectToAtom];this.connectToAtom=x.bo[x.bo.length-1],this.newCount++,this.lastPos=d}else if(r>.6&&1.2>r&&-1!=l&&1==k){var y;if(y=vectorLength(vector(this.chem.atoms[q],this.stow(d)))<=1.2&&this.chem.findShortestPath(this.connectToAtom,q).length<2?q:-1,-1!=y&&this.newCount>0){for(var v=0;v<this.chem.atoms.length-y;v++)this.chem.removeAtoms([this.connectToAtom]),this.h_atom=this.h_bond=-1,this.connectToAtom--,this.newCount--,0==this.chem.atoms.length&&(this.connectToAtom=-1);this.chem.atoms.length>0&&0==this.newCount&&this.chem.atoms[this.connectToAtom].bo.length>=1&&(this.connectToAtom=this.atomHold)}}else p>Math.PI/2&&.6>r&&-1!=l&&1==k&&this.newCount>0&&(this.chem.removeAtoms([this.connectToAtom]),this.h_atom=this.h_bond=-1,this.connectToAtom=l,this.newCount--,0==this.chem.atoms.length&&(this.connectToAtom=-1),this.lastPos=d);return void this.drawMol()}if(this.dragAtoms.length>0&&-1!=this.connectToAtom&&f>5){if(this.activeTool){var i=vector(this.chem.atoms[this.connectToAtom],this.stow(d));if(vectorLength(i)<.001)return;this.h_atom=this.chem.findClosestAtom(this.stow(d)),this.h_atom==this.connectToAtom&&(this.h_atom=-1),this.chem.rotateAtomsVector(this.dragAtoms,this.chem.atoms[this.connectToAtom],i,this.h_atom)}return this.lastPos=d,void this.drawMol()}var z=!1;if(e=this.chem.findClosestAtom(this.stow(d)),e!=this.h_atom&&(this.h_atom=e,z=!0),this.rotateAroundPoint=null,-1!=this.h_atom&&this.chem.atoms[this.h_atom].ms&M_CE&&this.getDragAtoms().length>1){var A=this.chem.apoFromSelection(M_CE);1==A.length?this.rotateAroundPoint={x:this.chem.atoms[A[0]].x,y:this.chem.atoms[A[0]].y,z:0}:0==A.length&&(this.rotateAroundPoint=this.chem.centerPoint())}if(-1==e){var B=this.chem.findClosestBond(this.stow(d));B!=this.h_bond&&(this.h_bond=B,z=!0)}else z==this.h_bond!=-1,this.h_bond=-1;-1!=this.h_atom?this.showStatus("<b>Hint</b>: to change atom type press 'C','N','O',etc.. "):-1!=this.h_bond?this.showStatus("<b>Hint</b>: to change bond type press '-','=','#','u','d'"):this.clearStatus(),z&&this.drawMol()},ChemicalView.prototype.onMouseUp=function(){this.clearStatus(),this.dragAtoms.length>0?(this.chem.gravitateCollisions(),this.changed(!0)):this.mode==MODE_CHAIN&&(this.chem.gravitateCollisions(),(1==this.chem.atoms.length||0==this.newCount&&0==this.chem.atoms[this.connectToAtom].bo.length)&&(this.chem.removeAtoms([this.chem.atoms.length-1]),this.h_atom=this.h_bond=-1,this.connectToAtom=-1)),this.mode=MODE_NORMAL,this.endPos=this.lastPos=null,this.lastPosArr=[],this.lassoPath=[],this.dragAtoms=[],this.connectToAtom=-1,this.button=-1,this.drawMol()},ChemicalView.prototype.multiTouch=function(a,b){if(!(a.length!=b.length||a.length<2)){var c,d,e=vemulby(veadd(vesub(b[0],a[0]),vesub(b[1],a[1])),.5),f=vectorLength(vesub(a[0],b[0])),g=vectorLength(vesub(a[1],b[1])),h=null;if(g>f?(h=vemulby(veadd(a[0],b[0]),.5),c=a[1],d=b[1]):(h=vemulby(veadd(a[1],b[1]),.5),c=a[0],d=b[0]),null!=h){var i=vesub(c,h),j=vesub(d,h),k=Math.acos(scmul(i,j)/(vectorLength(i)*vectorLength(j)))*vemulZSign(j,i);if(Math.abs(k)>.001){for(var l=[],m=0;m<this.chem.atoms.length;m++)l.push(m);this.chem.rotateAtomsAround(l,this.stow(h),k)}}f=vectorLength(vesub(a[0],a[1])),g=vectorLength(vesub(b[0],b[1]));var n=vemulby(veadd(a[0],a[1]),.5),o=this.stow(n);this.kfc*=g/f;var p=this.wtos(o);this.dx+=n.x-p.x+e.x,this.dy+=n.y-p.y+e.y,this.updateZoom=!1,this.drawMol()}};var unicodesupermap={"+":"⁺","−":"⁻",0:"⁰",1:"¹",2:"²",3:"³",4:"⁴",5:"⁵",6:"⁶",7:"⁷",8:"⁸",9:"⁹"};!function(a){function b(a){return Object.prototype.toString.call(a).slice(8,-1).toLowerCase()}function c(a,b){for(var c=[];b>0;c[--b]=a);return c.join("")}var d=function(){return d.cache.hasOwnProperty(arguments[0])||(d.cache[arguments[0]]=d.parse(arguments[0])),d.format.call(null,d.cache[arguments[0]],arguments)};d.format=function(a,e){var f,g,h,i,j,k,l,m=1,n=a.length,o="",p=[];for(g=0;n>g;g++)if(o=b(a[g]),"string"===o)p.push(a[g]);else if("array"===o){if(i=a[g],i[2])for(f=e[m],h=0;h<i[2].length;h++){if(!f.hasOwnProperty(i[2][h]))throw d('[sprintf] property "%s" does not exist',i[2][h]);f=f[i[2][h]]}else f=i[1]?e[i[1]]:e[m++];if(/[^s]/.test(i[8])&&"number"!=b(f))throw d("[sprintf] expecting number but found %s",b(f));switch(i[8]){case"b":f=f.toString(2);break;case"c":f=String.fromCharCode(f);break;case"d":f=parseInt(f,10);break;case"e":f=i[7]?f.toExponential(i[7]):f.toExponential();break;case"f":f=i[7]?parseFloat(f).toFixed(i[7]):parseFloat(f);break;case"o":f=f.toString(8);break;case"s":f=(f=String(f))&&i[7]?f.substring(0,i[7]):f;break;case"u":f>>>=0;break;case"x":f=f.toString(16);break;case"X":f=f.toString(16).toUpperCase()}f=/[def]/.test(i[8])&&i[3]&&f>=0?"+"+f:f,k=i[4]?"0"==i[4]?"0":i[4].charAt(1):" ",l=i[6]-String(f).length,j=i[6]?c(k,l):"",p.push(i[5]?f+j:j+f)}return p.join("")},d.cache={},d.parse=function(a){for(var b=a,c=[],d=[],e=0;b;){if(null!==(c=/^[^\x25]+/.exec(b)))d.push(c[0]);else if(null!==(c=/^\x25{2}/.exec(b)))d.push("%");else{if(null===(c=/^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-fosuxX])/.exec(b)))throw"[sprintf] huh?";if(c[2]){e|=1;var f=[],g=c[2],h=[];if(null===(h=/^([a-z_][a-z_\d]*)/i.exec(g)))throw"[sprintf] huh?";for(f.push(h[1]);""!==(g=g.substring(h[0].length));)if(null!==(h=/^\.([a-z_][a-z_\d]*)/i.exec(g)))f.push(h[1]);else{if(null===(h=/^\[(\d+)\]/.exec(g)))throw"[sprintf] huh?";f.push(h[1])}c[2]=f}else e|=2;if(3===e)throw"[sprintf] mixing positional and named placeholders is not (yet) supported";d.push(c)}b=b.substring(c[0].length)}return d};var e=function(a,b,c){return c=b.slice(0),c.splice(0,0,a),d.apply(null,c)};a.sprintf=d,a.vsprintf=e}("undefined"!=typeof exports?exports:window);var THREE=THREE||{REVISION:"49"};self.Int32Array||(self.Int32Array=Array,self.Float32Array=Array),function(){for(var a=0,b=["ms","moz","webkit","o"],c=0;c<b.length&&!window.requestAnimationFrame;++c)window.requestAnimationFrame=window[b[c]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[b[c]+"CancelAnimationFrame"]||window[b[c]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(b){var c=Date.now(),d=Math.max(0,16-(c-a)),e=window.setTimeout(function(){b(c+d)},d);return a=c+d,e}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(a){clearTimeout(a)})}(),THREE.Clock=function(a){this.autoStart=void 0!==a?a:!0,this.elapsedTime=this.oldTime=this.startTime=0,this.running=!1},THREE.Clock.prototype.start=function(){this.oldTime=this.startTime=Date.now(),this.running=!0},THREE.Clock.prototype.stop=function(){this.getElapsedTime(),this.running=!1},THREE.Clock.prototype.getElapsedTime=function(){return this.elapsedTime=this.elapsedTime+this.getDelta()},THREE.Clock.prototype.getDelta=function(){var a=0;if(this.autoStart&&!this.running&&this.start(),this.running){var b=Date.now(),a=.001*(b-this.oldTime);this.oldTime=b,this.elapsedTime=this.elapsedTime+a}return a},THREE.Color=function(a){return void 0!==a&&this.setHex(a),this},THREE.Color.prototype={constructor:THREE.Color,r:1,g:1,b:1,copy:function(a){return this.r=a.r,this.g=a.g,this.b=a.b,this},copyGammaToLinear:function(a){return this.r=a.r*a.r,this.g=a.g*a.g,this.b=a.b*a.b,this},copyLinearToGamma:function(a){return this.r=Math.sqrt(a.r),this.g=Math.sqrt(a.g),this.b=Math.sqrt(a.b),this},convertGammaToLinear:function(){var a=this.r,b=this.g,c=this.b;return this.r=a*a,this.g=b*b,this.b=c*c,this},convertLinearToGamma:function(){return this.r=Math.sqrt(this.r),this.g=Math.sqrt(this.g),this.b=Math.sqrt(this.b),this},setRGB:function(a,b,c){return this.r=a,this.g=b,this.b=c,this},setHSV:function(a,b,c){var d,e,f;if(0===c)this.r=this.g=this.b=0;else switch(d=Math.floor(6*a),e=6*a-d,a=c*(1-b),f=c*(1-b*e),b=c*(1-b*(1-e)),d){case 1:this.r=f,this.g=c,this.b=a;break;case 2:this.r=a,this.g=c,this.b=b;break;case 3:this.r=a,this.g=f,this.b=c;break;case 4:this.r=b,this.g=a,this.b=c;break;case 5:this.r=c,this.g=a,this.b=f;break;case 6:case 0:this.r=c,this.g=b,this.b=a}return this},setHex:function(a){return a=Math.floor(a),this.r=(a>>16&255)/255,this.g=(a>>8&255)/255,this.b=(255&a)/255,this},lerpSelf:function(a,b){return this.r=this.r+(a.r-this.r)*b,this.g=this.g+(a.g-this.g)*b,this.b=this.b+(a.b-this.b)*b,this},getHex:function(){return Math.floor(255*this.r)<<16^Math.floor(255*this.g)<<8^Math.floor(255*this.b)},getContextStyle:function(){return"rgb("+Math.floor(255*this.r)+","+Math.floor(255*this.g)+","+Math.floor(255*this.b)+")"},clone:function(){return(new THREE.Color).setRGB(this.r,this.g,this.b)}},THREE.Vector2=function(a,b){this.x=a||0,this.y=b||0},THREE.Vector2.prototype={constructor:THREE.Vector2,set:function(a,b){return this.x=a,this.y=b,this},copy:function(a){return this.x=a.x,this.y=a.y,this},add:function(a,b){return this.x=a.x+b.x,this.y=a.y+b.y,this},addSelf:function(a){return this.x=this.x+a.x,this.y=this.y+a.y,this},sub:function(a,b){return this.x=a.x-b.x,this.y=a.y-b.y,this},subSelf:function(a){return this.x=this.x-a.x,this.y=this.y-a.y,this},multiplyScalar:function(a){return this.x=this.x*a,this.y=this.y*a,this},divideScalar:function(a){return a?(this.x=this.x/a,this.y=this.y/a):this.set(0,0),this},negate:function(){return this.multiplyScalar(-1)},dot:function(a){return this.x*a.x+this.y*a.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.lengthSq())},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(a){return Math.sqrt(this.distanceToSquared(a))},distanceToSquared:function(a){var b=this.x-a.x,a=this.y-a.y;return b*b+a*a},setLength:function(a){return this.normalize().multiplyScalar(a)},lerpSelf:function(a,b){return this.x=this.x+(a.x-this.x)*b,this.y=this.y+(a.y-this.y)*b,this},equals:function(a){return a.x===this.x&&a.y===this.y},isZero:function(){return this.lengthSq()<1e-4},clone:function(){return new THREE.Vector2(this.x,this.y)}},THREE.Vector3=function(a,b,c){this.x=a||0,this.y=b||0,this.z=c||0},THREE.Vector3.prototype={constructor:THREE.Vector3,set:function(a,b,c){return this.x=a,this.y=b,this.z=c,this},setX:function(a){return this.x=a,this},setY:function(a){return this.y=a,this},setZ:function(a){return this.z=a,this},copy:function(a){return this.x=a.x,this.y=a.y,this.z=a.z,this},add:function(a,b){return this.x=a.x+b.x,this.y=a.y+b.y,this.z=a.z+b.z,this},addSelf:function(a){return this.x=this.x+a.x,this.y=this.y+a.y,this.z=this.z+a.z,this},addScalar:function(a){return this.x=this.x+a,this.y=this.y+a,this.z=this.z+a,this},sub:function(a,b){return this.x=a.x-b.x,this.y=a.y-b.y,this.z=a.z-b.z,this},subSelf:function(a){return this.x=this.x-a.x,this.y=this.y-a.y,this.z=this.z-a.z,this},multiply:function(a,b){return this.x=a.x*b.x,this.y=a.y*b.y,this.z=a.z*b.z,this},multiplySelf:function(a){return this.x=this.x*a.x,this.y=this.y*a.y,this.z=this.z*a.z,this},multiplyScalar:function(a){return this.x=this.x*a,this.y=this.y*a,this.z=this.z*a,this},divideSelf:function(a){return this.x=this.x/a.x,this.y=this.y/a.y,this.z=this.z/a.z,this},divideScalar:function(a){return a?(this.x=this.x/a,this.y=this.y/a,this.z=this.z/a):this.z=this.y=this.x=0,this},negate:function(){return this.multiplyScalar(-1)},dot:function(a){return this.x*a.x+this.y*a.y+this.z*a.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.lengthSq())},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length())},setLength:function(a){return this.normalize().multiplyScalar(a)},lerpSelf:function(a,b){return this.x=this.x+(a.x-this.x)*b,this.y=this.y+(a.y-this.y)*b,this.z=this.z+(a.z-this.z)*b,this},cross:function(a,b){return this.x=a.y*b.z-a.z*b.y,this.y=a.z*b.x-a.x*b.z,this.z=a.x*b.y-a.y*b.x,this},crossSelf:function(a){var b=this.x,c=this.y,d=this.z;return this.x=c*a.z-d*a.y,this.y=d*a.x-b*a.z,this.z=b*a.y-c*a.x,this},distanceTo:function(a){return Math.sqrt(this.distanceToSquared(a))},distanceToSquared:function(a){return(new THREE.Vector3).sub(this,a).lengthSq()},getPositionFromMatrix:function(a){return this.x=a.elements[12],this.y=a.elements[13],this.z=a.elements[14],this},getRotationFromMatrix:function(a,b){var c=b?b.x:1,d=b?b.y:1,e=b?b.z:1,f=a.elements[0]/c,g=a.elements[4]/d,c=a.elements[1]/c,d=a.elements[5]/d,h=a.elements[9]/e,i=a.elements[10]/e;return this.y=Math.asin(a.elements[8]/e),e=Math.cos(this.y),Math.abs(e)>1e-5?(this.x=Math.atan2(-h/e,i/e),this.z=Math.atan2(-g/e,f/e)):(this.x=0,this.z=Math.atan2(c,d)),this},getScaleFromMatrix:function(a){var b=this.set(a.elements[0],a.elements[1],a.elements[2]).length(),c=this.set(a.elements[4],a.elements[5],a.elements[6]).length(),a=this.set(a.elements[8],a.elements[9],a.elements[10]).length();this.x=b,this.y=c,this.z=a},equals:function(a){return a.x===this.x&&a.y===this.y&&a.z===this.z},isZero:function(){return this.lengthSq()<1e-4},clone:function(){return new THREE.Vector3(this.x,this.y,this.z)}},THREE.Vector4=function(a,b,c,d){this.x=a||0,this.y=b||0,this.z=c||0,this.w=void 0!==d?d:1},THREE.Vector4.prototype={constructor:THREE.Vector4,set:function(a,b,c,d){return this.x=a,this.y=b,this.z=c,this.w=d,this},copy:function(a){return this.x=a.x,this.y=a.y,this.z=a.z,this.w=void 0!==a.w?a.w:1,this},add:function(a,b){return this.x=a.x+b.x,this.y=a.y+b.y,this.z=a.z+b.z,this.w=a.w+b.w,this},addSelf:function(a){return this.x=this.x+a.x,this.y=this.y+a.y,this.z=this.z+a.z,this.w=this.w+a.w,this},sub:function(a,b){return this.x=a.x-b.x,this.y=a.y-b.y,this.z=a.z-b.z,this.w=a.w-b.w,this},subSelf:function(a){return this.x=this.x-a.x,this.y=this.y-a.y,this.z=this.z-a.z,this.w=this.w-a.w,this},multiplyScalar:function(a){return this.x=this.x*a,this.y=this.y*a,this.z=this.z*a,this.w=this.w*a,this},divideScalar:function(a){return a?(this.x=this.x/a,this.y=this.y/a,this.z=this.z/a,this.w=this.w/a):(this.z=this.y=this.x=0,this.w=1),this},negate:function(){return this.multiplyScalar(-1)},dot:function(a){return this.x*a.x+this.y*a.y+this.z*a.z+this.w*a.w},lengthSq:function(){return this.dot(this)},length:function(){return Math.sqrt(this.lengthSq())},normalize:function(){return this.divideScalar(this.length())},setLength:function(a){return this.normalize().multiplyScalar(a)},lerpSelf:function(a,b){return this.x=this.x+(a.x-this.x)*b,this.y=this.y+(a.y-this.y)*b,this.z=this.z+(a.z-this.z)*b,this.w=this.w+(a.w-this.w)*b,this},clone:function(){return new THREE.Vector4(this.x,this.y,this.z,this.w)}},THREE.Frustum=function(){this.planes=[new THREE.Vector4,new THREE.Vector4,new THREE.Vector4,new THREE.Vector4,new THREE.Vector4,new THREE.Vector4]},THREE.Frustum.prototype.setFromMatrix=function(a){var b,c=this.planes,d=a.elements,a=d[0];b=d[1];var e=d[2],f=d[3],g=d[4],h=d[5],i=d[6],j=d[7],k=d[8],l=d[9],m=d[10],n=d[11],o=d[12],p=d[13],q=d[14],d=d[15];for(c[0].set(f-a,j-g,n-k,d-o),c[1].set(f+a,j+g,n+k,d+o),c[2].set(f+b,j+h,n+l,d+p),c[3].set(f-b,j-h,n-l,d-p),c[4].set(f-e,j-i,n-m,d-q),c[5].set(f+e,j+i,n+m,d+q),a=0;6>a;a++)b=c[a],b.divideScalar(Math.sqrt(b.x*b.x+b.y*b.y+b.z*b.z))},THREE.Frustum.prototype.contains=function(a){for(var b=this.planes,c=a.matrixWorld,d=c.elements,c=-a.geometry.boundingSphere.radius*c.getMaxScaleOnAxis(),e=0;6>e;e++)if(a=b[e].x*d[12]+b[e].y*d[13]+b[e].z*d[14]+b[e].w,c>=a)return!1;return!0},THREE.Frustum.__v1=new THREE.Vector3,THREE.Ray=function(a,b){function c(a,b,c){return z.sub(c,a),o=z.dot(b),p=A.add(a,B.copy(b).multiplyScalar(o)),q=c.distanceTo(p)}function d(a,b,c,d){return z.sub(d,b),A.sub(c,b),B.sub(a,b),r=z.dot(z),s=z.dot(A),t=z.dot(B),u=A.dot(A),v=A.dot(B),w=1/(r*u-s*s),x=(u*t-s*v)*w,y=(r*v-s*t)*w,x>=0&&y>=0&&1>x+y}this.origin=a||new THREE.Vector3,this.direction=b||new THREE.Vector3;var e=1e-4;this.setPrecision=function(a){e=a};var f=new THREE.Vector3,g=new THREE.Vector3,h=new THREE.Vector3,i=new THREE.Vector3,j=new THREE.Vector3,k=new THREE.Vector3,l=new THREE.Vector3,m=new THREE.Vector3,n=new THREE.Vector3;this.intersectObject=function(a){var b,o=[];if(a instanceof THREE.Particle){var p=c(this.origin,this.direction,a.matrixWorld.getPosition());if(p>a.scale.x)return[];b={distance:p,point:a.position,face:null,object:a},o.push(b)}else if(a instanceof THREE.Mesh){var p=c(this.origin,this.direction,a.matrixWorld.getPosition()),q=THREE.Frustum.__v1.set(a.matrixWorld.getColumnX().length(),a.matrixWorld.getColumnY().length(),a.matrixWorld.getColumnZ().length());if(p>a.geometry.boundingSphere.radius*Math.max(q.x,Math.max(q.y,q.z)))return o;var r,s,t,u=a.geometry,v=u.vertices;for(a.matrixRotationWorld.extractRotation(a.matrixWorld),p=0,q=u.faces.length;q>p;p++)b=u.faces[p],j.copy(this.origin),k.copy(this.direction),t=a.matrixWorld,l=t.multiplyVector3(l.copy(b.centroid)).subSelf(j),m=a.matrixRotationWorld.multiplyVector3(m.copy(b.normal)),r=k.dot(m),Math.abs(r)<e||(s=m.dot(l)/r,0>s||!a.doubleSided&&!(a.flipSided?r>0:0>r)||(n.add(j,k.multiplyScalar(s)),b instanceof THREE.Face3?(f=t.multiplyVector3(f.copy(v[b.a])),g=t.multiplyVector3(g.copy(v[b.b])),h=t.multiplyVector3(h.copy(v[b.c])),d(n,f,g,h)&&(b={distance:j.distanceTo(n),point:n.clone(),face:b,object:a},o.push(b))):b instanceof THREE.Face4&&(f=t.multiplyVector3(f.copy(v[b.a])),g=t.multiplyVector3(g.copy(v[b.b])),h=t.multiplyVector3(h.copy(v[b.c])),i=t.multiplyVector3(i.copy(v[b.d])),(d(n,f,g,i)||d(n,g,h,i))&&(b={distance:j.distanceTo(n),point:n.clone(),face:b,object:a},o.push(b)))))}return o},this.intersectObjects=function(a){for(var b=[],c=0,d=a.length;d>c;c++)Array.prototype.push.apply(b,this.intersectObject(a[c]));return b.sort(function(a,b){return a.distance-b.distance}),b};var o,p,q,r,s,t,u,v,w,x,y,z=new THREE.Vector3,A=new THREE.Vector3,B=new THREE.Vector3},THREE.Rectangle=function(){function a(){f=d-b,g=e-c}var b,c,d,e,f,g,h=!0;this.getX=function(){return b},this.getY=function(){return c},this.getWidth=function(){return f},this.getHeight=function(){return g},this.getLeft=function(){return b},this.getTop=function(){return c},this.getRight=function(){return d},this.getBottom=function(){return e},this.set=function(f,g,i,j){h=!1,b=f,c=g,d=i,e=j,a()},this.addPoint=function(f,g){h?(h=!1,b=f,c=g,d=f,e=g):(b=f>b?b:f,c=g>c?c:g,d=d>f?d:f,e=e>g?e:g),a()},this.add3Points=function(f,g,i,j,k,l){h?(h=!1,b=i>f?k>f?f:k:k>i?i:k,c=j>g?l>g?g:l:l>j?j:l,d=f>i?f>k?f:k:i>k?i:k,e=g>j?g>l?g:l:j>l?j:l):(b=i>f?k>f?b>f?f:b:b>k?k:b:k>i?b>i?i:b:b>k?k:b,c=j>g?l>g?c>g?g:c:c>l?l:c:l>j?c>j?j:c:c>l?l:c,d=f>i?f>k?f>d?f:d:k>d?k:d:i>k?i>d?i:d:k>d?k:d,e=g>j?g>l?g>e?g:e:l>e?l:e:j>l?j>e?j:e:l>e?l:e),a()},this.addRectangle=function(f){h?(h=!1,b=f.getLeft(),c=f.getTop(),d=f.getRight(),e=f.getBottom()):(b=b<f.getLeft()?b:f.getLeft(),c=c<f.getTop()?c:f.getTop(),d=d>f.getRight()?d:f.getRight(),e=e>f.getBottom()?e:f.getBottom()),a()},this.inflate=function(f){b-=f,c-=f,d+=f,e+=f,a()},this.minSelf=function(f){b=b>f.getLeft()?b:f.getLeft(),c=c>f.getTop()?c:f.getTop(),d=d<f.getRight()?d:f.getRight(),e=e<f.getBottom()?e:f.getBottom(),a()},this.intersects=function(a){return d<a.getLeft()||b>a.getRight()||e<a.getTop()||c>a.getBottom()?!1:!0},this.empty=function(){h=!0,e=d=c=b=0,a()},this.isEmpty=function(){return h}},THREE.Math={clamp:function(a,b,c){return b>a?b:a>c?c:a},clampBottom:function(a,b){return b>a?b:a},mapLinear:function(a,b,c,d,e){return d+(a-b)*(e-d)/(c-b)},random16:function(){return(65280*Math.random()+255*Math.random())/65535},randInt:function(a,b){return a+Math.floor(Math.random()*(b-a+1))},randFloat:function(a,b){return a+Math.random()*(b-a)},randFloatSpread:function(a){return a*(.5-Math.random())},sign:function(a){return 0>a?-1:a>0?1:0}},THREE.Matrix3=function(){this.elements=new Float32Array(9)},THREE.Matrix3.prototype={constructor:THREE.Matrix3,getInverse:function(a){var b=a.elements,a=b[10]*b[5]-b[6]*b[9],c=-b[10]*b[1]+b[2]*b[9],d=b[6]*b[1]-b[2]*b[5],e=-b[10]*b[4]+b[6]*b[8],f=b[10]*b[0]-b[2]*b[8],g=-b[6]*b[0]+b[2]*b[4],h=b[9]*b[4]-b[5]*b[8],i=-b[9]*b[0]+b[1]*b[8],j=b[5]*b[0]-b[1]*b[4],b=b[0]*a+b[1]*e+b[2]*h,b=1/b,k=this.elements;return k[0]=b*a,k[1]=b*c,k[2]=b*d,k[3]=b*e,k[4]=b*f,k[5]=b*g,k[6]=b*h,k[7]=b*i,k[8]=b*j,this},transpose:function(){var a,b=this.elements;return a=b[1],b[1]=b[3],b[3]=a,a=b[2],b[2]=b[6],b[6]=a,a=b[5],b[5]=b[7],b[7]=a,this},transposeIntoArray:function(a){var b=this.m;return a[0]=b[0],a[1]=b[3],a[2]=b[6],a[3]=b[1],a[4]=b[4],a[5]=b[7],a[6]=b[2],a[7]=b[5],a[8]=b[8],this}},THREE.Matrix4=function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){this.elements=new Float32Array(16),this.set(void 0!==a?a:1,b||0,c||0,d||0,e||0,void 0!==f?f:1,g||0,h||0,i||0,j||0,void 0!==k?k:1,l||0,m||0,n||0,o||0,void 0!==p?p:1)},THREE.Matrix4.prototype={constructor:THREE.Matrix4,set:function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){var q=this.elements;return q[0]=a,q[4]=b,q[8]=c,q[12]=d,q[1]=e,q[5]=f,q[9]=g,q[13]=h,q[2]=i,q[6]=j,q[10]=k,q[14]=l,q[3]=m,q[7]=n,q[11]=o,q[15]=p,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},copy:function(a){return a=a.elements,this.set(a[0],a[4],a[8],a[12],a[1],a[5],a[9],a[13],a[2],a[6],a[10],a[14],a[3],a[7],a[11],a[15]),this},lookAt:function(a,b,c){var d=this.elements,e=THREE.Matrix4.__v1,f=THREE.Matrix4.__v2,g=THREE.Matrix4.__v3;return g.sub(a,b).normalize(),0===g.length()&&(g.z=1),e.cross(c,g).normalize(),0===e.length()&&(g.x=g.x+1e-4,e.cross(c,g).normalize()),f.cross(g,e),d[0]=e.x,d[4]=f.x,d[8]=g.x,d[1]=e.y,d[5]=f.y,d[9]=g.y,d[2]=e.z,d[6]=f.z,d[10]=g.z,this},multiply:function(a,b){var c=a.elements,d=b.elements,e=this.elements,f=c[0],g=c[4],h=c[8],i=c[12],j=c[1],k=c[5],l=c[9],m=c[13],n=c[2],o=c[6],p=c[10],q=c[14],r=c[3],s=c[7],t=c[11],c=c[15],u=d[0],v=d[4],w=d[8],x=d[12],y=d[1],z=d[5],A=d[9],B=d[13],C=d[2],D=d[6],E=d[10],F=d[14],G=d[3],H=d[7],I=d[11],d=d[15];return e[0]=f*u+g*y+h*C+i*G,e[4]=f*v+g*z+h*D+i*H,e[8]=f*w+g*A+h*E+i*I,e[12]=f*x+g*B+h*F+i*d,e[1]=j*u+k*y+l*C+m*G,e[5]=j*v+k*z+l*D+m*H,e[9]=j*w+k*A+l*E+m*I,e[13]=j*x+k*B+l*F+m*d,e[2]=n*u+o*y+p*C+q*G,e[6]=n*v+o*z+p*D+q*H,e[10]=n*w+o*A+p*E+q*I,e[14]=n*x+o*B+p*F+q*d,e[3]=r*u+s*y+t*C+c*G,e[7]=r*v+s*z+t*D+c*H,e[11]=r*w+s*A+t*E+c*I,e[15]=r*x+s*B+t*F+c*d,this},multiplySelf:function(a){return this.multiply(this,a)},multiplyToArray:function(a,b,c){var d=this.elements;return this.multiply(a,b),c[0]=d[0],c[1]=d[1],c[2]=d[2],c[3]=d[3],c[4]=d[4],c[5]=d[5],c[6]=d[6],c[7]=d[7],c[8]=d[8],c[9]=d[9],c[10]=d[10],c[11]=d[11],c[12]=d[12],c[13]=d[13],c[14]=d[14],c[15]=d[15],this},multiplyScalar:function(a){var b=this.elements;return b[0]=b[0]*a,b[4]=b[4]*a,b[8]=b[8]*a,b[12]=b[12]*a,b[1]=b[1]*a,b[5]=b[5]*a,b[9]=b[9]*a,b[13]=b[13]*a,b[2]=b[2]*a,b[6]=b[6]*a,b[10]=b[10]*a,b[14]=b[14]*a,b[3]=b[3]*a,b[7]=b[7]*a,b[11]=b[11]*a,b[15]=b[15]*a,this},multiplyVector3:function(a){var b=this.elements,c=a.x,d=a.y,e=a.z,f=1/(b[3]*c+b[7]*d+b[11]*e+b[15]);return a.x=(b[0]*c+b[4]*d+b[8]*e+b[12])*f,a.y=(b[1]*c+b[5]*d+b[9]*e+b[13])*f,a.z=(b[2]*c+b[6]*d+b[10]*e+b[14])*f,a},multiplyVector4:function(a){var b=this.elements,c=a.x,d=a.y,e=a.z,f=a.w;return a.x=b[0]*c+b[4]*d+b[8]*e+b[12]*f,a.y=b[1]*c+b[5]*d+b[9]*e+b[13]*f,a.z=b[2]*c+b[6]*d+b[10]*e+b[14]*f,a.w=b[3]*c+b[7]*d+b[11]*e+b[15]*f,a
},rotateAxis:function(a){var b=this.elements,c=a.x,d=a.y,e=a.z;return a.x=c*b[0]+d*b[4]+e*b[8],a.y=c*b[1]+d*b[5]+e*b[9],a.z=c*b[2]+d*b[6]+e*b[10],a.normalize(),a},crossVector:function(a){var b=this.elements,c=new THREE.Vector4;return c.x=b[0]*a.x+b[4]*a.y+b[8]*a.z+b[12]*a.w,c.y=b[1]*a.x+b[5]*a.y+b[9]*a.z+b[13]*a.w,c.z=b[2]*a.x+b[6]*a.y+b[10]*a.z+b[14]*a.w,c.w=a.w?b[3]*a.x+b[7]*a.y+b[11]*a.z+b[15]*a.w:1,c},determinant:function(){var a=this.elements,b=a[0],c=a[4],d=a[8],e=a[12],f=a[1],g=a[5],h=a[9],i=a[13],j=a[2],k=a[6],l=a[10],m=a[14],n=a[3],o=a[7],p=a[11],a=a[15];return e*h*k*n-d*i*k*n-e*g*l*n+c*i*l*n+d*g*m*n-c*h*m*n-e*h*j*o+d*i*j*o+e*f*l*o-b*i*l*o-d*f*m*o+b*h*m*o+e*g*j*p-c*i*j*p-e*f*k*p+b*i*k*p+c*f*m*p-b*g*m*p-d*g*j*a+c*h*j*a+d*f*k*a-b*h*k*a-c*f*l*a+b*g*l*a},transpose:function(){var a,b=this.elements;return a=b[1],b[1]=b[4],b[4]=a,a=b[2],b[2]=b[8],b[8]=a,a=b[6],b[6]=b[9],b[9]=a,a=b[3],b[3]=b[12],b[12]=a,a=b[7],b[7]=b[13],b[13]=a,a=b[11],b[11]=b[14],b[14]=a,this},flattenToArray:function(a){var b=this.elements;return a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],a[4]=b[4],a[5]=b[5],a[6]=b[6],a[7]=b[7],a[8]=b[8],a[9]=b[9],a[10]=b[10],a[11]=b[11],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15],a},flattenToArrayOffset:function(a,b){var c=this.elements;return a[b]=c[0],a[b+1]=c[1],a[b+2]=c[2],a[b+3]=c[3],a[b+4]=c[4],a[b+5]=c[5],a[b+6]=c[6],a[b+7]=c[7],a[b+8]=c[8],a[b+9]=c[9],a[b+10]=c[10],a[b+11]=c[11],a[b+12]=c[12],a[b+13]=c[13],a[b+14]=c[14],a[b+15]=c[15],a},getPosition:function(){var a=this.elements;return THREE.Matrix4.__v1.set(a[12],a[13],a[14])},setPosition:function(a){var b=this.elements;return b[12]=a.x,b[13]=a.y,b[14]=a.z,this},getColumnX:function(){var a=this.elements;return THREE.Matrix4.__v1.set(a[0],a[1],a[2])},getColumnY:function(){var a=this.elements;return THREE.Matrix4.__v1.set(a[4],a[5],a[6])},getColumnZ:function(){var a=this.elements;return THREE.Matrix4.__v1.set(a[8],a[9],a[10])},getInverse:function(a){var b=this.elements,c=a.elements,d=c[0],e=c[4],f=c[8],g=c[12],h=c[1],i=c[5],j=c[9],k=c[13],l=c[2],m=c[6],n=c[10],o=c[14],p=c[3],q=c[7],r=c[11],c=c[15];return b[0]=j*o*q-k*n*q+k*m*r-i*o*r-j*m*c+i*n*c,b[4]=g*n*q-f*o*q-g*m*r+e*o*r+f*m*c-e*n*c,b[8]=f*k*q-g*j*q+g*i*r-e*k*r-f*i*c+e*j*c,b[12]=g*j*m-f*k*m-g*i*n+e*k*n+f*i*o-e*j*o,b[1]=k*n*p-j*o*p-k*l*r+h*o*r+j*l*c-h*n*c,b[5]=f*o*p-g*n*p+g*l*r-d*o*r-f*l*c+d*n*c,b[9]=g*j*p-f*k*p-g*h*r+d*k*r+f*h*c-d*j*c,b[13]=f*k*l-g*j*l+g*h*n-d*k*n-f*h*o+d*j*o,b[2]=i*o*p-k*m*p+k*l*q-h*o*q-i*l*c+h*m*c,b[6]=g*m*p-e*o*p-g*l*q+d*o*q+e*l*c-d*m*c,b[10]=e*k*p-g*i*p+g*h*q-d*k*q-e*h*c+d*i*c,b[14]=g*i*l-e*k*l-g*h*m+d*k*m+e*h*o-d*i*o,b[3]=j*m*p-i*n*p-j*l*q+h*n*q+i*l*r-h*m*r,b[7]=e*n*p-f*m*p+f*l*q-d*n*q-e*l*r+d*m*r,b[11]=f*i*p-e*j*p-f*h*q+d*j*q+e*h*r-d*i*r,b[15]=e*j*l-f*i*l+f*h*m-d*j*m-e*h*n+d*i*n,this.multiplyScalar(1/a.determinant()),this},setRotationFromEuler:function(a,b){var c=this.elements,d=a.x,e=a.y,f=a.z,g=Math.cos(d),d=Math.sin(d),h=Math.cos(e),e=Math.sin(e),i=Math.cos(f),f=Math.sin(f);switch(b){case"YXZ":var j=h*i,k=h*f,l=e*i,m=e*f;c[0]=j+m*d,c[4]=l*d-k,c[8]=g*e,c[1]=g*f,c[5]=g*i,c[9]=-d,c[2]=k*d-l,c[6]=m+j*d,c[10]=g*h;break;case"ZXY":j=h*i,k=h*f,l=e*i,m=e*f,c[0]=j-m*d,c[4]=-g*f,c[8]=l+k*d,c[1]=k+l*d,c[5]=g*i,c[9]=m-j*d,c[2]=-g*e,c[6]=d,c[10]=g*h;break;case"ZYX":j=g*i,k=g*f,l=d*i,m=d*f,c[0]=h*i,c[4]=l*e-k,c[8]=j*e+m,c[1]=h*f,c[5]=m*e+j,c[9]=k*e-l,c[2]=-e,c[6]=d*h,c[10]=g*h;break;case"YZX":j=g*h,k=g*e,l=d*h,m=d*e,c[0]=h*i,c[4]=m-j*f,c[8]=l*f+k,c[1]=f,c[5]=g*i,c[9]=-d*i,c[2]=-e*i,c[6]=k*f+l,c[10]=j-m*f;break;case"XZY":j=g*h,k=g*e,l=d*h,m=d*e,c[0]=h*i,c[4]=-f,c[8]=e*i,c[1]=j*f+m,c[5]=g*i,c[9]=k*f-l,c[2]=l*f-k,c[6]=d*i,c[10]=m*f+j;break;default:j=g*i,k=g*f,l=d*i,m=d*f,c[0]=h*i,c[4]=-h*f,c[8]=e,c[1]=k+l*e,c[5]=j-m*e,c[9]=-d*h,c[2]=m-j*e,c[6]=l+k*e,c[10]=g*h}return this},setRotationFromQuaternion:function(a){var b=this.elements,c=a.x,d=a.y,e=a.z,f=a.w,g=c+c,h=d+d,i=e+e,a=c*g,j=c*h,c=c*i,k=d*h,d=d*i,e=e*i,g=f*g,h=f*h,f=f*i;return b[0]=1-(k+e),b[4]=j-f,b[8]=c+h,b[1]=j+f,b[5]=1-(a+e),b[9]=d-g,b[2]=c-h,b[6]=d+g,b[10]=1-(a+k),this},compose:function(a,b,c){var d=this.elements,e=THREE.Matrix4.__m1,f=THREE.Matrix4.__m2;return e.identity(),e.setRotationFromQuaternion(b),f.makeScale(c.x,c.y,c.z),this.multiply(e,f),d[12]=a.x,d[13]=a.y,d[14]=a.z,this},decompose:function(a,b,c){var d=this.elements,e=THREE.Matrix4.__v1,f=THREE.Matrix4.__v2,g=THREE.Matrix4.__v3;return e.set(d[0],d[1],d[2]),f.set(d[4],d[5],d[6]),g.set(d[8],d[9],d[10]),a=a instanceof THREE.Vector3?a:new THREE.Vector3,b=b instanceof THREE.Quaternion?b:new THREE.Quaternion,c=c instanceof THREE.Vector3?c:new THREE.Vector3,c.x=e.length(),c.y=f.length(),c.z=g.length(),a.x=d[12],a.y=d[13],a.z=d[14],d=THREE.Matrix4.__m1,d.copy(this),d.elements[0]=d.elements[0]/c.x,d.elements[1]=d.elements[1]/c.x,d.elements[2]=d.elements[2]/c.x,d.elements[4]=d.elements[4]/c.y,d.elements[5]=d.elements[5]/c.y,d.elements[6]=d.elements[6]/c.y,d.elements[8]=d.elements[8]/c.z,d.elements[9]=d.elements[9]/c.z,d.elements[10]=d.elements[10]/c.z,b.setFromRotationMatrix(d),[a,b,c]},extractPosition:function(a){var b=this.elements,a=a.elements;return b[12]=a[12],b[13]=a[13],b[14]=a[14],this},extractRotation:function(a){var b=this.elements,a=a.elements,c=THREE.Matrix4.__v1,d=1/c.set(a[0],a[1],a[2]).length(),e=1/c.set(a[4],a[5],a[6]).length(),c=1/c.set(a[8],a[9],a[10]).length();return b[0]=a[0]*d,b[1]=a[1]*d,b[2]=a[2]*d,b[4]=a[4]*e,b[5]=a[5]*e,b[6]=a[6]*e,b[8]=a[8]*c,b[9]=a[9]*c,b[10]=a[10]*c,this},translate:function(a){var b=this.elements,c=a.x,d=a.y,a=a.z;return b[12]=b[0]*c+b[4]*d+b[8]*a+b[12],b[13]=b[1]*c+b[5]*d+b[9]*a+b[13],b[14]=b[2]*c+b[6]*d+b[10]*a+b[14],b[15]=b[3]*c+b[7]*d+b[11]*a+b[15],this},rotateX:function(a){var b=this.elements,c=b[4],d=b[5],e=b[6],f=b[7],g=b[8],h=b[9],i=b[10],j=b[11],k=Math.cos(a),a=Math.sin(a);return b[4]=k*c+a*g,b[5]=k*d+a*h,b[6]=k*e+a*i,b[7]=k*f+a*j,b[8]=k*g-a*c,b[9]=k*h-a*d,b[10]=k*i-a*e,b[11]=k*j-a*f,this},rotateY:function(a){var b=this.elements,c=b[0],d=b[1],e=b[2],f=b[3],g=b[8],h=b[9],i=b[10],j=b[11],k=Math.cos(a),a=Math.sin(a);return b[0]=k*c-a*g,b[1]=k*d-a*h,b[2]=k*e-a*i,b[3]=k*f-a*j,b[8]=k*g+a*c,b[9]=k*h+a*d,b[10]=k*i+a*e,b[11]=k*j+a*f,this},rotateZ:function(a){var b=this.elements,c=b[0],d=b[1],e=b[2],f=b[3],g=b[4],h=b[5],i=b[6],j=b[7],k=Math.cos(a),a=Math.sin(a);return b[0]=k*c+a*g,b[1]=k*d+a*h,b[2]=k*e+a*i,b[3]=k*f+a*j,b[4]=k*g-a*c,b[5]=k*h-a*d,b[6]=k*i-a*e,b[7]=k*j-a*f,this},rotateByAxis:function(a,b){var c=this.elements;if(1===a.x&&0===a.y&&0===a.z)return this.rotateX(b);if(0===a.x&&1===a.y&&0===a.z)return this.rotateY(b);if(0===a.x&&0===a.y&&1===a.z)return this.rotateZ(b);var d=a.x,e=a.y,f=a.z,g=Math.sqrt(d*d+e*e+f*f),d=d/g,e=e/g,f=f/g,g=d*d,h=e*e,i=f*f,j=Math.cos(b),k=Math.sin(b),l=1-j,m=d*e*l,n=d*f*l,l=e*f*l,d=d*k,o=e*k,k=f*k,f=g+(1-g)*j,g=m+k,e=n-o,m=m-k,h=h+(1-h)*j,k=l+d,n=n+o,l=l-d,i=i+(1-i)*j,j=c[0],d=c[1],o=c[2],p=c[3],q=c[4],r=c[5],s=c[6],t=c[7],u=c[8],v=c[9],w=c[10],x=c[11];return c[0]=f*j+g*q+e*u,c[1]=f*d+g*r+e*v,c[2]=f*o+g*s+e*w,c[3]=f*p+g*t+e*x,c[4]=m*j+h*q+k*u,c[5]=m*d+h*r+k*v,c[6]=m*o+h*s+k*w,c[7]=m*p+h*t+k*x,c[8]=n*j+l*q+i*u,c[9]=n*d+l*r+i*v,c[10]=n*o+l*s+i*w,c[11]=n*p+l*t+i*x,this},scale:function(a){var b=this.elements,c=a.x,d=a.y,a=a.z;return b[0]=b[0]*c,b[4]=b[4]*d,b[8]=b[8]*a,b[1]=b[1]*c,b[5]=b[5]*d,b[9]=b[9]*a,b[2]=b[2]*c,b[6]=b[6]*d,b[10]=b[10]*a,b[3]=b[3]*c,b[7]=b[7]*d,b[11]=b[11]*a,this},getMaxScaleOnAxis:function(){var a=this.elements;return Math.sqrt(Math.max(a[0]*a[0]+a[1]*a[1]+a[2]*a[2],Math.max(a[4]*a[4]+a[5]*a[5]+a[6]*a[6],a[8]*a[8]+a[9]*a[9]+a[10]*a[10])))},makeTranslation:function(a,b,c){return this.set(1,0,0,a,0,1,0,b,0,0,1,c,0,0,0,1),this},makeRotationX:function(a){var b=Math.cos(a),a=Math.sin(a);return this.set(1,0,0,0,0,b,-a,0,0,a,b,0,0,0,0,1),this},makeRotationY:function(a){var b=Math.cos(a),a=Math.sin(a);return this.set(b,0,a,0,0,1,0,0,-a,0,b,0,0,0,0,1),this},makeRotationZ:function(a){var b=Math.cos(a),a=Math.sin(a);return this.set(b,-a,0,0,a,b,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(a,b){var c=Math.cos(b),d=Math.sin(b),e=1-c,f=a.x,g=a.y,h=a.z,i=e*f,j=e*g;return this.set(i*f+c,i*g-d*h,i*h+d*g,0,i*g+d*h,j*g+c,j*h-d*f,0,i*h-d*g,j*h+d*f,e*h*h+c,0,0,0,0,1),this},makeScale:function(a,b,c){return this.set(a,0,0,0,0,b,0,0,0,0,c,0,0,0,0,1),this},makeFrustum:function(a,b,c,d,e,f){var g=this.elements;return g[0]=2*e/(b-a),g[4]=0,g[8]=(b+a)/(b-a),g[12]=0,g[1]=0,g[5]=2*e/(d-c),g[9]=(d+c)/(d-c),g[13]=0,g[2]=0,g[6]=0,g[10]=-(f+e)/(f-e),g[14]=-2*f*e/(f-e),g[3]=0,g[7]=0,g[11]=-1,g[15]=0,this},makePerspective:function(a,b,c,d){var a=c*Math.tan(a*Math.PI/360),e=-a;return this.makeFrustum(e*b,a*b,e,a,c,d)},makeOrthographic:function(a,b,c,d,e,f){var g=this.elements,h=b-a,i=c-d,j=f-e;return g[0]=2/h,g[4]=0,g[8]=0,g[12]=-((b+a)/h),g[1]=0,g[5]=2/i,g[9]=0,g[13]=-((c+d)/i),g[2]=0,g[6]=0,g[10]=-2/j,g[14]=-((f+e)/j),g[3]=0,g[7]=0,g[11]=0,g[15]=1,this},clone:function(){var a=this.elements;return new THREE.Matrix4(a[0],a[4],a[8],a[12],a[1],a[5],a[9],a[13],a[2],a[6],a[10],a[14],a[3],a[7],a[11],a[15])}},THREE.Matrix4.__v1=new THREE.Vector3,THREE.Matrix4.__v2=new THREE.Vector3,THREE.Matrix4.__v3=new THREE.Vector3,THREE.Matrix4.__m1=new THREE.Matrix4,THREE.Matrix4.__m2=new THREE.Matrix4,THREE.Object3D=function(){this.id=THREE.Object3DCount++,this.name="",this.parent=void 0,this.children=[],this.up=new THREE.Vector3(0,1,0),this.position=new THREE.Vector3,this.rotation=new THREE.Vector3,this.eulerOrder="XYZ",this.scale=new THREE.Vector3(1,1,1),this.flipSided=this.doubleSided=!1,this.renderDepth=null,this.rotationAutoUpdate=!0,this.matrix=new THREE.Matrix4,this.matrixWorld=new THREE.Matrix4,this.matrixRotationWorld=new THREE.Matrix4,this.matrixWorldNeedsUpdate=this.matrixAutoUpdate=!0,this.quaternion=new THREE.Quaternion,this.useQuaternion=!1,this.boundRadius=0,this.boundRadiusScale=1,this.visible=!0,this.receiveShadow=this.castShadow=!1,this.frustumCulled=!0,this._vector=new THREE.Vector3},THREE.Object3D.prototype={constructor:THREE.Object3D,applyMatrix:function(a){this.matrix.multiply(a,this.matrix),this.scale.getScaleFromMatrix(this.matrix),this.rotation.getRotationFromMatrix(this.matrix,this.scale),this.position.getPositionFromMatrix(this.matrix)},translate:function(a,b){this.matrix.rotateAxis(b),this.position.addSelf(b.multiplyScalar(a))},translateX:function(a){this.translate(a,this._vector.set(1,0,0))},translateY:function(a){this.translate(a,this._vector.set(0,1,0))},translateZ:function(a){this.translate(a,this._vector.set(0,0,1))},lookAt:function(a){this.matrix.lookAt(a,this.position,this.up),this.rotationAutoUpdate&&this.rotation.getRotationFromMatrix(this.matrix)},add:function(a){if(a===this);else if(a instanceof THREE.Object3D){void 0!==a.parent&&a.parent.remove(a),a.parent=this,this.children.push(a);for(var b=this;void 0!==b.parent;)b=b.parent;void 0!==b&&b instanceof THREE.Scene&&b.__addObject(a)}},remove:function(a){var b=this.children.indexOf(a);if(-1!==b){for(a.parent=void 0,this.children.splice(b,1),b=this;void 0!==b.parent;)b=b.parent;void 0!==b&&b instanceof THREE.Scene&&b.__removeObject(a)}},getChildByName:function(a,b){var c,d,e;for(c=0,d=this.children.length;d>c;c++){if(e=this.children[c],e.name===a)return e;if(b&&(e=e.getChildByName(a,b),void 0!==e))return e}},updateMatrix:function(){this.matrix.setPosition(this.position),this.useQuaternion?this.matrix.setRotationFromQuaternion(this.quaternion):this.matrix.setRotationFromEuler(this.rotation,this.eulerOrder),(1!==this.scale.x||1!==this.scale.y||1!==this.scale.z)&&(this.matrix.scale(this.scale),this.boundRadiusScale=Math.max(this.scale.x,Math.max(this.scale.y,this.scale.z))),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(a){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||a)&&(this.parent?this.matrixWorld.multiply(this.parent.matrixWorld,this.matrix):this.matrixWorld.copy(this.matrix),this.matrixWorldNeedsUpdate=!1,a=!0);for(var b=0,c=this.children.length;c>b;b++)this.children[b].updateMatrixWorld(a)}},THREE.Object3DCount=0,THREE.Projector=function(){function a(){var a=p[g]=p[g]||new THREE.RenderableVertex;return g++,a}function b(a,b){return b.z-a.z}function c(a,b){var c=0,d=1,e=a.z+a.w,f=b.z+b.w,g=-a.z+a.w,h=-b.z+b.w;return e>=0&&f>=0&&g>=0&&h>=0?!0:0>e&&0>f||0>g&&0>h?!1:(0>e?c=Math.max(c,e/(e-f)):0>f&&(d=Math.min(d,e/(e-f))),0>g?c=Math.max(c,g/(g-h)):0>h&&(d=Math.min(d,g/(g-h))),c>d?!1:(a.lerpSelf(b,c),b.lerpSelf(a,1-d),!0))}var d,e,f,g,h,i,j,k,l,m,n,o=[],p=[],q=[],r=[],s=[],t=[],u={objects:[],sprites:[],lights:[],elements:[]},v=new THREE.Vector3,w=new THREE.Vector4,x=new THREE.Matrix4,y=new THREE.Matrix4,z=new THREE.Frustum,A=new THREE.Vector4,B=new THREE.Vector4;this.projectVector=function(a,b){return b.matrixWorldInverse.getInverse(b.matrixWorld),x.multiply(b.projectionMatrix,b.matrixWorldInverse),x.multiplyVector3(a),a},this.unprojectVector=function(a,b){return b.projectionMatrixInverse.getInverse(b.projectionMatrix),x.multiply(b.matrixWorld,b.projectionMatrixInverse),x.multiplyVector3(a),a},this.pickingRay=function(a,b){var c;return a.z=-1,c=new THREE.Vector3(a.x,a.y,1),this.unprojectVector(a,b),this.unprojectVector(c,b),c.subSelf(a).normalize(),new THREE.Ray(a,c)},this.projectGraph=function(a,c){e=0,u.objects.length=0,u.sprites.length=0,u.lights.length=0;var f=function(a){if(a.visible!==!1){if((a instanceof THREE.Mesh||a instanceof THREE.Line)&&(a.frustumCulled===!1||z.contains(a))){v.copy(a.matrixWorld.getPosition()),x.multiplyVector3(v);var b=o[e]=o[e]||new THREE.RenderableObject;e++,d=b,d.object=a,d.z=v.z,u.objects.push(d)}else a instanceof THREE.Light&&u.lights.push(a);for(var b=0,c=a.children.length;c>b;b++)f(a.children[b])}};return f(a),c&&u.objects.sort(b),u},this.projectScene=function(d,e,o){var v,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q=e.near,R=e.far,S=!1;for(n=l=j=i=0,u.elements.length=0,void 0===e.parent&&d.add(e),d.updateMatrixWorld(),e.matrixWorldInverse.getInverse(e.matrixWorld),x.multiply(e.projectionMatrix,e.matrixWorldInverse),z.setFromMatrix(x),u=this.projectGraph(d,!1),d=0,v=u.objects.length;v>d;d++)if(J=u.objects[d].object,K=J.matrixWorld,g=0,J instanceof THREE.Mesh){for(L=J.geometry,M=J.geometry.materials,E=L.vertices,N=L.faces,O=L.faceVertexUvs,L=J.matrixRotationWorld.extractRotation(K),C=0,D=E.length;D>C;C++)f=a(),f.positionWorld.copy(E[C]),K.multiplyVector3(f.positionWorld),f.positionScreen.copy(f.positionWorld),x.multiplyVector4(f.positionScreen),f.positionScreen.x=f.positionScreen.x/f.positionScreen.w,f.positionScreen.y=f.positionScreen.y/f.positionScreen.w,f.visible=f.positionScreen.z>Q&&f.positionScreen.z<R;for(E=0,C=N.length;C>E;E++){if(D=N[E],D instanceof THREE.Face3){if(F=p[D.a],G=p[D.b],H=p[D.c],!(F.visible&&G.visible&&H.visible))continue;if(S=(H.positionScreen.x-F.positionScreen.x)*(G.positionScreen.y-F.positionScreen.y)-(H.positionScreen.y-F.positionScreen.y)*(G.positionScreen.x-F.positionScreen.x)<0,!J.doubleSided&&S==J.flipSided)continue;I=q[i]=q[i]||new THREE.RenderableFace3,i++,h=I,h.v1.copy(F),h.v2.copy(G),h.v3.copy(H)}else if(D instanceof THREE.Face4){if(F=p[D.a],G=p[D.b],H=p[D.c],I=p[D.d],!(F.visible&&G.visible&&H.visible&&I.visible))continue;if(S=(I.positionScreen.x-F.positionScreen.x)*(G.positionScreen.y-F.positionScreen.y)-(I.positionScreen.y-F.positionScreen.y)*(G.positionScreen.x-F.positionScreen.x)<0||(G.positionScreen.x-H.positionScreen.x)*(I.positionScreen.y-H.positionScreen.y)-(G.positionScreen.y-H.positionScreen.y)*(I.positionScreen.x-H.positionScreen.x)<0,!J.doubleSided&&S==J.flipSided)continue;P=r[j]=r[j]||new THREE.RenderableFace4,j++,h=P,h.v1.copy(F),h.v2.copy(G),h.v3.copy(H),h.v4.copy(I)}for(h.normalWorld.copy(D.normal),!S&&(J.flipSided||J.doubleSided)&&h.normalWorld.negate(),L.multiplyVector3(h.normalWorld),h.centroidWorld.copy(D.centroid),K.multiplyVector3(h.centroidWorld),h.centroidScreen.copy(h.centroidWorld),x.multiplyVector3(h.centroidScreen),H=D.vertexNormals,F=0,G=H.length;G>F;F++)I=h.vertexNormalsWorld[F],I.copy(H[F]),!S&&(J.flipSided||J.doubleSided)&&I.negate(),L.multiplyVector3(I);for(F=0,G=O.length;G>F;F++)if(P=O[F][E])for(H=0,I=P.length;I>H;H++)h.uvs[F][H]=P[H];h.material=J.material,h.faceMaterial=null!==D.materialIndex?M[D.materialIndex]:null,h.z=h.centroidScreen.z,u.elements.push(h)}}else if(J instanceof THREE.Line)for(y.multiply(x,K),E=J.geometry.vertices,F=a(),F.positionScreen.copy(E[0]),y.multiplyVector4(F.positionScreen),K=J.type===THREE.LinePieces?2:1,C=1,D=E.length;D>C;C++)F=a(),F.positionScreen.copy(E[C]),y.multiplyVector4(F.positionScreen),(C+1)%K>0||(G=p[g-2],A.copy(F.positionScreen),B.copy(G.positionScreen),c(A,B)&&(A.multiplyScalar(1/A.w),B.multiplyScalar(1/B.w),M=s[l]=s[l]||new THREE.RenderableLine,l++,k=M,k.v1.positionScreen.copy(A),k.v2.positionScreen.copy(B),k.z=Math.max(A.z,B.z),k.material=J.material,u.elements.push(k)));for(d=0,v=u.sprites.length;v>d;d++)J=u.sprites[d].object,K=J.matrixWorld,J instanceof THREE.Particle&&(w.set(K.elements[12],K.elements[13],K.elements[14],1),x.multiplyVector4(w),w.z=w.z/w.w,w.z>0&&w.z<1&&(Q=t[n]=t[n]||new THREE.RenderableParticle,n++,m=Q,m.x=w.x/w.w,m.y=w.y/w.w,m.z=w.z,m.rotation=J.rotation.z,m.scale.x=J.scale.x*Math.abs(m.x-(w.x+e.projectionMatrix.elements[0])/(w.w+e.projectionMatrix.elements[12])),m.scale.y=J.scale.y*Math.abs(m.y-(w.y+e.projectionMatrix.elements[5])/(w.w+e.projectionMatrix.elements[13])),m.material=J.material,u.elements.push(m)));return o&&u.elements.sort(b),u}},THREE.Quaternion=function(a,b,c,d){this.x=a||0,this.y=b||0,this.z=c||0,this.w=void 0!==d?d:1},THREE.Quaternion.prototype={constructor:THREE.Quaternion,set:function(a,b,c,d){return this.x=a,this.y=b,this.z=c,this.w=d,this},copy:function(a){return this.x=a.x,this.y=a.y,this.z=a.z,this.w=a.w,this},setFromEuler:function(a){var b=Math.PI/360,c=a.x*b,d=a.y*b,e=a.z*b,a=Math.cos(d),d=Math.sin(d),b=Math.cos(-e),e=Math.sin(-e),f=Math.cos(c),c=Math.sin(c),g=a*b,h=d*e;return this.w=g*f-h*c,this.x=g*c+h*f,this.y=d*b*f+a*e*c,this.z=a*e*f-d*b*c,this},setFromAxisAngle:function(a,b){var c=b/2,d=Math.sin(c);return this.x=a.x*d,this.y=a.y*d,this.z=a.z*d,this.w=Math.cos(c),this},setFromRotationMatrix:function(a){var b=Math.pow(a.determinant(),1/3);return this.w=Math.sqrt(Math.max(0,b+a.elements[0]+a.elements[5]+a.elements[10]))/2,this.x=Math.sqrt(Math.max(0,b+a.elements[0]-a.elements[5]-a.elements[10]))/2,this.y=Math.sqrt(Math.max(0,b-a.elements[0]+a.elements[5]-a.elements[10]))/2,this.z=Math.sqrt(Math.max(0,b-a.elements[0]-a.elements[5]+a.elements[10]))/2,this.x=a.elements[6]-a.elements[9]<0?-Math.abs(this.x):Math.abs(this.x),this.y=a.elements[8]-a.elements[2]<0?-Math.abs(this.y):Math.abs(this.y),this.z=a.elements[1]-a.elements[4]<0?-Math.abs(this.z):Math.abs(this.z),this.normalize(),this},calculateW:function(){return this.w=-Math.sqrt(Math.abs(1-this.x*this.x-this.y*this.y-this.z*this.z)),this},inverse:function(){return this.x=-1*this.x,this.y=-1*this.y,this.z=-1*this.z,this},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},normalize:function(){var a=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);return 0===a?this.w=this.z=this.y=this.x=0:(a=1/a,this.x=this.x*a,this.y=this.y*a,this.z=this.z*a,this.w=this.w*a),this},multiply:function(a,b){return this.x=a.x*b.w+a.y*b.z-a.z*b.y+a.w*b.x,this.y=-a.x*b.z+a.y*b.w+a.z*b.x+a.w*b.y,this.z=a.x*b.y-a.y*b.x+a.z*b.w+a.w*b.z,this.w=-a.x*b.x-a.y*b.y-a.z*b.z+a.w*b.w,this},multiplySelf:function(a){var b=this.x,c=this.y,d=this.z,e=this.w,f=a.x,g=a.y,h=a.z,a=a.w;return this.x=b*a+e*f+c*h-d*g,this.y=c*a+e*g+d*f-b*h,this.z=d*a+e*h+b*g-c*f,this.w=e*a-b*f-c*g-d*h,this},multiplyVector3:function(a,b){b||(b=a);var c=a.x,d=a.y,e=a.z,f=this.x,g=this.y,h=this.z,i=this.w,j=i*c+g*e-h*d,k=i*d+h*c-f*e,l=i*e+f*d-g*c,c=-f*c-g*d-h*e;return b.x=j*i+c*-f+k*-h-l*-g,b.y=k*i+c*-g+l*-f-j*-h,b.z=l*i+c*-h+j*-g-k*-f,b},clone:function(){return new THREE.Quaternion(this.x,this.y,this.z,this.w)}},THREE.Quaternion.slerp=function(a,b,c,d){var e=a.w*b.w+a.x*b.x+a.y*b.y+a.z*b.z;if(0>e?(c.w=-b.w,c.x=-b.x,c.y=-b.y,c.z=-b.z,e=-e):c.copy(b),Math.abs(e)>=1)return c.w=a.w,c.x=a.x,c.y=a.y,c.z=a.z,c;var f=Math.acos(e),e=Math.sqrt(1-e*e);return Math.abs(e)<.001?(c.w=.5*(a.w+b.w),c.x=.5*(a.x+b.x),c.y=.5*(a.y+b.y),c.z=.5*(a.z+b.z),c):(b=Math.sin((1-d)*f)/e,d=Math.sin(d*f)/e,c.w=a.w*b+c.w*d,c.x=a.x*b+c.x*d,c.y=a.y*b+c.y*d,c.z=a.z*b+c.z*d,c)},THREE.Vertex=function(){},THREE.Face3=function(a,b,c,d,e,f){this.a=a,this.b=b,this.c=c,this.normal=d instanceof THREE.Vector3?d:new THREE.Vector3,this.vertexNormals=d instanceof Array?d:[],this.color=e instanceof THREE.Color?e:new THREE.Color,this.vertexColors=e instanceof Array?e:[],this.vertexTangents=[],this.materialIndex=f,this.centroid=new THREE.Vector3},THREE.Face3.prototype={constructor:THREE.Face3,clone:function(){var a=new THREE.Face3(this.a,this.b,this.c);a.normal.copy(this.normal),a.color.copy(this.color),a.centroid.copy(this.centroid),a.materialIndex=this.materialIndex;var b,c;for(b=0,c=this.vertexNormals.length;c>b;b++)a.vertexNormals[b]=this.vertexNormals[b].clone();for(b=0,c=this.vertexColors.length;c>b;b++)a.vertexColors[b]=this.vertexColors[b].clone();for(b=0,c=this.vertexTangents.length;c>b;b++)a.vertexTangents[b]=this.vertexTangents[b].clone();return a}},THREE.Face4=function(a,b,c,d,e,f,g){this.a=a,this.b=b,this.c=c,this.d=d,this.normal=e instanceof THREE.Vector3?e:new THREE.Vector3,this.vertexNormals=e instanceof Array?e:[],this.color=f instanceof THREE.Color?f:new THREE.Color,this.vertexColors=f instanceof Array?f:[],this.vertexTangents=[],this.materialIndex=g,this.centroid=new THREE.Vector3},THREE.Face4.prototype={constructor:THREE.Face4,clone:function(){var a=new THREE.Face4(this.a,this.b,this.c,this.d);a.normal.copy(this.normal),a.color.copy(this.color),a.centroid.copy(this.centroid),a.materialIndex=this.materialIndex;var b,c;for(b=0,c=this.vertexNormals.length;c>b;b++)a.vertexNormals[b]=this.vertexNormals[b].clone();for(b=0,c=this.vertexColors.length;c>b;b++)a.vertexColors[b]=this.vertexColors[b].clone();for(b=0,c=this.vertexTangents.length;c>b;b++)a.vertexTangents[b]=this.vertexTangents[b].clone();return a}},THREE.UV=function(a,b){this.u=a||0,this.v=b||0},THREE.UV.prototype={constructor:THREE.UV,set:function(a,b){return this.u=a,this.v=b,this},copy:function(a){return this.u=a.u,this.v=a.v,this},lerpSelf:function(a,b){return this.u=this.u+(a.u-this.u)*b,this.v=this.v+(a.v-this.v)*b,this},clone:function(){return new THREE.UV(this.u,this.v)}},THREE.Geometry=function(){this.id=THREE.GeometryCount++,this.vertices=[],this.colors=[],this.materials=[],this.faces=[],this.faceUvs=[[]],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphColors=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.boundingSphere=this.boundingBox=null,this.dynamic=this.hasTangents=!1},THREE.Geometry.prototype={constructor:THREE.Geometry,applyMatrix:function(a){var b=new THREE.Matrix4;b.extractRotation(a);for(var c=0,d=this.vertices.length;d>c;c++)a.multiplyVector3(this.vertices[c]);for(c=0,d=this.faces.length;d>c;c++){var e=this.faces[c];b.multiplyVector3(e.normal);for(var f=0,g=e.vertexNormals.length;g>f;f++)b.multiplyVector3(e.vertexNormals[f]);a.multiplyVector3(e.centroid)}},computeCentroids:function(){var a,b,c;for(a=0,b=this.faces.length;b>a;a++)c=this.faces[a],c.centroid.set(0,0,0),c instanceof THREE.Face3?(c.centroid.addSelf(this.vertices[c.a]),c.centroid.addSelf(this.vertices[c.b]),c.centroid.addSelf(this.vertices[c.c]),c.centroid.divideScalar(3)):c instanceof THREE.Face4&&(c.centroid.addSelf(this.vertices[c.a]),c.centroid.addSelf(this.vertices[c.b]),c.centroid.addSelf(this.vertices[c.c]),c.centroid.addSelf(this.vertices[c.d]),c.centroid.divideScalar(4))},computeFaceNormals:function(){var a,b,c,d,e,f,g=new THREE.Vector3,h=new THREE.Vector3;for(a=0,b=this.faces.length;b>a;a++)c=this.faces[a],d=this.vertices[c.a],e=this.vertices[c.b],f=this.vertices[c.c],g.sub(f,e),h.sub(d,e),g.crossSelf(h),g.isZero()||g.normalize(),c.normal.copy(g)},computeVertexNormals:function(){var a,b,c,d;if(void 0===this.__tmpVertices){for(d=this.__tmpVertices=Array(this.vertices.length),a=0,b=this.vertices.length;b>a;a++)d[a]=new THREE.Vector3;for(a=0,b=this.faces.length;b>a;a++)c=this.faces[a],c instanceof THREE.Face3?c.vertexNormals=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3]:c instanceof THREE.Face4&&(c.vertexNormals=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3])}else for(d=this.__tmpVertices,a=0,b=this.vertices.length;b>a;a++)d[a].set(0,0,0);for(a=0,b=this.faces.length;b>a;a++)c=this.faces[a],c instanceof THREE.Face3?(d[c.a].addSelf(c.normal),d[c.b].addSelf(c.normal),d[c.c].addSelf(c.normal)):c instanceof THREE.Face4&&(d[c.a].addSelf(c.normal),d[c.b].addSelf(c.normal),d[c.c].addSelf(c.normal),d[c.d].addSelf(c.normal));for(a=0,b=this.vertices.length;b>a;a++)d[a].normalize();for(a=0,b=this.faces.length;b>a;a++)c=this.faces[a],c instanceof THREE.Face3?(c.vertexNormals[0].copy(d[c.a]),c.vertexNormals[1].copy(d[c.b]),c.vertexNormals[2].copy(d[c.c])):c instanceof THREE.Face4&&(c.vertexNormals[0].copy(d[c.a]),c.vertexNormals[1].copy(d[c.b]),c.vertexNormals[2].copy(d[c.c]),c.vertexNormals[3].copy(d[c.d]))},computeMorphNormals:function(){var a,b,c,d,e;for(c=0,d=this.faces.length;d>c;c++)for(e=this.faces[c],e.__originalFaceNormal?e.__originalFaceNormal.copy(e.normal):e.__originalFaceNormal=e.normal.clone(),e.__originalVertexNormals||(e.__originalVertexNormals=[]),a=0,b=e.vertexNormals.length;b>a;a++)e.__originalVertexNormals[a]?e.__originalVertexNormals[a].copy(e.vertexNormals[a]):e.__originalVertexNormals[a]=e.vertexNormals[a].clone();var f=new THREE.Geometry;for(f.faces=this.faces,a=0,b=this.morphTargets.length;b>a;a++){if(!this.morphNormals[a]){this.morphNormals[a]={},this.morphNormals[a].faceNormals=[],this.morphNormals[a].vertexNormals=[];var g,h,i=this.morphNormals[a].faceNormals,j=this.morphNormals[a].vertexNormals;for(c=0,d=this.faces.length;d>c;c++)e=this.faces[c],g=new THREE.Vector3,h=e instanceof THREE.Face3?{a:new THREE.Vector3,b:new THREE.Vector3,c:new THREE.Vector3}:{a:new THREE.Vector3,b:new THREE.Vector3,c:new THREE.Vector3,d:new THREE.Vector3},i.push(g),j.push(h)}for(i=this.morphNormals[a],f.vertices=this.morphTargets[a].vertices,f.computeFaceNormals(),f.computeVertexNormals(),c=0,d=this.faces.length;d>c;c++)e=this.faces[c],g=i.faceNormals[c],h=i.vertexNormals[c],g.copy(e.normal),e instanceof THREE.Face3?(h.a.copy(e.vertexNormals[0]),h.b.copy(e.vertexNormals[1]),h.c.copy(e.vertexNormals[2])):(h.a.copy(e.vertexNormals[0]),h.b.copy(e.vertexNormals[1]),h.c.copy(e.vertexNormals[2]),h.d.copy(e.vertexNormals[3]))}for(c=0,d=this.faces.length;d>c;c++)e=this.faces[c],e.normal=e.__originalFaceNormal,e.vertexNormals=e.__originalVertexNormals},computeTangents:function(){function a(a,b,c,d,e,f,y){h=a.vertices[b],i=a.vertices[c],j=a.vertices[d],k=g[e],l=g[f],m=g[y],n=i.x-h.x,o=j.x-h.x,p=i.y-h.y,q=j.y-h.y,r=i.z-h.z,s=j.z-h.z,t=l.u-k.u,u=m.u-k.u,v=l.v-k.v,w=m.v-k.v,x=1/(t*w-u*v),B.set((w*n-v*o)*x,(w*p-v*q)*x,(w*r-v*s)*x),C.set((t*o-u*n)*x,(t*q-u*p)*x,(t*s-u*r)*x),z[b].addSelf(B),z[c].addSelf(B),z[d].addSelf(B),A[b].addSelf(C),A[c].addSelf(C),A[d].addSelf(C)}var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z=[],A=[],B=new THREE.Vector3,C=new THREE.Vector3,D=new THREE.Vector3,E=new THREE.Vector3,F=new THREE.Vector3;for(b=0,c=this.vertices.length;c>b;b++)z[b]=new THREE.Vector3,A[b]=new THREE.Vector3;for(b=0,c=this.faces.length;c>b;b++)f=this.faces[b],g=this.faceVertexUvs[0][b],f instanceof THREE.Face3?a(this,f.a,f.b,f.c,0,1,2):f instanceof THREE.Face4&&(a(this,f.a,f.b,f.d,0,1,3),a(this,f.b,f.c,f.d,1,2,3));var G=["a","b","c","d"];for(b=0,c=this.faces.length;c>b;b++)for(f=this.faces[b],d=0;d<f.vertexNormals.length;d++)F.copy(f.vertexNormals[d]),e=f[G[d]],y=z[e],D.copy(y),D.subSelf(F.multiplyScalar(F.dot(y))).normalize(),E.cross(f.vertexNormals[d],y),e=E.dot(A[e]),e=0>e?-1:1,f.vertexTangents[d]=new THREE.Vector4(D.x,D.y,D.z,e);this.hasTangents=!0},computeBoundingBox:function(){if(this.boundingBox||(this.boundingBox={min:new THREE.Vector3,max:new THREE.Vector3}),this.vertices.length>0){var a;a=this.vertices[0],this.boundingBox.min.copy(a),this.boundingBox.max.copy(a);for(var b=this.boundingBox.min,c=this.boundingBox.max,d=1,e=this.vertices.length;e>d;d++)a=this.vertices[d],a.x<b.x?b.x=a.x:a.x>c.x&&(c.x=a.x),a.y<b.y?b.y=a.y:a.y>c.y&&(c.y=a.y),a.z<b.z?b.z=a.z:a.z>c.z&&(c.z=a.z)}else this.boundingBox.min.set(0,0,0),this.boundingBox.max.set(0,0,0)},computeBoundingSphere:function(){this.boundingSphere||(this.boundingSphere={radius:0});for(var a,b=0,c=0,d=this.vertices.length;d>c;c++)a=this.vertices[c].length(),a>b&&(b=a);this.boundingSphere.radius=b},mergeVertices:function(){var a,b,c,d,e={},f=[],g=[],h=Math.pow(10,4);for(b=0,c=this.vertices.length;c>b;b++)a=this.vertices[b],a=[Math.round(a.x*h),Math.round(a.y*h),Math.round(a.z*h)].join("_"),void 0===e[a]?(e[a]=b,f.push(this.vertices[b]),g[b]=f.length-1):g[b]=g[e[a]];for(b=0,c=this.faces.length;c>b;b++)if(h=this.faces[b],h instanceof THREE.Face3)h.a=g[h.a],h.b=g[h.b],h.c=g[h.c];else if(h instanceof THREE.Face4)for(h.a=g[h.a],h.b=g[h.b],h.c=g[h.c],h.d=g[h.d],a=[h.a,h.b,h.c,h.d],e=3;e>0;e--)if(a.indexOf(h["abcd"[e]])!=e){for(a.splice(e,1),this.faces[b]=new THREE.Face3(a[0],a[1],a[2]),h=0,a=this.faceVertexUvs.length;a>h;h++)(d=this.faceVertexUvs[h][b])&&d.splice(e,1);break}return g=this.vertices.length-f.length,this.vertices=f,g}},THREE.GeometryCount=0,THREE.Spline=function(a){function b(a,b,c,d,e,f,g){return a=.5*(c-a),d=.5*(d-b),(2*(b-c)+a+d)*g+(-3*(b-c)-2*a-d)*f+a*e+b}this.points=a;var c,d,e,f,g,h,i,j,k,l=[],m={x:0,y:0,z:0};this.initFromArray=function(a){this.points=[];for(var b=0;b<a.length;b++)this.points[b]={x:a[b][0],y:a[b][1],z:a[b][2]}},this.getPoint=function(a){return c=(this.points.length-1)*a,d=Math.floor(c),e=c-d,l[0]=0===d?d:d-1,l[1]=d,l[2]=d>this.points.length-2?this.points.length-1:d+1,l[3]=d>this.points.length-3?this.points.length-1:d+2,h=this.points[l[0]],i=this.points[l[1]],j=this.points[l[2]],k=this.points[l[3]],f=e*e,g=e*f,m.x=b(h.x,i.x,j.x,k.x,e,f,g),m.y=b(h.y,i.y,j.y,k.y,e,f,g),m.z=b(h.z,i.z,j.z,k.z,e,f,g),m},this.getControlPointsArray=function(){var a,b,c=this.points.length,d=[];for(a=0;c>a;a++)b=this.points[a],d[a]=[b.x,b.y,b.z];return d},this.getLength=function(a){var b,c,d,e=b=b=0,f=new THREE.Vector3,g=new THREE.Vector3,h=[],i=0;for(h[0]=0,a||(a=100),c=this.points.length*a,f.copy(this.points[0]),a=1;c>a;a++)b=a/c,d=this.getPoint(b),g.copy(d),i+=g.distanceTo(f),f.copy(d),b=(this.points.length-1)*b,b=Math.floor(b),b!=e&&(h[b]=i,e=b);return h[h.length]=i,{chunks:h,total:i}},this.reparametrizeByArcLength=function(a){var b,c,d,e,f,g,h=[],i=new THREE.Vector3,j=this.getLength();for(h.push(i.copy(this.points[0]).clone()),b=1;b<this.points.length;b++){for(c=j.chunks[b]-j.chunks[b-1],g=Math.ceil(a*c/j.total),e=(b-1)/(this.points.length-1),f=b/(this.points.length-1),c=1;g-1>c;c++)d=e+c*(1/g)*(f-e),d=this.getPoint(d),h.push(i.copy(d).clone());h.push(i.copy(this.points[b]).clone())}this.points=h}},THREE.Camera=function(){THREE.Object3D.call(this),this.matrixWorldInverse=new THREE.Matrix4,this.projectionMatrix=new THREE.Matrix4,this.projectionMatrixInverse=new THREE.Matrix4},THREE.Camera.prototype=new THREE.Object3D,THREE.Camera.prototype.constructor=THREE.Camera,THREE.Camera.prototype.lookAt=function(a){this.matrix.lookAt(this.position,a,this.up),this.rotationAutoUpdate&&this.rotation.getRotationFromMatrix(this.matrix)},THREE.OrthographicCamera=function(a,b,c,d,e,f){THREE.Camera.call(this),this.left=a,this.right=b,this.top=c,this.bottom=d,this.near=void 0!==e?e:.1,this.far=void 0!==f?f:2e3,this.updateProjectionMatrix()},THREE.OrthographicCamera.prototype=new THREE.Camera,THREE.OrthographicCamera.prototype.constructor=THREE.OrthographicCamera,THREE.OrthographicCamera.prototype.updateProjectionMatrix=function(){this.projectionMatrix.makeOrthographic(this.left,this.right,this.top,this.bottom,this.near,this.far)},THREE.PerspectiveCamera=function(a,b,c,d){THREE.Camera.call(this),this.fov=void 0!==a?a:50,this.aspect=void 0!==b?b:1,this.near=void 0!==c?c:.1,this.far=void 0!==d?d:2e3,this.updateProjectionMatrix()
},THREE.PerspectiveCamera.prototype=new THREE.Camera,THREE.PerspectiveCamera.prototype.constructor=THREE.PerspectiveCamera,THREE.PerspectiveCamera.prototype.setLens=function(a,b){this.fov=2*Math.atan((void 0!==b?b:24)/(2*a))*(180/Math.PI),this.updateProjectionMatrix()},THREE.PerspectiveCamera.prototype.setViewOffset=function(a,b,c,d,e,f){this.fullWidth=a,this.fullHeight=b,this.x=c,this.y=d,this.width=e,this.height=f,this.updateProjectionMatrix()},THREE.PerspectiveCamera.prototype.updateProjectionMatrix=function(){if(this.fullWidth){var a=this.fullWidth/this.fullHeight,b=Math.tan(this.fov*Math.PI/360)*this.near,c=-b,d=a*c,a=Math.abs(a*b-d),c=Math.abs(b-c);this.projectionMatrix.makeFrustum(d+this.x*a/this.fullWidth,d+(this.x+this.width)*a/this.fullWidth,b-(this.y+this.height)*c/this.fullHeight,b-this.y*c/this.fullHeight,this.near,this.far)}else this.projectionMatrix.makePerspective(this.fov,this.aspect,this.near,this.far)},THREE.Light=function(a){THREE.Object3D.call(this),this.color=new THREE.Color(a)},THREE.Light.prototype=new THREE.Object3D,THREE.Light.prototype.constructor=THREE.Light,THREE.Light.prototype.supr=THREE.Object3D.prototype,THREE.AmbientLight=function(a){THREE.Light.call(this,a)},THREE.AmbientLight.prototype=new THREE.Light,THREE.AmbientLight.prototype.constructor=THREE.AmbientLight,THREE.DirectionalLight=function(a,b,c){THREE.Light.call(this,a),this.position=new THREE.Vector3(0,1,0),this.target=new THREE.Object3D,this.intensity=void 0!==b?b:1,this.distance=void 0!==c?c:0,this.onlyShadow=this.castShadow=!1,this.shadowCameraNear=50,this.shadowCameraFar=5e3,this.shadowCameraLeft=-500,this.shadowCameraTop=this.shadowCameraRight=500,this.shadowCameraBottom=-500,this.shadowCameraVisible=!1,this.shadowBias=0,this.shadowDarkness=.5,this.shadowMapHeight=this.shadowMapWidth=512,this.shadowCascade=!1,this.shadowCascadeOffset=new THREE.Vector3(0,0,-1e3),this.shadowCascadeCount=2,this.shadowCascadeBias=[0,0,0],this.shadowCascadeWidth=[512,512,512],this.shadowCascadeHeight=[512,512,512],this.shadowCascadeNearZ=[-1,.99,.998],this.shadowCascadeFarZ=[.99,.998,1],this.shadowCascadeArray=[],this.shadowMatrix=this.shadowCamera=this.shadowMapSize=this.shadowMap=null},THREE.DirectionalLight.prototype=new THREE.Light,THREE.DirectionalLight.prototype.constructor=THREE.DirectionalLight,THREE.PointLight=function(a,b,c){THREE.Light.call(this,a),this.position=new THREE.Vector3(0,0,0),this.intensity=void 0!==b?b:1,this.distance=void 0!==c?c:0},THREE.PointLight.prototype=new THREE.Light,THREE.PointLight.prototype.constructor=THREE.PointLight,THREE.SpotLight=function(a,b,c,d,e){THREE.Light.call(this,a),this.position=new THREE.Vector3(0,1,0),this.target=new THREE.Object3D,this.intensity=void 0!==b?b:1,this.distance=void 0!==c?c:0,this.angle=void 0!==d?d:Math.PI/2,this.exponent=void 0!==e?e:10,this.onlyShadow=this.castShadow=!1,this.shadowCameraNear=50,this.shadowCameraFar=5e3,this.shadowCameraFov=50,this.shadowCameraVisible=!1,this.shadowBias=0,this.shadowDarkness=.5,this.shadowMapHeight=this.shadowMapWidth=512,this.shadowMatrix=this.shadowCamera=this.shadowMapSize=this.shadowMap=null},THREE.SpotLight.prototype=new THREE.Light,THREE.SpotLight.prototype.constructor=THREE.SpotLight,THREE.Material=function(a){a=a||{},this.id=THREE.MaterialCount++,this.name="",this.opacity=void 0!==a.opacity?a.opacity:1,this.transparent=void 0!==a.transparent?a.transparent:!1,this.blending=void 0!==a.blending?a.blending:THREE.NormalBlending,this.blendSrc=void 0!==a.blendSrc?a.blendSrc:THREE.SrcAlphaFactor,this.blendDst=void 0!==a.blendDst?a.blendDst:THREE.OneMinusSrcAlphaFactor,this.blendEquation=void 0!==a.blendEquation?a.blendEquation:THREE.AddEquation,this.depthTest=void 0!==a.depthTest?a.depthTest:!0,this.depthWrite=void 0!==a.depthWrite?a.depthWrite:!0,this.polygonOffset=void 0!==a.polygonOffset?a.polygonOffset:!1,this.polygonOffsetFactor=void 0!==a.polygonOffsetFactor?a.polygonOffsetFactor:0,this.polygonOffsetUnits=void 0!==a.polygonOffsetUnits?a.polygonOffsetUnits:0,this.alphaTest=void 0!==a.alphaTest?a.alphaTest:0,this.overdraw=void 0!==a.overdraw?a.overdraw:!1,this.needsUpdate=this.visible=!0},THREE.MaterialCount=0,THREE.NoShading=0,THREE.FlatShading=1,THREE.SmoothShading=2,THREE.NoColors=0,THREE.FaceColors=1,THREE.VertexColors=2,THREE.NoBlending=0,THREE.NormalBlending=1,THREE.AdditiveBlending=2,THREE.SubtractiveBlending=3,THREE.MultiplyBlending=4,THREE.AdditiveAlphaBlending=5,THREE.CustomBlending=6,THREE.AddEquation=100,THREE.SubtractEquation=101,THREE.ReverseSubtractEquation=102,THREE.ZeroFactor=200,THREE.OneFactor=201,THREE.SrcColorFactor=202,THREE.OneMinusSrcColorFactor=203,THREE.SrcAlphaFactor=204,THREE.OneMinusSrcAlphaFactor=205,THREE.DstAlphaFactor=206,THREE.OneMinusDstAlphaFactor=207,THREE.DstColorFactor=208,THREE.OneMinusDstColorFactor=209,THREE.SrcAlphaSaturateFactor=210,THREE.LineBasicMaterial=function(a){THREE.Material.call(this,a),a=a||{},this.color=new THREE.Color(void 0!==a.color?a.color:16777215),this.linewidth=void 0!==a.linewidth?a.linewidth:1,this.linecap=void 0!==a.linecap?a.linecap:"round",this.linejoin=void 0!==a.linejoin?a.linejoin:"round",this.vertexColors=a.vertexColors?a.vertexColors:!1,this.fog=void 0!==a.fog?a.fog:!0},THREE.LineBasicMaterial.prototype=new THREE.Material,THREE.LineBasicMaterial.prototype.constructor=THREE.LineBasicMaterial,THREE.MeshBasicMaterial=function(a){THREE.Material.call(this,a),a=a||{},this.color=new THREE.Color(void 0!==a.color?a.color:16777215),this.map=void 0!==a.map?a.map:null,this.lightMap=void 0!==a.lightMap?a.lightMap:null,this.envMap=void 0!==a.envMap?a.envMap:null,this.combine=void 0!==a.combine?a.combine:THREE.MultiplyOperation,this.reflectivity=void 0!==a.reflectivity?a.reflectivity:1,this.refractionRatio=void 0!==a.refractionRatio?a.refractionRatio:.98,this.fog=void 0!==a.fog?a.fog:!0,this.shading=void 0!==a.shading?a.shading:THREE.SmoothShading,this.wireframe=void 0!==a.wireframe?a.wireframe:!1,this.wireframeLinewidth=void 0!==a.wireframeLinewidth?a.wireframeLinewidth:1,this.wireframeLinecap=void 0!==a.wireframeLinecap?a.wireframeLinecap:"round",this.wireframeLinejoin=void 0!==a.wireframeLinejoin?a.wireframeLinejoin:"round",this.vertexColors=void 0!==a.vertexColors?a.vertexColors:THREE.NoColors,this.skinning=void 0!==a.skinning?a.skinning:!1,this.morphTargets=void 0!==a.morphTargets?a.morphTargets:!1},THREE.MeshBasicMaterial.prototype=new THREE.Material,THREE.MeshBasicMaterial.prototype.constructor=THREE.MeshBasicMaterial,THREE.MeshLambertMaterial=function(a){THREE.Material.call(this,a),a=a||{},this.color=new THREE.Color(void 0!==a.color?a.color:16777215),this.ambient=new THREE.Color(void 0!==a.ambient?a.ambient:16777215),this.emissive=new THREE.Color(void 0!==a.emissive?a.emissive:0),this.wrapAround=void 0!==a.wrapAround?a.wrapAround:!1,this.wrapRGB=new THREE.Vector3(1,1,1),this.map=void 0!==a.map?a.map:null,this.lightMap=void 0!==a.lightMap?a.lightMap:null,this.envMap=void 0!==a.envMap?a.envMap:null,this.combine=void 0!==a.combine?a.combine:THREE.MultiplyOperation,this.reflectivity=void 0!==a.reflectivity?a.reflectivity:1,this.refractionRatio=void 0!==a.refractionRatio?a.refractionRatio:.98,this.fog=void 0!==a.fog?a.fog:!0,this.shading=void 0!==a.shading?a.shading:THREE.SmoothShading,this.wireframe=void 0!==a.wireframe?a.wireframe:!1,this.wireframeLinewidth=void 0!==a.wireframeLinewidth?a.wireframeLinewidth:1,this.wireframeLinecap=void 0!==a.wireframeLinecap?a.wireframeLinecap:"round",this.wireframeLinejoin=void 0!==a.wireframeLinejoin?a.wireframeLinejoin:"round",this.vertexColors=void 0!==a.vertexColors?a.vertexColors:THREE.NoColors,this.skinning=void 0!==a.skinning?a.skinning:!1,this.morphTargets=void 0!==a.morphTargets?a.morphTargets:!1,this.morphNormals=void 0!==a.morphNormals?a.morphNormals:!1},THREE.MeshLambertMaterial.prototype=new THREE.Material,THREE.MeshLambertMaterial.prototype.constructor=THREE.MeshLambertMaterial,THREE.MeshPhongMaterial=function(a){THREE.Material.call(this,a),a=a||{},this.color=new THREE.Color(void 0!==a.color?a.color:16777215),this.ambient=new THREE.Color(void 0!==a.ambient?a.ambient:16777215),this.emissive=new THREE.Color(void 0!==a.emissive?a.emissive:0),this.specular=new THREE.Color(void 0!==a.specular?a.specular:1118481),this.shininess=void 0!==a.shininess?a.shininess:30,this.metal=void 0!==a.metal?a.metal:!1,this.perPixel=void 0!==a.perPixel?a.perPixel:!1,this.wrapAround=void 0!==a.wrapAround?a.wrapAround:!1,this.wrapRGB=new THREE.Vector3(1,1,1),this.map=void 0!==a.map?a.map:null,this.lightMap=void 0!==a.lightMap?a.lightMap:null,this.envMap=void 0!==a.envMap?a.envMap:null,this.combine=void 0!==a.combine?a.combine:THREE.MultiplyOperation,this.reflectivity=void 0!==a.reflectivity?a.reflectivity:1,this.refractionRatio=void 0!==a.refractionRatio?a.refractionRatio:.98,this.fog=void 0!==a.fog?a.fog:!0,this.shading=void 0!==a.shading?a.shading:THREE.SmoothShading,this.wireframe=void 0!==a.wireframe?a.wireframe:!1,this.wireframeLinewidth=void 0!==a.wireframeLinewidth?a.wireframeLinewidth:1,this.wireframeLinecap=void 0!==a.wireframeLinecap?a.wireframeLinecap:"round",this.wireframeLinejoin=void 0!==a.wireframeLinejoin?a.wireframeLinejoin:"round",this.vertexColors=void 0!==a.vertexColors?a.vertexColors:THREE.NoColors,this.skinning=void 0!==a.skinning?a.skinning:!1,this.morphTargets=void 0!==a.morphTargets?a.morphTargets:!1,this.morphNormals=void 0!==a.morphNormals?a.morphNormals:!1},THREE.MeshPhongMaterial.prototype=new THREE.Material,THREE.MeshPhongMaterial.prototype.constructor=THREE.MeshPhongMaterial,THREE.MeshDepthMaterial=function(a){THREE.Material.call(this,a),a=a||{},this.shading=void 0!==a.shading?a.shading:THREE.SmoothShading,this.wireframe=void 0!==a.wireframe?a.wireframe:!1,this.wireframeLinewidth=void 0!==a.wireframeLinewidth?a.wireframeLinewidth:1},THREE.MeshDepthMaterial.prototype=new THREE.Material,THREE.MeshDepthMaterial.prototype.constructor=THREE.MeshDepthMaterial,THREE.MeshNormalMaterial=function(a){THREE.Material.call(this,a),a=a||{},this.shading=a.shading?a.shading:THREE.FlatShading,this.wireframe=a.wireframe?a.wireframe:!1,this.wireframeLinewidth=a.wireframeLinewidth?a.wireframeLinewidth:1},THREE.MeshNormalMaterial.prototype=new THREE.Material,THREE.MeshNormalMaterial.prototype.constructor=THREE.MeshNormalMaterial,THREE.MeshFaceMaterial=function(){},THREE.ParticleBasicMaterial=function(a){THREE.Material.call(this,a),a=a||{},this.color=new THREE.Color(void 0!==a.color?a.color:16777215),this.map=void 0!==a.map?a.map:null,this.size=void 0!==a.size?a.size:1,this.sizeAttenuation=void 0!==a.sizeAttenuation?a.sizeAttenuation:!0,this.vertexColors=void 0!==a.vertexColors?a.vertexColors:!1,this.fog=void 0!==a.fog?a.fog:!0},THREE.ParticleBasicMaterial.prototype=new THREE.Material,THREE.ParticleBasicMaterial.prototype.constructor=THREE.ParticleBasicMaterial,THREE.ShaderMaterial=function(a){THREE.Material.call(this,a),a=a||{},this.fragmentShader=void 0!==a.fragmentShader?a.fragmentShader:"void main() {}",this.vertexShader=void 0!==a.vertexShader?a.vertexShader:"void main() {}",this.uniforms=void 0!==a.uniforms?a.uniforms:{},this.attributes=a.attributes,this.shading=void 0!==a.shading?a.shading:THREE.SmoothShading,this.wireframe=void 0!==a.wireframe?a.wireframe:!1,this.wireframeLinewidth=void 0!==a.wireframeLinewidth?a.wireframeLinewidth:1,this.fog=void 0!==a.fog?a.fog:!1,this.lights=void 0!==a.lights?a.lights:!1,this.vertexColors=void 0!==a.vertexColors?a.vertexColors:THREE.NoColors,this.skinning=void 0!==a.skinning?a.skinning:!1,this.morphTargets=void 0!==a.morphTargets?a.morphTargets:!1,this.morphNormals=void 0!==a.morphNormals?a.morphNormals:!1},THREE.ShaderMaterial.prototype=new THREE.Material,THREE.ShaderMaterial.prototype.constructor=THREE.ShaderMaterial,THREE.Texture=function(a,b,c,d,e,f,g,h){this.id=THREE.TextureCount++,this.image=a,this.mapping=void 0!==b?b:new THREE.UVMapping,this.wrapS=void 0!==c?c:THREE.ClampToEdgeWrapping,this.wrapT=void 0!==d?d:THREE.ClampToEdgeWrapping,this.magFilter=void 0!==e?e:THREE.LinearFilter,this.minFilter=void 0!==f?f:THREE.LinearMipMapLinearFilter,this.format=void 0!==g?g:THREE.RGBAFormat,this.type=void 0!==h?h:THREE.UnsignedByteType,this.offset=new THREE.Vector2(0,0),this.repeat=new THREE.Vector2(1,1),this.generateMipmaps=!0,this.needsUpdate=this.premultiplyAlpha=!1,this.onUpdate=null},THREE.Texture.prototype={constructor:THREE.Texture,clone:function(){var a=new THREE.Texture(this.image,this.mapping,this.wrapS,this.wrapT,this.magFilter,this.minFilter,this.format,this.type);return a.offset.copy(this.offset),a.repeat.copy(this.repeat),a}},THREE.TextureCount=0,THREE.MultiplyOperation=0,THREE.MixOperation=1,THREE.UVMapping=function(){},THREE.CubeReflectionMapping=function(){},THREE.CubeRefractionMapping=function(){},THREE.SphericalReflectionMapping=function(){},THREE.SphericalRefractionMapping=function(){},THREE.RepeatWrapping=0,THREE.ClampToEdgeWrapping=1,THREE.MirroredRepeatWrapping=2,THREE.NearestFilter=3,THREE.NearestMipMapNearestFilter=4,THREE.NearestMipMapLinearFilter=5,THREE.LinearFilter=6,THREE.LinearMipMapNearestFilter=7,THREE.LinearMipMapLinearFilter=8,THREE.ByteType=9,THREE.UnsignedByteType=10,THREE.ShortType=11,THREE.UnsignedShortType=12,THREE.IntType=13,THREE.UnsignedIntType=14,THREE.FloatType=15,THREE.AlphaFormat=16,THREE.RGBFormat=17,THREE.RGBAFormat=18,THREE.LuminanceFormat=19,THREE.LuminanceAlphaFormat=20,THREE.DataTexture=function(a,b,c,d,e,f,g,h,i,j){THREE.Texture.call(this,null,f,g,h,i,j,d,e),this.image={data:a,width:b,height:c}},THREE.DataTexture.prototype=new THREE.Texture,THREE.DataTexture.prototype.constructor=THREE.DataTexture,THREE.DataTexture.prototype.clone=function(){var a=new THREE.DataTexture(this.image.data,this.image.width,this.image.height,this.format,this.type,this.mapping,this.wrapS,this.wrapT,this.magFilter,this.minFilter);return a.offset.copy(this.offset),a.repeat.copy(this.repeat),a},THREE.Particle=function(a){THREE.Object3D.call(this),this.material=a},THREE.Particle.prototype=new THREE.Object3D,THREE.Particle.prototype.constructor=THREE.Particle,THREE.ParticleSystem=function(a,b){THREE.Object3D.call(this),this.geometry=a,this.material=void 0!==b?b:new THREE.ParticleBasicMaterial({color:16777215*Math.random()}),this.sortParticles=!1,this.geometry&&(this.geometry.boundingSphere||this.geometry.computeBoundingSphere(),this.boundRadius=a.boundingSphere.radius),this.frustumCulled=!1},THREE.ParticleSystem.prototype=new THREE.Object3D,THREE.ParticleSystem.prototype.constructor=THREE.ParticleSystem,THREE.Line=function(a,b,c){THREE.Object3D.call(this),this.geometry=a,this.material=void 0!==b?b:new THREE.LineBasicMaterial({color:16777215*Math.random()}),this.type=void 0!==c?c:THREE.LineStrip,this.geometry&&(this.geometry.boundingSphere||this.geometry.computeBoundingSphere())},THREE.LineStrip=0,THREE.LinePieces=1,THREE.Line.prototype=new THREE.Object3D,THREE.Line.prototype.constructor=THREE.Line,THREE.Mesh=function(a,b){if(THREE.Object3D.call(this),this.geometry=a,this.material=void 0!==b?b:new THREE.MeshBasicMaterial({color:16777215*Math.random(),wireframe:!0}),this.geometry&&(this.geometry.boundingSphere||this.geometry.computeBoundingSphere(),this.boundRadius=a.boundingSphere.radius,this.geometry.morphTargets.length)){this.morphTargetBase=-1,this.morphTargetForcedOrder=[],this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var c=0;c<this.geometry.morphTargets.length;c++)this.morphTargetInfluences.push(0),this.morphTargetDictionary[this.geometry.morphTargets[c].name]=c}},THREE.Mesh.prototype=new THREE.Object3D,THREE.Mesh.prototype.constructor=THREE.Mesh,THREE.Mesh.prototype.supr=THREE.Object3D.prototype,THREE.Mesh.prototype.getMorphTargetIndexByName=function(a){return void 0!==this.morphTargetDictionary[a]?this.morphTargetDictionary[a]:0},THREE.Ribbon=function(a,b){THREE.Object3D.call(this),this.geometry=a,this.material=b},THREE.Ribbon.prototype=new THREE.Object3D,THREE.Ribbon.prototype.constructor=THREE.Ribbon,THREE.LOD=function(){THREE.Object3D.call(this),this.LODs=[]},THREE.LOD.prototype=new THREE.Object3D,THREE.LOD.prototype.constructor=THREE.LOD,THREE.LOD.prototype.supr=THREE.Object3D.prototype,THREE.LOD.prototype.addLevel=function(a,b){void 0===b&&(b=0);for(var b=Math.abs(b),c=0;c<this.LODs.length&&!(b<this.LODs[c].visibleAtDistance);c++);this.LODs.splice(c,0,{visibleAtDistance:b,object3D:a}),this.add(a)},THREE.LOD.prototype.update=function(a){if(this.LODs.length>1){a.matrixWorldInverse.getInverse(a.matrixWorld),a=a.matrixWorldInverse,a=-(a.elements[2]*this.matrixWorld.elements[12]+a.elements[6]*this.matrixWorld.elements[13]+a.elements[10]*this.matrixWorld.elements[14]+a.elements[14]),this.LODs[0].object3D.visible=!0;for(var b=1;b<this.LODs.length&&a>=this.LODs[b].visibleAtDistance;b++)this.LODs[b-1].object3D.visible=!1,this.LODs[b].object3D.visible=!0;for(;b<this.LODs.length;b++)this.LODs[b].object3D.visible=!1}},THREE.Sprite=function(a){THREE.Object3D.call(this),this.color=new THREE.Color(void 0!==a.color?a.color:16777215),this.map=void 0!==a.map?a.map:new THREE.Texture,this.blending=void 0!==a.blending?a.blending:THREE.NormalBlending,this.blendSrc=void 0!==a.blendSrc?a.blendSrc:THREE.SrcAlphaFactor,this.blendDst=void 0!==a.blendDst?a.blendDst:THREE.OneMinusSrcAlphaFactor,this.blendEquation=void 0!==a.blendEquation?a.blendEquation:THREE.AddEquation,this.useScreenCoordinates=void 0!==a.useScreenCoordinates?a.useScreenCoordinates:!0,this.mergeWith3D=void 0!==a.mergeWith3D?a.mergeWith3D:!this.useScreenCoordinates,this.affectedByDistance=void 0!==a.affectedByDistance?a.affectedByDistance:!this.useScreenCoordinates,this.scaleByViewport=void 0!==a.scaleByViewport?a.scaleByViewport:!this.affectedByDistance,this.alignment=a.alignment instanceof THREE.Vector2?a.alignment:THREE.SpriteAlignment.center,this.rotation3d=this.rotation,this.rotation=0,this.opacity=1,this.uvOffset=new THREE.Vector2(0,0),this.uvScale=new THREE.Vector2(1,1)},THREE.Sprite.prototype=new THREE.Object3D,THREE.Sprite.prototype.constructor=THREE.Sprite,THREE.Sprite.prototype.updateMatrix=function(){this.matrix.setPosition(this.position),this.rotation3d.set(0,0,this.rotation),this.matrix.setRotationFromEuler(this.rotation3d),(1!==this.scale.x||1!==this.scale.y)&&(this.matrix.scale(this.scale),this.boundRadiusScale=Math.max(this.scale.x,this.scale.y)),this.matrixWorldNeedsUpdate=!0},THREE.SpriteAlignment={},THREE.SpriteAlignment.topLeft=new THREE.Vector2(1,-1),THREE.SpriteAlignment.topCenter=new THREE.Vector2(0,-1),THREE.SpriteAlignment.topRight=new THREE.Vector2(-1,-1),THREE.SpriteAlignment.centerLeft=new THREE.Vector2(1,0),THREE.SpriteAlignment.center=new THREE.Vector2(0,0),THREE.SpriteAlignment.centerRight=new THREE.Vector2(-1,0),THREE.SpriteAlignment.bottomLeft=new THREE.Vector2(1,1),THREE.SpriteAlignment.bottomCenter=new THREE.Vector2(0,1),THREE.SpriteAlignment.bottomRight=new THREE.Vector2(-1,1),THREE.Scene=function(){THREE.Object3D.call(this),this.overrideMaterial=this.fog=null,this.matrixAutoUpdate=!1,this.__objects=[],this.__lights=[],this.__objectsAdded=[],this.__objectsRemoved=[]},THREE.Scene.prototype=new THREE.Object3D,THREE.Scene.prototype.constructor=THREE.Scene,THREE.Scene.prototype.__addObject=function(a){if(a instanceof THREE.Light)-1===this.__lights.indexOf(a)&&this.__lights.push(a);else if(!(a instanceof THREE.Camera)&&-1===this.__objects.indexOf(a)){this.__objects.push(a),this.__objectsAdded.push(a);var b=this.__objectsRemoved.indexOf(a);-1!==b&&this.__objectsRemoved.splice(b,1)}for(b=0;b<a.children.length;b++)this.__addObject(a.children[b])},THREE.Scene.prototype.__removeObject=function(a){if(a instanceof THREE.Light){var b=this.__lights.indexOf(a);-1!==b&&this.__lights.splice(b,1)}else a instanceof THREE.Camera||(b=this.__objects.indexOf(a),-1!==b&&(this.__objects.splice(b,1),this.__objectsRemoved.push(a),b=this.__objectsAdded.indexOf(a),-1!==b&&this.__objectsAdded.splice(b,1)));for(b=0;b<a.children.length;b++)this.__removeObject(a.children[b])},THREE.Fog=function(a,b,c){this.color=new THREE.Color(a),this.near=void 0!==b?b:1,this.far=void 0!==c?c:1e3},THREE.FogExp2=function(a,b){this.color=new THREE.Color(a),this.density=void 0!==b?b:25e-5},THREE.ShaderChunk={fog_pars_fragment:"#ifdef USE_FOG\nuniform vec3 fogColor;\n#ifdef FOG_EXP2\nuniform float fogDensity;\n#else\nuniform float fogNear;\nuniform float fogFar;\n#endif\n#endif",fog_fragment:"#ifdef USE_FOG\nfloat depth = gl_FragCoord.z / gl_FragCoord.w;\n#ifdef FOG_EXP2\nconst float LOG2 = 1.442695;\nfloat fogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );\nfogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );\n#else\nfloat fogFactor = smoothstep( fogNear, fogFar, depth );\n#endif\ngl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\nvarying vec3 vReflect;\nuniform float reflectivity;\nuniform samplerCube envMap;\nuniform float flipEnvMap;\nuniform int combine;\n#endif",envmap_fragment:"#ifdef USE_ENVMAP\n#ifdef DOUBLE_SIDED\nfloat flipNormal = ( -1.0 + 2.0 * float( gl_FrontFacing ) );\nvec4 cubeColor = textureCube( envMap, flipNormal * vec3( flipEnvMap * vReflect.x, vReflect.yz ) );\n#else\nvec4 cubeColor = textureCube( envMap, vec3( flipEnvMap * vReflect.x, vReflect.yz ) );\n#endif\n#ifdef GAMMA_INPUT\ncubeColor.xyz *= cubeColor.xyz;\n#endif\nif ( combine == 1 ) {\ngl_FragColor.xyz = mix( gl_FragColor.xyz, cubeColor.xyz, reflectivity );\n} else {\ngl_FragColor.xyz = gl_FragColor.xyz * cubeColor.xyz;\n}\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\nvarying vec3 vReflect;\nuniform float refractionRatio;\nuniform bool useRefract;\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\nvec4 mPosition = objectMatrix * vec4( position, 1.0 );\nvec3 nWorld = mat3( objectMatrix[ 0 ].xyz, objectMatrix[ 1 ].xyz, objectMatrix[ 2 ].xyz ) * normal;\nif ( useRefract ) {\nvReflect = refract( normalize( mPosition.xyz - cameraPosition ), normalize( nWorld.xyz ), refractionRatio );\n} else {\nvReflect = reflect( normalize( mPosition.xyz - cameraPosition ), normalize( nWorld.xyz ) );\n}\n#endif",map_particle_pars_fragment:"#ifdef USE_MAP\nuniform sampler2D map;\n#endif",map_particle_fragment:"#ifdef USE_MAP\ngl_FragColor = gl_FragColor * texture2D( map, gl_PointCoord );\n#endif",map_pars_vertex:"#ifdef USE_MAP\nvarying vec2 vUv;\nuniform vec4 offsetRepeat;\n#endif",map_pars_fragment:"#ifdef USE_MAP\nvarying vec2 vUv;\nuniform sampler2D map;\n#endif",map_vertex:"#ifdef USE_MAP\nvUv = uv * offsetRepeat.zw + offsetRepeat.xy;\n#endif",map_fragment:"#ifdef USE_MAP\n#ifdef GAMMA_INPUT\nvec4 texelColor = texture2D( map, vUv );\ntexelColor.xyz *= texelColor.xyz;\ngl_FragColor = gl_FragColor * texelColor;\n#else\ngl_FragColor = gl_FragColor * texture2D( map, vUv );\n#endif\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\nvarying vec2 vUv2;\nuniform sampler2D lightMap;\n#endif",lightmap_pars_vertex:"#ifdef USE_LIGHTMAP\nvarying vec2 vUv2;\n#endif",lightmap_fragment:"#ifdef USE_LIGHTMAP\ngl_FragColor = gl_FragColor * texture2D( lightMap, vUv2 );\n#endif",lightmap_vertex:"#ifdef USE_LIGHTMAP\nvUv2 = uv2;\n#endif",lights_lambert_pars_vertex:"uniform vec3 ambient;\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 ambientLightColor;\n#if MAX_DIR_LIGHTS > 0\nuniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\nuniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\n#endif\n#if MAX_POINT_LIGHTS > 0\nuniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\nuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\nuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\n#endif\n#if MAX_SPOT_LIGHTS > 0\nuniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];\nuniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\nuniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];\nuniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\nuniform float spotLightAngle[ MAX_SPOT_LIGHTS ];\nuniform float spotLightExponent[ MAX_SPOT_LIGHTS ];\n#endif\n#ifdef WRAP_AROUND\nuniform vec3 wrapRGB;\n#endif",lights_lambert_vertex:"vLightFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\nvLightBack = vec3( 0.0 );\n#endif\ntransformedNormal = normalize( transformedNormal );\n#if MAX_DIR_LIGHTS > 0\nfor( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {\nvec4 lDirection = viewMatrix * vec4( directionalLightDirection[ i ], 0.0 );\nvec3 dirVector = normalize( lDirection.xyz );\nfloat dotProduct = dot( transformedNormal, dirVector );\nvec3 directionalLightWeighting = vec3( max( dotProduct, 0.0 ) );\n#ifdef DOUBLE_SIDED\nvec3 directionalLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );\n#ifdef WRAP_AROUND\nvec3 directionalLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );\n#endif\n#endif\n#ifdef WRAP_AROUND\nvec3 directionalLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );\ndirectionalLightWeighting = mix( directionalLightWeighting, directionalLightWeightingHalf, wrapRGB );\n#ifdef DOUBLE_SIDED\ndirectionalLightWeightingBack = mix( directionalLightWeightingBack, directionalLightWeightingHalfBack, wrapRGB );\n#endif\n#endif\nvLightFront += directionalLightColor[ i ] * directionalLightWeighting;\n#ifdef DOUBLE_SIDED\nvLightBack += directionalLightColor[ i ] * directionalLightWeightingBack;\n#endif\n}\n#endif\n#if MAX_POINT_LIGHTS > 0\nfor( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\nvec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\nvec3 lVector = lPosition.xyz - mvPosition.xyz;\nfloat lDistance = 1.0;\nif ( pointLightDistance[ i ] > 0.0 )\nlDistance = 1.0 - min( ( length( lVector ) / pointLightDistance[ i ] ), 1.0 );\nlVector = normalize( lVector );\nfloat dotProduct = dot( transformedNormal, lVector );\nvec3 pointLightWeighting = vec3( max( dotProduct, 0.0 ) );\n#ifdef DOUBLE_SIDED\nvec3 pointLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );\n#ifdef WRAP_AROUND\nvec3 pointLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );\n#endif\n#endif\n#ifdef WRAP_AROUND\nvec3 pointLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );\npointLightWeighting = mix( pointLightWeighting, pointLightWeightingHalf, wrapRGB );\n#ifdef DOUBLE_SIDED\npointLightWeightingBack = mix( pointLightWeightingBack, pointLightWeightingHalfBack, wrapRGB );\n#endif\n#endif\nvLightFront += pointLightColor[ i ] * pointLightWeighting * lDistance;\n#ifdef DOUBLE_SIDED\nvLightBack += pointLightColor[ i ] * pointLightWeightingBack * lDistance;\n#endif\n}\n#endif\n#if MAX_SPOT_LIGHTS > 0\nfor( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\nvec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );\nvec3 lVector = lPosition.xyz - mvPosition.xyz;\nlVector = normalize( lVector );\nfloat spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - mPosition.xyz ) );\nif ( spotEffect > spotLightAngle[ i ] ) {\nspotEffect = pow( spotEffect, spotLightExponent[ i ] );\nfloat lDistance = 1.0;\nif ( spotLightDistance[ i ] > 0.0 )\nlDistance = 1.0 - min( ( length( lVector ) / spotLightDistance[ i ] ), 1.0 );\nfloat dotProduct = dot( transformedNormal, lVector );\nvec3 spotLightWeighting = vec3( max( dotProduct, 0.0 ) );\n#ifdef DOUBLE_SIDED\nvec3 spotLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );\n#ifdef WRAP_AROUND\nvec3 spotLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );\n#endif\n#endif\n#ifdef WRAP_AROUND\nvec3 spotLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );\nspotLightWeighting = mix( spotLightWeighting, spotLightWeightingHalf, wrapRGB );\n#ifdef DOUBLE_SIDED\nspotLightWeightingBack = mix( spotLightWeightingBack, spotLightWeightingHalfBack, wrapRGB );\n#endif\n#endif\nvLightFront += spotLightColor[ i ] * spotLightWeighting * lDistance * spotEffect;\n#ifdef DOUBLE_SIDED\nvLightBack += spotLightColor[ i ] * spotLightWeightingBack * lDistance * spotEffect;\n#endif\n}\n}\n#endif\nvLightFront = vLightFront * diffuse + ambient * ambientLightColor + emissive;\n#ifdef DOUBLE_SIDED\nvLightBack = vLightBack * diffuse + ambient * ambientLightColor + emissive;\n#endif",lights_phong_pars_vertex:"#ifndef PHONG_PER_PIXEL\n#if MAX_POINT_LIGHTS > 0\nuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\nuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\nvarying vec4 vPointLight[ MAX_POINT_LIGHTS ];\n#endif\n#if MAX_SPOT_LIGHTS > 0\nuniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\nuniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\nvarying vec4 vSpotLight[ MAX_SPOT_LIGHTS ];\n#endif\n#endif\n#if MAX_SPOT_LIGHTS > 0\nvarying vec3 vWorldPosition;\n#endif",lights_phong_vertex:"#ifndef PHONG_PER_PIXEL\n#if MAX_POINT_LIGHTS > 0\nfor( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\nvec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\nvec3 lVector = lPosition.xyz - mvPosition.xyz;\nfloat lDistance = 1.0;\nif ( pointLightDistance[ i ] > 0.0 )\nlDistance = 1.0 - min( ( length( lVector ) / pointLightDistance[ i ] ), 1.0 );\nvPointLight[ i ] = vec4( lVector, lDistance );\n}\n#endif\n#if MAX_SPOT_LIGHTS > 0\nfor( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\nvec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );\nvec3 lVector = lPosition.xyz - mvPosition.xyz;\nfloat lDistance = 1.0;\nif ( spotLightDistance[ i ] > 0.0 )\nlDistance = 1.0 - min( ( length( lVector ) / spotLightDistance[ i ] ), 1.0 );\nvSpotLight[ i ] = vec4( lVector, lDistance );\n}\n#endif\n#endif\n#if MAX_SPOT_LIGHTS > 0\nvWorldPosition = mPosition.xyz;\n#endif",lights_phong_pars_fragment:"uniform vec3 ambientLightColor;\n#if MAX_DIR_LIGHTS > 0\nuniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\nuniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\n#endif\n#if MAX_POINT_LIGHTS > 0\nuniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\n#ifdef PHONG_PER_PIXEL\nuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\nuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\n#else\nvarying vec4 vPointLight[ MAX_POINT_LIGHTS ];\n#endif\n#endif\n#if MAX_SPOT_LIGHTS > 0\nuniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];\nuniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\nuniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];\nuniform float spotLightAngle[ MAX_SPOT_LIGHTS ];\nuniform float spotLightExponent[ MAX_SPOT_LIGHTS ];\n#ifdef PHONG_PER_PIXEL\nuniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\n#else\nvarying vec4 vSpotLight[ MAX_SPOT_LIGHTS ];\n#endif\nvarying vec3 vWorldPosition;\n#endif\n#ifdef WRAP_AROUND\nuniform vec3 wrapRGB;\n#endif\nvarying vec3 vViewPosition;\nvarying vec3 vNormal;",lights_phong_fragment:"vec3 normal = normalize( vNormal );\nvec3 viewPosition = normalize( vViewPosition );\n#ifdef DOUBLE_SIDED\nnormal = normal * ( -1.0 + 2.0 * float( gl_FrontFacing ) );\n#endif\n#if MAX_POINT_LIGHTS > 0\nvec3 pointDiffuse  = vec3( 0.0 );\nvec3 pointSpecular = vec3( 0.0 );\nfor ( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\n#ifdef PHONG_PER_PIXEL\nvec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\nvec3 lVector = lPosition.xyz + vViewPosition.xyz;\nfloat lDistance = 1.0;\nif ( pointLightDistance[ i ] > 0.0 )\nlDistance = 1.0 - min( ( length( lVector ) / pointLightDistance[ i ] ), 1.0 );\nlVector = normalize( lVector );\n#else\nvec3 lVector = normalize( vPointLight[ i ].xyz );\nfloat lDistance = vPointLight[ i ].w;\n#endif\nfloat dotProduct = dot( normal, lVector );\n#ifdef WRAP_AROUND\nfloat pointDiffuseWeightFull = max( dotProduct, 0.0 );\nfloat pointDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\nvec3 pointDiffuseWeight = mix( vec3 ( pointDiffuseWeightFull ), vec3( pointDiffuseWeightHalf ), wrapRGB );\n#else\nfloat pointDiffuseWeight = max( dotProduct, 0.0 );\n#endif\npointDiffuse  += diffuse * pointLightColor[ i ] * pointDiffuseWeight * lDistance;\nvec3 pointHalfVector = normalize( lVector + viewPosition );\nfloat pointDotNormalHalf = max( dot( normal, pointHalfVector ), 0.0 );\nfloat pointSpecularWeight = max( pow( pointDotNormalHalf, shininess ), 0.0 );\n#ifdef PHYSICALLY_BASED_SHADING\nfloat specularNormalization = ( shininess + 2.0001 ) / 8.0;\nvec3 schlick = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( lVector, pointHalfVector ), 5.0 );\npointSpecular += schlick * pointLightColor[ i ] * pointSpecularWeight * pointDiffuseWeight * lDistance * specularNormalization;\n#else\npointSpecular += specular * pointLightColor[ i ] * pointSpecularWeight * pointDiffuseWeight * lDistance;\n#endif\n}\n#endif\n#if MAX_SPOT_LIGHTS > 0\nvec3 spotDiffuse  = vec3( 0.0 );\nvec3 spotSpecular = vec3( 0.0 );\nfor ( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\n#ifdef PHONG_PER_PIXEL\nvec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );\nvec3 lVector = lPosition.xyz + vViewPosition.xyz;\nfloat lDistance = 1.0;\nif ( spotLightDistance[ i ] > 0.0 )\nlDistance = 1.0 - min( ( length( lVector ) / spotLightDistance[ i ] ), 1.0 );\nlVector = normalize( lVector );\n#else\nvec3 lVector = normalize( vSpotLight[ i ].xyz );\nfloat lDistance = vSpotLight[ i ].w;\n#endif\nfloat spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - vWorldPosition ) );\nif ( spotEffect > spotLightAngle[ i ] ) {\nspotEffect = pow( spotEffect, spotLightExponent[ i ] );\nfloat dotProduct = dot( normal, lVector );\n#ifdef WRAP_AROUND\nfloat spotDiffuseWeightFull = max( dotProduct, 0.0 );\nfloat spotDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\nvec3 spotDiffuseWeight = mix( vec3 ( spotDiffuseWeightFull ), vec3( spotDiffuseWeightHalf ), wrapRGB );\n#else\nfloat spotDiffuseWeight = max( dotProduct, 0.0 );\n#endif\nspotDiffuse += diffuse * spotLightColor[ i ] * spotDiffuseWeight * lDistance * spotEffect;\nvec3 spotHalfVector = normalize( lVector + viewPosition );\nfloat spotDotNormalHalf = max( dot( normal, spotHalfVector ), 0.0 );\nfloat spotSpecularWeight = max( pow( spotDotNormalHalf, shininess ), 0.0 );\n#ifdef PHYSICALLY_BASED_SHADING\nfloat specularNormalization = ( shininess + 2.0001 ) / 8.0;\nvec3 schlick = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( lVector, spotHalfVector ), 5.0 );\nspotSpecular += schlick * spotLightColor[ i ] * spotSpecularWeight * spotDiffuseWeight * lDistance * specularNormalization * spotEffect;\n#else\nspotSpecular += specular * spotLightColor[ i ] * spotSpecularWeight * spotDiffuseWeight * lDistance * spotEffect;\n#endif\n}\n}\n#endif\n#if MAX_DIR_LIGHTS > 0\nvec3 dirDiffuse  = vec3( 0.0 );\nvec3 dirSpecular = vec3( 0.0 );\nfor( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {\nvec4 lDirection = viewMatrix * vec4( directionalLightDirection[ i ], 0.0 );\nvec3 dirVector = normalize( lDirection.xyz );\nfloat dotProduct = dot( normal, dirVector );\n#ifdef WRAP_AROUND\nfloat dirDiffuseWeightFull = max( dotProduct, 0.0 );\nfloat dirDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\nvec3 dirDiffuseWeight = mix( vec3( dirDiffuseWeightFull ), vec3( dirDiffuseWeightHalf ), wrapRGB );\n#else\nfloat dirDiffuseWeight = max( dotProduct, 0.0 );\n#endif\ndirDiffuse  += diffuse * directionalLightColor[ i ] * dirDiffuseWeight;\nvec3 dirHalfVector = normalize( dirVector + viewPosition );\nfloat dirDotNormalHalf = max( dot( normal, dirHalfVector ), 0.0 );\nfloat dirSpecularWeight = max( pow( dirDotNormalHalf, shininess ), 0.0 );\n#ifdef PHYSICALLY_BASED_SHADING\nfloat specularNormalization = ( shininess + 2.0001 ) / 8.0;\nvec3 schlick = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( dirVector, dirHalfVector ), 5.0 );\ndirSpecular += schlick * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight * specularNormalization;\n#else\ndirSpecular += specular * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight;\n#endif\n}\n#endif\nvec3 totalDiffuse = vec3( 0.0 );\nvec3 totalSpecular = vec3( 0.0 );\n#if MAX_DIR_LIGHTS > 0\ntotalDiffuse += dirDiffuse;\ntotalSpecular += dirSpecular;\n#endif\n#if MAX_POINT_LIGHTS > 0\ntotalDiffuse += pointDiffuse;\ntotalSpecular += pointSpecular;\n#endif\n#if MAX_SPOT_LIGHTS > 0\ntotalDiffuse += spotDiffuse;\ntotalSpecular += spotSpecular;\n#endif\n#ifdef METAL\ngl_FragColor.xyz = gl_FragColor.xyz * ( emissive + totalDiffuse + ambientLightColor * ambient + totalSpecular );\n#else\ngl_FragColor.xyz = gl_FragColor.xyz * ( emissive + totalDiffuse + ambientLightColor * ambient ) + totalSpecular;\n#endif",color_pars_fragment:"#ifdef USE_COLOR\nvarying vec3 vColor;\n#endif",color_fragment:"#ifdef USE_COLOR\ngl_FragColor = gl_FragColor * vec4( vColor, opacity );\n#endif",color_pars_vertex:"#ifdef USE_COLOR\nvarying vec3 vColor;\n#endif",color_vertex:"#ifdef USE_COLOR\n#ifdef GAMMA_INPUT\nvColor = color * color;\n#else\nvColor = color;\n#endif\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\nuniform mat4 boneGlobalMatrices[ MAX_BONES ];\n#endif",skinning_vertex:"#ifdef USE_SKINNING\ngl_Position  = ( boneGlobalMatrices[ int( skinIndex.x ) ] * skinVertexA ) * skinWeight.x;\ngl_Position += ( boneGlobalMatrices[ int( skinIndex.y ) ] * skinVertexB ) * skinWeight.y;\ngl_Position  = projectionMatrix * modelViewMatrix * gl_Position;\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n#ifndef USE_MORPHNORMALS\nuniform float morphTargetInfluences[ 8 ];\n#else\nuniform float morphTargetInfluences[ 4 ];\n#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\nvec3 morphed = vec3( 0.0 );\nmorphed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\nmorphed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\nmorphed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\nmorphed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\n#ifndef USE_MORPHNORMALS\nmorphed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\nmorphed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\nmorphed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\nmorphed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\n#endif\nmorphed += position;\ngl_Position = projectionMatrix * modelViewMatrix * vec4( morphed, 1.0 );\n#endif",default_vertex:"#ifndef USE_MORPHTARGETS\n#ifndef USE_SKINNING\ngl_Position = projectionMatrix * mvPosition;\n#endif\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\nvec3 morphedNormal = vec3( 0.0 );\nmorphedNormal +=  ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\nmorphedNormal +=  ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\nmorphedNormal +=  ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\nmorphedNormal +=  ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\nmorphedNormal += normal;\nvec3 transformedNormal = normalMatrix * morphedNormal;\n#else\nvec3 transformedNormal = normalMatrix * normal;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\nuniform sampler2D shadowMap[ MAX_SHADOWS ];\nuniform vec2 shadowMapSize[ MAX_SHADOWS ];\nuniform float shadowDarkness[ MAX_SHADOWS ];\nuniform float shadowBias[ MAX_SHADOWS ];\nvarying vec4 vShadowCoord[ MAX_SHADOWS ];\nfloat unpackDepth( const in vec4 rgba_depth ) {\nconst vec4 bit_shift = vec4( 1.0 / ( 256.0 * 256.0 * 256.0 ), 1.0 / ( 256.0 * 256.0 ), 1.0 / 256.0, 1.0 );\nfloat depth = dot( rgba_depth, bit_shift );\nreturn depth;\n}\n#endif",shadowmap_fragment:"#ifdef USE_SHADOWMAP\n#ifdef SHADOWMAP_DEBUG\nvec3 frustumColors[3];\nfrustumColors[0] = vec3( 1.0, 0.5, 0.0 );\nfrustumColors[1] = vec3( 0.0, 1.0, 0.8 );\nfrustumColors[2] = vec3( 0.0, 0.5, 1.0 );\n#endif\n#ifdef SHADOWMAP_CASCADE\nint inFrustumCount = 0;\n#endif\nfloat fDepth;\nvec3 shadowColor = vec3( 1.0 );\nfor( int i = 0; i < MAX_SHADOWS; i ++ ) {\nvec3 shadowCoord = vShadowCoord[ i ].xyz / vShadowCoord[ i ].w;\nbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\nbool inFrustum = all( inFrustumVec );\n#ifdef SHADOWMAP_CASCADE\ninFrustumCount += int( inFrustum );\nbvec3 frustumTestVec = bvec3( inFrustum, inFrustumCount == 1, shadowCoord.z <= 1.0 );\n#else\nbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n#endif\nbool frustumTest = all( frustumTestVec );\nif ( frustumTest ) {\nshadowCoord.z += shadowBias[ i ];\n#ifdef SHADOWMAP_SOFT\nfloat shadow = 0.0;\nconst float shadowDelta = 1.0 / 9.0;\nfloat xPixelOffset = 1.0 / shadowMapSize[ i ].x;\nfloat yPixelOffset = 1.0 / shadowMapSize[ i ].y;\nfloat dx0 = -1.25 * xPixelOffset;\nfloat dy0 = -1.25 * yPixelOffset;\nfloat dx1 = 1.25 * xPixelOffset;\nfloat dy1 = 1.25 * yPixelOffset;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy0 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy0 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy0 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, 0.0 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, 0.0 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy1 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy1 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy1 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nshadowColor = shadowColor * vec3( ( 1.0 - shadowDarkness[ i ] * shadow ) );\n#else\nvec4 rgbaDepth = texture2D( shadowMap[ i ], shadowCoord.xy );\nfloat fDepth = unpackDepth( rgbaDepth );\nif ( fDepth < shadowCoord.z )\nshadowColor = shadowColor * vec3( 1.0 - shadowDarkness[ i ] );\n#endif\n}\n#ifdef SHADOWMAP_DEBUG\n#ifdef SHADOWMAP_CASCADE\nif ( inFrustum && inFrustumCount == 1 ) gl_FragColor.xyz *= frustumColors[ i ];\n#else\nif ( inFrustum ) gl_FragColor.xyz *= frustumColors[ i ];\n#endif\n#endif\n}\n#ifdef GAMMA_OUTPUT\nshadowColor *= shadowColor;\n#endif\ngl_FragColor.xyz = gl_FragColor.xyz * shadowColor;\n#endif",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\nvarying vec4 vShadowCoord[ MAX_SHADOWS ];\nuniform mat4 shadowMatrix[ MAX_SHADOWS ];\n#endif",shadowmap_vertex:"#ifdef USE_SHADOWMAP\nfor( int i = 0; i < MAX_SHADOWS; i ++ ) {\n#ifdef USE_MORPHTARGETS\nvShadowCoord[ i ] = shadowMatrix[ i ] * objectMatrix * vec4( morphed, 1.0 );\n#else\nvShadowCoord[ i ] = shadowMatrix[ i ] * objectMatrix * vec4( position, 1.0 );\n#endif\n}\n#endif",alphatest_fragment:"#ifdef ALPHATEST\nif ( gl_FragColor.a < ALPHATEST ) discard;\n#endif",linear_to_gamma_fragment:"#ifdef GAMMA_OUTPUT\ngl_FragColor.xyz = sqrt( gl_FragColor.xyz );\n#endif"},THREE.UniformsUtils={merge:function(a){var b,c,d,e={};
for(b=0;b<a.length;b++){d=this.clone(a[b]);for(c in d)e[c]=d[c]}return e},clone:function(a){var b,c,d,e={};for(b in a){e[b]={};for(c in a[b])d=a[b][c],e[b][c]=d instanceof THREE.Color||d instanceof THREE.Vector2||d instanceof THREE.Vector3||d instanceof THREE.Vector4||d instanceof THREE.Matrix4||d instanceof THREE.Texture?d.clone():d instanceof Array?d.slice():d}return e}},THREE.UniformsLib={common:{diffuse:{type:"c",value:new THREE.Color(15658734)},opacity:{type:"f",value:1},map:{type:"t",value:0,texture:null},offsetRepeat:{type:"v4",value:new THREE.Vector4(0,0,1,1)},lightMap:{type:"t",value:2,texture:null},envMap:{type:"t",value:1,texture:null},flipEnvMap:{type:"f",value:-1},useRefract:{type:"i",value:0},reflectivity:{type:"f",value:1},refractionRatio:{type:"f",value:.98},combine:{type:"i",value:0},morphTargetInfluences:{type:"f",value:0}},fog:{fogDensity:{type:"f",value:25e-5},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},fogColor:{type:"c",value:new THREE.Color(16777215)}},lights:{ambientLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]},directionalLightColor:{type:"fv",value:[]},pointLightColor:{type:"fv",value:[]},pointLightPosition:{type:"fv",value:[]},pointLightDistance:{type:"fv1",value:[]},spotLightColor:{type:"fv",value:[]},spotLightPosition:{type:"fv",value:[]},spotLightDirection:{type:"fv",value:[]},spotLightDistance:{type:"fv1",value:[]},spotLightAngle:{type:"fv1",value:[]},spotLightExponent:{type:"fv1",value:[]}},particle:{psColor:{type:"c",value:new THREE.Color(15658734)},opacity:{type:"f",value:1},size:{type:"f",value:1},scale:{type:"f",value:1},map:{type:"t",value:0,texture:null},fogDensity:{type:"f",value:25e-5},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},fogColor:{type:"c",value:new THREE.Color(16777215)}},shadowmap:{shadowMap:{type:"tv",value:6,texture:[]},shadowMapSize:{type:"v2v",value:[]},shadowBias:{type:"fv1",value:[]},shadowDarkness:{type:"fv1",value:[]},shadowMatrix:{type:"m4v",value:[]}}},THREE.ShaderLib={depth:{uniforms:{mNear:{type:"f",value:1},mFar:{type:"f",value:2e3},opacity:{type:"f",value:1}},vertexShader:"void main() {\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"uniform float mNear;\nuniform float mFar;\nuniform float opacity;\nvoid main() {\nfloat depth = gl_FragCoord.z / gl_FragCoord.w;\nfloat color = 1.0 - smoothstep( mNear, mFar, depth );\ngl_FragColor = vec4( vec3( color ), opacity );\n}"},normal:{uniforms:{opacity:{type:"f",value:1}},vertexShader:"varying vec3 vNormal;\nvoid main() {\nvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\nvNormal = normalMatrix * normal;\ngl_Position = projectionMatrix * mvPosition;\n}",fragmentShader:"uniform float opacity;\nvarying vec3 vNormal;\nvoid main() {\ngl_FragColor = vec4( 0.5 * normalize( vNormal ) + 0.5, opacity );\n}"},basic:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.fog,THREE.UniformsLib.shadowmap]),vertexShader:[THREE.ShaderChunk.map_pars_vertex,THREE.ShaderChunk.lightmap_pars_vertex,THREE.ShaderChunk.envmap_pars_vertex,THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.skinning_pars_vertex,THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,"void main() {\nvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );",THREE.ShaderChunk.map_vertex,THREE.ShaderChunk.lightmap_vertex,THREE.ShaderChunk.envmap_vertex,THREE.ShaderChunk.color_vertex,THREE.ShaderChunk.skinning_vertex,THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.default_vertex,THREE.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform vec3 diffuse;\nuniform float opacity;",THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.map_pars_fragment,THREE.ShaderChunk.lightmap_pars_fragment,THREE.ShaderChunk.envmap_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.shadowmap_pars_fragment,"void main() {\ngl_FragColor = vec4( diffuse, opacity );",THREE.ShaderChunk.map_fragment,THREE.ShaderChunk.alphatest_fragment,THREE.ShaderChunk.lightmap_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.envmap_fragment,THREE.ShaderChunk.shadowmap_fragment,THREE.ShaderChunk.linear_to_gamma_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n")},lambert:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.fog,THREE.UniformsLib.lights,THREE.UniformsLib.shadowmap,{ambient:{type:"c",value:new THREE.Color(16777215)},emissive:{type:"c",value:new THREE.Color(0)},wrapRGB:{type:"v3",value:new THREE.Vector3(1,1,1)}}]),vertexShader:["varying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\nvarying vec3 vLightBack;\n#endif",THREE.ShaderChunk.map_pars_vertex,THREE.ShaderChunk.lightmap_pars_vertex,THREE.ShaderChunk.envmap_pars_vertex,THREE.ShaderChunk.lights_lambert_pars_vertex,THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.skinning_pars_vertex,THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,"void main() {\nvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );",THREE.ShaderChunk.map_vertex,THREE.ShaderChunk.lightmap_vertex,THREE.ShaderChunk.envmap_vertex,THREE.ShaderChunk.color_vertex,THREE.ShaderChunk.morphnormal_vertex,"#ifndef USE_ENVMAP\nvec4 mPosition = objectMatrix * vec4( position, 1.0 );\n#endif",THREE.ShaderChunk.lights_lambert_vertex,THREE.ShaderChunk.skinning_vertex,THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.default_vertex,THREE.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform float opacity;\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\nvarying vec3 vLightBack;\n#endif",THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.map_pars_fragment,THREE.ShaderChunk.lightmap_pars_fragment,THREE.ShaderChunk.envmap_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.shadowmap_pars_fragment,"void main() {\ngl_FragColor = vec4( vec3 ( 1.0 ), opacity );",THREE.ShaderChunk.map_fragment,THREE.ShaderChunk.alphatest_fragment,"#ifdef DOUBLE_SIDED\nif ( gl_FrontFacing )\ngl_FragColor.xyz *= vLightFront;\nelse\ngl_FragColor.xyz *= vLightBack;\n#else\ngl_FragColor.xyz *= vLightFront;\n#endif",THREE.ShaderChunk.lightmap_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.envmap_fragment,THREE.ShaderChunk.shadowmap_fragment,THREE.ShaderChunk.linear_to_gamma_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n")},phong:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.fog,THREE.UniformsLib.lights,THREE.UniformsLib.shadowmap,{ambient:{type:"c",value:new THREE.Color(16777215)},emissive:{type:"c",value:new THREE.Color(0)},specular:{type:"c",value:new THREE.Color(1118481)},shininess:{type:"f",value:30},wrapRGB:{type:"v3",value:new THREE.Vector3(1,1,1)}}]),vertexShader:["varying vec3 vViewPosition;\nvarying vec3 vNormal;",THREE.ShaderChunk.map_pars_vertex,THREE.ShaderChunk.lightmap_pars_vertex,THREE.ShaderChunk.envmap_pars_vertex,THREE.ShaderChunk.lights_phong_pars_vertex,THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.skinning_pars_vertex,THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,"void main() {\nvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );",THREE.ShaderChunk.map_vertex,THREE.ShaderChunk.lightmap_vertex,THREE.ShaderChunk.envmap_vertex,THREE.ShaderChunk.color_vertex,"#ifndef USE_ENVMAP\nvec4 mPosition = objectMatrix * vec4( position, 1.0 );\n#endif\nvViewPosition = -mvPosition.xyz;",THREE.ShaderChunk.morphnormal_vertex,"vNormal = transformedNormal;",THREE.ShaderChunk.lights_phong_vertex,THREE.ShaderChunk.skinning_vertex,THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.default_vertex,THREE.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform vec3 diffuse;\nuniform float opacity;\nuniform vec3 ambient;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;",THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.map_pars_fragment,THREE.ShaderChunk.lightmap_pars_fragment,THREE.ShaderChunk.envmap_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.lights_phong_pars_fragment,THREE.ShaderChunk.shadowmap_pars_fragment,"void main() {\ngl_FragColor = vec4( vec3 ( 1.0 ), opacity );",THREE.ShaderChunk.map_fragment,THREE.ShaderChunk.alphatest_fragment,THREE.ShaderChunk.lights_phong_fragment,THREE.ShaderChunk.lightmap_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.envmap_fragment,THREE.ShaderChunk.shadowmap_fragment,THREE.ShaderChunk.linear_to_gamma_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n")},particle_basic:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.particle,THREE.UniformsLib.shadowmap]),vertexShader:["uniform float size;\nuniform float scale;",THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,"void main() {",THREE.ShaderChunk.color_vertex,"vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n#ifdef USE_SIZEATTENUATION\ngl_PointSize = size * ( scale / length( mvPosition.xyz ) );\n#else\ngl_PointSize = size;\n#endif\ngl_Position = projectionMatrix * mvPosition;",THREE.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform vec3 psColor;\nuniform float opacity;",THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.map_particle_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.shadowmap_pars_fragment,"void main() {\ngl_FragColor = vec4( psColor, opacity );",THREE.ShaderChunk.map_particle_fragment,THREE.ShaderChunk.alphatest_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.shadowmap_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n")},depthRGBA:{uniforms:{},vertexShader:[THREE.ShaderChunk.morphtarget_pars_vertex,"void main() {\nvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );",THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.default_vertex,"}"].join("\n"),fragmentShader:"vec4 pack_depth( const in float depth ) {\nconst vec4 bit_shift = vec4( 256.0 * 256.0 * 256.0, 256.0 * 256.0, 256.0, 1.0 );\nconst vec4 bit_mask  = vec4( 0.0, 1.0 / 256.0, 1.0 / 256.0, 1.0 / 256.0 );\nvec4 res = fract( depth * bit_shift );\nres -= res.xxyz * bit_mask;\nreturn res;\n}\nvoid main() {\ngl_FragData[ 0 ] = pack_depth( gl_FragCoord.z );\n}"}},THREE.WebGLRenderer=function(a){function b(a,b){var c=a.vertices.length,d=b.material;if(d.attributes){void 0===a.__webglCustomAttributesList&&(a.__webglCustomAttributesList=[]);for(var e in d.attributes){var f=d.attributes[e];if(!f.__webglInitialized||f.createUniqueBuffers){f.__webglInitialized=!0;var g=1;"v2"===f.type?g=2:"v3"===f.type?g=3:"v4"===f.type?g=4:"c"===f.type&&(g=3),f.size=g,f.array=new Float32Array(c*g),f.buffer=F.createBuffer(),f.buffer.belongsToAttribute=e,f.needsUpdate=!0}a.__webglCustomAttributesList.push(f)}}}function c(a,b){return!a.material||a.material instanceof THREE.MeshFaceMaterial?b.materialIndex>=0?a.geometry.materials[b.materialIndex]:void 0:a.material}function d(a){return a instanceof THREE.MeshBasicMaterial&&!a.envMap||a instanceof THREE.MeshDepthMaterial?!1:a&&void 0!==a.shading&&a.shading===THREE.SmoothShading?THREE.SmoothShading:THREE.FlatShading}function e(a){return a.map||a.lightMap||a instanceof THREE.ShaderMaterial?!0:!1}function f(a,b,c){var d,e,f,g,h=a.vertices;g=h.length;var i=a.colors,j=i.length,k=a.__vertexArray,l=a.__colorArray,m=a.__sortArray,n=a.verticesNeedUpdate,o=a.colorsNeedUpdate,p=a.__webglCustomAttributesList;if(c.sortParticles){for(gb.copy(fb),gb.multiplySelf(c.matrixWorld),d=0;g>d;d++)e=h[d],hb.copy(e),gb.multiplyVector3(hb),m[d]=[hb.z,d];for(m.sort(function(a,b){return b[0]-a[0]}),d=0;g>d;d++)e=h[m[d][1]],f=3*d,k[f]=e.x,k[f+1]=e.y,k[f+2]=e.z;for(d=0;j>d;d++)f=3*d,e=i[m[d][1]],l[f]=e.r,l[f+1]=e.g,l[f+2]=e.b;if(p)for(i=0,j=p.length;j>i;i++)if(h=p[i],void 0===h.boundTo||"vertices"===h.boundTo)if(f=0,e=h.value.length,1===h.size)for(d=0;e>d;d++)g=m[d][1],h.array[d]=h.value[g];else if(2===h.size)for(d=0;e>d;d++)g=m[d][1],g=h.value[g],h.array[f]=g.x,h.array[f+1]=g.y,f+=2;else if(3===h.size)if("c"===h.type)for(d=0;e>d;d++)g=m[d][1],g=h.value[g],h.array[f]=g.r,h.array[f+1]=g.g,h.array[f+2]=g.b,f+=3;else for(d=0;e>d;d++)g=m[d][1],g=h.value[g],h.array[f]=g.x,h.array[f+1]=g.y,h.array[f+2]=g.z,f+=3;else if(4===h.size)for(d=0;e>d;d++)g=m[d][1],g=h.value[g],h.array[f]=g.x,h.array[f+1]=g.y,h.array[f+2]=g.z,h.array[f+3]=g.w,f+=4}else{if(n)for(d=0;g>d;d++)e=h[d],f=3*d,k[f]=e.x,k[f+1]=e.y,k[f+2]=e.z;if(o)for(d=0;j>d;d++)e=i[d],f=3*d,l[f]=e.r,l[f+1]=e.g,l[f+2]=e.b;if(p)for(i=0,j=p.length;j>i;i++)if(h=p[i],h.needsUpdate&&(void 0===h.boundTo||"vertices"===h.boundTo))if(e=h.value.length,f=0,1===h.size)for(d=0;e>d;d++)h.array[d]=h.value[d];else if(2===h.size)for(d=0;e>d;d++)g=h.value[d],h.array[f]=g.x,h.array[f+1]=g.y,f+=2;else if(3===h.size)if("c"===h.type)for(d=0;e>d;d++)g=h.value[d],h.array[f]=g.r,h.array[f+1]=g.g,h.array[f+2]=g.b,f+=3;else for(d=0;e>d;d++)g=h.value[d],h.array[f]=g.x,h.array[f+1]=g.y,h.array[f+2]=g.z,f+=3;else if(4===h.size)for(d=0;e>d;d++)g=h.value[d],h.array[f]=g.x,h.array[f+1]=g.y,h.array[f+2]=g.z,h.array[f+3]=g.w,f+=4}if((n||c.sortParticles)&&(F.bindBuffer(F.ARRAY_BUFFER,a.__webglVertexBuffer),F.bufferData(F.ARRAY_BUFFER,k,b)),(o||c.sortParticles)&&(F.bindBuffer(F.ARRAY_BUFFER,a.__webglColorBuffer),F.bufferData(F.ARRAY_BUFFER,l,b)),p)for(i=0,j=p.length;j>i;i++)h=p[i],(h.needsUpdate||c.sortParticles)&&(F.bindBuffer(F.ARRAY_BUFFER,h.buffer),F.bufferData(F.ARRAY_BUFFER,h.array,b))}function g(a,b){return b.z-a.z}function h(a,b,c){if(a.length)for(var d=0,e=a.length;e>d;d++)M=I=null,K=L=P=O=V=U=Q=-1,jb=!0,a[d].render(b,c,cb,db),M=I=null,K=L=P=O=V=U=Q=-1,jb=!0}function i(a,b,c,d,e,f,g,h){var i,j,k,l;b?(j=a.length-1,l=b=-1):(j=0,b=a.length,l=1);for(var m=j;m!==b;m+=l)if(i=a[m],i.render){if(j=i.object,k=i.buffer,h)i=h;else{if(i=i[c],!i)continue;g&&G.setBlending(i.blending,i.blendEquation,i.blendSrc,i.blendDst),G.setDepthTest(i.depthTest),G.setDepthWrite(i.depthWrite),p(i.polygonOffset,i.polygonOffsetFactor,i.polygonOffsetUnits)}G.setObjectFaces(j),k instanceof THREE.BufferGeometry?G.renderBufferDirect(d,e,f,i,k,j):G.renderBuffer(d,e,f,i,k,j)}}function j(a,b,c,d,e,f,g){for(var h,i,j=0,k=a.length;k>j;j++)if(h=a[j],i=h.object,i.visible){if(g)h=g;else{if(h=h[b],!h)continue;f&&G.setBlending(h.blending,h.blendEquation,h.blendSrc,h.blendDst),G.setDepthTest(h.depthTest),G.setDepthWrite(h.depthWrite),p(h.polygonOffset,h.polygonOffsetFactor,h.polygonOffsetUnits)}G.renderImmediateObject(c,d,e,h,i)}}function k(a,b,c){a.push({buffer:b,object:c,opaque:null,transparent:null})}function l(a){for(var b in a.attributes)if(a.attributes[b].needsUpdate)return!0;return!1}function m(a){for(var b in a.attributes)a.attributes[b].needsUpdate=!1}function n(a,b,c,d,e){if((!d.program||d.needsUpdate)&&(G.initMaterial(d,b,c,e),d.needsUpdate=!1),d.morphTargets&&!e.__webglMorphTargetInfluences){e.__webglMorphTargetInfluences=new Float32Array(G.maxMorphTargets);for(var f=0,g=G.maxMorphTargets;g>f;f++)e.__webglMorphTargetInfluences[f]=0}var h=!1,f=d.program,g=f.uniforms,i=d.uniforms;if(f!==I&&(F.useProgram(f),I=f,h=!0),d.id!==K&&(K=d.id,h=!0),(h||a!==M)&&(F.uniformMatrix4fv(g.projectionMatrix,!1,a._projectionMatrixArray),a!==M&&(M=a)),h){if(c&&d.fog&&(i.fogColor.value=c.color,c instanceof THREE.Fog?(i.fogNear.value=c.near,i.fogFar.value=c.far):c instanceof THREE.FogExp2&&(i.fogDensity.value=c.density)),d instanceof THREE.MeshPhongMaterial||d instanceof THREE.MeshLambertMaterial||d.lights){if(jb){for(var j,k,l,m,n=0,o=0,p=0,q=kb,s=q.directional.colors,t=q.directional.positions,w=q.point.colors,x=q.point.positions,y=q.point.distances,z=q.spot.colors,A=q.spot.positions,B=q.spot.distances,C=q.spot.directions,D=q.spot.angles,E=q.spot.exponents,H=0,J=0,L=0,N=m=0,c=N=0,h=b.length;h>c;c++)j=b[c],j.onlyShadow||(k=j.color,l=j.intensity,m=j.distance,j instanceof THREE.AmbientLight?G.gammaInput?(n+=k.r*k.r,o+=k.g*k.g,p+=k.b*k.b):(n+=k.r,o+=k.g,p+=k.b):j instanceof THREE.DirectionalLight?(m=3*H,G.gammaInput?(s[m]=k.r*k.r*l*l,s[m+1]=k.g*k.g*l*l,s[m+2]=k.b*k.b*l*l):(s[m]=k.r*l,s[m+1]=k.g*l,s[m+2]=k.b*l),ib.copy(j.matrixWorld.getPosition()),ib.subSelf(j.target.matrixWorld.getPosition()),ib.normalize(),t[m]=ib.x,t[m+1]=ib.y,t[m+2]=ib.z,H+=1):j instanceof THREE.PointLight?(N=3*J,G.gammaInput?(w[N]=k.r*k.r*l*l,w[N+1]=k.g*k.g*l*l,w[N+2]=k.b*k.b*l*l):(w[N]=k.r*l,w[N+1]=k.g*l,w[N+2]=k.b*l),k=j.matrixWorld.getPosition(),x[N]=k.x,x[N+1]=k.y,x[N+2]=k.z,y[J]=m,J+=1):j instanceof THREE.SpotLight&&(N=3*L,G.gammaInput?(z[N]=k.r*k.r*l*l,z[N+1]=k.g*k.g*l*l,z[N+2]=k.b*k.b*l*l):(z[N]=k.r*l,z[N+1]=k.g*l,z[N+2]=k.b*l),k=j.matrixWorld.getPosition(),A[N]=k.x,A[N+1]=k.y,A[N+2]=k.z,B[L]=m,ib.copy(k),ib.subSelf(j.target.matrixWorld.getPosition()),ib.normalize(),C[N]=ib.x,C[N+1]=ib.y,C[N+2]=ib.z,D[L]=Math.cos(j.angle),E[L]=j.exponent,L+=1));for(c=3*H,h=s.length;h>c;c++)s[c]=0;for(c=3*J,h=w.length;h>c;c++)w[c]=0;for(c=3*L,h=z.length;h>c;c++)z[c]=0;q.directional.length=H,q.point.length=J,q.spot.length=L,q.ambient[0]=n,q.ambient[1]=o,q.ambient[2]=p,jb=!1}c=kb,i.ambientLightColor.value=c.ambient,i.directionalLightColor.value=c.directional.colors,i.directionalLightDirection.value=c.directional.positions,i.pointLightColor.value=c.point.colors,i.pointLightPosition.value=c.point.positions,i.pointLightDistance.value=c.point.distances,i.spotLightColor.value=c.spot.colors,i.spotLightPosition.value=c.spot.positions,i.spotLightDistance.value=c.spot.distances,i.spotLightDirection.value=c.spot.directions,i.spotLightAngle.value=c.spot.angles,i.spotLightExponent.value=c.spot.exponents}if((d instanceof THREE.MeshBasicMaterial||d instanceof THREE.MeshLambertMaterial||d instanceof THREE.MeshPhongMaterial)&&(i.opacity.value=d.opacity,G.gammaInput?i.diffuse.value.copyGammaToLinear(d.color):i.diffuse.value=d.color,(i.map.texture=d.map)&&i.offsetRepeat.value.set(d.map.offset.x,d.map.offset.y,d.map.repeat.x,d.map.repeat.y),i.lightMap.texture=d.lightMap,i.envMap.texture=d.envMap,i.flipEnvMap.value=d.envMap instanceof THREE.WebGLRenderTargetCube?1:-1,i.reflectivity.value=d.reflectivity,i.refractionRatio.value=d.refractionRatio,i.combine.value=d.combine,i.useRefract.value=d.envMap&&d.envMap.mapping instanceof THREE.CubeRefractionMapping),d instanceof THREE.LineBasicMaterial?(i.diffuse.value=d.color,i.opacity.value=d.opacity):d instanceof THREE.ParticleBasicMaterial?(i.psColor.value=d.color,i.opacity.value=d.opacity,i.size.value=d.size,i.scale.value=v.height/2,i.map.texture=d.map):d instanceof THREE.MeshPhongMaterial?(i.shininess.value=d.shininess,G.gammaInput?(i.ambient.value.copyGammaToLinear(d.ambient),i.emissive.value.copyGammaToLinear(d.emissive),i.specular.value.copyGammaToLinear(d.specular)):(i.ambient.value=d.ambient,i.emissive.value=d.emissive,i.specular.value=d.specular),d.wrapAround&&i.wrapRGB.value.copy(d.wrapRGB)):d instanceof THREE.MeshLambertMaterial?(G.gammaInput?(i.ambient.value.copyGammaToLinear(d.ambient),i.emissive.value.copyGammaToLinear(d.emissive)):(i.ambient.value=d.ambient,i.emissive.value=d.emissive),d.wrapAround&&i.wrapRGB.value.copy(d.wrapRGB)):d instanceof THREE.MeshDepthMaterial?(i.mNear.value=a.near,i.mFar.value=a.far,i.opacity.value=d.opacity):d instanceof THREE.MeshNormalMaterial&&(i.opacity.value=d.opacity),e.receiveShadow&&!d._shadowPass&&i.shadowMatrix)for(h=c=0,j=b.length;j>h;h++)n=b[h],n.castShadow&&(n instanceof THREE.SpotLight||n instanceof THREE.DirectionalLight&&!n.shadowCascade)&&(i.shadowMap.texture[c]=n.shadowMap,i.shadowMapSize.value[c]=n.shadowMapSize,i.shadowMatrix.value[c]=n.shadowMatrix,i.shadowDarkness.value[c]=n.shadowDarkness,i.shadowBias.value[c]=n.shadowBias,c++);for(b=d.uniformsList,i=0,c=b.length;c>i;i++)if(n=f.uniforms[b[i][1]])switch(h=b[i][0],o=h.type,j=h.value,o){case"i":F.uniform1i(n,j);break;case"f":F.uniform1f(n,j);break;case"v2":F.uniform2f(n,j.x,j.y);break;case"v3":F.uniform3f(n,j.x,j.y,j.z);break;case"v4":F.uniform4f(n,j.x,j.y,j.z,j.w);break;case"c":F.uniform3f(n,j.r,j.g,j.b);break;case"fv1":F.uniform1fv(n,j);break;case"fv":F.uniform3fv(n,j);break;case"v2v":for(h._array||(h._array=new Float32Array(2*j.length)),o=0,p=j.length;p>o;o++)q=2*o,h._array[q]=j[o].x,h._array[q+1]=j[o].y;F.uniform2fv(n,h._array);break;case"v3v":for(h._array||(h._array=new Float32Array(3*j.length)),o=0,p=j.length;p>o;o++)q=3*o,h._array[q]=j[o].x,h._array[q+1]=j[o].y,h._array[q+2]=j[o].z;F.uniform3fv(n,h._array);break;case"v4v":for(h._array||(h._array=new Float32Array(4*j.length)),o=0,p=j.length;p>o;o++)q=4*o,h._array[q]=j[o].x,h._array[q+1]=j[o].y,h._array[q+2]=j[o].z,h._array[q+3]=j[o].w;F.uniform4fv(n,h._array);break;case"m4":h._array||(h._array=new Float32Array(16)),j.flattenToArray(h._array),F.uniformMatrix4fv(n,!1,h._array);break;case"m4v":for(h._array||(h._array=new Float32Array(16*j.length)),o=0,p=j.length;p>o;o++)j[o].flattenToArrayOffset(h._array,16*o);F.uniformMatrix4fv(n,!1,h._array);break;case"t":if(F.uniform1i(n,j),n=h.texture,!n)continue;if(n.image instanceof Array&&6===n.image.length){if(h=n,6===h.image.length)if(h.needsUpdate){for(h.image.__webglTextureCube||(h.image.__webglTextureCube=F.createTexture()),F.activeTexture(F.TEXTURE0+j),F.bindTexture(F.TEXTURE_CUBE_MAP,h.image.__webglTextureCube),j=[],n=0;6>n;n++)o=j,p=n,G.autoScaleCubemaps?(q=h.image[n],t=mb,q.width<=t&&q.height<=t||(w=Math.max(q.width,q.height),s=Math.floor(q.width*t/w),t=Math.floor(q.height*t/w),w=document.createElement("canvas"),w.width=s,w.height=t,w.getContext("2d").drawImage(q,0,0,q.width,q.height,0,0,s,t),q=w)):q=h.image[n],o[p]=q;for(n=j[0],o=0===(n.width&n.width-1)&&0===(n.height&n.height-1),p=u(h.format),q=u(h.type),r(F.TEXTURE_CUBE_MAP,h,o),n=0;6>n;n++)F.texImage2D(F.TEXTURE_CUBE_MAP_POSITIVE_X+n,0,p,p,q,j[n]);h.generateMipmaps&&o&&F.generateMipmap(F.TEXTURE_CUBE_MAP),h.needsUpdate=!1,h.onUpdate&&h.onUpdate()}else F.activeTexture(F.TEXTURE0+j),F.bindTexture(F.TEXTURE_CUBE_MAP,h.image.__webglTextureCube)}else n instanceof THREE.WebGLRenderTargetCube?(h=n,F.activeTexture(F.TEXTURE0+j),F.bindTexture(F.TEXTURE_CUBE_MAP,h.__webglTexture)):G.setTexture(n,j);break;case"tv":if(!h._array)for(h._array=[],o=0,p=h.texture.length;p>o;o++)h._array[o]=j+o;for(F.uniform1iv(n,h._array),o=0,p=h.texture.length;p>o;o++)(n=h.texture[o])&&G.setTexture(n,h._array[o])}(d instanceof THREE.ShaderMaterial||d instanceof THREE.MeshPhongMaterial||d.envMap)&&null!==g.cameraPosition&&(b=a.matrixWorld.getPosition(),F.uniform3f(g.cameraPosition,b.x,b.y,b.z)),(d instanceof THREE.MeshPhongMaterial||d instanceof THREE.MeshLambertMaterial||d instanceof THREE.ShaderMaterial||d.skinning)&&null!==g.viewMatrix&&F.uniformMatrix4fv(g.viewMatrix,!1,a._viewMatrixArray),d.skinning&&F.uniformMatrix4fv(g.boneGlobalMatrices,!1,e.boneMatrices)}return F.uniformMatrix4fv(g.modelViewMatrix,!1,e._modelViewMatrix.elements),g.normalMatrix&&F.uniformMatrix3fv(g.normalMatrix,!1,e._normalMatrix.elements),null!==g.objectMatrix&&F.uniformMatrix4fv(g.objectMatrix,!1,e.matrixWorld.elements),f}function o(a,b){a._modelViewMatrix.multiply(b.matrixWorldInverse,a.matrixWorld),a._normalMatrix.getInverse(a._modelViewMatrix),a._normalMatrix.transpose()}function p(a,b,c){W!==a&&(a?F.enable(F.POLYGON_OFFSET_FILL):F.disable(F.POLYGON_OFFSET_FILL),W=a),!a||X===b&&Y===c||(F.polygonOffset(b,c),X=b,Y=c)}function q(a,b){var c;return"fragment"===a?c=F.createShader(F.FRAGMENT_SHADER):"vertex"===a&&(c=F.createShader(F.VERTEX_SHADER)),F.shaderSource(c,b),F.compileShader(c),F.getShaderParameter(c,F.COMPILE_STATUS)?c:null}function r(a,b,c){c?(F.texParameteri(a,F.TEXTURE_WRAP_S,u(b.wrapS)),F.texParameteri(a,F.TEXTURE_WRAP_T,u(b.wrapT)),F.texParameteri(a,F.TEXTURE_MAG_FILTER,u(b.magFilter)),F.texParameteri(a,F.TEXTURE_MIN_FILTER,u(b.minFilter))):(F.texParameteri(a,F.TEXTURE_WRAP_S,F.CLAMP_TO_EDGE),F.texParameteri(a,F.TEXTURE_WRAP_T,F.CLAMP_TO_EDGE),F.texParameteri(a,F.TEXTURE_MAG_FILTER,t(b.magFilter)),F.texParameteri(a,F.TEXTURE_MIN_FILTER,t(b.minFilter)))}function s(a,b){F.bindRenderbuffer(F.RENDERBUFFER,a),b.depthBuffer&&!b.stencilBuffer?(F.renderbufferStorage(F.RENDERBUFFER,F.DEPTH_COMPONENT16,b.width,b.height),F.framebufferRenderbuffer(F.FRAMEBUFFER,F.DEPTH_ATTACHMENT,F.RENDERBUFFER,a)):b.depthBuffer&&b.stencilBuffer?(F.renderbufferStorage(F.RENDERBUFFER,F.DEPTH_STENCIL,b.width,b.height),F.framebufferRenderbuffer(F.FRAMEBUFFER,F.DEPTH_STENCIL_ATTACHMENT,F.RENDERBUFFER,a)):F.renderbufferStorage(F.RENDERBUFFER,F.RGBA4,b.width,b.height)}function t(a){switch(a){case THREE.NearestFilter:case THREE.NearestMipMapNearestFilter:case THREE.NearestMipMapLinearFilter:return F.NEAREST;default:return F.LINEAR}}function u(a){switch(a){case THREE.RepeatWrapping:return F.REPEAT;case THREE.ClampToEdgeWrapping:return F.CLAMP_TO_EDGE;case THREE.MirroredRepeatWrapping:return F.MIRRORED_REPEAT;case THREE.NearestFilter:return F.NEAREST;case THREE.NearestMipMapNearestFilter:return F.NEAREST_MIPMAP_NEAREST;case THREE.NearestMipMapLinearFilter:return F.NEAREST_MIPMAP_LINEAR;case THREE.LinearFilter:return F.LINEAR;case THREE.LinearMipMapNearestFilter:return F.LINEAR_MIPMAP_NEAREST;case THREE.LinearMipMapLinearFilter:return F.LINEAR_MIPMAP_LINEAR;case THREE.ByteType:return F.BYTE;case THREE.UnsignedByteType:return F.UNSIGNED_BYTE;case THREE.ShortType:return F.SHORT;case THREE.UnsignedShortType:return F.UNSIGNED_SHORT;case THREE.IntType:return F.INT;case THREE.UnsignedIntType:return F.UNSIGNED_INT;case THREE.FloatType:return F.FLOAT;case THREE.AlphaFormat:return F.ALPHA;case THREE.RGBFormat:return F.RGB;case THREE.RGBAFormat:return F.RGBA;case THREE.LuminanceFormat:return F.LUMINANCE;case THREE.LuminanceAlphaFormat:return F.LUMINANCE_ALPHA;case THREE.AddEquation:return F.FUNC_ADD;case THREE.SubtractEquation:return F.FUNC_SUBTRACT;case THREE.ReverseSubtractEquation:return F.FUNC_REVERSE_SUBTRACT;case THREE.ZeroFactor:return F.ZERO;case THREE.OneFactor:return F.ONE;case THREE.SrcColorFactor:return F.SRC_COLOR;case THREE.OneMinusSrcColorFactor:return F.ONE_MINUS_SRC_COLOR;case THREE.SrcAlphaFactor:return F.SRC_ALPHA;case THREE.OneMinusSrcAlphaFactor:return F.ONE_MINUS_SRC_ALPHA;case THREE.DstAlphaFactor:return F.DST_ALPHA;case THREE.OneMinusDstAlphaFactor:return F.ONE_MINUS_DST_ALPHA;case THREE.DstColorFactor:return F.DST_COLOR;case THREE.OneMinusDstColorFactor:return F.ONE_MINUS_DST_COLOR;case THREE.SrcAlphaSaturateFactor:return F.SRC_ALPHA_SATURATE}return 0}var a=a||{},v=void 0!==a.canvas?a.canvas:document.createElement("canvas"),w=void 0!==a.precision?a.precision:"highp",x=void 0!==a.alpha?a.alpha:!0,y=void 0!==a.premultipliedAlpha?a.premultipliedAlpha:!0,z=void 0!==a.antialias?a.antialias:!1,A=void 0!==a.stencil?a.stencil:!0,B=void 0!==a.preserveDrawingBuffer?a.preserveDrawingBuffer:!1,C=new THREE.Color(void 0!==a.clearColor?a.clearColor:0),D=void 0!==a.clearAlpha?a.clearAlpha:0,E=void 0!==a.maxLights?a.maxLights:4;this.domElement=v,this.context=null,this.autoUpdateScene=this.autoUpdateObjects=this.sortObjects=this.autoClearStencil=this.autoClearDepth=this.autoClearColor=this.autoClear=!0,this.shadowMapEnabled=this.physicallyBasedShading=this.gammaOutput=this.gammaInput=!1,this.shadowMapCullFrontFaces=this.shadowMapSoft=this.shadowMapAutoUpdate=!0,this.shadowMapCascade=this.shadowMapDebug=!1,this.maxMorphTargets=8,this.maxMorphNormals=4,this.autoScaleCubemaps=!0,this.renderPluginsPre=[],this.renderPluginsPost=[],this.info={memory:{programs:0,geometries:0,textures:0},render:{calls:0,vertices:0,faces:0,points:0}};var F,G=this,H=[],I=null,J=null,K=-1,L=null,M=null,N=0,O=-1,P=-1,Q=-1,R=-1,S=-1,T=-1,U=-1,V=-1,W=null,X=null,Y=null,Z=null,$=0,_=0,ab=0,bb=0,cb=0,db=0,eb=new THREE.Frustum,fb=new THREE.Matrix4,gb=new THREE.Matrix4,hb=new THREE.Vector4,ib=new THREE.Vector3,jb=!0,kb={ambient:[0,0,0],directional:{length:0,colors:[],positions:[]},point:{length:0,colors:[],positions:[],distances:[]},spot:{length:0,colors:[],positions:[],distances:[],directions:[],angles:[],exponents:[]}};F=function(){var a;try{if(!(a=v.getContext("experimental-webgl",{alpha:x,premultipliedAlpha:y,antialias:z,stencil:A,preserveDrawingBuffer:B})))throw"Error creating WebGL context."}catch(b){}return a.getExtension("OES_texture_float")||void 0,a}(),F.clearColor(0,0,0,1),F.clearDepth(1),F.clearStencil(0),F.enable(F.DEPTH_TEST),F.depthFunc(F.LEQUAL),F.frontFace(F.CCW),F.cullFace(F.BACK),F.enable(F.CULL_FACE),F.enable(F.BLEND),F.blendEquation(F.FUNC_ADD),F.blendFunc(F.SRC_ALPHA,F.ONE_MINUS_SRC_ALPHA),F.clearColor(C.r,C.g,C.b,D),this.context=F;var lb=F.getParameter(F.MAX_VERTEX_TEXTURE_IMAGE_UNITS);F.getParameter(F.MAX_TEXTURE_SIZE);var mb=F.getParameter(F.MAX_CUBE_MAP_TEXTURE_SIZE);this.getContext=function(){return F},this.supportsVertexTextures=function(){return lb>0},this.setSize=function(a,b){v.width=a,v.height=b,this.setViewport(0,0,v.width,v.height)},this.setViewport=function(a,b,c,d){$=a,_=b,ab=c,bb=d,F.viewport($,_,ab,bb)},this.setScissor=function(a,b,c,d){F.scissor(a,b,c,d)},this.enableScissorTest=function(a){a?F.enable(F.SCISSOR_TEST):F.disable(F.SCISSOR_TEST)},this.setClearColorHex=function(a,b){C.setHex(a),D=b,F.clearColor(C.r,C.g,C.b,D)},this.setClearColor=function(a,b){C.copy(a),D=b,F.clearColor(C.r,C.g,C.b,D)},this.getClearColor=function(){return C},this.getClearAlpha=function(){return D},this.clear=function(a,b,c){var d=0;(void 0===a||a)&&(d|=F.COLOR_BUFFER_BIT),(void 0===b||b)&&(d|=F.DEPTH_BUFFER_BIT),(void 0===c||c)&&(d|=F.STENCIL_BUFFER_BIT),F.clear(d)},this.clearTarget=function(a,b,c,d){this.setRenderTarget(a),this.clear(b,c,d)},this.addPostPlugin=function(a){a.init(this),this.renderPluginsPost.push(a)},this.addPrePlugin=function(a){a.init(this),this.renderPluginsPre.push(a)},this.deallocateObject=function(a){if(a.__webglInit)if(a.__webglInit=!1,delete a._modelViewMatrix,delete a._normalMatrix,delete a._normalMatrixArray,delete a._modelViewMatrixArray,delete a._objectMatrixArray,a instanceof THREE.Mesh)for(var b in a.geometry.geometryGroups){var c=a.geometry.geometryGroups[b];F.deleteBuffer(c.__webglVertexBuffer),F.deleteBuffer(c.__webglNormalBuffer),F.deleteBuffer(c.__webglTangentBuffer),F.deleteBuffer(c.__webglColorBuffer),F.deleteBuffer(c.__webglUVBuffer),F.deleteBuffer(c.__webglUV2Buffer),F.deleteBuffer(c.__webglSkinVertexABuffer),F.deleteBuffer(c.__webglSkinVertexBBuffer),F.deleteBuffer(c.__webglSkinIndicesBuffer),F.deleteBuffer(c.__webglSkinWeightsBuffer),F.deleteBuffer(c.__webglFaceBuffer),F.deleteBuffer(c.__webglLineBuffer);var d=void 0,e=void 0;if(c.numMorphTargets)for(d=0,e=c.numMorphTargets;e>d;d++)F.deleteBuffer(c.__webglMorphTargetsBuffers[d]);if(c.numMorphNormals)for(d=0,e=c.numMorphNormals;e>d;d++)F.deleteBuffer(c.__webglMorphNormalsBuffers[d]);if(c.__webglCustomAttributesList){d=void 0;for(d in c.__webglCustomAttributesList)F.deleteBuffer(c.__webglCustomAttributesList[d].buffer)}G.info.memory.geometries--}else a instanceof THREE.Line&&(a=a.geometry,F.deleteBuffer(a.__webglVertexBuffer),F.deleteBuffer(a.__webglColorBuffer),G.info.memory.geometries--)},this.deallocateTexture=function(a){a.__webglInit&&(a.__webglInit=!1,F.deleteTexture(a.__webglTexture),G.info.memory.textures--)},this.deallocateRenderTarget=function(a){if(a&&a.__webglTexture)if(F.deleteTexture(a.__webglTexture),a instanceof THREE.WebGLRenderTargetCube)for(var b=0;6>b;b++)F.deleteFramebuffer(a.__webglFramebuffer[b]),F.deleteRenderbuffer(a.__webglRenderbuffer[b]);else F.deleteFramebuffer(a.__webglFramebuffer),F.deleteRenderbuffer(a.__webglRenderbuffer)},this.updateShadowMap=function(a,b){I=null,K=L=V=U=Q=-1,jb=!0,P=O=-1,this.shadowMapPlugin.update(a,b)},this.renderBufferImmediate=function(a,b,c){if(a.__webglVertexBuffer||(a.__webglVertexBuffer=F.createBuffer()),a.__webglNormalBuffer||(a.__webglNormalBuffer=F.createBuffer()),a.hasPos&&(F.bindBuffer(F.ARRAY_BUFFER,a.__webglVertexBuffer),F.bufferData(F.ARRAY_BUFFER,a.positionArray,F.DYNAMIC_DRAW),F.enableVertexAttribArray(b.attributes.position),F.vertexAttribPointer(b.attributes.position,3,F.FLOAT,!1,0,0)),a.hasNormal){if(F.bindBuffer(F.ARRAY_BUFFER,a.__webglNormalBuffer),c===THREE.FlatShading){var d,e,f,g,h,i,j,k,l,m,n=3*a.count;for(m=0;n>m;m+=9)c=a.normalArray,d=c[m],e=c[m+1],f=c[m+2],g=c[m+3],i=c[m+4],k=c[m+5],h=c[m+6],j=c[m+7],l=c[m+8],d=(d+g+h)/3,e=(e+i+j)/3,f=(f+k+l)/3,c[m]=d,c[m+1]=e,c[m+2]=f,c[m+3]=d,c[m+4]=e,c[m+5]=f,c[m+6]=d,c[m+7]=e,c[m+8]=f
}F.bufferData(F.ARRAY_BUFFER,a.normalArray,F.DYNAMIC_DRAW),F.enableVertexAttribArray(b.attributes.normal),F.vertexAttribPointer(b.attributes.normal,3,F.FLOAT,!1,0,0)}F.drawArrays(F.TRIANGLES,0,a.count),a.count=0},this.renderBufferDirect=function(a,b,c,d,e,f){if(d.visible!==!1&&(c=n(a,b,c,d,f),a=c.attributes,b=!1,d=16777215*e.id+2*c.id+(d.wireframe?1:0),d!==L&&(L=d,b=!0),f instanceof THREE.Mesh))for(f=e.offsets,d=0,c=f.length;c>d;++d)b&&(F.bindBuffer(F.ARRAY_BUFFER,e.vertexPositionBuffer),F.vertexAttribPointer(a.position,e.vertexPositionBuffer.itemSize,F.FLOAT,!1,0,12*f[d].index),a.normal>=0&&e.vertexNormalBuffer&&(F.bindBuffer(F.ARRAY_BUFFER,e.vertexNormalBuffer),F.vertexAttribPointer(a.normal,e.vertexNormalBuffer.itemSize,F.FLOAT,!1,0,12*f[d].index)),a.uv>=0&&e.vertexUvBuffer&&(e.vertexUvBuffer?(F.bindBuffer(F.ARRAY_BUFFER,e.vertexUvBuffer),F.vertexAttribPointer(a.uv,e.vertexUvBuffer.itemSize,F.FLOAT,!1,0,8*f[d].index),F.enableVertexAttribArray(a.uv)):F.disableVertexAttribArray(a.uv)),a.color>=0&&e.vertexColorBuffer&&(F.bindBuffer(F.ARRAY_BUFFER,e.vertexColorBuffer),F.vertexAttribPointer(a.color,e.vertexColorBuffer.itemSize,F.FLOAT,!1,0,16*f[d].index)),F.bindBuffer(F.ELEMENT_ARRAY_BUFFER,e.vertexIndexBuffer)),F.drawElements(F.TRIANGLES,f[d].count,F.UNSIGNED_SHORT,2*f[d].start),G.info.render.calls++,G.info.render.vertices=G.info.render.vertices+f[d].count,G.info.render.faces=G.info.render.faces+f[d].count/3},this.renderBuffer=function(a,b,c,d,e,f){if(d.visible!==!1){var g,h,c=n(a,b,c,d,f),b=c.attributes,a=!1,c=16777215*e.id+2*c.id+(d.wireframe?1:0);if(c!==L&&(L=c,a=!0),!d.morphTargets&&b.position>=0)a&&(F.bindBuffer(F.ARRAY_BUFFER,e.__webglVertexBuffer),F.vertexAttribPointer(b.position,3,F.FLOAT,!1,0,0));else if(f.morphTargetBase){if(c=d.program.attributes,-1!==f.morphTargetBase?(F.bindBuffer(F.ARRAY_BUFFER,e.__webglMorphTargetsBuffers[f.morphTargetBase]),F.vertexAttribPointer(c.position,3,F.FLOAT,!1,0,0)):c.position>=0&&(F.bindBuffer(F.ARRAY_BUFFER,e.__webglVertexBuffer),F.vertexAttribPointer(c.position,3,F.FLOAT,!1,0,0)),f.morphTargetForcedOrder.length){g=0;var i=f.morphTargetForcedOrder;for(h=f.morphTargetInfluences;g<d.numSupportedMorphTargets&&g<i.length;)F.bindBuffer(F.ARRAY_BUFFER,e.__webglMorphTargetsBuffers[i[g]]),F.vertexAttribPointer(c["morphTarget"+g],3,F.FLOAT,!1,0,0),d.morphNormals&&(F.bindBuffer(F.ARRAY_BUFFER,e.__webglMorphNormalsBuffers[i[g]]),F.vertexAttribPointer(c["morphNormal"+g],3,F.FLOAT,!1,0,0)),f.__webglMorphTargetInfluences[g]=h[i[g]],g++}else{var i=[],j=-1,k=0;h=f.morphTargetInfluences;var l,m=h.length;for(g=0,-1!==f.morphTargetBase&&(i[f.morphTargetBase]=!0);g<d.numSupportedMorphTargets;){for(l=0;m>l;l++)!i[l]&&h[l]>j&&(k=l,j=h[k]);F.bindBuffer(F.ARRAY_BUFFER,e.__webglMorphTargetsBuffers[k]),F.vertexAttribPointer(c["morphTarget"+g],3,F.FLOAT,!1,0,0),d.morphNormals&&(F.bindBuffer(F.ARRAY_BUFFER,e.__webglMorphNormalsBuffers[k]),F.vertexAttribPointer(c["morphNormal"+g],3,F.FLOAT,!1,0,0)),f.__webglMorphTargetInfluences[g]=j,i[k]=1,j=-1,g++}}null!==d.program.uniforms.morphTargetInfluences&&F.uniform1fv(d.program.uniforms.morphTargetInfluences,f.__webglMorphTargetInfluences)}if(a){if(e.__webglCustomAttributesList)for(g=0,h=e.__webglCustomAttributesList.length;h>g;g++)c=e.__webglCustomAttributesList[g],b[c.buffer.belongsToAttribute]>=0&&(F.bindBuffer(F.ARRAY_BUFFER,c.buffer),F.vertexAttribPointer(b[c.buffer.belongsToAttribute],c.size,F.FLOAT,!1,0,0));b.color>=0&&(F.bindBuffer(F.ARRAY_BUFFER,e.__webglColorBuffer),F.vertexAttribPointer(b.color,3,F.FLOAT,!1,0,0)),b.normal>=0&&(F.bindBuffer(F.ARRAY_BUFFER,e.__webglNormalBuffer),F.vertexAttribPointer(b.normal,3,F.FLOAT,!1,0,0)),b.tangent>=0&&(F.bindBuffer(F.ARRAY_BUFFER,e.__webglTangentBuffer),F.vertexAttribPointer(b.tangent,4,F.FLOAT,!1,0,0)),b.uv>=0&&(e.__webglUVBuffer?(F.bindBuffer(F.ARRAY_BUFFER,e.__webglUVBuffer),F.vertexAttribPointer(b.uv,2,F.FLOAT,!1,0,0),F.enableVertexAttribArray(b.uv)):F.disableVertexAttribArray(b.uv)),b.uv2>=0&&(e.__webglUV2Buffer?(F.bindBuffer(F.ARRAY_BUFFER,e.__webglUV2Buffer),F.vertexAttribPointer(b.uv2,2,F.FLOAT,!1,0,0),F.enableVertexAttribArray(b.uv2)):F.disableVertexAttribArray(b.uv2)),d.skinning&&b.skinVertexA>=0&&b.skinVertexB>=0&&b.skinIndex>=0&&b.skinWeight>=0&&(F.bindBuffer(F.ARRAY_BUFFER,e.__webglSkinVertexABuffer),F.vertexAttribPointer(b.skinVertexA,4,F.FLOAT,!1,0,0),F.bindBuffer(F.ARRAY_BUFFER,e.__webglSkinVertexBBuffer),F.vertexAttribPointer(b.skinVertexB,4,F.FLOAT,!1,0,0),F.bindBuffer(F.ARRAY_BUFFER,e.__webglSkinIndicesBuffer),F.vertexAttribPointer(b.skinIndex,4,F.FLOAT,!1,0,0),F.bindBuffer(F.ARRAY_BUFFER,e.__webglSkinWeightsBuffer),F.vertexAttribPointer(b.skinWeight,4,F.FLOAT,!1,0,0))}f instanceof THREE.Mesh?(d.wireframe?(d=d.wireframeLinewidth,d!==Z&&(F.lineWidth(d),Z=d),a&&F.bindBuffer(F.ELEMENT_ARRAY_BUFFER,e.__webglLineBuffer),F.drawElements(F.LINES,e.__webglLineCount,F.UNSIGNED_SHORT,0)):(a&&F.bindBuffer(F.ELEMENT_ARRAY_BUFFER,e.__webglFaceBuffer),F.drawElements(F.TRIANGLES,e.__webglFaceCount,F.UNSIGNED_SHORT,0)),G.info.render.calls++,G.info.render.vertices=G.info.render.vertices+e.__webglFaceCount,G.info.render.faces=G.info.render.faces+e.__webglFaceCount/3):f instanceof THREE.Line&&(f=f.type===THREE.LineStrip?F.LINE_STRIP:F.LINES,d=d.linewidth,d!==Z&&(F.lineWidth(d),Z=d),F.drawArrays(f,0,e.__webglLineCount),G.info.render.calls++)}},this.render=function(a,b,c,d){var e,f,k,l,m=a.__lights,n=a.fog;for(K=-1,jb=!0,void 0===b.parent&&a.add(b),this.autoUpdateScene&&a.updateMatrixWorld(),b._viewMatrixArray||(b._viewMatrixArray=new Float32Array(16)),b._projectionMatrixArray||(b._projectionMatrixArray=new Float32Array(16)),b.matrixWorldInverse.getInverse(b.matrixWorld),b.matrixWorldInverse.flattenToArray(b._viewMatrixArray),b.projectionMatrix.flattenToArray(b._projectionMatrixArray),fb.multiply(b.projectionMatrix,b.matrixWorldInverse),eb.setFromMatrix(fb),this.autoUpdateObjects&&this.initWebGLObjects(a),h(this.renderPluginsPre,a,b),G.info.render.calls=0,G.info.render.vertices=0,G.info.render.faces=0,G.info.render.points=0,this.setRenderTarget(c),(this.autoClear||d)&&this.clear(this.autoClearColor,this.autoClearDepth,this.autoClearStencil),l=a.__webglObjects,d=0,e=l.length;e>d;d++)if(f=l[d],k=f.object,f.render=!1,k.visible&&(!(k instanceof THREE.Mesh||k instanceof THREE.ParticleSystem)||!k.frustumCulled||eb.contains(k))){o(k,b);var q=f,r=q.object,s=q.buffer,t=void 0,t=t=void 0,t=r.material;t instanceof THREE.MeshFaceMaterial?(t=s.materialIndex,t>=0&&(t=r.geometry.materials[t],t.transparent?(q.transparent=t,q.opaque=null):(q.opaque=t,q.transparent=null))):t&&(t.transparent?(q.transparent=t,q.opaque=null):(q.opaque=t,q.transparent=null)),f.render=!0,this.sortObjects&&(k.renderDepth?f.z=k.renderDepth:(hb.copy(k.matrixWorld.getPosition()),fb.multiplyVector3(hb),f.z=hb.z))}for(this.sortObjects&&l.sort(g),l=a.__webglObjectsImmediate,d=0,e=l.length;e>d;d++)f=l[d],k=f.object,k.visible&&(o(k,b),k=f.object.material,k.transparent?(f.transparent=k,f.opaque=null):(f.opaque=k,f.transparent=null));a.overrideMaterial?(d=a.overrideMaterial,this.setBlending(d.blending,d.blendEquation,d.blendSrc,d.blendDst),this.setDepthTest(d.depthTest),this.setDepthWrite(d.depthWrite),p(d.polygonOffset,d.polygonOffsetFactor,d.polygonOffsetUnits),i(a.__webglObjects,!1,"",b,m,n,!0,d),j(a.__webglObjectsImmediate,"",b,m,n,!1,d)):(this.setBlending(THREE.NormalBlending),i(a.__webglObjects,!0,"opaque",b,m,n,!1),j(a.__webglObjectsImmediate,"opaque",b,m,n,!1),i(a.__webglObjects,!1,"transparent",b,m,n,!0),j(a.__webglObjectsImmediate,"transparent",b,m,n,!0)),h(this.renderPluginsPost,a,b),c&&c.generateMipmaps&&c.minFilter!==THREE.NearestFilter&&c.minFilter!==THREE.LinearFilter&&(c instanceof THREE.WebGLRenderTargetCube?(F.bindTexture(F.TEXTURE_CUBE_MAP,c.__webglTexture),F.generateMipmap(F.TEXTURE_CUBE_MAP),F.bindTexture(F.TEXTURE_CUBE_MAP,null)):(F.bindTexture(F.TEXTURE_2D,c.__webglTexture),F.generateMipmap(F.TEXTURE_2D),F.bindTexture(F.TEXTURE_2D,null))),this.setDepthTest(!0),this.setDepthWrite(!0)},this.renderImmediateObject=function(a,b,c,d,e){var f=n(a,b,c,d,e);L=-1,G.setObjectFaces(e),e.immediateRenderCallback?e.immediateRenderCallback(f,F,eb):e.render(function(a){G.renderBufferImmediate(a,f,d.shading)})},this.initWebGLObjects=function(a){for(a.__webglObjects||(a.__webglObjects=[],a.__webglObjectsImmediate=[],a.__webglSprites=[],a.__webglFlares=[]);a.__objectsAdded.length;){var g=a.__objectsAdded[0],h=a,i=void 0,j=void 0,n=void 0;if(!g.__webglInit)if(g.__webglInit=!0,g._modelViewMatrix=new THREE.Matrix4,g._normalMatrix=new THREE.Matrix3,g instanceof THREE.Mesh){if(j=g.geometry,j instanceof THREE.Geometry){if(void 0===j.geometryGroups){var o=j,p=void 0,q=void 0,r=void 0,s=void 0,t=void 0,u=void 0,v=void 0,w={},x=o.morphTargets.length,y=o.morphNormals.length;for(o.geometryGroups={},p=0,q=o.faces.length;q>p;p++)r=o.faces[p],s=r.materialIndex,u=void 0!==s?s:-1,void 0===w[u]&&(w[u]={hash:u,counter:0}),v=w[u].hash+"_"+w[u].counter,void 0===o.geometryGroups[v]&&(o.geometryGroups[v]={faces3:[],faces4:[],materialIndex:s,vertices:0,numMorphTargets:x,numMorphNormals:y}),t=r instanceof THREE.Face3?3:4,o.geometryGroups[v].vertices+t>65535&&(w[u].counter=w[u].counter+1,v=w[u].hash+"_"+w[u].counter,void 0===o.geometryGroups[v]&&(o.geometryGroups[v]={faces3:[],faces4:[],materialIndex:s,vertices:0,numMorphTargets:x,numMorphNormals:y})),r instanceof THREE.Face3?o.geometryGroups[v].faces3.push(p):o.geometryGroups[v].faces4.push(p),o.geometryGroups[v].vertices=o.geometryGroups[v].vertices+t;o.geometryGroupsList=[];var z=void 0;for(z in o.geometryGroups)o.geometryGroups[z].id=N++,o.geometryGroupsList.push(o.geometryGroups[z])}for(i in j.geometryGroups)if(n=j.geometryGroups[i],!n.__webglVertexBuffer){var A=n;A.__webglVertexBuffer=F.createBuffer(),A.__webglNormalBuffer=F.createBuffer(),A.__webglTangentBuffer=F.createBuffer(),A.__webglColorBuffer=F.createBuffer(),A.__webglUVBuffer=F.createBuffer(),A.__webglUV2Buffer=F.createBuffer(),A.__webglSkinVertexABuffer=F.createBuffer(),A.__webglSkinVertexBBuffer=F.createBuffer(),A.__webglSkinIndicesBuffer=F.createBuffer(),A.__webglSkinWeightsBuffer=F.createBuffer(),A.__webglFaceBuffer=F.createBuffer(),A.__webglLineBuffer=F.createBuffer();var B=void 0,C=void 0;if(A.numMorphTargets)for(A.__webglMorphTargetsBuffers=[],B=0,C=A.numMorphTargets;C>B;B++)A.__webglMorphTargetsBuffers.push(F.createBuffer());if(A.numMorphNormals)for(A.__webglMorphNormalsBuffers=[],B=0,C=A.numMorphNormals;C>B;B++)A.__webglMorphNormalsBuffers.push(F.createBuffer());G.info.memory.geometries++;var D=n,E=g,H=E.geometry,I=D.faces3,J=D.faces4,K=3*I.length+4*J.length,L=1*I.length+2*J.length,M=3*I.length+4*J.length,O=c(E,D),P=e(O),Q=d(O),R=O.vertexColors?O.vertexColors:!1;D.__vertexArray=new Float32Array(3*K),Q&&(D.__normalArray=new Float32Array(3*K)),H.hasTangents&&(D.__tangentArray=new Float32Array(4*K)),R&&(D.__colorArray=new Float32Array(3*K)),P&&((H.faceUvs.length>0||H.faceVertexUvs.length>0)&&(D.__uvArray=new Float32Array(2*K)),(H.faceUvs.length>1||H.faceVertexUvs.length>1)&&(D.__uv2Array=new Float32Array(2*K))),E.geometry.skinWeights.length&&E.geometry.skinIndices.length&&(D.__skinVertexAArray=new Float32Array(4*K),D.__skinVertexBArray=new Float32Array(4*K),D.__skinIndexArray=new Float32Array(4*K),D.__skinWeightArray=new Float32Array(4*K)),D.__faceArray=new Uint16Array(3*L),D.__lineArray=new Uint16Array(2*M);var S=void 0,T=void 0;if(D.numMorphTargets)for(D.__morphTargetsArrays=[],S=0,T=D.numMorphTargets;T>S;S++)D.__morphTargetsArrays.push(new Float32Array(3*K));if(D.numMorphNormals)for(D.__morphNormalsArrays=[],S=0,T=D.numMorphNormals;T>S;S++)D.__morphNormalsArrays.push(new Float32Array(3*K));if(D.__webglFaceCount=3*L,D.__webglLineCount=2*M,O.attributes){void 0===D.__webglCustomAttributesList&&(D.__webglCustomAttributesList=[]);var U=void 0;for(U in O.attributes){var V,W=O.attributes[U],X={};for(V in W)X[V]=W[V];if(!X.__webglInitialized||X.createUniqueBuffers){X.__webglInitialized=!0;var Y=1;"v2"===X.type?Y=2:"v3"===X.type?Y=3:"v4"===X.type?Y=4:"c"===X.type&&(Y=3),X.size=Y,X.array=new Float32Array(K*Y),X.buffer=F.createBuffer(),X.buffer.belongsToAttribute=U,W.needsUpdate=!0,X.__original=W}D.__webglCustomAttributesList.push(X)}}D.__inittedArrays=!0,j.verticesNeedUpdate=!0,j.morphTargetsNeedUpdate=!0,j.elementsNeedUpdate=!0,j.uvsNeedUpdate=!0,j.normalsNeedUpdate=!0,j.tangetsNeedUpdate=!0,j.colorsNeedUpdate=!0}}}else if(g instanceof THREE.Line){if(j=g.geometry,!j.__webglVertexBuffer){var Z=j;Z.__webglVertexBuffer=F.createBuffer(),Z.__webglColorBuffer=F.createBuffer(),G.info.memory.geometries++;var $=j,_=g,ab=$.vertices.length;$.__vertexArray=new Float32Array(3*ab),$.__colorArray=new Float32Array(3*ab),$.__webglLineCount=ab,b($,_),j.verticesNeedUpdate=!0,j.colorsNeedUpdate=!0}}else if(g instanceof THREE.ParticleSystem&&(j=g.geometry,!j.__webglVertexBuffer)){var bb=j;bb.__webglVertexBuffer=F.createBuffer(),bb.__webglColorBuffer=F.createBuffer(),G.info.geometries++;var cb=j,db=g,eb=cb.vertices.length;cb.__vertexArray=new Float32Array(3*eb),cb.__colorArray=new Float32Array(3*eb),cb.__sortArray=[],cb.__webglParticleCount=eb,b(cb,db),j.verticesNeedUpdate=!0,j.colorsNeedUpdate=!0}if(!g.__webglActive){if(g instanceof THREE.Mesh)if(j=g.geometry,j instanceof THREE.BufferGeometry)k(h.__webglObjects,j,g);else for(i in j.geometryGroups)n=j.geometryGroups[i],k(h.__webglObjects,n,g);else g instanceof THREE.Line&&(j=g.geometry,k(h.__webglObjects,j,g));g.__webglActive=!0}a.__objectsAdded.splice(0,1)}for(;a.__objectsRemoved.length;){var fb=a.__objectsRemoved[0];if(fb instanceof THREE.Mesh||fb instanceof THREE.Line)for(var gb=a.__webglObjects,hb=fb,ib=gb.length-1;ib>=0;ib--)gb[ib].object===hb&&gb.splice(ib,1);fb.__webglActive=!1,a.__objectsRemoved.splice(0,1)}for(var jb=0,kb=a.__webglObjects.length;kb>jb;jb++){var lb=a.__webglObjects[jb].object,mb=lb.geometry,nb=void 0,ob=void 0,pb=void 0;if(lb instanceof THREE.Mesh)if(mb instanceof THREE.BufferGeometry)mb.verticesNeedUpdate=!1,mb.elementsNeedUpdate=!1,mb.uvsNeedUpdate=!1,mb.normalsNeedUpdate=!1,mb.colorsNeedUpdate=!1;else{for(var qb=0,rb=mb.geometryGroupsList.length;rb>qb;qb++)if(nb=mb.geometryGroupsList[qb],pb=c(lb,nb),ob=pb.attributes&&l(pb),mb.verticesNeedUpdate||mb.morphTargetsNeedUpdate||mb.elementsNeedUpdate||mb.uvsNeedUpdate||mb.normalsNeedUpdate||mb.colorsNeedUpdate||mb.tangetsNeedUpdate||ob){var sb=nb,tb=lb,ub=F.DYNAMIC_DRAW,vb=!mb.dynamic,wb=pb;if(sb.__inittedArrays){var xb=d(wb),yb=wb.vertexColors?wb.vertexColors:!1,zb=e(wb),Ab=xb===THREE.SmoothShading,Bb=void 0,Cb=void 0,Db=void 0,Eb=void 0,Fb=void 0,Gb=void 0,Hb=void 0,Ib=void 0,Jb=void 0,Kb=void 0,Lb=void 0,Mb=void 0,Nb=void 0,Ob=void 0,Pb=void 0,Qb=void 0,Rb=void 0,Sb=void 0,Tb=void 0,Ub=void 0,Vb=void 0,Wb=void 0,Xb=void 0,Yb=void 0,Zb=void 0,$b=void 0,_b=void 0,ac=void 0,bc=void 0,cc=void 0,dc=void 0,ec=void 0,fc=void 0,gc=void 0,hc=void 0,ic=void 0,jc=void 0,kc=void 0,lc=void 0,mc=void 0,nc=void 0,oc=void 0,pc=void 0,qc=void 0,rc=void 0,sc=void 0,tc=void 0,uc=void 0,vc=void 0,wc=void 0,xc=void 0,yc=void 0,zc=void 0,Ac=void 0,Bc=0,Cc=0,Dc=0,Ec=0,Fc=0,Gc=0,Hc=0,Ic=0,Jc=0,Kc=0,Lc=0,Mc=0,Nc=void 0,Oc=sb.__vertexArray,Pc=sb.__uvArray,Qc=sb.__uv2Array,Rc=sb.__normalArray,Sc=sb.__tangentArray,Tc=sb.__colorArray,Uc=sb.__skinVertexAArray,Vc=sb.__skinVertexBArray,Wc=sb.__skinIndexArray,Xc=sb.__skinWeightArray,Yc=sb.__morphTargetsArrays,Zc=sb.__morphNormalsArrays,$c=sb.__webglCustomAttributesList,_c=void 0,ad=sb.__faceArray,bd=sb.__lineArray,cd=tb.geometry,dd=cd.elementsNeedUpdate,ed=cd.uvsNeedUpdate,fd=cd.normalsNeedUpdate,gd=cd.tangetsNeedUpdate,hd=cd.colorsNeedUpdate,id=cd.morphTargetsNeedUpdate,jd=cd.vertices,kd=sb.faces3,ld=sb.faces4,md=cd.faces,nd=cd.faceVertexUvs[0],od=cd.faceVertexUvs[1],pd=cd.skinVerticesA,qd=cd.skinVerticesB,rd=cd.skinIndices,sd=cd.skinWeights,td=cd.morphTargets,ud=cd.morphNormals;if(cd.verticesNeedUpdate){for(Bb=0,Cb=kd.length;Cb>Bb;Bb++)Eb=md[kd[Bb]],Mb=jd[Eb.a],Nb=jd[Eb.b],Ob=jd[Eb.c],Oc[Cc]=Mb.x,Oc[Cc+1]=Mb.y,Oc[Cc+2]=Mb.z,Oc[Cc+3]=Nb.x,Oc[Cc+4]=Nb.y,Oc[Cc+5]=Nb.z,Oc[Cc+6]=Ob.x,Oc[Cc+7]=Ob.y,Oc[Cc+8]=Ob.z,Cc+=9;for(Bb=0,Cb=ld.length;Cb>Bb;Bb++)Eb=md[ld[Bb]],Mb=jd[Eb.a],Nb=jd[Eb.b],Ob=jd[Eb.c],Pb=jd[Eb.d],Oc[Cc]=Mb.x,Oc[Cc+1]=Mb.y,Oc[Cc+2]=Mb.z,Oc[Cc+3]=Nb.x,Oc[Cc+4]=Nb.y,Oc[Cc+5]=Nb.z,Oc[Cc+6]=Ob.x,Oc[Cc+7]=Ob.y,Oc[Cc+8]=Ob.z,Oc[Cc+9]=Pb.x,Oc[Cc+10]=Pb.y,Oc[Cc+11]=Pb.z,Cc+=12;F.bindBuffer(F.ARRAY_BUFFER,sb.__webglVertexBuffer),F.bufferData(F.ARRAY_BUFFER,Oc,ub)}if(id)for(vc=0,wc=td.length;wc>vc;vc++){for(Bb=Lc=0,Cb=kd.length;Cb>Bb;Bb++)zc=kd[Bb],Eb=md[zc],Mb=td[vc].vertices[Eb.a],Nb=td[vc].vertices[Eb.b],Ob=td[vc].vertices[Eb.c],xc=Yc[vc],xc[Lc]=Mb.x,xc[Lc+1]=Mb.y,xc[Lc+2]=Mb.z,xc[Lc+3]=Nb.x,xc[Lc+4]=Nb.y,xc[Lc+5]=Nb.z,xc[Lc+6]=Ob.x,xc[Lc+7]=Ob.y,xc[Lc+8]=Ob.z,wb.morphNormals&&(Ab?(Ac=ud[vc].vertexNormals[zc],Ub=Ac.a,Vb=Ac.b,Wb=Ac.c):Wb=Vb=Ub=ud[vc].faceNormals[zc],yc=Zc[vc],yc[Lc]=Ub.x,yc[Lc+1]=Ub.y,yc[Lc+2]=Ub.z,yc[Lc+3]=Vb.x,yc[Lc+4]=Vb.y,yc[Lc+5]=Vb.z,yc[Lc+6]=Wb.x,yc[Lc+7]=Wb.y,yc[Lc+8]=Wb.z),Lc+=9;for(Bb=0,Cb=ld.length;Cb>Bb;Bb++)zc=ld[Bb],Eb=md[zc],Mb=td[vc].vertices[Eb.a],Nb=td[vc].vertices[Eb.b],Ob=td[vc].vertices[Eb.c],Pb=td[vc].vertices[Eb.d],xc=Yc[vc],xc[Lc]=Mb.x,xc[Lc+1]=Mb.y,xc[Lc+2]=Mb.z,xc[Lc+3]=Nb.x,xc[Lc+4]=Nb.y,xc[Lc+5]=Nb.z,xc[Lc+6]=Ob.x,xc[Lc+7]=Ob.y,xc[Lc+8]=Ob.z,xc[Lc+9]=Pb.x,xc[Lc+10]=Pb.y,xc[Lc+11]=Pb.z,wb.morphNormals&&(Ab?(Ac=ud[vc].vertexNormals[zc],Ub=Ac.a,Vb=Ac.b,Wb=Ac.c,Xb=Ac.d):Xb=Wb=Vb=Ub=ud[vc].faceNormals[zc],yc=Zc[vc],yc[Lc]=Ub.x,yc[Lc+1]=Ub.y,yc[Lc+2]=Ub.z,yc[Lc+3]=Vb.x,yc[Lc+4]=Vb.y,yc[Lc+5]=Vb.z,yc[Lc+6]=Wb.x,yc[Lc+7]=Wb.y,yc[Lc+8]=Wb.z,yc[Lc+9]=Xb.x,yc[Lc+10]=Xb.y,yc[Lc+11]=Xb.z),Lc+=12;F.bindBuffer(F.ARRAY_BUFFER,sb.__webglMorphTargetsBuffers[vc]),F.bufferData(F.ARRAY_BUFFER,Yc[vc],ub),wb.morphNormals&&(F.bindBuffer(F.ARRAY_BUFFER,sb.__webglMorphNormalsBuffers[vc]),F.bufferData(F.ARRAY_BUFFER,Zc[vc],ub))}if(sd.length){for(Bb=0,Cb=kd.length;Cb>Bb;Bb++)Eb=md[kd[Bb]],ac=sd[Eb.a],bc=sd[Eb.b],cc=sd[Eb.c],Xc[Kc]=ac.x,Xc[Kc+1]=ac.y,Xc[Kc+2]=ac.z,Xc[Kc+3]=ac.w,Xc[Kc+4]=bc.x,Xc[Kc+5]=bc.y,Xc[Kc+6]=bc.z,Xc[Kc+7]=bc.w,Xc[Kc+8]=cc.x,Xc[Kc+9]=cc.y,Xc[Kc+10]=cc.z,Xc[Kc+11]=cc.w,ec=rd[Eb.a],fc=rd[Eb.b],gc=rd[Eb.c],Wc[Kc]=ec.x,Wc[Kc+1]=ec.y,Wc[Kc+2]=ec.z,Wc[Kc+3]=ec.w,Wc[Kc+4]=fc.x,Wc[Kc+5]=fc.y,Wc[Kc+6]=fc.z,Wc[Kc+7]=fc.w,Wc[Kc+8]=gc.x,Wc[Kc+9]=gc.y,Wc[Kc+10]=gc.z,Wc[Kc+11]=gc.w,ic=pd[Eb.a],jc=pd[Eb.b],kc=pd[Eb.c],Uc[Kc]=ic.x,Uc[Kc+1]=ic.y,Uc[Kc+2]=ic.z,Uc[Kc+3]=1,Uc[Kc+4]=jc.x,Uc[Kc+5]=jc.y,Uc[Kc+6]=jc.z,Uc[Kc+7]=1,Uc[Kc+8]=kc.x,Uc[Kc+9]=kc.y,Uc[Kc+10]=kc.z,Uc[Kc+11]=1,mc=qd[Eb.a],nc=qd[Eb.b],oc=qd[Eb.c],Vc[Kc]=mc.x,Vc[Kc+1]=mc.y,Vc[Kc+2]=mc.z,Vc[Kc+3]=1,Vc[Kc+4]=nc.x,Vc[Kc+5]=nc.y,Vc[Kc+6]=nc.z,Vc[Kc+7]=1,Vc[Kc+8]=oc.x,Vc[Kc+9]=oc.y,Vc[Kc+10]=oc.z,Vc[Kc+11]=1,Kc+=12;for(Bb=0,Cb=ld.length;Cb>Bb;Bb++)Eb=md[ld[Bb]],ac=sd[Eb.a],bc=sd[Eb.b],cc=sd[Eb.c],dc=sd[Eb.d],Xc[Kc]=ac.x,Xc[Kc+1]=ac.y,Xc[Kc+2]=ac.z,Xc[Kc+3]=ac.w,Xc[Kc+4]=bc.x,Xc[Kc+5]=bc.y,Xc[Kc+6]=bc.z,Xc[Kc+7]=bc.w,Xc[Kc+8]=cc.x,Xc[Kc+9]=cc.y,Xc[Kc+10]=cc.z,Xc[Kc+11]=cc.w,Xc[Kc+12]=dc.x,Xc[Kc+13]=dc.y,Xc[Kc+14]=dc.z,Xc[Kc+15]=dc.w,ec=rd[Eb.a],fc=rd[Eb.b],gc=rd[Eb.c],hc=rd[Eb.d],Wc[Kc]=ec.x,Wc[Kc+1]=ec.y,Wc[Kc+2]=ec.z,Wc[Kc+3]=ec.w,Wc[Kc+4]=fc.x,Wc[Kc+5]=fc.y,Wc[Kc+6]=fc.z,Wc[Kc+7]=fc.w,Wc[Kc+8]=gc.x,Wc[Kc+9]=gc.y,Wc[Kc+10]=gc.z,Wc[Kc+11]=gc.w,Wc[Kc+12]=hc.x,Wc[Kc+13]=hc.y,Wc[Kc+14]=hc.z,Wc[Kc+15]=hc.w,ic=pd[Eb.a],jc=pd[Eb.b],kc=pd[Eb.c],lc=pd[Eb.d],Uc[Kc]=ic.x,Uc[Kc+1]=ic.y,Uc[Kc+2]=ic.z,Uc[Kc+3]=1,Uc[Kc+4]=jc.x,Uc[Kc+5]=jc.y,Uc[Kc+6]=jc.z,Uc[Kc+7]=1,Uc[Kc+8]=kc.x,Uc[Kc+9]=kc.y,Uc[Kc+10]=kc.z,Uc[Kc+11]=1,Uc[Kc+12]=lc.x,Uc[Kc+13]=lc.y,Uc[Kc+14]=lc.z,Uc[Kc+15]=1,mc=qd[Eb.a],nc=qd[Eb.b],oc=qd[Eb.c],pc=qd[Eb.d],Vc[Kc]=mc.x,Vc[Kc+1]=mc.y,Vc[Kc+2]=mc.z,Vc[Kc+3]=1,Vc[Kc+4]=nc.x,Vc[Kc+5]=nc.y,Vc[Kc+6]=nc.z,Vc[Kc+7]=1,Vc[Kc+8]=oc.x,Vc[Kc+9]=oc.y,Vc[Kc+10]=oc.z,Vc[Kc+11]=1,Vc[Kc+12]=pc.x,Vc[Kc+13]=pc.y,Vc[Kc+14]=pc.z,Vc[Kc+15]=1,Kc+=16;Kc>0&&(F.bindBuffer(F.ARRAY_BUFFER,sb.__webglSkinVertexABuffer),F.bufferData(F.ARRAY_BUFFER,Uc,ub),F.bindBuffer(F.ARRAY_BUFFER,sb.__webglSkinVertexBBuffer),F.bufferData(F.ARRAY_BUFFER,Vc,ub),F.bindBuffer(F.ARRAY_BUFFER,sb.__webglSkinIndicesBuffer),F.bufferData(F.ARRAY_BUFFER,Wc,ub),F.bindBuffer(F.ARRAY_BUFFER,sb.__webglSkinWeightsBuffer),F.bufferData(F.ARRAY_BUFFER,Xc,ub))}if(hd&&yb){for(Bb=0,Cb=kd.length;Cb>Bb;Bb++)Eb=md[kd[Bb]],Hb=Eb.vertexColors,Ib=Eb.color,3===Hb.length&&yb===THREE.VertexColors?(Yb=Hb[0],Zb=Hb[1],$b=Hb[2]):$b=Zb=Yb=Ib,Tc[Jc]=Yb.r,Tc[Jc+1]=Yb.g,Tc[Jc+2]=Yb.b,Tc[Jc+3]=Zb.r,Tc[Jc+4]=Zb.g,Tc[Jc+5]=Zb.b,Tc[Jc+6]=$b.r,Tc[Jc+7]=$b.g,Tc[Jc+8]=$b.b,Jc+=9;for(Bb=0,Cb=ld.length;Cb>Bb;Bb++)Eb=md[ld[Bb]],Hb=Eb.vertexColors,Ib=Eb.color,4===Hb.length&&yb===THREE.VertexColors?(Yb=Hb[0],Zb=Hb[1],$b=Hb[2],_b=Hb[3]):_b=$b=Zb=Yb=Ib,Tc[Jc]=Yb.r,Tc[Jc+1]=Yb.g,Tc[Jc+2]=Yb.b,Tc[Jc+3]=Zb.r,Tc[Jc+4]=Zb.g,Tc[Jc+5]=Zb.b,Tc[Jc+6]=$b.r,Tc[Jc+7]=$b.g,Tc[Jc+8]=$b.b,Tc[Jc+9]=_b.r,Tc[Jc+10]=_b.g,Tc[Jc+11]=_b.b,Jc+=12;Jc>0&&(F.bindBuffer(F.ARRAY_BUFFER,sb.__webglColorBuffer),F.bufferData(F.ARRAY_BUFFER,Tc,ub))}if(gd&&cd.hasTangents){for(Bb=0,Cb=kd.length;Cb>Bb;Bb++)Eb=md[kd[Bb]],Jb=Eb.vertexTangents,Qb=Jb[0],Rb=Jb[1],Sb=Jb[2],Sc[Hc]=Qb.x,Sc[Hc+1]=Qb.y,Sc[Hc+2]=Qb.z,Sc[Hc+3]=Qb.w,Sc[Hc+4]=Rb.x,Sc[Hc+5]=Rb.y,Sc[Hc+6]=Rb.z,Sc[Hc+7]=Rb.w,Sc[Hc+8]=Sb.x,Sc[Hc+9]=Sb.y,Sc[Hc+10]=Sb.z,Sc[Hc+11]=Sb.w,Hc+=12;for(Bb=0,Cb=ld.length;Cb>Bb;Bb++)Eb=md[ld[Bb]],Jb=Eb.vertexTangents,Qb=Jb[0],Rb=Jb[1],Sb=Jb[2],Tb=Jb[3],Sc[Hc]=Qb.x,Sc[Hc+1]=Qb.y,Sc[Hc+2]=Qb.z,Sc[Hc+3]=Qb.w,Sc[Hc+4]=Rb.x,Sc[Hc+5]=Rb.y,Sc[Hc+6]=Rb.z,Sc[Hc+7]=Rb.w,Sc[Hc+8]=Sb.x,Sc[Hc+9]=Sb.y,Sc[Hc+10]=Sb.z,Sc[Hc+11]=Sb.w,Sc[Hc+12]=Tb.x,Sc[Hc+13]=Tb.y,Sc[Hc+14]=Tb.z,Sc[Hc+15]=Tb.w,Hc+=16;F.bindBuffer(F.ARRAY_BUFFER,sb.__webglTangentBuffer),F.bufferData(F.ARRAY_BUFFER,Sc,ub)}if(fd&&xb){for(Bb=0,Cb=kd.length;Cb>Bb;Bb++)if(Eb=md[kd[Bb]],Fb=Eb.vertexNormals,Gb=Eb.normal,3===Fb.length&&Ab)for(qc=0;3>qc;qc++)sc=Fb[qc],Rc[Gc]=sc.x,Rc[Gc+1]=sc.y,Rc[Gc+2]=sc.z,Gc+=3;else for(qc=0;3>qc;qc++)Rc[Gc]=Gb.x,Rc[Gc+1]=Gb.y,Rc[Gc+2]=Gb.z,Gc+=3;for(Bb=0,Cb=ld.length;Cb>Bb;Bb++)if(Eb=md[ld[Bb]],Fb=Eb.vertexNormals,Gb=Eb.normal,4===Fb.length&&Ab)for(qc=0;4>qc;qc++)sc=Fb[qc],Rc[Gc]=sc.x,Rc[Gc+1]=sc.y,Rc[Gc+2]=sc.z,Gc+=3;else for(qc=0;4>qc;qc++)Rc[Gc]=Gb.x,Rc[Gc+1]=Gb.y,Rc[Gc+2]=Gb.z,Gc+=3;F.bindBuffer(F.ARRAY_BUFFER,sb.__webglNormalBuffer),F.bufferData(F.ARRAY_BUFFER,Rc,ub)}if(ed&&nd&&zb){for(Bb=0,Cb=kd.length;Cb>Bb;Bb++)if(Db=kd[Bb],Eb=md[Db],Kb=nd[Db],void 0!==Kb)for(qc=0;3>qc;qc++)tc=Kb[qc],Pc[Dc]=tc.u,Pc[Dc+1]=tc.v,Dc+=2;for(Bb=0,Cb=ld.length;Cb>Bb;Bb++)if(Db=ld[Bb],Eb=md[Db],Kb=nd[Db],void 0!==Kb)for(qc=0;4>qc;qc++)tc=Kb[qc],Pc[Dc]=tc.u,Pc[Dc+1]=tc.v,Dc+=2;Dc>0&&(F.bindBuffer(F.ARRAY_BUFFER,sb.__webglUVBuffer),F.bufferData(F.ARRAY_BUFFER,Pc,ub))}if(ed&&od&&zb){for(Bb=0,Cb=kd.length;Cb>Bb;Bb++)if(Db=kd[Bb],Eb=md[Db],Lb=od[Db],void 0!==Lb)for(qc=0;3>qc;qc++)uc=Lb[qc],Qc[Ec]=uc.u,Qc[Ec+1]=uc.v,Ec+=2;for(Bb=0,Cb=ld.length;Cb>Bb;Bb++)if(Db=ld[Bb],Eb=md[Db],Lb=od[Db],void 0!==Lb)for(qc=0;4>qc;qc++)uc=Lb[qc],Qc[Ec]=uc.u,Qc[Ec+1]=uc.v,Ec+=2;Ec>0&&(F.bindBuffer(F.ARRAY_BUFFER,sb.__webglUV2Buffer),F.bufferData(F.ARRAY_BUFFER,Qc,ub))}if(dd){for(Bb=0,Cb=kd.length;Cb>Bb;Bb++)Eb=md[kd[Bb]],ad[Fc]=Bc,ad[Fc+1]=Bc+1,ad[Fc+2]=Bc+2,Fc+=3,bd[Ic]=Bc,bd[Ic+1]=Bc+1,bd[Ic+2]=Bc,bd[Ic+3]=Bc+2,bd[Ic+4]=Bc+1,bd[Ic+5]=Bc+2,Ic+=6,Bc+=3;for(Bb=0,Cb=ld.length;Cb>Bb;Bb++)Eb=md[ld[Bb]],ad[Fc]=Bc,ad[Fc+1]=Bc+1,ad[Fc+2]=Bc+3,ad[Fc+3]=Bc+1,ad[Fc+4]=Bc+2,ad[Fc+5]=Bc+3,Fc+=6,bd[Ic]=Bc,bd[Ic+1]=Bc+1,bd[Ic+2]=Bc,bd[Ic+3]=Bc+3,bd[Ic+4]=Bc+1,bd[Ic+5]=Bc+2,bd[Ic+6]=Bc+2,bd[Ic+7]=Bc+3,Ic+=8,Bc+=4;F.bindBuffer(F.ELEMENT_ARRAY_BUFFER,sb.__webglFaceBuffer),F.bufferData(F.ELEMENT_ARRAY_BUFFER,ad,ub),F.bindBuffer(F.ELEMENT_ARRAY_BUFFER,sb.__webglLineBuffer),F.bufferData(F.ELEMENT_ARRAY_BUFFER,bd,ub)}if($c)for(qc=0,rc=$c.length;rc>qc;qc++)if(_c=$c[qc],_c.__original.needsUpdate){if(Mc=0,1===_c.size){if(void 0===_c.boundTo||"vertices"===_c.boundTo){for(Bb=0,Cb=kd.length;Cb>Bb;Bb++)Eb=md[kd[Bb]],_c.array[Mc]=_c.value[Eb.a],_c.array[Mc+1]=_c.value[Eb.b],_c.array[Mc+2]=_c.value[Eb.c],Mc+=3;for(Bb=0,Cb=ld.length;Cb>Bb;Bb++)Eb=md[ld[Bb]],_c.array[Mc]=_c.value[Eb.a],_c.array[Mc+1]=_c.value[Eb.b],_c.array[Mc+2]=_c.value[Eb.c],_c.array[Mc+3]=_c.value[Eb.d],Mc+=4}else if("faces"===_c.boundTo){for(Bb=0,Cb=kd.length;Cb>Bb;Bb++)Nc=_c.value[kd[Bb]],_c.array[Mc]=Nc,_c.array[Mc+1]=Nc,_c.array[Mc+2]=Nc,Mc+=3;for(Bb=0,Cb=ld.length;Cb>Bb;Bb++)Nc=_c.value[ld[Bb]],_c.array[Mc]=Nc,_c.array[Mc+1]=Nc,_c.array[Mc+2]=Nc,_c.array[Mc+3]=Nc,Mc+=4}}else if(2===_c.size){if(void 0===_c.boundTo||"vertices"===_c.boundTo){for(Bb=0,Cb=kd.length;Cb>Bb;Bb++)Eb=md[kd[Bb]],Mb=_c.value[Eb.a],Nb=_c.value[Eb.b],Ob=_c.value[Eb.c],_c.array[Mc]=Mb.x,_c.array[Mc+1]=Mb.y,_c.array[Mc+2]=Nb.x,_c.array[Mc+3]=Nb.y,_c.array[Mc+4]=Ob.x,_c.array[Mc+5]=Ob.y,Mc+=6;for(Bb=0,Cb=ld.length;Cb>Bb;Bb++)Eb=md[ld[Bb]],Mb=_c.value[Eb.a],Nb=_c.value[Eb.b],Ob=_c.value[Eb.c],Pb=_c.value[Eb.d],_c.array[Mc]=Mb.x,_c.array[Mc+1]=Mb.y,_c.array[Mc+2]=Nb.x,_c.array[Mc+3]=Nb.y,_c.array[Mc+4]=Ob.x,_c.array[Mc+5]=Ob.y,_c.array[Mc+6]=Pb.x,_c.array[Mc+7]=Pb.y,Mc+=8}else if("faces"===_c.boundTo){for(Bb=0,Cb=kd.length;Cb>Bb;Bb++)Ob=Nb=Mb=Nc=_c.value[kd[Bb]],_c.array[Mc]=Mb.x,_c.array[Mc+1]=Mb.y,_c.array[Mc+2]=Nb.x,_c.array[Mc+3]=Nb.y,_c.array[Mc+4]=Ob.x,_c.array[Mc+5]=Ob.y,Mc+=6;for(Bb=0,Cb=ld.length;Cb>Bb;Bb++)Pb=Ob=Nb=Mb=Nc=_c.value[ld[Bb]],_c.array[Mc]=Mb.x,_c.array[Mc+1]=Mb.y,_c.array[Mc+2]=Nb.x,_c.array[Mc+3]=Nb.y,_c.array[Mc+4]=Ob.x,_c.array[Mc+5]=Ob.y,_c.array[Mc+6]=Pb.x,_c.array[Mc+7]=Pb.y,Mc+=8}}else if(3===_c.size){var vd;if(vd="c"===_c.type?["r","g","b"]:["x","y","z"],void 0===_c.boundTo||"vertices"===_c.boundTo){for(Bb=0,Cb=kd.length;Cb>Bb;Bb++)Eb=md[kd[Bb]],Mb=_c.value[Eb.a],Nb=_c.value[Eb.b],Ob=_c.value[Eb.c],_c.array[Mc]=Mb[vd[0]],_c.array[Mc+1]=Mb[vd[1]],_c.array[Mc+2]=Mb[vd[2]],_c.array[Mc+3]=Nb[vd[0]],_c.array[Mc+4]=Nb[vd[1]],_c.array[Mc+5]=Nb[vd[2]],_c.array[Mc+6]=Ob[vd[0]],_c.array[Mc+7]=Ob[vd[1]],_c.array[Mc+8]=Ob[vd[2]],Mc+=9;for(Bb=0,Cb=ld.length;Cb>Bb;Bb++)Eb=md[ld[Bb]],Mb=_c.value[Eb.a],Nb=_c.value[Eb.b],Ob=_c.value[Eb.c],Pb=_c.value[Eb.d],_c.array[Mc]=Mb[vd[0]],_c.array[Mc+1]=Mb[vd[1]],_c.array[Mc+2]=Mb[vd[2]],_c.array[Mc+3]=Nb[vd[0]],_c.array[Mc+4]=Nb[vd[1]],_c.array[Mc+5]=Nb[vd[2]],_c.array[Mc+6]=Ob[vd[0]],_c.array[Mc+7]=Ob[vd[1]],_c.array[Mc+8]=Ob[vd[2]],_c.array[Mc+9]=Pb[vd[0]],_c.array[Mc+10]=Pb[vd[1]],_c.array[Mc+11]=Pb[vd[2]],Mc+=12}else if("faces"===_c.boundTo){for(Bb=0,Cb=kd.length;Cb>Bb;Bb++)Ob=Nb=Mb=Nc=_c.value[kd[Bb]],_c.array[Mc]=Mb[vd[0]],_c.array[Mc+1]=Mb[vd[1]],_c.array[Mc+2]=Mb[vd[2]],_c.array[Mc+3]=Nb[vd[0]],_c.array[Mc+4]=Nb[vd[1]],_c.array[Mc+5]=Nb[vd[2]],_c.array[Mc+6]=Ob[vd[0]],_c.array[Mc+7]=Ob[vd[1]],_c.array[Mc+8]=Ob[vd[2]],Mc+=9;for(Bb=0,Cb=ld.length;Cb>Bb;Bb++)Pb=Ob=Nb=Mb=Nc=_c.value[ld[Bb]],_c.array[Mc]=Mb[vd[0]],_c.array[Mc+1]=Mb[vd[1]],_c.array[Mc+2]=Mb[vd[2]],_c.array[Mc+3]=Nb[vd[0]],_c.array[Mc+4]=Nb[vd[1]],_c.array[Mc+5]=Nb[vd[2]],_c.array[Mc+6]=Ob[vd[0]],_c.array[Mc+7]=Ob[vd[1]],_c.array[Mc+8]=Ob[vd[2]],_c.array[Mc+9]=Pb[vd[0]],_c.array[Mc+10]=Pb[vd[1]],_c.array[Mc+11]=Pb[vd[2]],Mc+=12}}else if(4===_c.size)if(void 0===_c.boundTo||"vertices"===_c.boundTo){for(Bb=0,Cb=kd.length;Cb>Bb;Bb++)Eb=md[kd[Bb]],Mb=_c.value[Eb.a],Nb=_c.value[Eb.b],Ob=_c.value[Eb.c],_c.array[Mc]=Mb.x,_c.array[Mc+1]=Mb.y,_c.array[Mc+2]=Mb.z,_c.array[Mc+3]=Mb.w,_c.array[Mc+4]=Nb.x,_c.array[Mc+5]=Nb.y,_c.array[Mc+6]=Nb.z,_c.array[Mc+7]=Nb.w,_c.array[Mc+8]=Ob.x,_c.array[Mc+9]=Ob.y,_c.array[Mc+10]=Ob.z,_c.array[Mc+11]=Ob.w,Mc+=12;for(Bb=0,Cb=ld.length;Cb>Bb;Bb++)Eb=md[ld[Bb]],Mb=_c.value[Eb.a],Nb=_c.value[Eb.b],Ob=_c.value[Eb.c],Pb=_c.value[Eb.d],_c.array[Mc]=Mb.x,_c.array[Mc+1]=Mb.y,_c.array[Mc+2]=Mb.z,_c.array[Mc+3]=Mb.w,_c.array[Mc+4]=Nb.x,_c.array[Mc+5]=Nb.y,_c.array[Mc+6]=Nb.z,_c.array[Mc+7]=Nb.w,_c.array[Mc+8]=Ob.x,_c.array[Mc+9]=Ob.y,_c.array[Mc+10]=Ob.z,_c.array[Mc+11]=Ob.w,_c.array[Mc+12]=Pb.x,_c.array[Mc+13]=Pb.y,_c.array[Mc+14]=Pb.z,_c.array[Mc+15]=Pb.w,Mc+=16}else if("faces"===_c.boundTo){for(Bb=0,Cb=kd.length;Cb>Bb;Bb++)Ob=Nb=Mb=Nc=_c.value[kd[Bb]],_c.array[Mc]=Mb.x,_c.array[Mc+1]=Mb.y,_c.array[Mc+2]=Mb.z,_c.array[Mc+3]=Mb.w,_c.array[Mc+4]=Nb.x,_c.array[Mc+5]=Nb.y,_c.array[Mc+6]=Nb.z,_c.array[Mc+7]=Nb.w,_c.array[Mc+8]=Ob.x,_c.array[Mc+9]=Ob.y,_c.array[Mc+10]=Ob.z,_c.array[Mc+11]=Ob.w,Mc+=12;for(Bb=0,Cb=ld.length;Cb>Bb;Bb++)Pb=Ob=Nb=Mb=Nc=_c.value[ld[Bb]],_c.array[Mc]=Mb.x,_c.array[Mc+1]=Mb.y,_c.array[Mc+2]=Mb.z,_c.array[Mc+3]=Mb.w,_c.array[Mc+4]=Nb.x,_c.array[Mc+5]=Nb.y,_c.array[Mc+6]=Nb.z,_c.array[Mc+7]=Nb.w,_c.array[Mc+8]=Ob.x,_c.array[Mc+9]=Ob.y,_c.array[Mc+10]=Ob.z,_c.array[Mc+11]=Ob.w,_c.array[Mc+12]=Pb.x,_c.array[Mc+13]=Pb.y,_c.array[Mc+14]=Pb.z,_c.array[Mc+15]=Pb.w,Mc+=16}F.bindBuffer(F.ARRAY_BUFFER,_c.buffer),F.bufferData(F.ARRAY_BUFFER,_c.array,ub)}vb&&(delete sb.__inittedArrays,delete sb.__colorArray,delete sb.__normalArray,delete sb.__tangentArray,delete sb.__uvArray,delete sb.__uv2Array,delete sb.__faceArray,delete sb.__vertexArray,delete sb.__lineArray,delete sb.__skinVertexAArray,delete sb.__skinVertexBArray,delete sb.__skinIndexArray,delete sb.__skinWeightArray)}}mb.verticesNeedUpdate=!1,mb.morphTargetsNeedUpdate=!1,mb.elementsNeedUpdate=!1,mb.uvsNeedUpdate=!1,mb.normalsNeedUpdate=!1,mb.colorsNeedUpdate=!1,mb.tangetsNeedUpdate=!1,pb.attributes&&m(pb)}else if(lb instanceof THREE.Line){if(pb=c(lb,nb),ob=pb.attributes&&l(pb),mb.verticesNeedUpdate||mb.colorsNeedUpdate||ob){var wd=mb,xd=F.DYNAMIC_DRAW,yd=void 0,zd=void 0,Ad=void 0,Bd=void 0,Cd=void 0,Dd=wd.vertices,Ed=wd.colors,Fd=Dd.length,Gd=Ed.length,Hd=wd.__vertexArray,Id=wd.__colorArray,Jd=wd.colorsNeedUpdate,Kd=wd.__webglCustomAttributesList,Ld=void 0,Md=void 0,Nd=void 0,Od=void 0,Pd=void 0,Qd=void 0;if(wd.verticesNeedUpdate){for(yd=0;Fd>yd;yd++)Ad=Dd[yd],Bd=3*yd,Hd[Bd]=Ad.x,Hd[Bd+1]=Ad.y,Hd[Bd+2]=Ad.z;F.bindBuffer(F.ARRAY_BUFFER,wd.__webglVertexBuffer),F.bufferData(F.ARRAY_BUFFER,Hd,xd)}if(Jd){for(zd=0;Gd>zd;zd++)Cd=Ed[zd],Bd=3*zd,Id[Bd]=Cd.r,Id[Bd+1]=Cd.g,Id[Bd+2]=Cd.b;F.bindBuffer(F.ARRAY_BUFFER,wd.__webglColorBuffer),F.bufferData(F.ARRAY_BUFFER,Id,xd)}if(Kd)for(Ld=0,Md=Kd.length;Md>Ld;Ld++)if(Qd=Kd[Ld],Qd.needsUpdate&&(void 0===Qd.boundTo||"vertices"===Qd.boundTo)){if(Bd=0,Od=Qd.value.length,1===Qd.size)for(Nd=0;Od>Nd;Nd++)Qd.array[Nd]=Qd.value[Nd];else if(2===Qd.size)for(Nd=0;Od>Nd;Nd++)Pd=Qd.value[Nd],Qd.array[Bd]=Pd.x,Qd.array[Bd+1]=Pd.y,Bd+=2;else if(3===Qd.size)if("c"===Qd.type)for(Nd=0;Od>Nd;Nd++)Pd=Qd.value[Nd],Qd.array[Bd]=Pd.r,Qd.array[Bd+1]=Pd.g,Qd.array[Bd+2]=Pd.b,Bd+=3;else for(Nd=0;Od>Nd;Nd++)Pd=Qd.value[Nd],Qd.array[Bd]=Pd.x,Qd.array[Bd+1]=Pd.y,Qd.array[Bd+2]=Pd.z,Bd+=3;else if(4===Qd.size)for(Nd=0;Od>Nd;Nd++)Pd=Qd.value[Nd],Qd.array[Bd]=Pd.x,Qd.array[Bd+1]=Pd.y,Qd.array[Bd+2]=Pd.z,Qd.array[Bd+3]=Pd.w,Bd+=4;F.bindBuffer(F.ARRAY_BUFFER,Qd.buffer),F.bufferData(F.ARRAY_BUFFER,Qd.array,xd)}}mb.verticesNeedUpdate=!1,mb.colorsNeedUpdate=!1,pb.attributes&&m(pb)}else lb instanceof THREE.ParticleSystem&&(pb=c(lb,nb),ob=pb.attributes&&l(pb),(mb.verticesNeedUpdate||mb.colorsNeedUpdate||lb.sortParticles||ob)&&f(mb,F.DYNAMIC_DRAW,lb),mb.verticesNeedUpdate=!1,mb.colorsNeedUpdate=!1,pb.attributes&&m(pb))}},this.initMaterial=function(a,b,c,d){var e,f,g;if(a instanceof THREE.MeshDepthMaterial?g="depth":a instanceof THREE.MeshNormalMaterial?g="normal":a instanceof THREE.MeshBasicMaterial?g="basic":a instanceof THREE.MeshLambertMaterial?g="lambert":a instanceof THREE.MeshPhongMaterial?g="phong":a instanceof THREE.LineBasicMaterial?g="basic":a instanceof THREE.ParticleBasicMaterial&&(g="particle_basic"),g){var h=THREE.ShaderLib[g];a.uniforms=THREE.UniformsUtils.clone(h.uniforms),a.vertexShader=h.vertexShader,a.fragmentShader=h.fragmentShader}var i,j,k,l,m;for(i=l=m=h=0,j=b.length;j>i;i++)k=b[i],k.onlyShadow||(k instanceof THREE.DirectionalLight&&l++,k instanceof THREE.PointLight&&m++,k instanceof THREE.SpotLight&&h++);E>=m+h+l?(j=l,k=m,l=h):(j=Math.ceil(E*l/(m+l)),l=k=E-j);var n=0,h=0;for(m=b.length;m>h;h++)i=b[h],i.castShadow&&(i instanceof THREE.SpotLight&&n++,i instanceof THREE.DirectionalLight&&!i.shadowCascade&&n++);var o;a:{m=a.fragmentShader,i=a.vertexShader;
var p,h=a.uniforms,b=a.attributes,c={map:!!a.map,envMap:!!a.envMap,lightMap:!!a.lightMap,vertexColors:a.vertexColors,fog:c,useFog:a.fog,sizeAttenuation:a.sizeAttenuation,skinning:a.skinning,maxBones:50,morphTargets:a.morphTargets,morphNormals:a.morphNormals,maxMorphTargets:this.maxMorphTargets,maxMorphNormals:this.maxMorphNormals,maxDirLights:j,maxPointLights:k,maxSpotLights:l,maxShadows:n,shadowMapEnabled:this.shadowMapEnabled&&d.receiveShadow,shadowMapSoft:this.shadowMapSoft,shadowMapDebug:this.shadowMapDebug,shadowMapCascade:this.shadowMapCascade,alphaTest:a.alphaTest,metal:a.metal,perPixel:a.perPixel,wrapAround:a.wrapAround,doubleSided:d&&d.doubleSided},d=[];g?d.push(g):(d.push(m),d.push(i));for(p in c)d.push(p),d.push(c[p]);for(g=d.join(),p=0,d=H.length;d>p;p++)if(H[p].code===g){o=H[p].program;break a}p=F.createProgram(),d=["precision "+w+" float;",lb>0?"#define VERTEX_TEXTURES":"",G.gammaInput?"#define GAMMA_INPUT":"",G.gammaOutput?"#define GAMMA_OUTPUT":"",G.physicallyBasedShading?"#define PHYSICALLY_BASED_SHADING":"","#define MAX_DIR_LIGHTS "+c.maxDirLights,"#define MAX_POINT_LIGHTS "+c.maxPointLights,"#define MAX_SPOT_LIGHTS "+c.maxSpotLights,"#define MAX_SHADOWS "+c.maxShadows,"#define MAX_BONES "+c.maxBones,c.map?"#define USE_MAP":"",c.envMap?"#define USE_ENVMAP":"",c.lightMap?"#define USE_LIGHTMAP":"",c.vertexColors?"#define USE_COLOR":"",c.skinning?"#define USE_SKINNING":"",c.morphTargets?"#define USE_MORPHTARGETS":"",c.morphNormals?"#define USE_MORPHNORMALS":"",c.perPixel?"#define PHONG_PER_PIXEL":"",c.wrapAround?"#define WRAP_AROUND":"",c.doubleSided?"#define DOUBLE_SIDED":"",c.shadowMapEnabled?"#define USE_SHADOWMAP":"",c.shadowMapSoft?"#define SHADOWMAP_SOFT":"",c.shadowMapDebug?"#define SHADOWMAP_DEBUG":"",c.shadowMapCascade?"#define SHADOWMAP_CASCADE":"",c.sizeAttenuation?"#define USE_SIZEATTENUATION":"","uniform mat4 objectMatrix;\nuniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\nuniform mat4 viewMatrix;\nuniform mat3 normalMatrix;\nuniform vec3 cameraPosition;\nattribute vec3 position;\nattribute vec3 normal;\nattribute vec2 uv;\nattribute vec2 uv2;\n#ifdef USE_COLOR\nattribute vec3 color;\n#endif\n#ifdef USE_MORPHTARGETS\nattribute vec3 morphTarget0;\nattribute vec3 morphTarget1;\nattribute vec3 morphTarget2;\nattribute vec3 morphTarget3;\n#ifdef USE_MORPHNORMALS\nattribute vec3 morphNormal0;\nattribute vec3 morphNormal1;\nattribute vec3 morphNormal2;\nattribute vec3 morphNormal3;\n#else\nattribute vec3 morphTarget4;\nattribute vec3 morphTarget5;\nattribute vec3 morphTarget6;\nattribute vec3 morphTarget7;\n#endif\n#endif\n#ifdef USE_SKINNING\nattribute vec4 skinVertexA;\nattribute vec4 skinVertexB;\nattribute vec4 skinIndex;\nattribute vec4 skinWeight;\n#endif\n"].join("\n"),j=["precision "+w+" float;","#define MAX_DIR_LIGHTS "+c.maxDirLights,"#define MAX_POINT_LIGHTS "+c.maxPointLights,"#define MAX_SPOT_LIGHTS "+c.maxSpotLights,"#define MAX_SHADOWS "+c.maxShadows,c.alphaTest?"#define ALPHATEST "+c.alphaTest:"",G.gammaInput?"#define GAMMA_INPUT":"",G.gammaOutput?"#define GAMMA_OUTPUT":"",G.physicallyBasedShading?"#define PHYSICALLY_BASED_SHADING":"",c.useFog&&c.fog?"#define USE_FOG":"",c.useFog&&c.fog instanceof THREE.FogExp2?"#define FOG_EXP2":"",c.map?"#define USE_MAP":"",c.envMap?"#define USE_ENVMAP":"",c.lightMap?"#define USE_LIGHTMAP":"",c.vertexColors?"#define USE_COLOR":"",c.metal?"#define METAL":"",c.perPixel?"#define PHONG_PER_PIXEL":"",c.wrapAround?"#define WRAP_AROUND":"",c.doubleSided?"#define DOUBLE_SIDED":"",c.shadowMapEnabled?"#define USE_SHADOWMAP":"",c.shadowMapSoft?"#define SHADOWMAP_SOFT":"",c.shadowMapDebug?"#define SHADOWMAP_DEBUG":"",c.shadowMapCascade?"#define SHADOWMAP_CASCADE":"","uniform mat4 viewMatrix;\nuniform vec3 cameraPosition;\n"].join("\n"),F.attachShader(p,q("fragment",j+m)),F.attachShader(p,q("vertex",d+i)),F.linkProgram(p),F.getProgramParameter(p,F.LINK_STATUS)||void 0,p.uniforms={},p.attributes={};var r,d=["viewMatrix","modelViewMatrix","projectionMatrix","normalMatrix","objectMatrix","cameraPosition","boneGlobalMatrices","morphTargetInfluences"];for(r in h)d.push(r);for(r=d,d=0,h=r.length;h>d;d++)m=r[d],p.uniforms[m]=F.getUniformLocation(p,m);for(d=["position","normal","uv","uv2","tangent","color","skinVertexA","skinVertexB","skinIndex","skinWeight"],r=0;r<c.maxMorphTargets;r++)d.push("morphTarget"+r);for(r=0;r<c.maxMorphNormals;r++)d.push("morphNormal"+r);for(o in b)d.push(o);for(o=d,r=0,b=o.length;b>r;r++)c=o[r],p.attributes[c]=F.getAttribLocation(p,c);p.id=H.length,H.push({program:p,code:g}),G.info.memory.programs=H.length,o=p}if(a.program=o,o=a.program.attributes,o.position>=0&&F.enableVertexAttribArray(o.position),o.color>=0&&F.enableVertexAttribArray(o.color),o.normal>=0&&F.enableVertexAttribArray(o.normal),o.tangent>=0&&F.enableVertexAttribArray(o.tangent),a.skinning&&o.skinVertexA>=0&&o.skinVertexB>=0&&o.skinIndex>=0&&o.skinWeight>=0&&(F.enableVertexAttribArray(o.skinVertexA),F.enableVertexAttribArray(o.skinVertexB),F.enableVertexAttribArray(o.skinIndex),F.enableVertexAttribArray(o.skinWeight)),a.attributes)for(f in a.attributes)void 0!==o[f]&&o[f]>=0&&F.enableVertexAttribArray(o[f]);if(a.morphTargets)for(a.numSupportedMorphTargets=0,p="morphTarget",f=0;f<this.maxMorphTargets;f++)r=p+f,o[r]>=0&&(F.enableVertexAttribArray(o[r]),a.numSupportedMorphTargets++);if(a.morphNormals)for(a.numSupportedMorphNormals=0,p="morphNormal",f=0;f<this.maxMorphNormals;f++)r=p+f,o[r]>=0&&(F.enableVertexAttribArray(o[r]),a.numSupportedMorphNormals++);a.uniformsList=[];for(e in a.uniforms)a.uniformsList.push([a.uniforms[e],e])},this.setFaceCulling=function(a,b){a?(F.frontFace(b&&"ccw"!==b?F.CW:F.CCW),F.cullFace("back"===a?F.BACK:"front"===a?F.FRONT:F.FRONT_AND_BACK),F.enable(F.CULL_FACE)):F.disable(F.CULL_FACE)},this.setObjectFaces=function(a){O!==a.doubleSided&&(a.doubleSided?F.disable(F.CULL_FACE):F.enable(F.CULL_FACE),O=a.doubleSided),P!==a.flipSided&&(F.frontFace(a.flipSided?F.CW:F.CCW),P=a.flipSided)},this.setDepthTest=function(a){U!==a&&(a?F.enable(F.DEPTH_TEST):F.disable(F.DEPTH_TEST),U=a)},this.setDepthWrite=function(a){V!==a&&(F.depthMask(a),V=a)},this.setBlending=function(a,b,c,d){if(a!==Q){switch(a){case THREE.NoBlending:F.disable(F.BLEND);break;case THREE.AdditiveBlending:F.enable(F.BLEND),F.blendEquation(F.FUNC_ADD),F.blendFunc(F.SRC_ALPHA,F.ONE);break;case THREE.SubtractiveBlending:F.enable(F.BLEND),F.blendEquation(F.FUNC_ADD),F.blendFunc(F.ZERO,F.ONE_MINUS_SRC_COLOR);break;case THREE.MultiplyBlending:F.enable(F.BLEND),F.blendEquation(F.FUNC_ADD),F.blendFunc(F.ZERO,F.SRC_COLOR);break;case THREE.CustomBlending:F.enable(F.BLEND);break;default:F.enable(F.BLEND),F.blendEquationSeparate(F.FUNC_ADD,F.FUNC_ADD),F.blendFuncSeparate(F.SRC_ALPHA,F.ONE_MINUS_SRC_ALPHA,F.ONE,F.ONE_MINUS_SRC_ALPHA)}Q=a}a===THREE.CustomBlending?(b!==R&&(F.blendEquation(u(b)),R=b),(c!==S||d!==T)&&(F.blendFunc(u(c),u(d)),S=c,T=d)):T=S=R=null},this.setTexture=function(a,b){if(a.needsUpdate){a.__webglInit||(a.__webglInit=!0,a.__webglTexture=F.createTexture(),G.info.memory.textures++),F.activeTexture(F.TEXTURE0+b),F.bindTexture(F.TEXTURE_2D,a.__webglTexture),F.pixelStorei(F.UNPACK_PREMULTIPLY_ALPHA_WEBGL,a.premultiplyAlpha);var c=a.image,d=0===(c.width&c.width-1)&&0===(c.height&c.height-1),e=u(a.format),f=u(a.type);r(F.TEXTURE_2D,a,d),a instanceof THREE.DataTexture?F.texImage2D(F.TEXTURE_2D,0,e,c.width,c.height,0,e,f,c.data):F.texImage2D(F.TEXTURE_2D,0,e,e,f,a.image),a.generateMipmaps&&d&&F.generateMipmap(F.TEXTURE_2D),a.needsUpdate=!1,a.onUpdate&&a.onUpdate()}else F.activeTexture(F.TEXTURE0+b),F.bindTexture(F.TEXTURE_2D,a.__webglTexture)},this.setRenderTarget=function(a){var b=a instanceof THREE.WebGLRenderTargetCube;if(a&&!a.__webglFramebuffer){void 0===a.depthBuffer&&(a.depthBuffer=!0),void 0===a.stencilBuffer&&(a.stencilBuffer=!0),a.__webglTexture=F.createTexture();var c=0===(a.width&a.width-1)&&0===(a.height&a.height-1),d=u(a.format),e=u(a.type);if(b){a.__webglFramebuffer=[],a.__webglRenderbuffer=[],F.bindTexture(F.TEXTURE_CUBE_MAP,a.__webglTexture),r(F.TEXTURE_CUBE_MAP,a,c);for(var f=0;6>f;f++){a.__webglFramebuffer[f]=F.createFramebuffer(),a.__webglRenderbuffer[f]=F.createRenderbuffer(),F.texImage2D(F.TEXTURE_CUBE_MAP_POSITIVE_X+f,0,d,a.width,a.height,0,d,e,null);var g=a,h=F.TEXTURE_CUBE_MAP_POSITIVE_X+f;F.bindFramebuffer(F.FRAMEBUFFER,a.__webglFramebuffer[f]),F.framebufferTexture2D(F.FRAMEBUFFER,F.COLOR_ATTACHMENT0,h,g.__webglTexture,0),s(a.__webglRenderbuffer[f],a)}c&&F.generateMipmap(F.TEXTURE_CUBE_MAP)}else a.__webglFramebuffer=F.createFramebuffer(),a.__webglRenderbuffer=F.createRenderbuffer(),F.bindTexture(F.TEXTURE_2D,a.__webglTexture),r(F.TEXTURE_2D,a,c),F.texImage2D(F.TEXTURE_2D,0,d,a.width,a.height,0,d,e,null),d=F.TEXTURE_2D,F.bindFramebuffer(F.FRAMEBUFFER,a.__webglFramebuffer),F.framebufferTexture2D(F.FRAMEBUFFER,F.COLOR_ATTACHMENT0,d,a.__webglTexture,0),s(a.__webglRenderbuffer,a),c&&F.generateMipmap(F.TEXTURE_2D);b?F.bindTexture(F.TEXTURE_CUBE_MAP,null):F.bindTexture(F.TEXTURE_2D,null),F.bindRenderbuffer(F.RENDERBUFFER,null),F.bindFramebuffer(F.FRAMEBUFFER,null)}a?(b=b?a.__webglFramebuffer[a.activeCubeFace]:a.__webglFramebuffer,c=a.width,a=a.height,e=d=0):(b=null,c=ab,a=bb,d=$,e=_),b!==J&&(F.bindFramebuffer(F.FRAMEBUFFER,b),F.viewport(d,e,c,a),J=b),cb=c,db=a}},THREE.WebGLRenderTarget=function(a,b,c){this.width=a,this.height=b,c=c||{},this.wrapS=void 0!==c.wrapS?c.wrapS:THREE.ClampToEdgeWrapping,this.wrapT=void 0!==c.wrapT?c.wrapT:THREE.ClampToEdgeWrapping,this.magFilter=void 0!==c.magFilter?c.magFilter:THREE.LinearFilter,this.minFilter=void 0!==c.minFilter?c.minFilter:THREE.LinearMipMapLinearFilter,this.offset=new THREE.Vector2(0,0),this.repeat=new THREE.Vector2(1,1),this.format=void 0!==c.format?c.format:THREE.RGBAFormat,this.type=void 0!==c.type?c.type:THREE.UnsignedByteType,this.depthBuffer=void 0!==c.depthBuffer?c.depthBuffer:!0,this.stencilBuffer=void 0!==c.stencilBuffer?c.stencilBuffer:!0,this.generateMipmaps=!0},THREE.WebGLRenderTarget.prototype.clone=function(){var a=new THREE.WebGLRenderTarget(this.width,this.height);return a.wrapS=this.wrapS,a.wrapT=this.wrapT,a.magFilter=this.magFilter,a.minFilter=this.minFilter,a.offset.copy(this.offset),a.repeat.copy(this.repeat),a.format=this.format,a.type=this.type,a.depthBuffer=this.depthBuffer,a.stencilBuffer=this.stencilBuffer,a},THREE.WebGLRenderTargetCube=function(a,b,c){THREE.WebGLRenderTarget.call(this,a,b,c),this.activeCubeFace=0},THREE.WebGLRenderTargetCube.prototype=new THREE.WebGLRenderTarget,THREE.WebGLRenderTargetCube.prototype.constructor=THREE.WebGLRenderTargetCube,THREE.RenderableVertex=function(){this.positionWorld=new THREE.Vector3,this.positionScreen=new THREE.Vector4,this.visible=!0},THREE.RenderableVertex.prototype.copy=function(a){this.positionWorld.copy(a.positionWorld),this.positionScreen.copy(a.positionScreen)},THREE.RenderableFace3=function(){this.v1=new THREE.RenderableVertex,this.v2=new THREE.RenderableVertex,this.v3=new THREE.RenderableVertex,this.centroidWorld=new THREE.Vector3,this.centroidScreen=new THREE.Vector3,this.normalWorld=new THREE.Vector3,this.vertexNormalsWorld=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3],this.faceMaterial=this.material=null,this.uvs=[[]],this.z=null},THREE.RenderableFace4=function(){this.v1=new THREE.RenderableVertex,this.v2=new THREE.RenderableVertex,this.v3=new THREE.RenderableVertex,this.v4=new THREE.RenderableVertex,this.centroidWorld=new THREE.Vector3,this.centroidScreen=new THREE.Vector3,this.normalWorld=new THREE.Vector3,this.vertexNormalsWorld=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3],this.faceMaterial=this.material=null,this.uvs=[[]],this.z=null},THREE.RenderableObject=function(){this.z=this.object=null},THREE.RenderableLine=function(){this.z=null,this.v1=new THREE.RenderableVertex,this.v2=new THREE.RenderableVertex,this.material=null},THREE.GeometryUtils={merge:function(a,b){for(var c,d,e=a.vertices.length,f=b instanceof THREE.Mesh?b.geometry:b,g=a.vertices,h=f.vertices,i=a.faces,j=f.faces,k=a.faceVertexUvs[0],l=f.faceVertexUvs[0],m={},n=0;n<a.materials.length;n++)m[a.materials[n].id]=n;b instanceof THREE.Mesh&&(b.matrixAutoUpdate&&b.updateMatrix(),c=b.matrix,d=new THREE.Matrix4,d.extractRotation(c,b.scale));for(var n=0,o=h.length;o>n;n++){var p=h[n].clone();c&&c.multiplyVector3(p),g.push(p)}for(n=0,o=j.length;o>n;n++){var q,r,g=j[n],s=g.vertexNormals,t=g.vertexColors;for(g instanceof THREE.Face3?q=new THREE.Face3(g.a+e,g.b+e,g.c+e):g instanceof THREE.Face4&&(q=new THREE.Face4(g.a+e,g.b+e,g.c+e,g.d+e)),q.normal.copy(g.normal),d&&d.multiplyVector3(q.normal),h=0,p=s.length;p>h;h++)r=s[h].clone(),d&&d.multiplyVector3(r),q.vertexNormals.push(r);for(q.color.copy(g.color),h=0,p=t.length;p>h;h++)r=t[h],q.vertexColors.push(r.clone());void 0!==g.materialIndex&&(h=f.materials[g.materialIndex],p=h.id,t=m[p],void 0===t&&(t=a.materials.length,m[p]=t,a.materials.push(h)),q.materialIndex=t),q.centroid.copy(g.centroid),c&&c.multiplyVector3(q.centroid),i.push(q)}for(n=0,o=l.length;o>n;n++){for(c=l[n],d=[],h=0,p=c.length;p>h;h++)d.push(new THREE.UV(c[h].u,c[h].v));k.push(d)}},clone:function(a){var b,c=new THREE.Geometry,d=a.vertices,e=a.faces,f=a.faceVertexUvs[0];for(a.materials&&(c.materials=a.materials.slice()),a=0,b=d.length;b>a;a++)c.vertices.push(d[a].clone());for(a=0,b=e.length;b>a;a++)c.faces.push(e[a].clone());for(a=0,b=f.length;b>a;a++){for(var d=f[a],e=[],g=0,h=d.length;h>g;g++)e.push(new THREE.UV(d[g].u,d[g].v));c.faceVertexUvs[0].push(e)}return c},randomPointInTriangle:function(a,b,c){var d,e,f,g=new THREE.Vector3,h=THREE.GeometryUtils.__v1;return d=THREE.GeometryUtils.random(),e=THREE.GeometryUtils.random(),d+e>1&&(d=1-d,e=1-e),f=1-d-e,g.copy(a),g.multiplyScalar(d),h.copy(b),h.multiplyScalar(e),g.addSelf(h),h.copy(c),h.multiplyScalar(f),g.addSelf(h),g},randomPointInFace:function(a,b,c){var d,e,f;if(a instanceof THREE.Face3)return d=b.vertices[a.a],e=b.vertices[a.b],f=b.vertices[a.c],THREE.GeometryUtils.randomPointInTriangle(d,e,f);if(a instanceof THREE.Face4){d=b.vertices[a.a],e=b.vertices[a.b],f=b.vertices[a.c];var g,b=b.vertices[a.d];return c?a._area1&&a._area2?(c=a._area1,g=a._area2):(c=THREE.GeometryUtils.triangleArea(d,e,b),g=THREE.GeometryUtils.triangleArea(e,f,b),a._area1=c,a._area2=g):(c=THREE.GeometryUtils.triangleArea(d,e,b),g=THREE.GeometryUtils.triangleArea(e,f,b)),THREE.GeometryUtils.random()*(c+g)<c?THREE.GeometryUtils.randomPointInTriangle(d,e,b):THREE.GeometryUtils.randomPointInTriangle(e,f,b)}},randomPointsInGeometry:function(a,b){function c(a){function b(c,d){if(c>d)return c;var e=c+Math.floor((d-c)/2);return n[e]>a?b(c,e-1):n[e]<a?b(e+1,d):e}return b(0,n.length-1)}var d,e,f,g,h,i,j=a.faces,k=a.vertices,l=j.length,m=0,n=[];for(e=0;l>e;e++)d=j[e],d instanceof THREE.Face3?(f=k[d.a],g=k[d.b],h=k[d.c],d._area=THREE.GeometryUtils.triangleArea(f,g,h)):d instanceof THREE.Face4&&(f=k[d.a],g=k[d.b],h=k[d.c],i=k[d.d],d._area1=THREE.GeometryUtils.triangleArea(f,g,i),d._area2=THREE.GeometryUtils.triangleArea(g,h,i),d._area=d._area1+d._area2),m+=d._area,n[e]=m;for(d=[],e=0;b>e;e++)k=THREE.GeometryUtils.random()*m,k=c(k),d[e]=THREE.GeometryUtils.randomPointInFace(j[k],a,!0);return d},triangleArea:function(a,b,c){var d,e=THREE.GeometryUtils.__v1;return e.sub(a,b),d=e.length(),e.sub(a,c),a=e.length(),e.sub(b,c),c=e.length(),b=.5*(d+a+c),Math.sqrt(b*(b-d)*(b-a)*(b-c))},center:function(a){a.computeBoundingBox();var b=a.boundingBox,c=new THREE.Vector3;return c.add(b.min,b.max),c.multiplyScalar(-.5),a.applyMatrix((new THREE.Matrix4).makeTranslation(c.x,c.y,c.z)),a.computeBoundingBox(),c},normalizeUVs:function(a){for(var a=a.faceVertexUvs[0],b=0,c=a.length;c>b;b++)for(var d=a[b],e=0,f=d.length;f>e;e++)1!==d[e].u&&(d[e].u=d[e].u-Math.floor(d[e].u)),1!==d[e].v&&(d[e].v=d[e].v-Math.floor(d[e].v))},triangulateQuads:function(a){var b,c,d,e,f=[],g=[],h=[];for(b=0,c=a.faceUvs.length;c>b;b++)g[b]=[];for(b=0,c=a.faceVertexUvs.length;c>b;b++)h[b]=[];for(b=0,c=a.faces.length;c>b;b++)if(d=a.faces[b],d instanceof THREE.Face4){e=d.a;var i=d.b,j=d.c,k=d.d,l=new THREE.Face3,m=new THREE.Face3;for(l.color.copy(d.color),m.color.copy(d.color),l.materialIndex=d.materialIndex,m.materialIndex=d.materialIndex,l.a=e,l.b=i,l.c=k,m.a=i,m.b=j,m.c=k,4===d.vertexColors.length&&(l.vertexColors[0]=d.vertexColors[0].clone(),l.vertexColors[1]=d.vertexColors[1].clone(),l.vertexColors[2]=d.vertexColors[3].clone(),m.vertexColors[0]=d.vertexColors[1].clone(),m.vertexColors[1]=d.vertexColors[2].clone(),m.vertexColors[2]=d.vertexColors[3].clone()),f.push(l,m),d=0,e=a.faceVertexUvs.length;e>d;d++)a.faceVertexUvs[d].length&&(l=a.faceVertexUvs[d][b],i=l[1],j=l[2],k=l[3],l=[l[0].clone(),i.clone(),k.clone()],i=[i.clone(),j.clone(),k.clone()],h[d].push(l,i));for(d=0,e=a.faceUvs.length;e>d;d++)a.faceUvs[d].length&&(i=a.faceUvs[d][b],g[d].push(i,i))}else{for(f.push(d),d=0,e=a.faceUvs.length;e>d;d++)g[d].push(a.faceUvs[d]);for(d=0,e=a.faceVertexUvs.length;e>d;d++)h[d].push(a.faceVertexUvs[d])}a.faces=f,a.faceUvs=g,a.faceVertexUvs=h,a.computeCentroids(),a.computeFaceNormals(),a.computeVertexNormals(),a.hasTangents&&a.computeTangents()},explode:function(a){for(var b=[],c=0,d=a.faces.length;d>c;c++){var e=b.length,f=a.faces[c];if(f instanceof THREE.Face4){var g=f.a,h=f.b,i=f.c,g=a.vertices[g],h=a.vertices[h],i=a.vertices[i],j=a.vertices[f.d];b.push(g.clone()),b.push(h.clone()),b.push(i.clone()),b.push(j.clone()),f.a=e,f.b=e+1,f.c=e+2,f.d=e+3}else g=f.a,h=f.b,i=f.c,g=a.vertices[g],h=a.vertices[h],i=a.vertices[i],b.push(g.clone()),b.push(h.clone()),b.push(i.clone()),f.a=e,f.b=e+1,f.c=e+2}a.vertices=b,delete a.__tmpVertices},tessellate:function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v=[],w=[];for(c=0,d=a.faceVertexUvs.length;d>c;c++)w[c]=[];for(c=0,d=a.faces.length;d>c;c++)if(e=a.faces[c],e instanceof THREE.Face3)if(f=e.a,g=e.b,h=e.c,j=a.vertices[f],k=a.vertices[g],l=a.vertices[h],n=j.distanceTo(k),o=k.distanceTo(l),m=j.distanceTo(l),n>b||o>b||m>b)for(i=a.vertices.length,t=e.clone(),u=e.clone(),n>=o&&n>=m?(j=j.clone(),j.lerpSelf(k,.5),t.a=f,t.b=i,t.c=h,u.a=i,u.b=g,u.c=h,3===e.vertexNormals.length&&(f=e.vertexNormals[0].clone(),f.lerpSelf(e.vertexNormals[1],.5),t.vertexNormals[1].copy(f),u.vertexNormals[0].copy(f)),3===e.vertexColors.length&&(f=e.vertexColors[0].clone(),f.lerpSelf(e.vertexColors[1],.5),t.vertexColors[1].copy(f),u.vertexColors[0].copy(f)),e=0):o>=n&&o>=m?(j=k.clone(),j.lerpSelf(l,.5),t.a=f,t.b=g,t.c=i,u.a=i,u.b=h,u.c=f,3===e.vertexNormals.length&&(f=e.vertexNormals[1].clone(),f.lerpSelf(e.vertexNormals[2],.5),t.vertexNormals[2].copy(f),u.vertexNormals[0].copy(f),u.vertexNormals[1].copy(e.vertexNormals[2]),u.vertexNormals[2].copy(e.vertexNormals[0])),3===e.vertexColors.length&&(f=e.vertexColors[1].clone(),f.lerpSelf(e.vertexColors[2],.5),t.vertexColors[2].copy(f),u.vertexColors[0].copy(f),u.vertexColors[1].copy(e.vertexColors[2]),u.vertexColors[2].copy(e.vertexColors[0])),e=1):(j=j.clone(),j.lerpSelf(l,.5),t.a=f,t.b=g,t.c=i,u.a=i,u.b=g,u.c=h,3===e.vertexNormals.length&&(f=e.vertexNormals[0].clone(),f.lerpSelf(e.vertexNormals[2],.5),t.vertexNormals[2].copy(f),u.vertexNormals[0].copy(f)),3===e.vertexColors.length&&(f=e.vertexColors[0].clone(),f.lerpSelf(e.vertexColors[2],.5),t.vertexColors[2].copy(f),u.vertexColors[0].copy(f)),e=2),v.push(t,u),a.vertices.push(j),f=0,g=a.faceVertexUvs.length;g>f;f++)a.faceVertexUvs[f].length&&(j=a.faceVertexUvs[f][c],u=j[0],h=j[1],t=j[2],0===e?(k=u.clone(),k.lerpSelf(h,.5),j=[u.clone(),k.clone(),t.clone()],h=[k.clone(),h.clone(),t.clone()]):1===e?(k=h.clone(),k.lerpSelf(t,.5),j=[u.clone(),h.clone(),k.clone()],h=[k.clone(),t.clone(),u.clone()]):(k=u.clone(),k.lerpSelf(t,.5),j=[u.clone(),h.clone(),k.clone()],h=[k.clone(),h.clone(),t.clone()]),w[f].push(j,h));else for(v.push(e),f=0,g=a.faceVertexUvs.length;g>f;f++)w[f].push(a.faceVertexUvs[f][c]);else if(f=e.a,g=e.b,h=e.c,i=e.d,j=a.vertices[f],k=a.vertices[g],l=a.vertices[h],m=a.vertices[i],n=j.distanceTo(k),o=k.distanceTo(l),p=l.distanceTo(m),q=j.distanceTo(m),n>b||o>b||p>b||q>b)for(r=a.vertices.length,s=a.vertices.length+1,t=e.clone(),u=e.clone(),n>=o&&n>=p&&n>=q||p>=o&&p>=n&&p>=q?(n=j.clone(),n.lerpSelf(k,.5),k=l.clone(),k.lerpSelf(m,.5),t.a=f,t.b=r,t.c=s,t.d=i,u.a=r,u.b=g,u.c=h,u.d=s,4===e.vertexNormals.length&&(f=e.vertexNormals[0].clone(),f.lerpSelf(e.vertexNormals[1],.5),g=e.vertexNormals[2].clone(),g.lerpSelf(e.vertexNormals[3],.5),t.vertexNormals[1].copy(f),t.vertexNormals[2].copy(g),u.vertexNormals[0].copy(f),u.vertexNormals[3].copy(g)),4===e.vertexColors.length&&(f=e.vertexColors[0].clone(),f.lerpSelf(e.vertexColors[1],.5),g=e.vertexColors[2].clone(),g.lerpSelf(e.vertexColors[3],.5),t.vertexColors[1].copy(f),t.vertexColors[2].copy(g),u.vertexColors[0].copy(f),u.vertexColors[3].copy(g)),e=0):(n=k.clone(),n.lerpSelf(l,.5),k=m.clone(),k.lerpSelf(j,.5),t.a=f,t.b=g,t.c=r,t.d=s,u.a=s,u.b=r,u.c=h,u.d=i,4===e.vertexNormals.length&&(f=e.vertexNormals[1].clone(),f.lerpSelf(e.vertexNormals[2],.5),g=e.vertexNormals[3].clone(),g.lerpSelf(e.vertexNormals[0],.5),t.vertexNormals[2].copy(f),t.vertexNormals[3].copy(g),u.vertexNormals[0].copy(g),u.vertexNormals[1].copy(f)),4===e.vertexColors.length&&(f=e.vertexColors[1].clone(),f.lerpSelf(e.vertexColors[2],.5),g=e.vertexColors[3].clone(),g.lerpSelf(e.vertexColors[0],.5),t.vertexColors[2].copy(f),t.vertexColors[3].copy(g),u.vertexColors[0].copy(g),u.vertexColors[1].copy(f)),e=1),v.push(t,u),a.vertices.push(n,k),f=0,g=a.faceVertexUvs.length;g>f;f++)a.faceVertexUvs[f].length&&(j=a.faceVertexUvs[f][c],u=j[0],h=j[1],t=j[2],j=j[3],0===e?(k=u.clone(),k.lerpSelf(h,.5),l=t.clone(),l.lerpSelf(j,.5),u=[u.clone(),k.clone(),l.clone(),j.clone()],h=[k.clone(),h.clone(),t.clone(),l.clone()]):(k=h.clone(),k.lerpSelf(t,.5),l=j.clone(),l.lerpSelf(u,.5),u=[u.clone(),h.clone(),k.clone(),l.clone()],h=[l.clone(),k.clone(),t.clone(),j.clone()]),w[f].push(u,h));else for(v.push(e),f=0,g=a.faceVertexUvs.length;g>f;f++)w[f].push(a.faceVertexUvs[f][c]);a.faces=v,a.faceVertexUvs=w}},THREE.GeometryUtils.random=THREE.Math.random16,THREE.GeometryUtils.__v1=new THREE.Vector3,THREE.ImageUtils={crossOrigin:"anonymous",loadTexture:function(a,b,c){var d=new Image,e=new THREE.Texture(d,b);return d.onload=function(){e.needsUpdate=!0,c&&c(this)},d.crossOrigin=this.crossOrigin,d.src=a,e},loadTextureCube:function(a,b,c){var d,e=[],f=new THREE.Texture(e,b),b=e.loadCount=0;for(d=a.length;d>b;++b)e[b]=new Image,e[b].onload=function(){e.loadCount=e.loadCount+1,6===e.loadCount&&(f.needsUpdate=!0),c&&c(this)},e[b].crossOrigin=this.crossOrigin,e[b].src=a[b];return f},getNormalMap:function(a,b){var c=function(a){var b=Math.sqrt(a[0]*a[0]+a[1]*a[1]+a[2]*a[2]);return[a[0]/b,a[1]/b,a[2]/b]},b=1|b,d=a.width,e=a.height,f=document.createElement("canvas");f.width=d,f.height=e;var g=f.getContext("2d");g.drawImage(a,0,0);for(var h=g.getImageData(0,0,d,e).data,i=g.createImageData(d,e),j=i.data,k=0;d>k;k++)for(var l=0;e>l;l++){var m=0>l-1?0:l-1,n=l+1>e-1?e-1:l+1,o=0>k-1?0:k-1,p=k+1>d-1?d-1:k+1,q=[],r=[0,0,h[4*(l*d+k)]/255*b];for(q.push([-1,0,h[4*(l*d+o)]/255*b]),q.push([-1,-1,h[4*(m*d+o)]/255*b]),q.push([0,-1,h[4*(m*d+k)]/255*b]),q.push([1,-1,h[4*(m*d+p)]/255*b]),q.push([1,0,h[4*(l*d+p)]/255*b]),q.push([1,1,h[4*(n*d+p)]/255*b]),q.push([0,1,h[4*(n*d+k)]/255*b]),q.push([-1,1,h[4*(n*d+o)]/255*b]),m=[],o=q.length,n=0;o>n;n++){var p=q[n],s=q[(n+1)%o],p=[p[0]-r[0],p[1]-r[1],p[2]-r[2]],s=[s[0]-r[0],s[1]-r[1],s[2]-r[2]];m.push(c([p[1]*s[2]-p[2]*s[1],p[2]*s[0]-p[0]*s[2],p[0]*s[1]-p[1]*s[0]]))}for(q=[0,0,0],n=0;n<m.length;n++)q[0]=q[0]+m[n][0],q[1]=q[1]+m[n][1],q[2]=q[2]+m[n][2];q[0]=q[0]/m.length,q[1]=q[1]/m.length,q[2]=q[2]/m.length,r=4*(l*d+k),j[r]=(q[0]+1)/2*255|0,j[r+1]=255*(q[1]+.5)|0,j[r+2]=255*q[2]|0,j[r+3]=255}return g.putImageData(i,0,0),f},generateDataTexture:function(a,b,c){for(var d=a*b,e=new Uint8Array(3*d),f=Math.floor(255*c.r),g=Math.floor(255*c.g),c=Math.floor(255*c.b),h=0;d>h;h++)e[3*h]=f,e[3*h+1]=g,e[3*h+2]=c;return a=new THREE.DataTexture(e,a,b,THREE.RGBFormat),a.needsUpdate=!0,a}},THREE.SceneUtils={showHierarchy:function(a,b){THREE.SceneUtils.traverseHierarchy(a,function(a){a.visible=b})},traverseHierarchy:function(a,b){var c,d,e=a.children.length;for(d=0;e>d;d++)c=a.children[d],b(c),THREE.SceneUtils.traverseHierarchy(c,b)},createMultiMaterialObject:function(a,b){var c,d=b.length,e=new THREE.Object3D;for(c=0;d>c;c++){var f=new THREE.Mesh(a,b[c]);e.add(f)}return e},cloneObject:function(a){var b;a instanceof THREE.Mesh?b=new THREE.Mesh(a.geometry,a.material):a instanceof THREE.Line?b=new THREE.Line(a.geometry,a.material,a.type):a instanceof THREE.Ribbon?b=new THREE.Ribbon(a.geometry,a.material):a instanceof THREE.ParticleSystem?(b=new THREE.ParticleSystem(a.geometry,a.material),b.sortParticles=a.sortParticles):a instanceof THREE.Particle?b=new THREE.Particle(a.material):a instanceof THREE.Sprite?(b=new THREE.Sprite({}),b.color.copy(a.color),b.map=a.map,b.blending=a.blending,b.useScreenCoordinates=a.useScreenCoordinates,b.mergeWith3D=a.mergeWith3D,b.affectedByDistance=a.affectedByDistance,b.scaleByViewport=a.scaleByViewport,b.alignment=a.alignment,b.rotation3d.copy(a.rotation3d),b.rotation=a.rotation,b.opacity=a.opacity,b.uvOffset.copy(a.uvOffset),b.uvScale.copy(a.uvScale)):a instanceof THREE.LOD?b=new THREE.LOD:a instanceof THREE.Object3D&&(b=new THREE.Object3D),b.name=a.name,b.parent=a.parent,b.up.copy(a.up),b.position.copy(a.position),b.rotation instanceof THREE.Vector3&&b.rotation.copy(a.rotation),b.eulerOrder=a.eulerOrder,b.scale.copy(a.scale),b.dynamic=a.dynamic,b.doubleSided=a.doubleSided,b.flipSided=a.flipSided,b.renderDepth=a.renderDepth,b.rotationAutoUpdate=a.rotationAutoUpdate,b.matrix.copy(a.matrix),b.matrixWorld.copy(a.matrixWorld),b.matrixRotationWorld.copy(a.matrixRotationWorld),b.matrixAutoUpdate=a.matrixAutoUpdate,b.matrixWorldNeedsUpdate=a.matrixWorldNeedsUpdate,b.quaternion.copy(a.quaternion),b.useQuaternion=a.useQuaternion,b.boundRadius=a.boundRadius,b.boundRadiusScale=a.boundRadiusScale,b.visible=a.visible,b.castShadow=a.castShadow,b.receiveShadow=a.receiveShadow,b.frustumCulled=a.frustumCulled;for(var c=0;c<a.children.length;c++){var d=THREE.SceneUtils.cloneObject(a.children[c]);b.children[c]=d,d.parent=b}if(a instanceof THREE.LOD)for(c=0;c<a.LODs.length;c++)b.LODs[c]={visibleAtDistance:a.LODs[c].visibleAtDistance,object3D:b.children[c]};return b},detach:function(a,b,c){a.applyMatrix(b.matrixWorld),b.remove(a),c.add(a)},attach:function(a,b,c){var d=new THREE.Matrix4;d.getInverse(c.matrixWorld),a.applyMatrix(d),b.remove(a),c.add(a)}},THREE.WebGLRenderer&&(THREE.ShaderUtils={lib:{fresnel:{uniforms:{mRefractionRatio:{type:"f",value:1.02},mFresnelBias:{type:"f",value:.1},mFresnelPower:{type:"f",value:2},mFresnelScale:{type:"f",value:1},tCube:{type:"t",value:1,texture:null}},fragmentShader:"uniform samplerCube tCube;\nvarying vec3 vReflect;\nvarying vec3 vRefract[3];\nvarying float vReflectionFactor;\nvoid main() {\nvec4 reflectedColor = textureCube( tCube, vec3( -vReflect.x, vReflect.yz ) );\nvec4 refractedColor = vec4( 1.0, 1.0, 1.0, 1.0 );\nrefractedColor.r = textureCube( tCube, vec3( -vRefract[0].x, vRefract[0].yz ) ).r;\nrefractedColor.g = textureCube( tCube, vec3( -vRefract[1].x, vRefract[1].yz ) ).g;\nrefractedColor.b = textureCube( tCube, vec3( -vRefract[2].x, vRefract[2].yz ) ).b;\nrefractedColor.a = 1.0;\ngl_FragColor = mix( refractedColor, reflectedColor, clamp( vReflectionFactor, 0.0, 1.0 ) );\n}",vertexShader:"uniform float mRefractionRatio;\nuniform float mFresnelBias;\nuniform float mFresnelScale;\nuniform float mFresnelPower;\nvarying vec3 vReflect;\nvarying vec3 vRefract[3];\nvarying float vReflectionFactor;\nvoid main() {\nvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\nvec4 mPosition = objectMatrix * vec4( position, 1.0 );\nvec3 nWorld = normalize ( mat3( objectMatrix[0].xyz, objectMatrix[1].xyz, objectMatrix[2].xyz ) * normal );\nvec3 I = mPosition.xyz - cameraPosition;\nvReflect = reflect( I, nWorld );\nvRefract[0] = refract( normalize( I ), nWorld, mRefractionRatio );\nvRefract[1] = refract( normalize( I ), nWorld, mRefractionRatio * 0.99 );\nvRefract[2] = refract( normalize( I ), nWorld, mRefractionRatio * 0.98 );\nvReflectionFactor = mFresnelBias + mFresnelScale * pow( 1.0 + dot( normalize( I ), nWorld ), mFresnelPower );\ngl_Position = projectionMatrix * mvPosition;\n}"},normal:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.fog,THREE.UniformsLib.lights,THREE.UniformsLib.shadowmap,{enableAO:{type:"i",value:0},enableDiffuse:{type:"i",value:0},enableSpecular:{type:"i",value:0},enableReflection:{type:"i",value:0},tDiffuse:{type:"t",value:0,texture:null},tCube:{type:"t",value:1,texture:null},tNormal:{type:"t",value:2,texture:null},tSpecular:{type:"t",value:3,texture:null},tAO:{type:"t",value:4,texture:null},tDisplacement:{type:"t",value:5,texture:null},uNormalScale:{type:"f",value:1},uDisplacementBias:{type:"f",value:0},uDisplacementScale:{type:"f",value:1},uDiffuseColor:{type:"c",value:new THREE.Color(16777215)},uSpecularColor:{type:"c",value:new THREE.Color(1118481)},uAmbientColor:{type:"c",value:new THREE.Color(16777215)},uShininess:{type:"f",value:30},uOpacity:{type:"f",value:1},uReflectivity:{type:"f",value:.5},uOffset:{type:"v2",value:new THREE.Vector2(0,0)},uRepeat:{type:"v2",value:new THREE.Vector2(1,1)},wrapRGB:{type:"v3",value:new THREE.Vector3(1,1,1)}}]),fragmentShader:["uniform vec3 uAmbientColor;\nuniform vec3 uDiffuseColor;\nuniform vec3 uSpecularColor;\nuniform float uShininess;\nuniform float uOpacity;\nuniform bool enableDiffuse;\nuniform bool enableSpecular;\nuniform bool enableAO;\nuniform bool enableReflection;\nuniform sampler2D tDiffuse;\nuniform sampler2D tNormal;\nuniform sampler2D tSpecular;\nuniform sampler2D tAO;\nuniform samplerCube tCube;\nuniform float uNormalScale;\nuniform float uReflectivity;\nvarying vec3 vTangent;\nvarying vec3 vBinormal;\nvarying vec3 vNormal;\nvarying vec2 vUv;\nuniform vec3 ambientLightColor;\n#if MAX_DIR_LIGHTS > 0\nuniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\nuniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\n#endif\n#if MAX_POINT_LIGHTS > 0\nuniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\nvarying vec4 vPointLight[ MAX_POINT_LIGHTS ];\n#endif\n#ifdef WRAP_AROUND\nuniform vec3 wrapRGB;\n#endif\nvarying vec3 vViewPosition;",THREE.ShaderChunk.shadowmap_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,"void main() {\ngl_FragColor = vec4( vec3( 1.0 ), uOpacity );\nvec3 specularTex = vec3( 1.0 );\nvec3 normalTex = texture2D( tNormal, vUv ).xyz * 2.0 - 1.0;\nnormalTex.xy *= uNormalScale;\nnormalTex = normalize( normalTex );\nif( enableDiffuse ) {\n#ifdef GAMMA_INPUT\nvec4 texelColor = texture2D( tDiffuse, vUv );\ntexelColor.xyz *= texelColor.xyz;\ngl_FragColor = gl_FragColor * texelColor;\n#else\ngl_FragColor = gl_FragColor * texture2D( tDiffuse, vUv );\n#endif\n}\nif( enableAO ) {\n#ifdef GAMMA_INPUT\nvec4 aoColor = texture2D( tAO, vUv );\naoColor.xyz *= aoColor.xyz;\ngl_FragColor.xyz = gl_FragColor.xyz * aoColor.xyz;\n#else\ngl_FragColor.xyz = gl_FragColor.xyz * texture2D( tAO, vUv ).xyz;\n#endif\n}\nif( enableSpecular )\nspecularTex = texture2D( tSpecular, vUv ).xyz;\nmat3 tsb = mat3( normalize( vTangent ), normalize( vBinormal ), normalize( vNormal ) );\nvec3 finalNormal = tsb * normalTex;\nvec3 normal = normalize( finalNormal );\nvec3 viewPosition = normalize( vViewPosition );\n#if MAX_POINT_LIGHTS > 0\nvec3 pointDiffuse = vec3( 0.0 );\nvec3 pointSpecular = vec3( 0.0 );\nfor ( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\nvec3 pointVector = normalize( vPointLight[ i ].xyz );\nfloat pointDistance = vPointLight[ i ].w;\n#ifdef WRAP_AROUND\nfloat pointDiffuseWeightFull = max( dot( normal, pointVector ), 0.0 );\nfloat pointDiffuseWeightHalf = max( 0.5 * dot( normal, pointVector ) + 0.5, 0.0 );\nvec3 pointDiffuseWeight = mix( vec3 ( pointDiffuseWeightFull ), vec3( pointDiffuseWeightHalf ), wrapRGB );\n#else\nfloat pointDiffuseWeight = max( dot( normal, pointVector ), 0.0 );\n#endif\npointDiffuse += pointDistance * pointLightColor[ i ] * uDiffuseColor * pointDiffuseWeight;\nvec3 pointHalfVector = normalize( pointVector + viewPosition );\nfloat pointDotNormalHalf = max( dot( normal, pointHalfVector ), 0.0 );\nfloat pointSpecularWeight = specularTex.r * max( pow( pointDotNormalHalf, uShininess ), 0.0 );\n#ifdef PHYSICALLY_BASED_SHADING\nfloat specularNormalization = ( uShininess + 2.0001 ) / 8.0;\nvec3 schlick = uSpecularColor + vec3( 1.0 - uSpecularColor ) * pow( 1.0 - dot( pointVector, pointHalfVector ), 5.0 );\npointSpecular += schlick * pointLightColor[ i ] * pointSpecularWeight * pointDiffuseWeight * pointDistance * specularNormalization;\n#else\npointSpecular += pointDistance * pointLightColor[ i ] * uSpecularColor * pointSpecularWeight * pointDiffuseWeight;\n#endif\n}\n#endif\n#if MAX_DIR_LIGHTS > 0\nvec3 dirDiffuse = vec3( 0.0 );\nvec3 dirSpecular = vec3( 0.0 );\nfor( int i = 0; i < MAX_DIR_LIGHTS; i++ ) {\nvec4 lDirection = viewMatrix * vec4( directionalLightDirection[ i ], 0.0 );\nvec3 dirVector = normalize( lDirection.xyz );\n#ifdef WRAP_AROUND\nfloat directionalLightWeightingFull = max( dot( normal, dirVector ), 0.0 );\nfloat directionalLightWeightingHalf = max( 0.5 * dot( normal, dirVector ) + 0.5, 0.0 );\nvec3 dirDiffuseWeight = mix( vec3( directionalLightWeightingFull ), vec3( directionalLightWeightingHalf ), wrapRGB );\n#else\nfloat dirDiffuseWeight = max( dot( normal, dirVector ), 0.0 );\n#endif\ndirDiffuse += directionalLightColor[ i ] * uDiffuseColor * dirDiffuseWeight;\nvec3 dirHalfVector = normalize( dirVector + viewPosition );\nfloat dirDotNormalHalf = max( dot( normal, dirHalfVector ), 0.0 );\nfloat dirSpecularWeight = specularTex.r * max( pow( dirDotNormalHalf, uShininess ), 0.0 );\n#ifdef PHYSICALLY_BASED_SHADING\nfloat specularNormalization = ( uShininess + 2.0001 ) / 8.0;\nvec3 schlick = uSpecularColor + vec3( 1.0 - uSpecularColor ) * pow( 1.0 - dot( dirVector, dirHalfVector ), 5.0 );\ndirSpecular += schlick * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight * specularNormalization;\n#else\ndirSpecular += directionalLightColor[ i ] * uSpecularColor * dirSpecularWeight * dirDiffuseWeight;\n#endif\n}\n#endif\nvec3 totalDiffuse = vec3( 0.0 );\nvec3 totalSpecular = vec3( 0.0 );\n#if MAX_DIR_LIGHTS > 0\ntotalDiffuse += dirDiffuse;\ntotalSpecular += dirSpecular;\n#endif\n#if MAX_POINT_LIGHTS > 0\ntotalDiffuse += pointDiffuse;\ntotalSpecular += pointSpecular;\n#endif\ngl_FragColor.xyz = gl_FragColor.xyz * ( totalDiffuse + ambientLightColor * uAmbientColor) + totalSpecular;\nif ( enableReflection ) {\nvec3 wPos = cameraPosition - vViewPosition;\nvec3 vReflect = reflect( normalize( wPos ), normal );\nvec4 cubeColor = textureCube( tCube, vec3( -vReflect.x, vReflect.yz ) );\n#ifdef GAMMA_INPUT\ncubeColor.xyz *= cubeColor.xyz;\n#endif\ngl_FragColor.xyz = mix( gl_FragColor.xyz, cubeColor.xyz, specularTex.r * uReflectivity );\n}",THREE.ShaderChunk.shadowmap_fragment,THREE.ShaderChunk.linear_to_gamma_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n"),vertexShader:["attribute vec4 tangent;\nuniform vec2 uOffset;\nuniform vec2 uRepeat;\n#ifdef VERTEX_TEXTURES\nuniform sampler2D tDisplacement;\nuniform float uDisplacementScale;\nuniform float uDisplacementBias;\n#endif\nvarying vec3 vTangent;\nvarying vec3 vBinormal;\nvarying vec3 vNormal;\nvarying vec2 vUv;\n#if MAX_POINT_LIGHTS > 0\nuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\nuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\nvarying vec4 vPointLight[ MAX_POINT_LIGHTS ];\n#endif\nvarying vec3 vViewPosition;",THREE.ShaderChunk.shadowmap_pars_vertex,"void main() {\nvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\nvViewPosition = -mvPosition.xyz;\nvNormal = normalMatrix * normal;\nvTangent = normalMatrix * tangent.xyz;\nvBinormal = cross( vNormal, vTangent ) * tangent.w;\nvUv = uv * uRepeat + uOffset;\n#if MAX_POINT_LIGHTS > 0\nfor( int i = 0; i < MAX_POINT_LIGHTS; i++ ) {\nvec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\nvec3 lVector = lPosition.xyz - mvPosition.xyz;\nfloat lDistance = 1.0;\nif ( pointLightDistance[ i ] > 0.0 )\nlDistance = 1.0 - min( ( length( lVector ) / pointLightDistance[ i ] ), 1.0 );\nlVector = normalize( lVector );\nvPointLight[ i ] = vec4( lVector, lDistance );\n}\n#endif\n#ifdef VERTEX_TEXTURES\nvec3 dv = texture2D( tDisplacement, uv ).xyz;\nfloat df = uDisplacementScale * dv.x + uDisplacementBias;\nvec4 displacedPosition = vec4( normalize( vNormal.xyz ) * df, 0.0 ) + mvPosition;\ngl_Position = projectionMatrix * displacedPosition;\n#else\ngl_Position = projectionMatrix * mvPosition;\n#endif",THREE.ShaderChunk.shadowmap_vertex,"}"].join("\n")},cube:{uniforms:{tCube:{type:"t",value:1,texture:null},tFlip:{type:"f",value:-1}},vertexShader:"varying vec3 vViewPosition;\nvoid main() {\nvec4 mPosition = objectMatrix * vec4( position, 1.0 );\nvViewPosition = cameraPosition - mPosition.xyz;\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"uniform samplerCube tCube;\nuniform float tFlip;\nvarying vec3 vViewPosition;\nvoid main() {\nvec3 wPos = cameraPosition - vViewPosition;\ngl_FragColor = textureCube( tCube, vec3( tFlip * wPos.x, wPos.yz ) );\n}"}}}),THREE.BufferGeometry=function(){this.id=THREE.GeometryCount++,this.vertexColorArray=this.vertexUvArray=this.vertexNormalArray=this.vertexPositionArray=this.vertexIndexArray=this.vertexColorBuffer=this.vertexUvBuffer=this.vertexNormalBuffer=this.vertexPositionBuffer=this.vertexIndexBuffer=null,this.dynamic=!1,this.boundingSphere=this.boundingBox=null,this.morphTargets=[]
},THREE.BufferGeometry.prototype={constructor:THREE.BufferGeometry,computeBoundingBox:function(){},computeBoundingSphere:function(){}},THREE.CubeGeometry=function(a,b,c,d,e,f,g,h){function i(a,b,c,g,h,i,j,k){var l,m=d||1,n=e||1,o=h/2,q=i/2,r=p.vertices.length;"x"===a&&"y"===b||"y"===a&&"x"===b?l="z":"x"===a&&"z"===b||"z"===a&&"x"===b?(l="y",n=f||1):("z"===a&&"y"===b||"y"===a&&"z"===b)&&(l="x",m=f||1);var s=m+1,t=n+1,u=h/m,v=i/n,w=new THREE.Vector3;for(w[l]=j>0?1:-1,h=0;t>h;h++)for(i=0;s>i;i++){var x=new THREE.Vector3;x[a]=(i*u-o)*c,x[b]=(h*v-q)*g,x[l]=j,p.vertices.push(x)}for(h=0;n>h;h++)for(i=0;m>i;i++)a=new THREE.Face4(i+s*h+r,i+s*(h+1)+r,i+1+s*(h+1)+r,i+1+s*h+r),a.normal.copy(w),a.vertexNormals.push(w.clone(),w.clone(),w.clone(),w.clone()),a.materialIndex=k,p.faces.push(a),p.faceVertexUvs[0].push([new THREE.UV(i/m,h/n),new THREE.UV(i/m,(h+1)/n),new THREE.UV((i+1)/m,(h+1)/n),new THREE.UV((i+1)/m,h/n)])}THREE.Geometry.call(this);var j,k,l,m,n,o,p=this,q=a/2,r=b/2,s=c/2;if(void 0!==g){if(g instanceof Array)this.materials=g;else for(this.materials=[],j=0;6>j;j++)this.materials.push(g);j=0,m=1,k=2,n=3,l=4,o=5}else this.materials=[];if(this.sides={px:!0,nx:!0,py:!0,ny:!0,pz:!0,nz:!0},void 0!=h)for(var t in h)void 0!==this.sides[t]&&(this.sides[t]=h[t]);this.sides.px&&i("z","y",-1,-1,c,b,q,j),this.sides.nx&&i("z","y",1,-1,c,b,-q,m),this.sides.py&&i("x","z",1,1,a,c,r,k),this.sides.ny&&i("x","z",1,-1,a,c,-r,n),this.sides.pz&&i("x","y",1,-1,a,b,s,l),this.sides.nz&&i("x","y",-1,-1,a,b,-s,o),this.computeCentroids(),this.mergeVertices()},THREE.CubeGeometry.prototype=new THREE.Geometry,THREE.CubeGeometry.prototype.constructor=THREE.CubeGeometry,THREE.CylinderGeometry=function(a,b,c,d,e,f){THREE.Geometry.call(this);var g,h,a=void 0!==a?a:20,b=void 0!==b?b:20,c=void 0!==c?c:100,i=c/2,d=d||8,e=e||1,j=[],k=[];for(h=0;e>=h;h++){var l=[],m=[],n=h/e,o=n*(b-a)+a;for(g=0;d>=g;g++){var p=g/d,q=new THREE.Vector3;q.x=o*Math.sin(p*Math.PI*2),q.y=-n*c+i,q.z=o*Math.cos(p*Math.PI*2),this.vertices.push(q),l.push(this.vertices.length-1),m.push(new THREE.UV(p,n))}j.push(l),k.push(m)}for(c=(b-a)/c,g=0;d>g;g++)for(0!==a?(l=this.vertices[j[0][g]].clone(),m=this.vertices[j[0][g+1]].clone()):(l=this.vertices[j[1][g]].clone(),m=this.vertices[j[1][g+1]].clone()),l.setY(Math.sqrt(l.x*l.x+l.z*l.z)*c).normalize(),m.setY(Math.sqrt(m.x*m.x+m.z*m.z)*c).normalize(),h=0;e>h;h++){var n=j[h][g],o=j[h+1][g],p=j[h+1][g+1],q=j[h][g+1],r=l.clone(),s=l.clone(),t=m.clone(),u=m.clone(),v=k[h][g].clone(),w=k[h+1][g].clone(),x=k[h+1][g+1].clone(),y=k[h][g+1].clone();this.faces.push(new THREE.Face4(n,o,p,q,[r,s,t,u])),this.faceVertexUvs[0].push([v,w,x,y])}if(!f&&a>0)for(this.vertices.push(new THREE.Vector3(0,i,0)),g=0;d>g;g++)n=j[0][g],o=j[0][g+1],p=this.vertices.length-1,r=new THREE.Vector3(0,1,0),s=new THREE.Vector3(0,1,0),t=new THREE.Vector3(0,1,0),v=k[0][g].clone(),w=k[0][g+1].clone(),x=new THREE.UV(w.u,0),this.faces.push(new THREE.Face3(n,o,p,[r,s,t])),this.faceVertexUvs[0].push([v,w,x]);if(!f&&b>0)for(this.vertices.push(new THREE.Vector3(0,-i,0)),g=0;d>g;g++)n=j[h][g+1],o=j[h][g],p=this.vertices.length-1,r=new THREE.Vector3(0,-1,0),s=new THREE.Vector3(0,-1,0),t=new THREE.Vector3(0,-1,0),v=k[h][g+1].clone(),w=k[h][g].clone(),x=new THREE.UV(w.u,1),this.faces.push(new THREE.Face3(n,o,p,[r,s,t])),this.faceVertexUvs[0].push([v,w,x]);this.computeCentroids(),this.computeFaceNormals()},THREE.CylinderGeometry.prototype=new THREE.Geometry,THREE.CylinderGeometry.prototype.constructor=THREE.CylinderGeometry,THREE.PlaneGeometry=function(a,b,c,d){THREE.Geometry.call(this);for(var e=a/2,f=b/2,c=c||1,d=d||1,g=c+1,h=d+1,i=a/c,j=b/d,k=new THREE.Vector3(0,1,0),a=0;h>a;a++)for(b=0;g>b;b++)this.vertices.push(new THREE.Vector3(b*i-e,0,a*j-f));for(a=0;d>a;a++)for(b=0;c>b;b++)e=new THREE.Face4(b+g*a,b+g*(a+1),b+1+g*(a+1),b+1+g*a),e.normal.copy(k),e.vertexNormals.push(k.clone(),k.clone(),k.clone(),k.clone()),this.faces.push(e),this.faceVertexUvs[0].push([new THREE.UV(b/c,a/d),new THREE.UV(b/c,(a+1)/d),new THREE.UV((b+1)/c,(a+1)/d),new THREE.UV((b+1)/c,a/d)]);this.computeCentroids()},THREE.PlaneGeometry.prototype=new THREE.Geometry,THREE.PlaneGeometry.prototype.constructor=THREE.PlaneGeometry,THREE.SphereGeometry=function(a,b,c,d,e,f,g){THREE.Geometry.call(this);var h,i,a=a||50,d=void 0!==d?d:0,e=void 0!==e?e:2*Math.PI,f=void 0!==f?f:0,g=void 0!==g?g:Math.PI,b=Math.max(3,Math.floor(b)||8),c=Math.max(2,Math.floor(c)||6),j=[],k=[];for(i=0;c>=i;i++){var l=[],m=[];for(h=0;b>=h;h++){var n=h/b,o=i/c,p=new THREE.Vector3;p.x=-a*Math.cos(d+n*e)*Math.sin(f+o*g),p.y=a*Math.cos(f+o*g),p.z=a*Math.sin(d+n*e)*Math.sin(f+o*g),this.vertices.push(p),l.push(this.vertices.length-1),m.push(new THREE.UV(n,o))}j.push(l),k.push(m)}for(i=0;c>i;i++)for(h=0;b>h;h++){var d=j[i][h+1],e=j[i][h],f=j[i+1][h],g=j[i+1][h+1],l=this.vertices[d].clone().normalize(),m=this.vertices[e].clone().normalize(),n=this.vertices[f].clone().normalize(),o=this.vertices[g].clone().normalize(),p=k[i][h+1].clone(),q=k[i][h].clone(),r=k[i+1][h].clone(),s=k[i+1][h+1].clone();Math.abs(this.vertices[d].y)==a?(this.faces.push(new THREE.Face3(d,f,g,[l,n,o])),this.faceVertexUvs[0].push([p,r,s])):Math.abs(this.vertices[f].y)==a?(this.faces.push(new THREE.Face3(d,e,f,[l,m,n])),this.faceVertexUvs[0].push([p,q,r])):(this.faces.push(new THREE.Face4(d,e,f,g,[l,m,n,o])),this.faceVertexUvs[0].push([p,q,r,s]))}this.computeCentroids(),this.computeFaceNormals(),this.boundingSphere={radius:a}},THREE.SphereGeometry.prototype=new THREE.Geometry,THREE.SphereGeometry.prototype.constructor=THREE.SphereGeometry,THREE.PolyhedronGeometry=function(a,b,c,d){function e(a){var b=a.normalize().clone();b.index=i.vertices.push(b)-1;var c=Math.atan2(a.z,-a.x)/2/Math.PI+.5,a=Math.atan2(-a.y,Math.sqrt(a.x*a.x+a.z*a.z))/Math.PI+.5;return b.uv=new THREE.UV(c,a),b}function f(a,b,c,d){1>d?(d=new THREE.Face3(a.index,b.index,c.index,[a.clone(),b.clone(),c.clone()]),d.centroid.addSelf(a).addSelf(b).addSelf(c).divideScalar(3),d.normal=d.centroid.clone().normalize(),i.faces.push(d),d=Math.atan2(d.centroid.z,-d.centroid.x),i.faceVertexUvs[0].push([h(a.uv,a,d),h(b.uv,b,d),h(c.uv,c,d)])):(d-=1,f(a,g(a,b),g(a,c),d),f(g(a,b),b,g(b,c),d),f(g(a,c),g(b,c),c,d),f(g(a,b),g(b,c),g(a,c),d))}function g(a,b){l[a.index]||(l[a.index]=[]),l[b.index]||(l[b.index]=[]);var c=l[a.index][b.index];return void 0===c&&(l[a.index][b.index]=l[b.index][a.index]=c=e((new THREE.Vector3).add(a,b).divideScalar(2))),c}function h(a,b,c){return 0>c&&1===a.u&&(a=new THREE.UV(a.u-1,a.v)),0===b.x&&0===b.z&&(a=new THREE.UV(c/2/Math.PI+.5,a.v)),a}THREE.Geometry.call(this);for(var c=c||1,d=d||0,i=this,j=0,k=a.length;k>j;j++)e(new THREE.Vector3(a[j][0],a[j][1],a[j][2]));for(var l=[],a=this.vertices,j=0,k=b.length;k>j;j++)f(a[b[j][0]],a[b[j][1]],a[b[j][2]],d);for(this.mergeVertices(),j=0,k=this.vertices.length;k>j;j++)this.vertices[j].multiplyScalar(c);this.computeCentroids(),this.boundingSphere={radius:c}},THREE.PolyhedronGeometry.prototype=new THREE.Geometry,THREE.PolyhedronGeometry.prototype.constructor=THREE.PolyhedronGeometry,THREE.IcosahedronGeometry=function(a,b){var c=(1+Math.sqrt(5))/2;THREE.PolyhedronGeometry.call(this,[[-1,c,0],[1,c,0],[-1,-c,0],[1,-c,0],[0,-1,c],[0,1,c],[0,-1,-c],[0,1,-c],[c,0,-1],[c,0,1],[-c,0,-1],[-c,0,1]],[[0,11,5],[0,5,1],[0,1,7],[0,7,10],[0,10,11],[1,5,9],[5,11,4],[11,10,2],[10,7,6],[7,1,8],[3,9,4],[3,4,2],[3,2,6],[3,6,8],[3,8,9],[4,9,5],[2,4,11],[6,2,10],[8,6,7],[9,8,1]],a,b)},THREE.IcosahedronGeometry.prototype=new THREE.Geometry,THREE.IcosahedronGeometry.prototype.constructor=THREE.IcosahedronGeometry,THREE.ShaderLib.lambert.fragmentShader=THREE.ShaderLib.lambert.fragmentShader.replace("gl_FrontFacing","true"),THREE.ShaderLib.lambert.vertexShader=THREE.ShaderLib.lambert.vertexShader.replace(/\}$/,"#ifdef DOUBLE_SIDED\n if(transformedNormal.z < 0.0) vLightFront = vLightBack;\n #endif\n }");var TV3=THREE.Vector3,TF3=THREE.Face3,TCo=THREE.Color;THREE.Geometry.prototype.colorAll=function(a){for(var b=0;b<this.faces.length;b++)this.faces[b].color=a},THREE.Matrix4.prototype.isIdentity=function(){for(var a=0;4>a;a++)for(var b=0;4>b;b++)if(this.elements[4*a+b]!=(a==b)?1:0)return!1;return!0};var GLmol=function(){function a(a,b,c,d){return a&&this.create(a,b,c,d),!0}return a.prototype.create=function(a,b,c,d){this.Nucleotides=["  G","  A","  T","  C","  U"," DG"," DA"," DT"," DC"," DU"],this.ElementColors={H:16777215,He:14286847,Li:13402367,Be:12779264,B:16758197,C:9474192,N:3166456,O:16715021,F:9494608,Ne:11789301,Na:11230450,Mg:9109248,Al:12560038,Si:1578e4,P:16744448,S:16777008,Cl:2093087,Ar:8442339,K:9388244,Ca:4062976,Sc:15132390,Ti:12567239,V:10921643,Cr:9083335,Mn:10255047,Fe:14706227,Co:15765664,Ni:5296208,Cu:13140019,Zn:8224944,Ga:12750735,Ge:6721423,As:12419299,Se:16752896,Br:10889513,Kr:6076625,Rb:7351984,Sr:65280,Y:9764863,Zr:9756896,Nb:7586505,Mo:5551541,Tc:3907230,Ru:2396047,Rh:687500,Pd:27013,Ag:12632256,Cd:16767375,In:10909043,Sn:6717568,Sb:10380213,Te:13924864,I:9699476,Xe:4366e3,Cs:5707663,Ba:51456,La:7394559,Ce:16777159,Pr:14286791,Nd:13107143,Pm:10747847,Sm:9437127,Eu:6422471,Gd:4587463,Tb:3211207,Dy:2097095,Ho:65436,Er:58997,Tm:54354,Yb:48952,Lu:43812,Hf:5096191,Ta:5089023,W:2200790,Re:2522539,Os:2516630,Ir:1528967,Pt:13684960,Au:16765219,Hg:12105936,Tl:10900557,Pb:5724513,Bi:10375093,Po:11230208,At:7688005,Rn:4358806,Fr:4325478,Ra:32e3,Ac:7384058,Th:47871,Pa:41471,U:36863,Np:33023,Pu:27647,Am:5528818,Cm:7888099,Bk:9064419,Cf:10565332,Es:11739092,Fm:11739066,Md:11734438,No:12389767,Lr:13041766,Rf:13369433,Db:13697103,Sg:14221381,Bh:14680120,Hs:15073326,Mt:15400998},this.vdwRadii={H:1.2,Li:1.82,Na:2.27,K:2.75,C:1.7,N:1.55,O:1.52,F:1.47,P:1.8,S:1.8,CL:1.75,BR:1.85,SE:1.9,ZN:1.39,CU:1.4,NI:1.63},this.id=a,this.aaScale=d,this.container=jQuery("#"+this.id),this.WIDTH=this.container.width()*this.aaScale,this.HEIGHT=this.container.height()*this.aaScale,this.ASPECT=this.WIDTH/this.HEIGHT,this.NEAR=1,FAR=800,this.CAMERA_Z=-150,this.webglFailed=!0;try{if(c)throw"WebGL disabled";this.renderer=new THREE.WebGLRenderer({antialias:!0}),this.renderer.sortObjects=!1,this.renderer.domElement.style.width="100%",this.renderer.domElement.style.height="100%",this.container.append(this.renderer.domElement),this.renderer.setSize(this.WIDTH,this.HEIGHT),this.webglFailed=!1}catch(e){this.canvas2d=jQuery("<canvas></canvas"),this.container.append(this.canvas2d),this.canvas2d[0].height=this.HEIGHT,this.canvas2d[0].width=this.WIDTH}this.camera=new THREE.PerspectiveCamera(20,this.ASPECT,1,800),this.camera.position=new TV3(0,0,this.CAMERA_Z),this.camera.lookAt(new TV3(0,0,0)),this.perspectiveCamera=this.camera,this.orthoscopicCamera=new THREE.OrthographicCamera,this.orthoscopicCamera.position.z=this.CAMERA_Z,this.orthoscopicCamera.lookAt(new TV3(0,0,0)),this.scene=null,this.rotationGroup=null,this.modelGroup=null,this.bgColor=0,this.fov=20,this.fogStart=.4,this.slabNear=-50,this.slabFar=50,this.sphereRadius=1.5,this.cylinderRadius=.4,this.lineWidth=1.5*this.aaScale,this.curveWidth=3*this.aaScale,this.defaultColor=13421772,this.sphereQuality=16,this.cylinderQuality=16,this.axisDIV=5,this.strandDIV=6,this.nucleicAcidStrandDIV=4,this.tubeDIV=8,this.coilWidth=.3,this.helixSheetWidth=1.3,this.nucleicAcidWidth=.8,this.thickness=.4,this.cq=new THREE.Quaternion(1,0,0,0),this.dq=new THREE.Quaternion(1,0,0,0),this.isDragging=!1,this.isMultiDragging=!1,this.mouseStartX=0,this.mouseStartY=0,this.multiTouchD=0,this.zoom2D=30,this.canvas_atom_radius=.5,this.canvas_bond_width=.3,this.canvas_vdw=!1,this.multic={x:0,y:0},this.currentModelPos=0,this.cz=0,this.enableMouse(),b||this.loadMolecule()},a.prototype.resize=function(){this.WIDTH=this.container.width()*this.aaScale,this.HEIGHT=this.container.height()*this.aaScale,this.webglFailed?(this.canvas2d[0].height=this.HEIGHT,this.canvas2d[0].width=this.WIDTH):(this.ASPECT=this.WIDTH/this.HEIGHT,this.renderer.setSize(this.WIDTH,this.HEIGHT),this.camera.aspect=this.ASPECT,this.camera.updateProjectionMatrix()),this.show()},a.prototype.setupLights=function(a){var b=new THREE.DirectionalLight(16777215);b.position=new TV3(.2,.2,-1).normalize(),b.intensity=1.2,a.add(b);var c=new THREE.AmbientLight(2105376);a.add(c)},a.prototype.parseSDF=function(a){var b=this.atoms,c=this.protein,d=a.split("\n");if(!(d.length<4)){var e=parseInt(d[3].substr(0,3));if(!(isNaN(e)||0>=e)){var f=parseInt(d[3].substr(3,3)),g=4;if(!(d.length<4+e+f)){for(var h=1;e>=h;h++){var i=d[g];g++;var j={};j.serial=h,j.x=parseFloat(i.substr(0,10)),j.y=parseFloat(i.substr(10,10)),j.z=parseFloat(i.substr(20,10)),j.hetflag=!0,j.atom=j.elem=i.substr(31,3).replace(/ /g,""),j.bonds=[],j.bondOrder=[],b[h]=j}for(h=1;f>=h;h++){var i=d[g];g++;var k=parseInt(i.substr(0,3)),l=parseInt(i.substr(3,3)),m=parseInt(i.substr(6,3));b[k].bonds.push(l),b[k].bondOrder.push(m),b[l].bonds.push(k),b[l].bondOrder.push(m)}return c.smallMolecule=!0,!0}}}},a.prototype.parseXYZ=function(a){var b=this.atoms,c=this.protein,d=a.split("\n");if(!(d.length<3)){var e=parseInt(d[0].substr(0,3));if(!(isNaN(e)||0>=e||d.length<e+2)){for(var f=2,g=1;e>=g;g++){var h=d[f++],i=h.replace(/^\s+/,"").replace(/\s+/g," ").split(" "),j={};j.serial=g,j.atom=j.elem=i[0],j.x=parseFloat(i[1]),j.y=parseFloat(i[2]),j.z=parseFloat(i[3]),j.hetflag=!0,j.bonds=[],j.bondOrder=[],b[g]=j}for(var g=1;e>g;g++)for(var k=g+1;e>=k;k++)this.isConnected(b[g],b[k])&&(b[g].bonds.push(k),b[g].bondOrder.push(1),b[k].bonds.push(g),b[k].bondOrder.push(1));return c.smallMolecule=!0,!0}}},a.prototype.parsePDB2=function(a){var b=this.atoms,c=this.protein;lines=a.split("\n");for(var d=0;d<lines.length;d++){line=lines[d].replace(/^\s*/,"");var e=line.substr(0,6);if("ATOM  "==e||"HETATM"==e){var f,g,h,i,j,k,l,m,n,o,p,q;if(p=line.substr(16,1)," "!=p&&"A"!=p)continue;o=parseInt(line.substr(6,5)),f=line.substr(12,4).replace(/ /g,""),g=line.substr(17,3),h=line.substr(21,1),i=parseInt(line.substr(22,5)),j=parseFloat(line.substr(30,8)),k=parseFloat(line.substr(38,8)),l=parseFloat(line.substr(46,8)),q=parseFloat(line.substr(60,8)),n=line.substr(76,2).replace(/ /g,""),""==n&&(n=line.substr(12,4).replace(/ /g,"")),m="H"==line[0]?!0:!1,b[o]={resn:g,x:j,y:k,z:l,elem:n,hetflag:m,chain:h,resi:i,serial:o,atom:f,ss:"c",color:16777215,bonds:[],bondOrder:[],b:q}}else if("SHEET "==e){var r=line.substr(21,1),s=parseInt(line.substr(22,4)),t=line.substr(32,1),u=parseInt(line.substr(33,4));c.sheet.push([r,s,t,u])}else if("CONECT"==e)for(var v=parseInt(line.substr(6,5)),w=0;4>w;w++){var x=parseInt(line.substr([11,16,21,26][w],5));isNaN(x)||void 0!=b[v]&&(b[v].bonds.push(x),b[v].bondOrder.push(1))}else if("HELIX "==e){var r=line.substr(19,1),s=parseInt(line.substr(21,4)),t=line.substr(31,1),u=parseInt(line.substr(33,4));c.helix.push([r,s,t,u])}else if("CRYST1"==e)c.a=parseFloat(line.substr(6,9)),c.b=parseFloat(line.substr(15,9)),c.c=parseFloat(line.substr(24,9)),c.alpha=parseFloat(line.substr(33,7)),c.beta=parseFloat(line.substr(40,7)),c.gamma=parseFloat(line.substr(47,7)),c.spacegroup=line.substr(55,11),this.defineCell();else if("REMARK"==e){var y=parseInt(line.substr(7,3));if(290==y&&"SMTRY"==line.substr(13,5)){var z=parseInt(line[18])-1,A=parseInt(line.substr(21,2));void 0==c.symMat[A]&&(c.symMat[A]=(new THREE.Matrix4).identity()),c.symMat[A].elements[z]=parseFloat(line.substr(24,9)),c.symMat[A].elements[z+4]=parseFloat(line.substr(34,9)),c.symMat[A].elements[z+8]=parseFloat(line.substr(44,9)),c.symMat[A].elements[z+12]=parseFloat(line.substr(54,10))}else if(350==y&&"BIOMT"==line.substr(13,5)){var z=parseInt(line[18])-1,A=parseInt(line.substr(21,2));void 0==c.biomtMatrices[A]&&(c.biomtMatrices[A]=(new THREE.Matrix4).identity()),c.biomtMatrices[A].elements[z]=parseFloat(line.substr(24,9)),c.biomtMatrices[A].elements[z+4]=parseFloat(line.substr(34,9)),c.biomtMatrices[A].elements[z+8]=parseFloat(line.substr(44,9)),c.biomtMatrices[A].elements[z+12]=parseFloat(line.substr(54,10))}else 350==y&&"BIOMOLECULE"==line.substr(11,11)?(c.biomtMatrices=[],c.biomtChains=""):350==y&&"CHAINS"==line.substr(34,6)&&(c.biomtChains+=line.substr(41,40))}else"HEADER"==e?c.pdbID=line.substr(62,4):"TITLE "==e&&(void 0==c.title&&(c.title=""),c.title+=line.substr(10,70)+"\n")}for(d=0;d<b.length;d++)if(f=b[d],void 0!=f){for(w=0;w<c.sheet.length;w++)f.chain==c.sheet[w][0]&&(f.resi<c.sheet[w][1]||f.resi>c.sheet[w][3]||(f.ss="s",f.resi==c.sheet[w][1]&&(f.ssbegin=!0),f.resi==c.sheet[w][3]&&(f.ssend=!0)));for(w=0;w<c.helix.length;w++)f.chain==c.helix[w][0]&&(f.resi<c.helix[w][1]||f.resi>c.helix[w][3]||(f.ss="h",f.resi==c.helix[w][1]?f.ssbegin=!0:f.resi==c.helix[w][3]&&(f.ssend=!0)))}return c.smallMolecule=!1,!0},a.prototype.subdivide=function(a,b){var c=[],d=a;d=new Array,d.push(a[0]);for(var e=1,f=a.length-1;f>e;e++){var g=a[e],h=a[e+1];d.push(g.smoothen?new TV3((g.x+h.x)/2,(g.y+h.y)/2,(g.z+h.z)/2):g)}d.push(a[a.length-1]);for(var e=-1,i=d.length;i-3>=e;e++)for(var j=d[-1==e?0:e],g=d[e+1],h=d[e+2],k=d[e==i-3?i-1:e+3],l=(new TV3).sub(h,j).multiplyScalar(.5),m=(new TV3).sub(k,g).multiplyScalar(.5),n=0;b>n;n++){var o=1/b*n,p=g.x+o*l.x+o*o*(-3*g.x+3*h.x-2*l.x-m.x)+o*o*o*(2*g.x-2*h.x+l.x+m.x),q=g.y+o*l.y+o*o*(-3*g.y+3*h.y-2*l.y-m.y)+o*o*o*(2*g.y-2*h.y+l.y+m.y),r=g.z+o*l.z+o*o*(-3*g.z+3*h.z-2*l.z-m.z)+o*o*o*(2*g.z-2*h.z+l.z+m.z);c.push(new TV3(p,q,r))}return c.push(d[d.length-1]),c},a.prototype.drawAtomsAsSphere=function(a,b,c,d,e){for(var f=new THREE.SphereGeometry(1,this.sphereQuality,this.sphereQuality),g=0;g<b.length;g++){var h=this.atoms[b[g]];if(void 0!=h){var i=new THREE.MeshLambertMaterial({color:h.color}),j=new THREE.Mesh(f,i);a.add(j);var k=d||void 0==this.vdwRadii[h.elem]?c:this.vdwRadii[h.elem];!d&&e&&(k*=e),j.scale.x=j.scale.y=j.scale.z=k,j.position.x=h.x,j.position.y=h.y,j.position.z=h.z}}},a.prototype.drawAtomsAsIcosahedron=function(a,b,c,d){for(var e=this.IcosahedronGeometry(),f=0;f<b.length;f++){var g=this.atoms[b[f]];if(void 0!=g){var h=new THREE.MeshLambertMaterial({color:g.color}),i=new THREE.Mesh(e,h);i.scale.x=i.scale.y=i.scale.z=d||void 0==this.vdwRadii[g.elem]?c:this.vdwRadii[g.elem],a.add(i),i.position.x=g.x,i.position.y=g.y,i.position.z=g.z}}},a.prototype.isConnected=function(a,b){var c=a.bonds.indexOf(b.serial);if(-1!=c)return a.bondOrder[c];if(this.protein.smallMolecule&&(a.hetflag||b.hetflag))return 0;var d=(a.x-b.x)*(a.x-b.x)+(a.y-b.y)*(a.y-b.y)+(a.z-b.z)*(a.z-b.z);return isNaN(d)?0:.5>d?0:d>1.3&&("H"==a.elem||"H"==b.elem||"D"==a.elem||"D"==b.elem)?0:3.42>d&&("S"==a.elem||"S"==b.elem)?1:d>2.78?0:1},a.prototype.drawBondAsStickSub=function(a,b,c,d,e){var f,g;e>1&&(f=this.calcBondDelta(b,c,2.3*d));{var h=new TV3(b.x,b.y,b.z),i=new TV3(c.x,c.y,c.z),j=h.clone().addSelf(i).multiplyScalar(.5);new TCo(b.color),new TCo(c.color)}(1==e||3==e)&&(this.drawCylinder(a,h,j,d,b.color),this.drawCylinder(a,i,j,d,c.color)),e>1&&(g=j.clone().addSelf(f),this.drawCylinder(a,h.clone().addSelf(f),g,d,b.color),this.drawCylinder(a,i.clone().addSelf(f),g,d,c.color),g=j.clone().subSelf(f),this.drawCylinder(a,h.clone().subSelf(f),g,d,b.color),this.drawCylinder(a,i.clone().subSelf(f),g,d,c.color))},a.prototype.drawBondsAsStick=function(a,b,c,d,e,f,g){var h=(new THREE.SphereGeometry(1,this.sphereQuality,this.sphereQuality),b.length),i=[];f&&(c/=2.5);for(var j=0;h>j;j++){var k=b[j],l=this.atoms[k];if(void 0!=l){for(var m=j+1;j+30>m&&h>m;m++){var n=b[m],o=this.atoms[n];if(void 0!=o){var p=this.isConnected(l,o);0!=p&&(l.connected=o.connected=!0,this.drawBondAsStickSub(a,l,o,c,f?p:1))}}for(var m=0;m<l.bonds.length;m++){var n=l.bonds[m];if(!(k+30>n)&&-1!=b.indexOf(n)){var o=this.atoms[n];void 0!=o&&(l.connected=o.connected=!0,this.drawBondAsStickSub(a,l,o,c,f?l.bondOrder[m]:1))}}l.connected&&i.push(k)}}this.drawAtomsAsSphere(a,i,d,!g,g)},a.prototype.defineCell=function(){var a=this.protein;void 0!=a.a&&(a.ax=a.a,a.ay=0,a.az=0,a.bx=a.b*Math.cos(Math.PI/180*a.gamma),a.by=a.b*Math.sin(Math.PI/180*a.gamma),a.bz=0,a.cx=a.c*Math.cos(Math.PI/180*a.beta),a.cy=a.c*(Math.cos(Math.PI/180*a.alpha)-Math.cos(Math.PI/180*a.gamma)*Math.cos(Math.PI/180*a.beta)/Math.sin(Math.PI/180*a.gamma)),a.cz=Math.sqrt(a.c*a.c*Math.sin(Math.PI/180*a.beta)*Math.sin(Math.PI/180*a.beta)-a.cy*a.cy))},a.prototype.drawUnitcell=function(a){var b=this.protein;if(void 0!=b.a){for(var c=[[0,0,0],[b.ax,b.ay,b.az],[b.bx,b.by,b.bz],[b.ax+b.bx,b.ay+b.by,b.az+b.bz],[b.cx,b.cy,b.cz],[b.cx+b.ax,b.cy+b.ay,b.cz+b.az],[b.cx+b.bx,b.cy+b.by,b.cz+b.bz],[b.cx+b.ax+b.bx,b.cy+b.ay+b.by,b.cz+b.az+b.bz]],d=[0,1,0,2,1,3,2,3,4,5,4,6,5,7,6,7,0,4,1,5,2,6,3,7],e=new THREE.Geometry,f=0;f<d.length;f++)e.vertices.push(new TV3(c[d[f]][0],c[d[f]][1],c[d[f]][2]));var g=new THREE.LineBasicMaterial({linewidth:1,color:13421772}),h=new THREE.Line(e,g);h.type=THREE.LinePieces,a.add(h)}},a.prototype.calcBondDelta=function(a,b,c){for(var d,e=new TV3(a.x-b.x,a.y-b.y,a.z-b.z).normalize(),f=null,g=0;g<a.bonds.length&&!f;g++){var h=this.atoms[a.bonds[g]];h&&h.serial!=b.serial&&"H"!=h.elem&&(f=h)}for(var g=0;g<b.bonds.length&&!f;g++){var h=this.atoms[b.bonds[g]];h&&h.serial!=a.serial&&"H"!=h.elem&&(f=h)}if(f){var i=new TV3(a.x-f.x,a.y-f.y,a.z-f.z).normalize();d=i.dot(e),delta=new TV3(i.x-e.x*d,i.y-e.y*d,i.z-e.z*d)}return(!f||Math.abs(d-1)<.001||Math.abs(d+1)<.001)&&(delta=e.x<.01&&e.y<.01?new TV3(0,-e.z,e.y):new TV3(-e.y,e.x,0)),delta.normalize().multiplyScalar(c),delta},a.prototype.drawBondsAsLineSub=function(a,b,c,d){var e,f,g=a.vertices,h=a.colors;d>1&&(e=this.calcBondDelta(b,c,.15));var i=new TV3(b.x,b.y,b.z),j=new TV3(c.x,c.y,c.z),k=i.clone().addSelf(j).multiplyScalar(.5),l=new TCo(b.color),m=new TCo(c.color);(1==d||3==d)&&(g.push(i),h.push(l),g.push(k),h.push(l),g.push(j),h.push(m),g.push(k),h.push(m)),d>1&&(g.push(i.clone().addSelf(e)),h.push(l),g.push(f=k.clone().addSelf(e)),h.push(l),g.push(j.clone().addSelf(e)),h.push(m),g.push(f),h.push(m),g.push(i.clone().subSelf(e)),h.push(l),g.push(f=k.clone().subSelf(e)),h.push(l),g.push(j.clone().subSelf(e)),h.push(m),g.push(f),h.push(m))},a.prototype.drawBondsAsLine=function(a,b,c){for(var d=new THREE.Geometry,e=b.length,f=0;e>f;f++){var g=b[f],h=this.atoms[g];if(void 0!=h){for(var i=f+1;f+30>i&&e>i;i++){var j=b[i],k=this.atoms[j];if(void 0!=k){var l=this.isConnected(h,k);0!=l&&this.drawBondsAsLineSub(d,h,k,l)}}for(var i=0;i<h.bonds.length;i++){var j=h.bonds[i];if(!(g+30>j)&&-1!=b.indexOf(j)){var k=this.atoms[j];void 0!=k&&this.drawBondsAsLineSub(d,h,k,h.bondOrder[i])}}}}var m=new THREE.LineBasicMaterial({linewidth:c});m.vertexColors=!0;var n=new THREE.Line(d,m);n.type=THREE.LinePieces,a.add(n)},a.prototype.drawSmoothCurve=function(a,b,c,d,e){if(0!=b.length){e=void 0==e?5:e;for(var f=new THREE.Geometry,g=this.subdivide(b,e),h=0;h<g.length;h++)f.vertices.push(g[h]),f.colors.push(new TCo(d[0==h?0:Math.round((h-1)/e)]));var i=new THREE.LineBasicMaterial({linewidth:c});i.vertexColors=!0;var j=new THREE.Line(f,i);j.type=THREE.LineStrip,a.add(j)}},a.prototype.drawAsCross=function(a,b,c){for(var d=new THREE.Geometry,e=[[c,0,0],[-c,0,0],[0,c,0],[0,-c,0],[0,0,c],[0,0,-c]],f=0,g=b.length;g>f;f++){var h=this.atoms[b[f]];if(void 0!=h)for(var i=new TCo(h.color),j=0;6>j;j++)d.vertices.push(new TV3(h.x+e[j][0],h.y+e[j][1],h.z+e[j][2])),d.colors.push(i)}var k=new THREE.LineBasicMaterial({linewidth:this.lineWidth});k.vertexColors=!0;var l=new THREE.Line(d,k,THREE.LinePieces);a.add(l)},a.prototype.drawSmoothTube=function(a,b,c,d){if(!(b.length<2)){for(var e,f=this.tubeDIV,g=this.axisDIV,h=new THREE.Geometry,i=this.subdivide(b,g),j=new TV3,k=0,l=i.length;l>k;k++){var m,n=(k-1)/g;if(0==k)m=d[0];else if(n%1==0)m=d[n];else{var o=Math.floor(n),p=n-o;m=d[o]*p+d[o+1]*(1-p)}var q,r,s;l-1>k?(q=(new TV3).sub(i[k],i[k+1]),r=new TV3(0,-q.z,q.y).normalize().multiplyScalar(m),s=(new TV3).cross(q,r).normalize().multiplyScalar(m),j.dot(r)<0&&(r.negate(),s.negate()),j=r,e=s):(r=j,s=e);for(var t=0;f>t;t++){var u=2*Math.PI/f*t,v=Math.cos(u),w=Math.sin(u);h.vertices.push(new TV3(i[k].x+v*r.x+w*s.x,i[k].y+v*r.y+w*s.y,i[k].z+v*r.z+w*s.z))}}for(var x=0,k=0,l=i.length-1;l>k;k++){var v=new TCo(c[Math.round((k-1)/g)]),y=0,z=(new TV3).sub(h.vertices[x],h.vertices[x+f]).lengthSq(),A=(new TV3).sub(h.vertices[x],h.vertices[x+f+1]).lengthSq();z>A&&(z=A,y=1);for(var t=0;f>t;t++)h.faces.push(new TF3(x+t,x+(t+y)%f+f,x+(t+1)%f)),h.faces.push(new TF3(x+(t+1)%f,x+(t+y)%f+f,x+(t+y+1)%f+f)),h.faces[h.faces.length-2].color=v,h.faces[h.faces.length-1].color=v;x+=f}h.computeFaceNormals(),h.computeVertexNormals(!1);var B=new THREE.MeshLambertMaterial;B.vertexColors=THREE.FaceColors;var C=new THREE.Mesh(h,B);C.doubleSided=!0,a.add(C)}},a.prototype.drawMainchainCurve=function(a,b,c,d,e){var f,g,h=[],i=[];void 0==e&&(e=5);for(var j in b){var k=this.atoms[b[j]];void 0!=k&&(k.atom!=d||k.hetflag||((f!=k.chain||g+1!=k.resi)&&(this.drawSmoothCurve(a,h,c,i,e),h=[],i=[]),h.push(new TV3(k.x,k.y,k.z)),i.push(k.color),f=k.chain,g=k.resi))}this.drawSmoothCurve(a,h,c,i,e)},a.prototype.drawMainchainTube=function(a,b,c,d){var e,f,g=[],h=[],i=[];for(var j in b){var k=this.atoms[b[j]];void 0!=k&&(k.atom!=c||k.hetflag||((e!=k.chain||f+1!=k.resi)&&(this.drawSmoothTube(a,g,h,i),g=[],h=[],i=[]),g.push(new TV3(k.x,k.y,k.z)),i.push(void 0==d?k.b>0?k.b/100:.3:d),h.push(k.color),e=k.chain,f=k.resi))}this.drawSmoothTube(a,g,h,i)},a.prototype.drawStrip=function(a,b,c,d,e,f){if(!(b.length<2)){if(e=e||this.axisDIV,b=this.subdivide(b,e),c=this.subdivide(c,e),!f)return this.drawThinStrip(a,b,c,d,e);for(var g,h,i,j,k,l=new THREE.Geometry,m=l.vertices,n=l.faces,o=0,p=b.length;p>o;o++){if(m.push(h=b[o]),m.push(h),m.push(i=c[o]),m.push(i),p-1>o){var q=b[o+1].clone().subSelf(b[o]),r=c[o].clone().subSelf(b[o]);g=r.crossSelf(q).normalize().multiplyScalar(f)}m.push(j=b[o].clone().addSelf(g)),m.push(j),m.push(k=c[o].clone().addSelf(g)),m.push(k)}for(var s=[[0,2,-6,-8],[-4,-2,6,4],[7,3,-5,-1],[-3,-7,1,5]],o=1,p=b.length;p>o;o++)for(var t=8*o,u=new TCo(d[Math.round((o-1)/e)]),v=0;4>v;v++){var w=new THREE.Face4(t+s[v][0],t+s[v][1],t+s[v][2],t+s[v][3],void 0,u);n.push(w)}for(var x=m.length-8,o=0;4>o;o++)m.push(m[2*o]),m.push(m[x+2*o]);x+=8,n.push(new THREE.Face4(x,x+2,x+6,x+4,void 0,n[0].color)),n.push(new THREE.Face4(x+1,x+5,x+7,x+3,void 0,n[n.length-3].color)),l.computeFaceNormals(),l.computeVertexNormals(!1);var y=new THREE.MeshLambertMaterial;y.vertexColors=THREE.FaceColors;var z=new THREE.Mesh(l,y);z.doubleSided=!0,a.add(z)}},a.prototype.drawThinStrip=function(a,b,c,d,e){for(var f=new THREE.Geometry,g=0,h=b.length;h>g;g++)f.vertices.push(b[g]),f.vertices.push(c[g]);for(var g=1,h=b.length;h>g;g++){var i=new THREE.Face4(2*g,2*g+1,2*g-1,2*g-2);i.color=new TCo(d[Math.round((g-1)/e)]),f.faces.push(i)}f.computeFaceNormals(),f.computeVertexNormals(!1);var j=new THREE.MeshLambertMaterial;j.vertexColors=THREE.FaceColors;var k=new THREE.Mesh(f,j);k.doubleSided=!0,a.add(k)},a.prototype.IcosahedronGeometry=function(){return this.icosahedron||(this.icosahedron=new THREE.IcosahedronGeometry(1)),this.icosahedron},a.prototype.drawCylinder=function(a,b,c,d,e,f){if(b&&c){var g=(new TV3).add(b,c).multiplyScalar(.5),e=new TCo(e);this.cylinderGeometry||(this.cylinderGeometry=new THREE.CylinderGeometry(1,1,1,this.cylinderQuality,1,!f),this.cylinderGeometry.faceUvs=[],this.faceVertexUvs=[]);var h=new THREE.MeshLambertMaterial({color:e.getHex()}),i=new THREE.Mesh(this.cylinderGeometry,h);i.position=g,i.lookAt(b),i.updateMatrix(),i.matrixAutoUpdate=!1;var j=(new THREE.Matrix4).makeScale(d,d,b.distanceTo(c));j.rotateX(Math.PI/2),i.matrix.multiplySelf(j),a.add(i)}},a.prototype.drawHelixAsCylinder=function(a,b,c){var d,e,f=null,g=[],h=[];for(var i in b){var j=this.atoms[b[i]];void 0==j||j.hetflag||(("h"!=j.ss&&"s"!=j.ss||j.ssend||j.ssbegin)&&g.push(j.serial),"s"==j.ss&&h.push(j.serial),"CA"==j.atom&&("h"==j.ss&&j.ssend&&(null!=f&&this.drawCylinder(a,new TV3(f.x,f.y,f.z),new TV3(j.x,j.y,j.z),c,j.color,!0),f=null),d=j.chain,e=j.resi,null==f&&"h"==j.ss&&j.ssbegin&&(f=j)))}null!=f&&this.drawCylinder(a,new TV3(f.x,f.y,f.z),new TV3(j.x,j.y,j.z),c,j.color),this.drawMainchainTube(a,g,"CA",.3),this.drawStrand(a,h,void 0,void 0,!0,0,this.helixSheetWidth,!1,2*this.thickness)},a.prototype.drawCartoon=function(a,b,c,d){this.drawStrand(a,b,2,void 0,!0,void 0,void 0,c,d)},a.prototype.drawStrand=function(a,b,c,d,e,f,g,h,i){c=c||this.strandDIV,d=d||this.axisDIV,f=f||this.coilWidth,g=g||this.helixSheetWidth;for(var j=[],k=0;c>k;k++)j[k]=[];var l,m,n,o=[],p=null,q=null,r=!1;for(var s in b){var t=this.atoms[b[s]];if(void 0!=t&&("O"==t.atom||"CA"==t.atom)&&!t.hetflag)if("CA"==t.atom){if(l!=t.chain||m+1!=t.resi){for(var u=0;!i&&c>u;u++)this.drawSmoothCurve(a,j[u],1,o,d);e&&this.drawStrip(a,j[0],j[c-1],o,d,i);for(var j=[],k=0;c>k;k++)j[k]=[];o=[],p=null,q=null,r=!1}n=new TV3(t.x,t.y,t.z),l=t.chain,m=t.resi,q=t.ss,r=t.ssstart||t.ssend,o.push(t.color)}else{var v=new TV3(t.x,t.y,t.z);v.subSelf(n),v.normalize(),v.multiplyScalar("c"==q?f:g),void 0!=p&&v.dot(p)<0&&v.negate(),p=v;for(var u=0;c>u;u++){var w=-1+2/(c-1)*u,x=new TV3(n.x+p.x*w,n.y+p.y*w,n.z+p.z*w);h||"s"!=q||(x.smoothen=!0),j[u].push(x)}}}for(var u=0;!i&&c>u;u++)this.drawSmoothCurve(a,j[u],1,o,d);e&&this.drawStrip(a,j[0],j[c-1],o,d,i)},a.prototype.drawNucleicAcidLadderSub=function(a,b,c,d){if(void 0!=c[0]&&void 0!=c[1]&&void 0!=c[2]&&void 0!=c[3]&&void 0!=c[4]&&void 0!=c[5]){for(var e=a.vertices.length,f=0;5>=f;f++)a.vertices.push(c[f]);a.faces.push(new TF3(e,e+1,e+2)),a.faces.push(new TF3(e,e+2,e+3)),a.faces.push(new TF3(e,e+3,e+4)),a.faces.push(new TF3(e,e+4,e+5));for(var g=a.faces.length-4,h=a.faces.length;h>g;g++)a.faces[g].color=d}if(void 0!=c[4]&&void 0!=c[3]&&void 0!=c[6]&&void 0!=c[7]&&void 0!=c[8]){var e=a.vertices.length;a.vertices.push(c[4]),a.vertices.push(c[3]),a.vertices.push(c[6]),a.vertices.push(c[7]),a.vertices.push(c[8]);for(var f=0;4>=f;f++)a.colors.push(d);a.faces.push(new TF3(e,e+1,e+2)),a.faces.push(new TF3(e,e+2,e+3)),a.faces.push(new TF3(e,e+3,e+4));for(var g=a.faces.length-3,h=a.faces.length;h>g;g++)a.faces[g].color=d}},a.prototype.drawNucleicAcidLadder=function(a,b){var c,d,e=new THREE.Geometry,f=new THREE.Geometry,g=["N1","C2","N3","C4","C5","C6","N9","C8","N7"],h=new Array(g.length),i=new TCo(13369344);for(var j in b){var k=this.atoms[b[j]];if(void 0!=k&&!k.hetflag){(k.resi!=d||k.chain!=c)&&(this.drawNucleicAcidLadderSub(e,f,h,i),h=new Array(g.length));var l=g.indexOf(k.atom);-1!=l&&(h[l]=new TV3(k.x,k.y,k.z)),"O3'"==k.atom&&(i=new TCo(k.color)),d=k.resi,c=k.chain}}this.drawNucleicAcidLadderSub(e,f,h,i),e.computeFaceNormals();var m=new THREE.MeshLambertMaterial;m.vertexColors=THREE.VertexColors;var n=new THREE.Mesh(e,m);n.doubleSided=!0,a.add(n)},a.prototype.drawNucleicAcidStick=function(a,b){var c,d,e=null,f=null;for(var g in b){var h=this.atoms[b[g]];void 0==h||h.hetflag||((h.resi!=d||h.chain!=c)&&(null!=e&&null!=f&&this.drawCylinder(a,new TV3(e.x,e.y,e.z),new TV3(f.x,f.y,f.z),.3,e.color,!0),e=null,f=null),"O3'"==h.atom&&(e=h),"  A"==h.resn||"  G"==h.resn||" DA"==h.resn||" DG"==h.resn?"N1"==h.atom&&(f=h):"N3"==h.atom&&(f=h),d=h.resi,c=h.chain)}null!=e&&null!=f&&this.drawCylinder(a,new TV3(e.x,e.y,e.z),new TV3(f.x,f.y,f.z),.3,e.color,!0)},a.prototype.drawNucleicAcidLine=function(a,b){var c,d,e=null,f=null,g=new THREE.Geometry;for(var h in b){var i=this.atoms[b[h]];void 0==i||i.hetflag||((i.resi!=d||i.chain!=c)&&(null!=e&&null!=f&&(g.vertices.push(new TV3(e.x,e.y,e.z)),g.colors.push(new TCo(e.color)),g.vertices.push(new TV3(f.x,f.y,f.z)),g.colors.push(new TCo(e.color))),e=null,f=null),"O3'"==i.atom&&(e=i),"  A"==i.resn||"  G"==i.resn||" DA"==i.resn||" DG"==i.resn?"N1"==i.atom&&(f=i):"N3"==i.atom&&(f=i),d=i.resi,c=i.chain)}null!=e&&null!=f&&(g.vertices.push(new TV3(e.x,e.y,e.z)),g.colors.push(new TCo(e.color)),g.vertices.push(new TV3(f.x,f.y,f.z)),g.colors.push(new TCo(e.color)));var j=new THREE.LineBasicMaterial({linewidth:1,linejoin:!1});j.linewidth=1.5,j.vertexColors=!0;var k=new THREE.Line(g,j,THREE.LinePieces);a.add(k)},a.prototype.drawCartoonNucleicAcid=function(a,b,c,d){this.drawStrandNucleicAcid(a,b,2,c,!0,void 0,d)},a.prototype.drawStrandNucleicAcid=function(a,b,c,d,e,f,g){f=f||this.nucleicAcidWidth,d=d||this.axisDIV,c=c||this.nucleicAcidStrandDIV;
for(var h=[],i=0;c>i;i++)h[i]=[];var j,k,l,m=[],n=null;for(var o in b){var p=this.atoms[b[o]];if(void 0!=p&&("O3'"==p.atom||"OP2"==p.atom)&&!p.hetflag)if("O3'"==p.atom){if(j!=p.chain||k+1!=p.resi){if(l)for(var q=0;c>q;q++){var r=-1+2/(c-1)*q;h[q].push(new TV3(l.x+n.x*r,l.y+n.y*r,l.z+n.z*r))}e&&this.drawStrip(a,h[0],h[1],m,d,g);for(var q=0;!g&&c>q;q++)this.drawSmoothCurve(a,h[q],1,m,d);for(var h=[],i=0;c>i;i++)h[i]=[];m=[],n=null}l=new TV3(p.x,p.y,p.z),j=p.chain,k=p.resi,m.push(p.color)}else{if(!l){n=null;continue}var s=new TV3(p.x,p.y,p.z);s.subSelf(l),s.normalize().multiplyScalar(f),void 0!=n&&s.dot(n)<0&&s.negate(),n=s;for(var q=0;c>q;q++){var r=-1+2/(c-1)*q;h[q].push(new TV3(l.x+n.x*r,l.y+n.y*r,l.z+n.z*r))}l=null}}if(l)for(var q=0;c>q;q++){var r=-1+2/(c-1)*q;h[q].push(new TV3(l.x+n.x*r,l.y+n.y*r,l.z+n.z*r))}e&&this.drawStrip(a,h[0],h[1],m,d,g);for(var q=0;!g&&c>q;q++)this.drawSmoothCurve(a,h[q],1,m,d)},a.prototype.drawDottedLines=function(a,b,c){for(var d=new THREE.Geometry,e=.3,f=0,g=Math.floor(b.length/2);g>f;f++){var h=b[2*f],i=b[2*f+1],j=i.clone().subSelf(h),k=j.length();j.normalize().multiplyScalar(e);for(var l=Math.floor(k/e),m=0;l>m;m++){var n=new TV3(h.x+j.x*m,h.y+j.y*m,h.z+j.z*m);d.vertices.push(n)}l%2==1&&d.vertices.push(i)}var o=new THREE.LineBasicMaterial({color:c.getHex()});o.linewidth=2;var p=new THREE.Line(d,o,THREE.LinePieces);a.add(p)},a.prototype.getAllAtoms=function(){var a=[];for(var b in this.atoms)a.push(this.atoms[b].serial);return a},a.prototype.getHetatms=function(a){var b=[];for(var c in a){var d=this.atoms[a[c]];void 0!=d&&d.hetflag&&b.push(d.serial)}return b},a.prototype.removeSolvents=function(a){var b=[];for(var c in a){var d=this.atoms[a[c]];void 0!=d&&"HOH"!=d.resn&&b.push(d.serial)}return b},a.prototype.getProteins=function(a){var b=[];for(var c in a){var d=this.atoms[a[c]];void 0!=d&&(d.hetflag||b.push(d.serial))}return b},a.prototype.excludeAtoms=function(a,b){var c=[],d=new Object;for(var e in b)d[b[e]]=!0;for(var e in a){var f=a[e];d[f]||c.push(f)}return c},a.prototype.getSidechains=function(a){var b=[];for(var c in a){var d=this.atoms[a[c]];void 0!=d&&(d.hetflag||"C"==d.atom||"O"==d.atom||"N"==d.atom&&"PRO"!=d.resn||b.push(d.serial))}return b},a.prototype.getAtomsWithin=function(a,b){var c=[];for(var d in a){var e=this.atoms[a[d]];void 0!=e&&(e.x<b[0][0]||e.x>b[1][0]||e.y<b[0][1]||e.y>b[1][1]||e.z<b[0][2]||e.z>b[1][2]||c.push(e.serial))}return c},a.prototype.getExtent=function(a){var b=ymin=zmin=9999,c=ymax=zmax=-9999,d=ysum=zsum=cnt=0;for(var e in a){var f=this.atoms[a[e]];void 0!=f&&(cnt++,d+=f.x,ysum+=f.y,zsum+=f.z,b=b<f.x?b:f.x,ymin=ymin<f.y?ymin:f.y,zmin=zmin<f.z?zmin:f.z,c=c>f.x?c:f.x,ymax=ymax>f.y?ymax:f.y,zmax=zmax>f.z?zmax:f.z)}return[[b,ymin,zmin],[c,ymax,zmax],[d/cnt,ysum/cnt,zsum/cnt]]},a.prototype.getResiduesById=function(a,b){var c=[];for(var d in a){var e=this.atoms[a[d]];void 0!=e&&-1!=b.indexOf(e.resi)&&c.push(e.serial)}return c},a.prototype.getResidueBySS=function(a,b){var c=[];for(var d in a){var e=this.atoms[a[d]];void 0!=e&&-1!=b.indexOf(e.ss)&&c.push(e.serial)}return c},a.prototype.getChain=function(a,b){var c=[],d={};b=b.toString();for(var e=0,f=b.length;f>e;e++)d[b.substr(e,1)]=!0;for(var e in a){var g=this.atoms[a[e]];void 0!=g&&d[g.chain]&&c.push(g.serial)}return c},a.prototype.getNonbonded=function(a){var b=[];for(var c in a){var d=this.atoms[a[c]];void 0!=d&&d.hetflag&&0==d.bonds.length&&b.push(d.serial)}return b},a.prototype.colorByAtom=function(a,b){for(var c in a){var d=this.atoms[a[c]];if(void 0!=d){var e=b[d.elem];void 0==e&&(e=this.ElementColors[d.elem]),void 0==e&&(e=this.defaultColor),d.color=e}}},a.prototype.colorByStructure=function(a,b,c,d){for(var e in a){var f=this.atoms[a[e]];void 0!=f&&(d||"CA"==f.atom&&!f.hetflag)&&("s"==f.ss[0]?f.color=c:"h"==f.ss[0]&&(f.color=b))}},a.prototype.colorByBFactor=function(a,b){var c=1e3,d=-1e3;for(var e in a){var f=this.atoms[a[e]];void 0!=f&&(f.hetflag||(b||"CA"==f.atom||"O3'"==f.atom)&&(c>f.b&&(c=f.b),d<f.b&&(d=f.b)))}var g=(d+c)/2,h=(d-c)/2;if(!(.01>h&&h>-.01))for(var e in a){var f=this.atoms[a[e]];if(void 0!=f&&!f.hetflag&&(b||"CA"==f.atom||"O3'"==f.atom)){var i=new TCo(0);f.b<g?i.setHSV(.667,(g-f.b)/h,1):i.setHSV(0,(f.b-g)/h,1),f.color=i.getHex()}}},a.prototype.colorByChain=function(a,b){for(var c in a){var d=this.atoms[a[c]];if(void 0!=d&&!d.hetflag&&(b||"CA"==d.atom||"O3'"==d.atom)){var e=new TCo(0);e.setHSV(5*d.chain.charCodeAt(0)%17/17,1,.9),d.color=e.getHex()}}},a.prototype.colorByResidue=function(a,b){for(var d in a){var e=this.atoms[a[d]];void 0!=e&&(c=b[e.resn],void 0!=c&&(e.color=c))}},a.prototype.colorAtoms=function(a,b){for(var c in a){var d=this.atoms[a[c]];void 0!=d&&(d.color=b)}},a.prototype.colorByPolarity=function(a,b,c){var d=["ARG","HIS","LYS","ASP","GLU","SER","THR","ASN","GLN","CYS"],e=["GLY","PRO","ALA","VAL","LEU","ILE","MET","PHE","TYR","TRP"],f={};for(var g in d)f[d[g]]=b;for(g in e)f[e[g]]=c;this.colorByResidue(a,f)},a.prototype.colorChainbow=function(a,b){var c,d,e=0;for(d in a)c=this.atoms[a[d]],void 0!=c&&(!b&&"CA"==c.atom&&"O3'"==c.atom||c.hetflag||e++);var f=e;e=0;for(d in a)if(c=this.atoms[a[d]],void 0!=c&&(b||"CA"!=c.atom||"O3'"!=c.atom)&&!c.hetflag){var g=new TCo(0);g.setHSV(240/360*(1-e/f),1,.9),c.color=g.getHex(),e++}},a.prototype.drawSymmetryMates2=function(a,b,c){if(void 0!=c){b.matrixAutoUpdate=!1;var d=1;this.protein.appliedMatrix=new THREE.Matrix4;for(var e=0;e<c.length;e++){var f=c[e];if(void 0!=f&&!f.isIdentity()){var g=THREE.SceneUtils.cloneObject(b);g.matrix=f,a.add(g);for(var h=0;16>h;h++)this.protein.appliedMatrix.elements[h]+=f.elements[h];d++}}this.protein.appliedMatrix.multiplyScalar(d)}},a.prototype.drawSymmetryMatesWithTranslation2=function(a,b,c){if(void 0!=c){var d=this.protein;b.matrixAutoUpdate=!1;for(var e=0;e<c.length;e++){var f=c[e];if(void 0!=f)for(var g=-1;0>=g;g++)for(var h=-1;0>=h;h++)for(var i=-1;0>=i;i++){var j=(new THREE.Matrix4).makeTranslation(d.ax*g+d.bx*h+d.cx*i,d.ay*g+d.by*h+d.cy*i,d.az*g+d.bz*h+d.cz*i),k=f.clone().multiplySelf(j);if(!k.isIdentity()){var l=THREE.SceneUtils.cloneObject(b);l.matrix=k,a.add(l)}}}}},a.prototype.defineRepresentation=function(){var a=this.getAllAtoms(),b=this.removeSolvents(this.getHetatms(a));this.colorByAtom(a,{}),this.colorByChain(a),this.drawAtomsAsSphere(this.modelGroup,b,this.sphereRadius),this.drawMainchainCurve(this.modelGroup,a,this.curveWidth,"P"),this.drawCartoon(this.modelGroup,a,this.curveWidth)},a.prototype.getView=function(){if(!this.modelGroup)return[0,0,0,0,0,0,0,1];var a=this.modelGroup.position,b=this.rotationGroup.quaternion;return[a.x,a.y,a.z,this.rotationGroup.position.z,b.x,b.y,b.z,b.w]},a.prototype.setView=function(a){this.modelGroup&&this.rotationGroup&&(this.modelGroup.position.x=a[0],this.modelGroup.position.y=a[1],this.modelGroup.position.z=a[2],this.rotationGroup.position.z=a[3],this.rotationGroup.quaternion.x=a[4],this.rotationGroup.quaternion.y=a[5],this.rotationGroup.quaternion.z=a[6],this.rotationGroup.quaternion.w=a[7],this.show())},a.prototype.setBackground=function(a,b){b=1|b,this.bgColor=a,this.renderer&&this.renderer.setClearColorHex(a,b),this.scene.fog.color=new TCo(a)},a.prototype.initializeScene=function(){this.scene=new THREE.Scene,this.scene.fog=new THREE.Fog(this.bgColor,100,200),this.modelGroup=new THREE.Object3D,this.rotationGroup=new THREE.Object3D,this.rotationGroup.useQuaternion=!0,this.rotationGroup.quaternion=new THREE.Quaternion(1,0,0,0),this.rotationGroup.add(this.modelGroup),this.scene.add(this.rotationGroup),this.setupLights(this.scene)},a.prototype.zoomInto=function(a,b){var c=this.getExtent(a),d=new TV3(c[2][0],c[2][1],c[2][2]);this.protein.appliedMatrix&&(d=this.protein.appliedMatrix.multiplyVector3(d)),this.modelGroup.position=d.multiplyScalar(-1);var e=c[1][0]-c[0][0],f=c[1][1]-c[0][1],g=c[1][2]-c[0][2],h=Math.sqrt(e*e+f*f+g*g);25>h&&(h=25),b||(this.slabNear=-h/1.9,this.slabFar=h/3),this.rotationGroup.position.z=.35*h/Math.tan(Math.PI/180*this.camera.fov/2)-150,this.rotationGroup.quaternion=new THREE.Quaternion(1,0,0,0)},a.prototype.rebuildScene=function(){time=new Date;var a=this.getView();this.initializeScene(),this.defineRepresentation(),this.setView(a)},a.prototype.loadMolecule=function(a){this.loadMoleculeStr(a,jQuery("#"+this.id+"_src").val())},a.prototype.loadMoleculeStr=function(a,b){new Date;this.protein={sheet:[],helix:[],biomtChains:"",biomtMatrices:[],symMat:[],pdbID:"",title:""},this.atoms=[],this.parsePDB2(b),this.parseSDF(b)||this.parseXYZ(b);var c=jQuery("#"+this.id+"_pdbTitle"),d="";""!=this.protein.pdbID&&(d+='<a href="http://www.rcsb.org/pdb/explore/explore.do?structureId='+this.protein.pdbID+'">'+this.protein.pdbID+"</a>"),""!=this.protein.title&&(d+="<br>"+this.protein.title),c.html(d),this.rebuildScene(!0),void 0!=a&&a||this.zoomInto(this.getAllAtoms()),this.show()},a.prototype.setSlabAndFog=function(){var a=this.rotationGroup.position.z-this.camera.position.z;1>a&&(a=1),this.camera.near=a+this.slabNear,this.camera.near<1&&(this.camera.near=1),this.camera.far=a+this.slabFar,this.camera.near+1>this.camera.far&&(this.camera.far=this.camera.near+1),this.camera instanceof THREE.PerspectiveCamera?this.camera.fov=this.fov:(this.camera.right=a*Math.tan(Math.PI/180*this.fov),this.camera.left=-this.camera.right,this.camera.top=this.camera.right/this.ASPECT,this.camera.bottom=-this.camera.top),this.camera.updateProjectionMatrix(),this.scene.fog.near=this.camera.near+this.fogStart*(this.camera.far-this.camera.near),this.scene.fog.far=this.camera.far},a.prototype.enableMouse=function(){var a=this,b=jQuery(this.container);b.bind("mousedown touchstart",function(b){if(b.preventDefault(),a.scene){var c=b.pageX,d=b.pageY;if(b.originalEvent.targetTouches&&b.originalEvent.targetTouches[0]&&(c=b.originalEvent.targetTouches[0].pageX,d=b.originalEvent.targetTouches[0].pageY),b.originalEvent.targetTouches&&b.originalEvent.targetTouches.length>1){var e=b.originalEvent.targetTouches,f=e[0].pageX-e[1].pageX,g=e[0].pageY-e[1].pageY;a.multiTouchD=Math.sqrt(f*f+g*g)}void 0!=c&&(a.isDragging=!0,a.mouseButton=b.which,a.mouseStartX=c,a.mouseStartY=d,a.cq=a.rotationGroup.quaternion,a.cz=a.rotationGroup.position.z,a.currentModelPos=a.modelGroup.position.clone(),a.cslabNear=a.slabNear,a.cslabFar=a.slabFar)}}),b.bind("DOMMouseScroll mousewheel",function(b){if(b.preventDefault(),a.scene){var c=.85*(a.rotationGroup.position.z-a.CAMERA_Z);b.originalEvent.detail?a.rotationGroup.position.z+=c*b.originalEvent.detail/10:b.originalEvent.wheelDelta&&(a.rotationGroup.position.z-=c*b.originalEvent.wheelDelta/400),a.show()}}),b.bind("contextmenu",function(a){a.preventDefault()}),jQuery(window).bind("mouseup touchend",function(){a.isDragging=!1,a.isMultiDragging=!1}),jQuery(window).bind("mousemove touchmove",function(b){if(a.scene&&a.isDragging){b.preventDefault();var c=0,d=b.pageX,e=b.pageY;if(b.originalEvent.targetTouches&&b.originalEvent.targetTouches[0]&&(d=b.originalEvent.targetTouches[0].pageX,e=b.originalEvent.targetTouches[0].pageY),b.originalEvent.targetTouches&&b.originalEvent.targetTouches.length>1){var f=b.originalEvent.targetTouches,g=f[0].pageX-f[1].pageX,h=f[0].pageY-f[1].pageY;a.isMultiDragging=!0;var i=Math.sqrt(g*g+h*h),j=i/a.multiTouchD;a.multiTouchD=i;var k=.85*(a.rotationGroup.position.z-a.CAMERA_Z);a.rotationGroup.position.z+=k*-(j-1),a.zoom2D*=j,a.zoom2D<2&&(a.zoom2D=2),a.show()}if(!a.isMultiDragging&&void 0!=d){var g=(d-a.mouseStartX)/a.WIDTH,h=(e-a.mouseStartY)/a.HEIGHT,l=Math.sqrt(g*g+h*h);if(3==c||3==a.mouseButton&&b.ctrlKey)a.slabNear=a.cslabNear+100*g,a.slabFar=a.cslabFar+100*h;else if(2==c||3==a.mouseButton||b.shiftKey){var k=.85*(a.rotationGroup.position.z-a.CAMERA_Z);80>k&&(k=80),a.rotationGroup.position.z=a.cz-h*k}else if(1==c||2==a.mouseButton||b.ctrlKey){var k=.85*(a.rotationGroup.position.z-a.CAMERA_Z);20>k&&(k=20),a.webglFailed&&(g*=-1,h*=-1);var m=new TV3(-g*k,-h*k,0),n=a.rotationGroup.quaternion,o=new THREE.Quaternion(n.x,n.y,n.z,n.w).inverse().normalize(),p=o.multiplyVector3(m);a.modelGroup.position.x=a.currentModelPos.x+p.x,a.modelGroup.position.y=a.currentModelPos.y+p.y,a.modelGroup.position.z=a.currentModelPos.z+p.z}else if((0==c||1==a.mouseButton)&&0!=l){var q=Math.sin(l*Math.PI)/l;a.dq.x=Math.cos(l*Math.PI),a.dq.y=0,a.dq.z=q*g,a.dq.w=q*h,a.rotationGroup.quaternion=new THREE.Quaternion(1,0,0,0),a.rotationGroup.quaternion.multiplySelf(a.dq),a.rotationGroup.quaternion.multiplySelf(a.cq)}a.show()}}})},a.prototype.show=function(){if(this.scene){{new Date}this.setSlabAndFog(),this.webglFailed?this.render2d():this.renderer.render(this.scene,this.camera)}},a.prototype.render2d=function(){var a=this.canvas2d[0].getContext("2d");this.scene.updateMatrixWorld(),a.fillRect(0,0,this.WIDTH,this.HEIGHT),a.save(),a.translate(this.WIDTH/2,this.HEIGHT/2),a.scale(this.zoom2D,this.zoom2D),a.lineCap="round";var b=new THREE.Matrix4;b.multiply(this.camera.matrixWorldInverse,this.modelGroup.matrixWorld);for(var c=2*Math.PI,d=[],e=this.atoms,f=0,g=this.atoms.length;g>f;f++){var h=e[f];void 0!=h&&(void 0==h.screen&&(h.screen=new THREE.Vector3),h.screen.set(h.x,h.y,h.z),b.multiplyVector3(h.screen),this.webglFailed||(h.screen.y*=-1),d.push([!1,h.screen.z,f,this.vdwRadii[h.elem]*this.vdwRadii[h.elem]||4]))}for(var f=0,g=this.atoms.length;g>f;f++){var h=e[f];if(void 0!=h)for(var i=0,j=h.bonds.length;j>i;i++){var k=e[h.bonds[i]];void 0!=k&&(h.serial>k.serial||d.push([!0,(h.screen.z+k.screen.z)/2,f,h.bonds[i]]))}}d.sort(function(a,b){return a[1]-b[1]});for(var f=0,g=d.length;g>f;f++){var h=e[d[f][2]];if(d[f][0]){var k=e[d[f][3]];a.lineWidth=this.canvas_bond_width;var l=(h.screen.x+k.screen.x)/2,m=(h.screen.y+k.screen.y)/2;a.strokeStyle="rgb("+(h.color>>16)+","+(h.color>>8&255)+","+(255&h.color)+")",a.beginPath(),a.moveTo(h.screen.x,h.screen.y),a.lineTo(l,m),a.closePath(),a.stroke(),a.strokeStyle="rgb("+(k.color>>16)+","+(k.color>>8&255)+","+(255&k.color)+")",a.beginPath(),a.moveTo(k.screen.x,k.screen.y),a.lineTo(l,m),a.closePath(),a.stroke()}else a.fillStyle="rgb("+(h.color>>16)+","+(h.color>>8&255)+","+(255&h.color)+")",a.lineWidth=.03,a.beginPath(),a.arc(h.screen.x,h.screen.y,this.canvas_vdw?d[f][3]*this.canvas_atom_radius:this.canvas_atom_radius,0,c,!0),a.closePath(),a.fill(),a.strokeStyle="#000000",2*this.canvas_atom_radius!=this.canvas_bond_width&&a.stroke()}a.restore()},a.prototype.doFunc=function(a){a(this)},a}(),ChemDoodle=function(){var a={iChemLabs:{},informatics:{},io:{},lib:{},structures:{}};return a.structures.d2={},a.structures.d3={},a.getVersion=function(){return"6.0.1"},a}();if(function(a,b,c){function d(a){var b=a.length,c=db.type(a);return db.isWindow(a)?!1:1===a.nodeType&&b?!0:"array"===c||"function"!==c&&(0===b||"number"==typeof b&&b>0&&b-1 in a)}function e(a,b,d,e){if(db.acceptData(a)){var f=db.expando,g=a.nodeType,h=g?db.cache:a,i=g?a[f]:a[f]&&f;if(i&&h[i]&&(e||h[i].data)||d!==c||"string"!=typeof b)return i||(i=g?a[f]=X.pop()||db.guid++:f),h[i]||(h[i]=g?{}:{toJSON:db.noop}),("object"==typeof b||"function"==typeof b)&&(e?h[i]=db.extend(h[i],b):h[i].data=db.extend(h[i].data,b)),a=h[i],e||(a.data||(a.data={}),a=a.data),d!==c&&(a[db.camelCase(b)]=d),"string"==typeof b?(d=a[b],null==d&&(d=a[db.camelCase(b)])):d=a,d}}function f(a,b,c){if(db.acceptData(a)){var d,e,f=a.nodeType,g=f?db.cache:a,i=f?a[db.expando]:db.expando;if(g[i]){if(b&&(d=c?g[i]:g[i].data)){db.isArray(b)?b=b.concat(db.map(b,db.camelCase)):b in d?b=[b]:(b=db.camelCase(b),b=b in d?[b]:b.split(" "));for(e=b.length;e--;)delete d[b[e]];if(c?!h(d):!db.isEmptyObject(d))return}if(!c&&(delete g[i].data,!h(g[i])))return;f?db.cleanData([a],!0):db.support.deleteExpando||g!=g.window?delete g[i]:g[i]=null}}}function g(a,b,d){if(d===c&&1===a.nodeType)if(d="data-"+b.replace(Yc,"-$1").toLowerCase(),d=a.getAttribute(d),"string"==typeof d){try{d="true"===d?!0:"false"===d?!1:"null"===d?null:+d+""===d?+d:Xc.test(d)?db.parseJSON(d):d}catch(e){}db.data(a,b,d)}else d=c;return d}function h(a){for(var b in a)if(("data"!==b||!db.isEmptyObject(a[b]))&&"toJSON"!==b)return!1;return!0}function i(){return!0}function j(){return!1}function k(){try{return S.activeElement}catch(a){}}function l(a,b){do a=a[b];while(a&&1!==a.nodeType);return a}function m(a,b,c){if(db.isFunction(b))return db.grep(a,function(a,d){return!!b.call(a,d,a)!==c});if(b.nodeType)return db.grep(a,function(a){return a===b!==c});if("string"==typeof b){if(ld.test(b))return db.filter(b,a,c);b=db.filter(b,a)}return db.grep(a,function(a){return 0<=db.inArray(a,b)!==c})}function n(a){var b=pd.split("|");if(a=a.createDocumentFragment(),a.createElement)for(;b.length;)a.createElement(b.pop());return a}function o(a,b){return db.nodeName(a,"table")&&db.nodeName(1===b.nodeType?b:b.firstChild,"tr")?a.getElementsByTagName("tbody")[0]||a.appendChild(a.ownerDocument.createElement("tbody")):a}function p(a){return a.type=(null!==db.find.attr(a,"type"))+"/"+a.type,a}function q(a){var b=Bd.exec(a.type);return b?a.type=b[1]:a.removeAttribute("type"),a}function r(a,b){for(var c,d=0;null!=(c=a[d]);d++)db._data(c,"globalEval",!b||db._data(b[d],"globalEval"))}function s(a,b){if(1===b.nodeType&&db.hasData(a)){var c,d,e;d=db._data(a);var f=db._data(b,d),g=d.events;if(g)for(c in delete f.handle,f.events={},g)for(d=0,e=g[c].length;e>d;d++)db.event.add(b,c,g[c][d]);f.data&&(f.data=db.extend({},f.data))}}function t(a,b){var d,e,f=0,g=typeof a.getElementsByTagName!==Q?a.getElementsByTagName(b||"*"):typeof a.querySelectorAll!==Q?a.querySelectorAll(b||"*"):c;if(!g)for(g=[],d=a.childNodes||a;null!=(e=d[f]);f++)!b||db.nodeName(e,b)?g.push(e):db.merge(g,t(e,b));return b===c||b&&db.nodeName(a,b)?db.merge([a],g):g}function u(a){yd.test(a.type)&&(a.defaultChecked=a.checked)}function v(a,b){if(b in a)return b;for(var c=b.charAt(0).toUpperCase()+b.slice(1),d=b,e=Ud.length;e--;)if(b=Ud[e]+c,b in a)return b;return d}function w(a,b){return a=b||a,"none"===db.css(a,"display")||!db.contains(a.ownerDocument,a)}function x(a,b){for(var c,d,e,f=[],g=0,h=a.length;h>g;g++)d=a[g],d.style&&(f[g]=db._data(d,"olddisplay"),c=d.style.display,b?(!f[g]&&"none"===c&&(d.style.display=""),""===d.style.display&&w(d)&&(f[g]=db._data(d,"olddisplay",B(d.nodeName)))):!f[g]&&(e=w(d),c&&"none"!==c||!e)&&db._data(d,"olddisplay",e?c:db.css(d,"display")));for(g=0;h>g;g++)d=a[g],!d.style||b&&"none"!==d.style.display&&""!==d.style.display||(d.style.display=b?f[g]||"":"none");return a}function y(a,b,c){return(a=Nd.exec(b))?Math.max(0,a[1]-(c||0))+(a[2]||"px"):b}function z(a,b,c,d,e){b=c===(d?"border":"content")?4:"width"===b?1:0;for(var f=0;4>b;b+=2)"margin"===c&&(f+=db.css(a,c+Td[b],!0,e)),d?("content"===c&&(f-=db.css(a,"padding"+Td[b],!0,e)),"margin"!==c&&(f-=db.css(a,"border"+Td[b]+"Width",!0,e))):(f+=db.css(a,"padding"+Td[b],!0,e),"padding"!==c&&(f+=db.css(a,"border"+Td[b]+"Width",!0,e)));return f}function A(a,b,c){var d=!0,e="width"===b?a.offsetWidth:a.offsetHeight,f=Gd(a),g=db.support.boxSizing&&"border-box"===db.css(a,"boxSizing",!1,f);if(0>=e||null==e){if(e=Hd(a,b,f),(0>e||null==e)&&(e=a.style[b]),Od.test(e))return e;d=g&&(db.support.boxSizingReliable||e===a.style[b]),e=parseFloat(e)||0}return e+z(a,b,c||(g?"border":"content"),d,f)+"px"}function B(a){var b=S,c=Qd[a];return c||(c=C(a,b),"none"!==c&&c||(Fd=(Fd||db("<iframe frameborder='0' width='0' height='0'/>").css("cssText","display:block !important")).appendTo(b.documentElement),b=(Fd[0].contentWindow||Fd[0].contentDocument).document,b.write("<!doctype html><html><body>"),b.close(),c=C(a,b),Fd.detach()),Qd[a]=c),c}function C(a,b){var c=db(b.createElement(a)).appendTo(b.body),d=db.css(c[0],"display");return c.remove(),d}function D(a,b,c,d){var e;if(db.isArray(b))db.each(b,function(b,e){c||Wd.test(a)?d(a,e):D(a+"["+("object"==typeof e?b:"")+"]",e,c,d)});else if(c||"object"!==db.type(b))d(a,b);else for(e in b)D(a+"["+e+"]",b[e],c,d)}function E(a){return function(b,c){"string"!=typeof b&&(c=b,b="*");var d,e=0,f=b.toLowerCase().match(fb)||[];if(db.isFunction(c))for(;d=f[e++];)"+"===d[0]?(d=d.slice(1)||"*",(a[d]=a[d]||[]).unshift(c)):(a[d]=a[d]||[]).push(c)}}function F(a,b,c,d){function e(h){var i;return f[h]=!0,db.each(a[h]||[],function(a,h){var j=h(b,c,d);return"string"!=typeof j||g||f[j]?g?!(i=j):void 0:(b.dataTypes.unshift(j),e(j),!1)}),i}var f={},g=a===ke;return e(b.dataTypes[0])||!f["*"]&&e("*")}function G(a,b){var d,e,f=db.ajaxSettings.flatOptions||{};for(e in b)b[e]!==c&&((f[e]?a:d||(d={}))[e]=b[e]);return d&&db.extend(!0,a,d),a}function H(){try{return new a.XMLHttpRequest}catch(b){}}function I(){return setTimeout(function(){te=c}),te=db.now()}function J(a,b,c){for(var d,e=(ze[b]||[]).concat(ze["*"]),f=0,g=e.length;g>f;f++)if(d=e[f].call(c,b,a))return d}function K(a,b,c){var d,e,f=0,g=ye.length,h=db.Deferred().always(function(){delete i.elem}),i=function(){if(e)return!1;for(var b=te||I(),b=Math.max(0,j.startTime+j.duration-b),c=1-(b/j.duration||0),d=0,f=j.tweens.length;f>d;d++)j.tweens[d].run(c);return h.notifyWith(a,[j,c,b]),1>c&&f?b:(h.resolveWith(a,[j]),!1)},j=h.promise({elem:a,props:db.extend({},b),opts:db.extend(!0,{specialEasing:{}},c),originalProperties:b,originalOptions:c,startTime:te||I(),duration:c.duration,tweens:[],createTween:function(b,c){var d=db.Tween(a,j.opts,b,c,j.opts.specialEasing[b]||j.opts.easing);return j.tweens.push(d),d},stop:function(b){var c=0,d=b?j.tweens.length:0;if(e)return this;for(e=!0;d>c;c++)j.tweens[c].run(1);return b?h.resolveWith(a,[j,b]):h.rejectWith(a,[j,b]),this}});b=j.props,c=j.opts.specialEasing;var k,l,m,n;for(d in b)if(k=db.camelCase(d),l=c[k],m=b[d],db.isArray(m)&&(l=m[1],m=b[d]=m[0]),d!==k&&(b[k]=m,delete b[d]),(n=db.cssHooks[k])&&"expand"in n)for(d in m=n.expand(m),delete b[k],m)d in b||(b[d]=m[d],c[d]=l);else c[k]=l;for(;g>f;f++)if(d=ye[f].call(j,a,b,j.opts))return d;return db.map(b,J,j),db.isFunction(j.opts.start)&&j.opts.start.call(a,j),db.fx.timer(db.extend(i,{elem:a,anim:j,queue:j.opts.queue})),j.progress(j.opts.progress).done(j.opts.done,j.opts.complete).fail(j.opts.fail).always(j.opts.always)}function L(a,b,c,d,e){return new L.prototype.init(a,b,c,d,e)}function M(a,b){var c,d={height:a},e=0;for(b=b?1:0;4>e;e+=2-b)c=Td[e],d["margin"+c]=d["padding"+c]=a;return b&&(d.opacity=d.width=a),d}function N(a){return db.isWindow(a)?a:9===a.nodeType?a.defaultView||a.parentWindow:!1}var O,P,Q=typeof c,R=a.location,S=a.document,T=S.documentElement,U=a.jQuery,V=a.$,W={},X=[],Y=X.concat,Z=X.push,$=X.slice,_=X.indexOf,ab=W.toString,bb=W.hasOwnProperty,cb="1.10.2".trim,db=function(a,b){return new db.fn.init(a,b,P)},eb=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,fb=/\S+/g,gb=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,hb=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,ib=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,jb=/^[\],:{}\s]*$/,kb=/(?:^|:|,)(?:\s*\[)+/g,lb=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,mb=/"[^"\\\r\n]*"|true|false|null|-?(?:\d+\.|)\d+(?:[eE][+-]?\d+|)/g,nb=/^-ms-/,ob=/-([\da-z])/gi,pb=function(a,b){return b.toUpperCase()},qb=function(a){(S.addEventListener||"load"===a.type||"complete"===S.readyState)&&(rb(),db.ready())},rb=function(){S.addEventListener?(S.removeEventListener("DOMContentLoaded",qb,!1),a.removeEventListener("load",qb,!1)):(S.detachEvent("onreadystatechange",qb),a.detachEvent("onload",qb))};db.fn=db.prototype={jquery:"1.10.2",constructor:db,init:function(a,b,d){var e;if(!a)return this;if("string"==typeof a){if((e="<"===a.charAt(0)&&">"===a.charAt(a.length-1)&&3<=a.length?[null,a,null]:hb.exec(a))&&(e[1]||!b)){if(e[1]){if(b=b instanceof db?b[0]:b,db.merge(this,db.parseHTML(e[1],b&&b.nodeType?b.ownerDocument||b:S,!0)),ib.test(e[1])&&db.isPlainObject(b))for(e in b)db.isFunction(this[e])?this[e](b[e]):this.attr(e,b[e])}else{if((b=S.getElementById(e[2]))&&b.parentNode){if(b.id!==e[2])return d.find(a);this.length=1,this[0]=b}this.context=S,this.selector=a}return this}return!b||b.jquery?(b||d).find(a):this.constructor(b).find(a)}return a.nodeType?(this.context=this[0]=a,this.length=1,this):db.isFunction(a)?d.ready(a):(a.selector!==c&&(this.selector=a.selector,this.context=a.context),db.makeArray(a,this))},selector:"",length:0,toArray:function(){return $.call(this)},get:function(a){return null==a?this.toArray():0>a?this[this.length+a]:this[a]},pushStack:function(a){return a=db.merge(this.constructor(),a),a.prevObject=this,a.context=this.context,a},each:function(a,b){return db.each(this,a,b)},ready:function(a){return db.ready.promise().done(a),this},slice:function(){return this.pushStack($.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(a){var b=this.length;return a=+a+(0>a?b:0),this.pushStack(a>=0&&b>a?[this[a]]:[])},map:function(a){return this.pushStack(db.map(this,function(b,c){return a.call(b,c,b)}))},end:function(){return this.prevObject||this.constructor(null)},push:Z,sort:[].sort,splice:[].splice},db.fn.init.prototype=db.fn,db.extend=db.fn.extend=function(){var a,b,d,e,f,g=arguments[0]||{},h=1,i=arguments.length,j=!1;for("boolean"==typeof g&&(j=g,g=arguments[1]||{},h=2),"object"!=typeof g&&!db.isFunction(g)&&(g={}),i===h&&(g=this,--h);i>h;h++)if(null!=(f=arguments[h]))for(e in f)a=g[e],d=f[e],g!==d&&(j&&d&&(db.isPlainObject(d)||(b=db.isArray(d)))?(b?(b=!1,a=a&&db.isArray(a)?a:[]):a=a&&db.isPlainObject(a)?a:{},g[e]=db.extend(j,a,d)):d!==c&&(g[e]=d));return g},db.extend({expando:"jQuery"+("1.10.2"+Math.random()).replace(/\D/g,""),noConflict:function(b){return a.$===db&&(a.$=V),b&&a.jQuery===db&&(a.jQuery=U),db},isReady:!1,readyWait:1,holdReady:function(a){a?db.readyWait++:db.ready(!0)},ready:function(a){if(!(!0===a?--db.readyWait:db.isReady)){if(!S.body)return setTimeout(db.ready);db.isReady=!0,!0!==a&&0<--db.readyWait||(O.resolveWith(S,[db]),db.fn.trigger&&db(S).trigger("ready").off("ready"))}},isFunction:function(a){return"function"===db.type(a)},isArray:Array.isArray||function(a){return"array"===db.type(a)},isWindow:function(a){return null!=a&&a==a.window},isNumeric:function(a){return!isNaN(parseFloat(a))&&isFinite(a)},type:function(a){return null==a?String(a):"object"==typeof a||"function"==typeof a?W[ab.call(a)]||"object":typeof a},isPlainObject:function(a){var b;if(!a||"object"!==db.type(a)||a.nodeType||db.isWindow(a))return!1;try{if(a.constructor&&!bb.call(a,"constructor")&&!bb.call(a.constructor.prototype,"isPrototypeOf"))return!1}catch(d){return!1}if(db.support.ownLast)for(b in a)return bb.call(a,b);for(b in a);return b===c||bb.call(a,b)},isEmptyObject:function(a){for(var b in a)return!1;return!0},error:function(a){throw Error(a)},parseHTML:function(a,b,c){if(!a||"string"!=typeof a)return null;"boolean"==typeof b&&(c=b,b=!1),b=b||S;var d=ib.exec(a);return c=!c&&[],d?[b.createElement(d[1])]:(d=db.buildFragment([a],b,c),c&&db(c).remove(),db.merge([],d.childNodes))},parseJSON:function(b){return a.JSON&&a.JSON.parse?a.JSON.parse(b):null===b?b:"string"==typeof b&&(b=db.trim(b))&&jb.test(b.replace(lb,"@").replace(mb,"]").replace(kb,""))?new Function("return "+b)():void db.error("Invalid JSON: "+b)},parseXML:function(b){var d,e;if(!b||"string"!=typeof b)return null;try{a.DOMParser?(e=new DOMParser,d=e.parseFromString(b,"text/xml")):(d=new ActiveXObject("Microsoft.XMLDOM"),d.async="false",d.loadXML(b))}catch(f){d=c}return(!d||!d.documentElement||d.getElementsByTagName("parsererror").length)&&db.error("Invalid XML: "+b),d},noop:function(){},globalEval:function(b){b&&db.trim(b)&&(a.execScript||function(b){a.eval.call(a,b)})(b)},camelCase:function(a){return a.replace(nb,"ms-").replace(ob,pb)},nodeName:function(a,b){return a.nodeName&&a.nodeName.toLowerCase()===b.toLowerCase()},each:function(a,b,c){var e,f=0,g=a.length;if(e=d(a),c){if(e)for(;g>f&&(e=b.apply(a[f],c),!(!1===e));f++);else for(f in a)if(e=b.apply(a[f],c),!1===e)break}else if(e)for(;g>f&&(e=b.call(a[f],f,a[f]),!(!1===e));f++);else for(f in a)if(e=b.call(a[f],f,a[f]),!1===e)break;return a},trim:cb&&!cb.call("﻿ ")?function(a){return null==a?"":cb.call(a)}:function(a){return null==a?"":(a+"").replace(gb,"")},makeArray:function(a,b){var c=b||[];return null!=a&&(d(Object(a))?db.merge(c,"string"==typeof a?[a]:a):Z.call(c,a)),c},inArray:function(a,b,c){var d;if(b){if(_)return _.call(b,a,c);for(d=b.length,c=c?0>c?Math.max(0,d+c):c:0;d>c;c++)if(c in b&&b[c]===a)return c}return-1},merge:function(a,b){var d=b.length,e=a.length,f=0;if("number"==typeof d)for(;d>f;f++)a[e++]=b[f];else for(;b[f]!==c;)a[e++]=b[f++];return a.length=e,a},grep:function(a,b,c){var d,e=[],f=0,g=a.length;for(c=!!c;g>f;f++)d=!!b(a[f],f),c!==d&&e.push(a[f]);return e},map:function(a,b,c){var e,f=0,g=a.length,h=[];if(d(a))for(;g>f;f++)e=b(a[f],f,c),null!=e&&(h[h.length]=e);else for(f in a)e=b(a[f],f,c),null!=e&&(h[h.length]=e);return Y.apply([],h)},guid:1,proxy:function(a,b){var d,e;return"string"==typeof b&&(e=a[b],b=a,a=e),db.isFunction(a)?(d=$.call(arguments,2),e=function(){return a.apply(b||this,d.concat($.call(arguments)))},e.guid=a.guid=a.guid||db.guid++,e):c},access:function(a,b,d,e,f,g,h){var i=0,j=a.length,k=null==d;if("object"===db.type(d))for(i in f=!0,d)db.access(a,b,i,d[i],!0,g,h);else if(e!==c&&(f=!0,db.isFunction(e)||(h=!0),k&&(h?(b.call(a,e),b=null):(k=b,b=function(a,b,c){return k.call(db(a),c)})),b))for(;j>i;i++)b(a[i],d,h?e:e.call(a[i],i,b(a[i],d)));return f?a:k?b.call(a):j?b(a[0],d):g},now:function(){return(new Date).getTime()},swap:function(a,b,c,d){var e,f={};for(e in b)f[e]=a.style[e],a.style[e]=b[e];c=c.apply(a,d||[]);for(e in b)a.style[e]=f[e];return c}}),db.ready.promise=function(b){if(!O)if(O=db.Deferred(),"complete"===S.readyState)setTimeout(db.ready);else if(S.addEventListener)S.addEventListener("DOMContentLoaded",qb,!1),a.addEventListener("load",qb,!1);else{S.attachEvent("onreadystatechange",qb),a.attachEvent("onload",qb);var c=!1;try{c=null==a.frameElement&&S.documentElement}catch(d){}c&&c.doScroll&&function e(){if(!db.isReady){try{c.doScroll("left")}catch(a){return setTimeout(e,50)}rb(),db.ready()}}()}return O.promise(b)},db.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(a,b){W["[object "+b+"]"]=b.toLowerCase()}),P=db(S);var sb,tb,ub,vb,wb,xb,yb,zb,Ab,Bb,Cb,Db,Eb,Fb,Gb,Hb,Ib,Jb=a,Kb=function(a,b,c,d){var e,f,g,h,i;if((b?b.ownerDocument||b:ac)!==Cb&&Bb(b),b=b||Cb,c=c||[],!a||"string"!=typeof a)return c;if(1!==(h=b.nodeType)&&9!==h)return[];if(Eb&&!d){if(e=Cc.exec(a))if(g=e[1]){if(9===h){if(!(f=b.getElementById(g))||!f.parentNode)return c;if(f.id===g)return c.push(f),c}else if(b.ownerDocument&&(f=b.ownerDocument.getElementById(g))&&Ib(b,f)&&f.id===g)return c.push(f),c}else{if(e[2])return nc.apply(c,b.getElementsByTagName(a)),c;if((g=e[3])&&tb.getElementsByClassName&&b.getElementsByClassName)return nc.apply(c,b.getElementsByClassName(g)),c}if(tb.qsa&&(!Fb||!Fb.test(a))){if(f=e=_b,g=b,i=9===h&&a,1===h&&"object"!==b.nodeName.toLowerCase()){for(h=Ub(a),(e=b.getAttribute("id"))?f=e.replace(Fc,"\\$&"):b.setAttribute("id",f),f="[id='"+f+"'] ",g=h.length;g--;)h[g]=f+Vb(h[g]);g=wc.test(a)&&b.parentNode||b,i=h.join(",")}if(i)try{return nc.apply(c,g.querySelectorAll(i)),c}catch(j){}finally{e||b.removeAttribute("id")}}}var k;a:{if(a=a.replace(tc,"$1"),f=Ub(a),!d&&1===f.length){if(e=f[0]=f[0].slice(0),2<e.length&&"ID"===(k=e[0]).type&&tb.getById&&9===b.nodeType&&Eb&&vb.relative[e[1].type]){if(b=(vb.find.ID(k.matches[0].replace(Gc,Hc),b)||[])[0],!b){k=c;break a}a=a.slice(e.shift().value.length)}for(h=Ac.needsContext.test(a)?0:e.length;h--&&(k=e[h],!vb.relative[g=k.type]);)if((g=vb.find[g])&&(d=g(k.matches[0].replace(Gc,Hc),wc.test(e[0].type)&&b.parentNode||b))){if(e.splice(h,1),a=d.length&&Vb(e),!a){nc.apply(c,d),k=c;break a}break}}yb(a,f)(d,b,!Eb,c,wc.test(a)),k=c}return k},Lb=function(){function a(c,d){return b.push(c+=" ")>vb.cacheLength&&delete a[b.shift()],a[c]=d}var b=[];return a},Mb=function(a){return a[_b]=!0,a},Nb=function(a){var b=Cb.createElement("div");try{return!!a(b)}catch(c){return!1}finally{b.parentNode&&b.parentNode.removeChild(b)}},Ob=function(a,b){for(var c=a.split("|"),d=a.length;d--;)vb.attrHandle[c[d]]=b},Pb=function(a,b){var c=b&&a,d=c&&1===a.nodeType&&1===b.nodeType&&(~b.sourceIndex||ic)-(~a.sourceIndex||ic);if(d)return d;if(c)for(;c=c.nextSibling;)if(c===b)return-1;
return a?1:-1},Qb=function(a){return function(b){return"input"===b.nodeName.toLowerCase()&&b.type===a}},Rb=function(a){return function(b){var c=b.nodeName.toLowerCase();return("input"===c||"button"===c)&&b.type===a}},Sb=function(a){return Mb(function(b){return b=+b,Mb(function(c,d){for(var e,f=a([],c.length,b),g=f.length;g--;)c[e=f[g]]&&(c[e]=!(d[e]=c[e]))})})},Tb=function(){},Ub=function(a,b){var c,d,e,f,g,h,i;if(g=ec[a+" "])return b?0:g.slice(0);for(g=a,h=[],i=vb.preFilter;g;){(!c||(d=uc.exec(g)))&&(d&&(g=g.slice(d[0].length)||g),h.push(e=[])),c=!1,(d=vc.exec(g))&&(c=d.shift(),e.push({value:c,type:d[0].replace(tc," ")}),g=g.slice(c.length));for(f in vb.filter)!(d=Ac[f].exec(g))||i[f]&&!(d=i[f](d))||(c=d.shift(),e.push({value:c,type:f,matches:d}),g=g.slice(c.length));if(!c)break}return b?g.length:g?Kb.error(a):ec(a,h).slice(0)},Vb=function(a){for(var b=0,c=a.length,d="";c>b;b++)d+=a[b].value;return d},Wb=function(a,b,c){var d=b.dir,e=c&&"parentNode"===d,f=cc++;return b.first?function(b,c,f){for(;b=b[d];)if(1===b.nodeType||e)return a(b,c,f)}:function(b,c,g){var h,i,j,k=bc+" "+f;if(g){for(;b=b[d];)if((1===b.nodeType||e)&&a(b,c,g))return!0}else for(;b=b[d];)if(1===b.nodeType||e)if(j=b[_b]||(b[_b]={}),(i=j[d])&&i[0]===k){if(!0===(h=i[1])||h===ub)return!0===h}else if(i=j[d]=[k],i[1]=a(b,c,g)||ub,!0===i[1])return!0}},Xb=function(a){return 1<a.length?function(b,c,d){for(var e=a.length;e--;)if(!a[e](b,c,d))return!1;return!0}:a[0]},Yb=function(a,b,c,d,e){for(var f,g=[],h=0,i=a.length,j=null!=b;i>h;h++)(f=a[h])&&(!c||c(f,d,e))&&(g.push(f),j&&b.push(h));return g},Zb=function(a,b,c,d,e,f){return d&&!d[_b]&&(d=Zb(d)),e&&!e[_b]&&(e=Zb(e,f)),Mb(function(f,g,h,i){var j,k,l,m=[],n=[],o=g.length;if(!(l=f)){l=b||"*";for(var p=h.nodeType?[h]:h,q=[],r=0,s=p.length;s>r;r++)Kb(l,p[r],q);l=q}if(l=!a||!f&&b?l:Yb(l,m,a,h,i),p=c?e||(f?a:o||d)?[]:g:l,c&&c(l,p,h,i),d)for(j=Yb(p,n),d(j,[],h,i),h=j.length;h--;)(k=j[h])&&(p[n[h]]=!(l[n[h]]=k));if(f){if(e||a){if(e){for(j=[],h=p.length;h--;)(k=p[h])&&j.push(l[h]=k);e(null,p=[],j,i)}for(h=p.length;h--;)(k=p[h])&&-1<(j=e?pc.call(f,k):m[h])&&(f[j]=!(g[j]=k))}}else p=Yb(p===g?p.splice(o,p.length):p),e?e(null,g,p,i):nc.apply(g,p)})},$b=function(a){var b,c,d,e=a.length,f=vb.relative[a[0].type];c=f||vb.relative[" "];for(var g=f?1:0,h=Wb(function(a){return a===b},c,!0),i=Wb(function(a){return-1<pc.call(b,a)},c,!0),j=[function(a,c,d){return!f&&(d||c!==zb)||((b=c).nodeType?h(a,c,d):i(a,c,d))}];e>g;g++)if(c=vb.relative[a[g].type])j=[Wb(Xb(j),c)];else{if(c=vb.filter[a[g].type].apply(null,a[g].matches),c[_b]){for(d=++g;e>d&&!vb.relative[a[d].type];d++);return Zb(g>1&&Xb(j),g>1&&Vb(a.slice(0,g-1).concat({value:" "===a[g-2].type?"*":""})).replace(tc,"$1"),c,d>g&&$b(a.slice(g,d)),e>d&&$b(a=a.slice(d)),e>d&&Vb(a))}j.push(c)}return Xb(j)},_b="sizzle"+-new Date,ac=Jb.document,bc=0,cc=0,dc=Lb(),ec=Lb(),fc=Lb(),gc=!1,hc=function(a,b){return a===b&&(gc=!0),0},ic=-2147483648,jc={}.hasOwnProperty,kc=[],lc=kc.pop,mc=kc.push,nc=kc.push,oc=kc.slice,pc=kc.indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(this[b]===a)return b;return-1},qc="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+".replace("w","w#"),rc="\\[[\\x20\\t\\r\\n\\f]*((?:\\\\.|[\\w-]|[^\\x00-\\xa0])+)[\\x20\\t\\r\\n\\f]*(?:([*^$|!~]?=)[\\x20\\t\\r\\n\\f]*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+qc+")|)|)[\\x20\\t\\r\\n\\f]*\\]",sc=":((?:\\\\.|[\\w-]|[^\\x00-\\xa0])+)(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+rc.replace(3,8)+")*)|.*)\\)|)",tc=RegExp("^[\\x20\\t\\r\\n\\f]+|((?:^|[^\\\\])(?:\\\\.)*)[\\x20\\t\\r\\n\\f]+$","g"),uc=/^[\x20\t\r\n\f]*,[\x20\t\r\n\f]*/,vc=/^[\x20\t\r\n\f]*([>+~]|[\x20\t\r\n\f])[\x20\t\r\n\f]*/,wc=/[\x20\t\r\n\f]*[+~]/,xc=RegExp("=[\\x20\\t\\r\\n\\f]*([^\\]'\"]*)[\\x20\\t\\r\\n\\f]*\\]","g"),yc=RegExp(sc),zc=RegExp("^"+qc+"$"),Ac={ID:/^#((?:\\.|[\w-]|[^\x00-\xa0])+)/,CLASS:/^\.((?:\\.|[\w-]|[^\x00-\xa0])+)/,TAG:RegExp("^("+"(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+".replace("w","w*")+")"),ATTR:RegExp("^"+rc),PSEUDO:RegExp("^"+sc),CHILD:RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\([\\x20\\t\\r\\n\\f]*(even|odd|(([+-]|)(\\d*)n|)[\\x20\\t\\r\\n\\f]*(?:([+-]|)[\\x20\\t\\r\\n\\f]*(\\d+)|))[\\x20\\t\\r\\n\\f]*\\)|)","i"),bool:RegExp("^(?:checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped)$","i"),needsContext:RegExp("^[\\x20\\t\\r\\n\\f]*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\([\\x20\\t\\r\\n\\f]*((?:-\\d)?\\d*)[\\x20\\t\\r\\n\\f]*\\)|)(?=[^-]|$)","i")},Bc=/^[^{]+\{\s*\[native \w/,Cc=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,Dc=/^(?:input|select|textarea|button)$/i,Ec=/^h\d$/i,Fc=/'|\\/g,Gc=RegExp("\\\\([\\da-f]{1,6}[\\x20\\t\\r\\n\\f]?|([\\x20\\t\\r\\n\\f])|.)","ig"),Hc=function(a,b,c){return a="0x"+b-65536,a!==a||c?b:0>a?String.fromCharCode(a+65536):String.fromCharCode(a>>10|55296,1023&a|56320)};try{nc.apply(kc=oc.call(ac.childNodes),ac.childNodes),kc[ac.childNodes.length].nodeType}catch(Ic){nc={apply:kc.length?function(a,b){mc.apply(a,oc.call(b))}:function(a,b){for(var c=a.length,d=0;a[c++]=b[d++];);a.length=c-1}}}xb=Kb.isXML=function(a){return(a=a&&(a.ownerDocument||a).documentElement)?"HTML"!==a.nodeName:!1},tb=Kb.support={},Bb=Kb.setDocument=function(a){var b=a?a.ownerDocument||a:ac;return a=b.defaultView,b!==Cb&&9===b.nodeType&&b.documentElement?(Cb=b,Db=b.documentElement,Eb=!xb(b),a&&a.attachEvent&&a!==a.top&&a.attachEvent("onbeforeunload",function(){Bb()}),tb.attributes=Nb(function(a){return a.className="i",!a.getAttribute("className")}),tb.getElementsByTagName=Nb(function(a){return a.appendChild(b.createComment("")),!a.getElementsByTagName("*").length}),tb.getElementsByClassName=Nb(function(a){return a.innerHTML="<div class='a'></div><div class='a i'></div>",a.firstChild.className="i",2===a.getElementsByClassName("i").length}),tb.getById=Nb(function(a){return Db.appendChild(a).id=_b,!b.getElementsByName||!b.getElementsByName(_b).length}),tb.getById?(vb.find.ID=function(a,b){if("undefined"!=typeof b.getElementById&&Eb){var c=b.getElementById(a);return c&&c.parentNode?[c]:[]}},vb.filter.ID=function(a){var b=a.replace(Gc,Hc);return function(a){return a.getAttribute("id")===b}}):(delete vb.find.ID,vb.filter.ID=function(a){var b=a.replace(Gc,Hc);return function(a){return(a="undefined"!=typeof a.getAttributeNode&&a.getAttributeNode("id"))&&a.value===b}}),vb.find.TAG=tb.getElementsByTagName?function(a,b){return"undefined"!=typeof b.getElementsByTagName?b.getElementsByTagName(a):void 0}:function(a,b){var c,d=[],e=0,f=b.getElementsByTagName(a);if("*"===a){for(;c=f[e++];)1===c.nodeType&&d.push(c);return d}return f},vb.find.CLASS=tb.getElementsByClassName&&function(a,b){return"undefined"!=typeof b.getElementsByClassName&&Eb?b.getElementsByClassName(a):void 0},Gb=[],Fb=[],(tb.qsa=Bc.test(b.querySelectorAll))&&(Nb(function(a){a.innerHTML="<select><option selected=''></option></select>",a.querySelectorAll("[selected]").length||Fb.push("\\[[\\x20\\t\\r\\n\\f]*(?:value|checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped)"),a.querySelectorAll(":checked").length||Fb.push(":checked")}),Nb(function(a){var c=b.createElement("input");c.setAttribute("type","hidden"),a.appendChild(c).setAttribute("t",""),a.querySelectorAll("[t^='']").length&&Fb.push("[*^$]=[\\x20\\t\\r\\n\\f]*(?:''|\"\")"),a.querySelectorAll(":enabled").length||Fb.push(":enabled",":disabled"),a.querySelectorAll("*,:x"),Fb.push(",.*:")})),(tb.matchesSelector=Bc.test(Hb=Db.webkitMatchesSelector||Db.mozMatchesSelector||Db.oMatchesSelector||Db.msMatchesSelector))&&Nb(function(a){tb.disconnectedMatch=Hb.call(a,"div"),Hb.call(a,"[s!='']:x"),Gb.push("!=",sc)}),Fb=Fb.length&&RegExp(Fb.join("|")),Gb=Gb.length&&RegExp(Gb.join("|")),Ib=Bc.test(Db.contains)||Db.compareDocumentPosition?function(a,b){var c=9===a.nodeType?a.documentElement:a,d=b&&b.parentNode;return a===d||!(!d||1!==d.nodeType||!(c.contains?c.contains(d):a.compareDocumentPosition&&16&a.compareDocumentPosition(d)))}:function(a,b){if(b)for(;b=b.parentNode;)if(b===a)return!0;return!1},hc=Db.compareDocumentPosition?function(a,c){if(a===c)return gc=!0,0;var d=c.compareDocumentPosition&&a.compareDocumentPosition&&a.compareDocumentPosition(c);return d?1&d||!tb.sortDetached&&c.compareDocumentPosition(a)===d?a===b||Ib(ac,a)?-1:c===b||Ib(ac,c)?1:Ab?pc.call(Ab,a)-pc.call(Ab,c):0:4&d?-1:1:a.compareDocumentPosition?-1:1}:function(a,c){var d,e=0;d=a.parentNode;var f=c.parentNode,g=[a],h=[c];if(a===c)return gc=!0,0;if(!d||!f)return a===b?-1:c===b?1:d?-1:f?1:Ab?pc.call(Ab,a)-pc.call(Ab,c):0;if(d===f)return Pb(a,c);for(d=a;d=d.parentNode;)g.unshift(d);for(d=c;d=d.parentNode;)h.unshift(d);for(;g[e]===h[e];)e++;return e?Pb(g[e],h[e]):g[e]===ac?-1:h[e]===ac?1:0},b):Cb},Kb.matches=function(a,b){return Kb(a,null,null,b)},Kb.matchesSelector=function(a,b){if((a.ownerDocument||a)!==Cb&&Bb(a),b=b.replace(xc,"='$1']"),!(!tb.matchesSelector||!Eb||Gb&&Gb.test(b)||Fb&&Fb.test(b)))try{var c=Hb.call(a,b);if(c||tb.disconnectedMatch||a.document&&11!==a.document.nodeType)return c}catch(d){}return 0<Kb(b,Cb,null,[a]).length},Kb.contains=function(a,b){return(a.ownerDocument||a)!==Cb&&Bb(a),Ib(a,b)},Kb.attr=function(a,b){(a.ownerDocument||a)!==Cb&&Bb(a);var c=vb.attrHandle[b.toLowerCase()],c=c&&jc.call(vb.attrHandle,b.toLowerCase())?c(a,b,!Eb):void 0;return void 0===c?tb.attributes||!Eb?a.getAttribute(b):(c=a.getAttributeNode(b))&&c.specified?c.value:null:c},Kb.error=function(a){throw Error("Syntax error, unrecognized expression: "+a)},Kb.uniqueSort=function(a){var b,c=[],d=0,e=0;if(gc=!tb.detectDuplicates,Ab=!tb.sortStable&&a.slice(0),a.sort(hc),gc){for(;b=a[e++];)b===a[e]&&(d=c.push(e));for(;d--;)a.splice(c[d],1)}return a},wb=Kb.getText=function(a){var b,c="",d=0;if(b=a.nodeType){if(1===b||9===b||11===b){if("string"==typeof a.textContent)return a.textContent;for(a=a.firstChild;a;a=a.nextSibling)c+=wb(a)}else if(3===b||4===b)return a.nodeValue}else for(;b=a[d];d++)c+=wb(b);return c},vb=Kb.selectors={cacheLength:50,createPseudo:Mb,match:Ac,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(a){return a[1]=a[1].replace(Gc,Hc),a[3]=(a[4]||a[5]||"").replace(Gc,Hc),"~="===a[2]&&(a[3]=" "+a[3]+" "),a.slice(0,4)},CHILD:function(a){return a[1]=a[1].toLowerCase(),"nth"===a[1].slice(0,3)?(a[3]||Kb.error(a[0]),a[4]=+(a[4]?a[5]+(a[6]||1):2*("even"===a[3]||"odd"===a[3])),a[5]=+(a[7]+a[8]||"odd"===a[3])):a[3]&&Kb.error(a[0]),a},PSEUDO:function(a){var b,c=!a[5]&&a[2];return Ac.CHILD.test(a[0])?null:(a[3]&&void 0!==a[4]?a[2]=a[4]:c&&yc.test(c)&&(b=Ub(c,!0))&&(b=c.indexOf(")",c.length-b)-c.length)&&(a[0]=a[0].slice(0,b),a[2]=c.slice(0,b)),a.slice(0,3))}},filter:{TAG:function(a){var b=a.replace(Gc,Hc).toLowerCase();return"*"===a?function(){return!0}:function(a){return a.nodeName&&a.nodeName.toLowerCase()===b}},CLASS:function(a){var b=dc[a+" "];return b||(b=RegExp("(^|[\\x20\\t\\r\\n\\f])"+a+"([\\x20\\t\\r\\n\\f]|$)"))&&dc(a,function(a){return b.test("string"==typeof a.className&&a.className||"undefined"!=typeof a.getAttribute&&a.getAttribute("class")||"")})},ATTR:function(a,b,c){return function(d){return d=Kb.attr(d,a),null==d?"!="===b:b?(d+="","="===b?d===c:"!="===b?d!==c:"^="===b?c&&0===d.indexOf(c):"*="===b?c&&-1<d.indexOf(c):"$="===b?c&&d.slice(-c.length)===c:"~="===b?-1<(" "+d+" ").indexOf(c):"|="===b?d===c||d.slice(0,c.length+1)===c+"-":!1):!0}},CHILD:function(a,b,c,d,e){var f="nth"!==a.slice(0,3),g="last"!==a.slice(-4),h="of-type"===b;return 1===d&&0===e?function(a){return!!a.parentNode}:function(b,c,i){var j,k,l,m,n;c=f!==g?"nextSibling":"previousSibling";var o=b.parentNode,p=h&&b.nodeName.toLowerCase();if(i=!i&&!h,o){if(f){for(;c;){for(k=b;k=k[c];)if(h?k.nodeName.toLowerCase()===p:1===k.nodeType)return!1;n=c="only"===a&&!n&&"nextSibling"}return!0}if(n=[g?o.firstChild:o.lastChild],g&&i){for(i=o[_b]||(o[_b]={}),j=i[a]||[],m=j[0]===bc&&j[1],l=j[0]===bc&&j[2],k=m&&o.childNodes[m];k=++m&&k&&k[c]||(l=m=0)||n.pop();)if(1===k.nodeType&&++l&&k===b){i[a]=[bc,m,l];break}}else if(i&&(j=(b[_b]||(b[_b]={}))[a])&&j[0]===bc)l=j[1];else for(;(k=++m&&k&&k[c]||(l=m=0)||n.pop())&&((h?k.nodeName.toLowerCase()!==p:1!==k.nodeType)||!++l||(i&&((k[_b]||(k[_b]={}))[a]=[bc,l]),k!==b)););return l-=e,l===d||0===l%d&&l/d>=0}}},PSEUDO:function(a,b){var c,d=vb.pseudos[a]||vb.setFilters[a.toLowerCase()]||Kb.error("unsupported pseudo: "+a);return d[_b]?d(b):1<d.length?(c=[a,a,"",b],vb.setFilters.hasOwnProperty(a.toLowerCase())?Mb(function(a,c){for(var e,f=d(a,b),g=f.length;g--;)e=pc.call(a,f[g]),a[e]=!(c[e]=f[g])}):function(a){return d(a,0,c)}):d}},pseudos:{not:Mb(function(a){var b=[],c=[],d=yb(a.replace(tc,"$1"));return d[_b]?Mb(function(a,b,c,e){e=d(a,null,e,[]);for(var f=a.length;f--;)(c=e[f])&&(a[f]=!(b[f]=c))}):function(a,e,f){return b[0]=a,d(b,null,f,c),!c.pop()}}),has:Mb(function(a){return function(b){return 0<Kb(a,b).length}}),contains:Mb(function(a){return function(b){return-1<(b.textContent||b.innerText||wb(b)).indexOf(a)}}),lang:Mb(function(a){return zc.test(a||"")||Kb.error("unsupported lang: "+a),a=a.replace(Gc,Hc).toLowerCase(),function(b){var c;do if(c=Eb?b.lang:b.getAttribute("xml:lang")||b.getAttribute("lang"))return c=c.toLowerCase(),c===a||0===c.indexOf(a+"-");while((b=b.parentNode)&&1===b.nodeType);return!1}}),target:function(a){var b=Jb.location&&Jb.location.hash;return b&&b.slice(1)===a.id},root:function(a){return a===Db},focus:function(a){return!(a!==Cb.activeElement||Cb.hasFocus&&!Cb.hasFocus()||!a.type&&!a.href&&!~a.tabIndex)},enabled:function(a){return!1===a.disabled},disabled:function(a){return!0===a.disabled},checked:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&!!a.checked||"option"===b&&!!a.selected},selected:function(a){return a.parentNode&&a.parentNode.selectedIndex,!0===a.selected},empty:function(a){for(a=a.firstChild;a;a=a.nextSibling)if("@"<a.nodeName||3===a.nodeType||4===a.nodeType)return!1;return!0},parent:function(a){return!vb.pseudos.empty(a)},header:function(a){return Ec.test(a.nodeName)},input:function(a){return Dc.test(a.nodeName)},button:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&"button"===a.type||"button"===b},text:function(a){var b;return"input"===a.nodeName.toLowerCase()&&"text"===a.type&&(null==(b=a.getAttribute("type"))||b.toLowerCase()===a.type)},first:Sb(function(){return[0]}),last:Sb(function(a,b){return[b-1]}),eq:Sb(function(a,b,c){return[0>c?c+b:c]}),even:Sb(function(a,b){for(var c=0;b>c;c+=2)a.push(c);return a}),odd:Sb(function(a,b){for(var c=1;b>c;c+=2)a.push(c);return a}),lt:Sb(function(a,b,c){for(b=0>c?c+b:c;0<=--b;)a.push(b);return a}),gt:Sb(function(a,b,c){for(c=0>c?c+b:c;++c<b;)a.push(c);return a})}},vb.pseudos.nth=vb.pseudos.eq;for(sb in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})vb.pseudos[sb]=Qb(sb);for(sb in{submit:!0,reset:!0})vb.pseudos[sb]=Rb(sb);Tb.prototype=vb.filters=vb.pseudos,vb.setFilters=new Tb,yb=Kb.compile=function(a,b){var c,d=[],e=[],f=fc[a+" "];if(!f){for(b||(b=Ub(a)),c=b.length;c--;)f=$b(b[c]),f[_b]?d.push(f):e.push(f);var g=0,h=0<d.length,i=0<e.length;c=function(a,b,c,f,j){var k,l,m=[],n=0,o="0",p=a&&[],q=null!=j,r=zb,s=a||i&&vb.find.TAG("*",j&&b.parentNode||b),t=bc+=null==r?1:Math.random()||.1;for(q&&(zb=b!==Cb&&b,ub=g);null!=(j=s[o]);o++){if(i&&j){for(k=0;l=e[k++];)if(l(j,b,c)){f.push(j);break}q&&(bc=t,ub=++g)}h&&((j=!l&&j)&&n--,a&&p.push(j))}if(n+=o,h&&o!==n){for(k=0;l=d[k++];)l(p,m,b,c);if(a){if(n>0)for(;o--;)!p[o]&&!m[o]&&(m[o]=lc.call(f));m=Yb(m)}nc.apply(f,m),q&&!a&&0<m.length&&1<n+d.length&&Kb.uniqueSort(f)}return q&&(bc=t,zb=r),p},c=h?Mb(c):c,f=fc(a,c)}return f},tb.sortStable=_b.split("").sort(hc).join("")===_b,tb.detectDuplicates=gc,Bb(),tb.sortDetached=Nb(function(a){return 1&a.compareDocumentPosition(Cb.createElement("div"))}),Nb(function(a){return a.innerHTML="<a href='#'></a>","#"===a.firstChild.getAttribute("href")})||Ob("type|href|height|width",function(a,b,c){return c?void 0:a.getAttribute(b,"type"===b.toLowerCase()?1:2)}),(!tb.attributes||!Nb(function(a){return a.innerHTML="<input/>",a.firstChild.setAttribute("value",""),""===a.firstChild.getAttribute("value")}))&&Ob("value",function(a,b,c){return c||"input"!==a.nodeName.toLowerCase()?void 0:a.defaultValue}),Nb(function(a){return null==a.getAttribute("disabled")})||Ob("checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",function(a,b,c){var d;return c?void 0:(d=a.getAttributeNode(b))&&d.specified?d.value:!0===a[b]?b.toLowerCase():null}),db.find=Kb,db.expr=Kb.selectors,db.expr[":"]=db.expr.pseudos,db.unique=Kb.uniqueSort,db.text=Kb.getText,db.isXMLDoc=Kb.isXML,db.contains=Kb.contains;var Jc={};db.Callbacks=function(a){var b;if("string"==typeof a){if(!(b=Jc[a])){b=a;var d=Jc[b]={};db.each(b.match(fb)||[],function(a,b){d[b]=!0}),b=d}}else b=db.extend({},a);a=b;var e,f,g,h,i,j,k=[],l=!a.once&&[],m=function(b){for(f=a.memory&&b,g=!0,i=j||0,j=0,h=k.length,e=!0;k&&h>i;i++)if(!1===k[i].apply(b[0],b[1])&&a.stopOnFalse){f=!1;break}e=!1,k&&(l?l.length&&m(l.shift()):f?k=[]:n.disable())},n={add:function(){if(k){var b=k.length;!function c(b){db.each(b,function(b,d){var e=db.type(d);"function"===e?(!a.unique||!n.has(d))&&k.push(d):d&&d.length&&"string"!==e&&c(d)})}(arguments),e?h=k.length:f&&(j=b,m(f))}return this},remove:function(){return k&&db.each(arguments,function(a,b){for(var c;-1<(c=db.inArray(b,k,c));)k.splice(c,1),e&&(h>=c&&h--,i>=c&&i--)}),this},has:function(a){return a?-1<db.inArray(a,k):!(!k||!k.length)},empty:function(){return k=[],h=0,this},disable:function(){return k=l=f=c,this},disabled:function(){return!k},lock:function(){return l=c,f||n.disable(),this},locked:function(){return!l},fireWith:function(a,b){return!k||g&&!l||(b=b||[],b=[a,b.slice?b.slice():b],e?l.push(b):m(b)),this},fire:function(){return n.fireWith(this,arguments),this},fired:function(){return!!g}};return n},db.extend({Deferred:function(a){var b=[["resolve","done",db.Callbacks("once memory"),"resolved"],["reject","fail",db.Callbacks("once memory"),"rejected"],["notify","progress",db.Callbacks("memory")]],c="pending",d={state:function(){return c},always:function(){return e.done(arguments).fail(arguments),this},then:function(){var a=arguments;return db.Deferred(function(c){db.each(b,function(b,f){var g=f[0],h=db.isFunction(a[b])&&a[b];e[f[1]](function(){var a=h&&h.apply(this,arguments);a&&db.isFunction(a.promise)?a.promise().done(c.resolve).fail(c.reject).progress(c.notify):c[g+"With"](this===d?c.promise():this,h?[a]:arguments)})}),a=null}).promise()},promise:function(a){return null!=a?db.extend(a,d):d}},e={};return d.pipe=d.then,db.each(b,function(a,f){var g=f[2],h=f[3];d[f[1]]=g.add,h&&g.add(function(){c=h},b[1^a][2].disable,b[2][2].lock),e[f[0]]=function(){return e[f[0]+"With"](this===e?d:this,arguments),this},e[f[0]+"With"]=g.fireWith}),d.promise(e),a&&a.call(e,e),e},when:function(a){var b,c,d,e=0,f=$.call(arguments),g=f.length,h=1!==g||a&&db.isFunction(a.promise)?g:0,i=1===h?a:db.Deferred(),j=function(a,c,d){return function(e){c[a]=this,d[a]=1<arguments.length?$.call(arguments):e,d===b?i.notifyWith(c,d):--h||i.resolveWith(c,d)}};if(g>1)for(b=Array(g),c=Array(g),d=Array(g);g>e;e++)f[e]&&db.isFunction(f[e].promise)?f[e].promise().done(j(e,d,f)).fail(i.reject).progress(j(e,c,b)):--h;return h||i.resolveWith(d,f),i.promise()}});var Kc,Lc,Mc,Nc,Oc,Pc,Qc,Rc,Sc,Tc=db,Uc={},Vc=S.createElement("div");if(Vc.setAttribute("className","t"),Vc.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",Kc=Vc.getElementsByTagName("*")||[],(Lc=Vc.getElementsByTagName("a")[0])&&Lc.style&&Kc.length){Nc=S.createElement("select"),Pc=Nc.appendChild(S.createElement("option")),Mc=Vc.getElementsByTagName("input")[0],Lc.style.cssText="top:1px;float:left;opacity:.5",Uc.getSetAttribute="t"!==Vc.className,Uc.leadingWhitespace=3===Vc.firstChild.nodeType,Uc.tbody=!Vc.getElementsByTagName("tbody").length,Uc.htmlSerialize=!!Vc.getElementsByTagName("link").length,Uc.style=/top/.test(Lc.getAttribute("style")),Uc.hrefNormalized="/a"===Lc.getAttribute("href"),Uc.opacity=/^0.5/.test(Lc.style.opacity),Uc.cssFloat=!!Lc.style.cssFloat,Uc.checkOn=!!Mc.value,Uc.optSelected=Pc.selected,Uc.enctype=!!S.createElement("form").enctype,Uc.html5Clone="<:nav></:nav>"!==S.createElement("nav").cloneNode(!0).outerHTML,Uc.inlineBlockNeedsLayout=!1,Uc.shrinkWrapBlocks=!1,Uc.pixelPosition=!1,Uc.deleteExpando=!0,Uc.noCloneEvent=!0,Uc.reliableMarginRight=!0,Uc.boxSizingReliable=!0,Mc.checked=!0,Uc.noCloneChecked=Mc.cloneNode(!0).checked,Nc.disabled=!0,Uc.optDisabled=!Pc.disabled;try{delete Vc.test}catch(Wc){Uc.deleteExpando=!1}Mc=S.createElement("input"),Mc.setAttribute("value",""),Uc.input=""===Mc.getAttribute("value"),Mc.value="t",Mc.setAttribute("type","radio"),Uc.radioValue="t"===Mc.value,Mc.setAttribute("checked","t"),Mc.setAttribute("name","t"),Oc=S.createDocumentFragment(),Oc.appendChild(Mc),Uc.appendChecked=Mc.checked,Uc.checkClone=Oc.cloneNode(!0).cloneNode(!0).lastChild.checked,Vc.attachEvent&&(Vc.attachEvent("onclick",function(){Uc.noCloneEvent=!1}),Vc.cloneNode(!0).click());for(Sc in{submit:!0,change:!0,focusin:!0})Vc.setAttribute(Qc="on"+Sc,"t"),Uc[Sc+"Bubbles"]=Qc in a||!1===Vc.attributes[Qc].expando;Vc.style.backgroundClip="content-box",Vc.cloneNode(!0).style.backgroundClip="",Uc.clearCloneStyle="content-box"===Vc.style.backgroundClip;for(Sc in db(Uc))break;Uc.ownLast="0"!==Sc,db(function(){var b,c,d=S.getElementsByTagName("body")[0];d&&(b=S.createElement("div"),b.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px",d.appendChild(b).appendChild(Vc),Vc.innerHTML="<table><tr><td></td><td>t</td></tr></table>",c=Vc.getElementsByTagName("td"),c[0].style.cssText="padding:0;margin:0;border:0;display:none",Rc=0===c[0].offsetHeight,c[0].style.display="",c[1].style.display="none",Uc.reliableHiddenOffsets=Rc&&0===c[0].offsetHeight,Vc.innerHTML="",Vc.style.cssText="box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%;",db.swap(d,null!=d.style.zoom?{zoom:1}:{},function(){Uc.boxSizing=4===Vc.offsetWidth}),a.getComputedStyle&&(Uc.pixelPosition="1%"!==(a.getComputedStyle(Vc,null)||{}).top,Uc.boxSizingReliable="4px"===(a.getComputedStyle(Vc,null)||{width:"4px"}).width,c=Vc.appendChild(S.createElement("div")),c.style.cssText=Vc.style.cssText="padding:0;margin:0;border:0;display:block;box-sizing:content-box;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;",c.style.marginRight=c.style.width="0",Vc.style.width="1px",Uc.reliableMarginRight=!parseFloat((a.getComputedStyle(c,null)||{}).marginRight)),typeof Vc.style.zoom!==Q&&(Vc.innerHTML="",Vc.style.cssText="padding:0;margin:0;border:0;display:block;box-sizing:content-box;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;width:1px;padding:1px;display:inline;zoom:1",Uc.inlineBlockNeedsLayout=3===Vc.offsetWidth,Vc.style.display="block",Vc.innerHTML="<div></div>",Vc.firstChild.style.width="5px",Uc.shrinkWrapBlocks=3!==Vc.offsetWidth,Uc.inlineBlockNeedsLayout&&(d.style.zoom=1)),d.removeChild(b),b=Vc=c=c=null)}),Kc=Nc=Oc=Pc=Lc=Mc=null}Tc.support=Uc;var Xc=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,Yc=/([A-Z])/g;db.extend({cache:{},noData:{applet:!0,embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"},hasData:function(a){return a=a.nodeType?db.cache[a[db.expando]]:a[db.expando],!!a&&!h(a)},data:function(a,b,c){return e(a,b,c)},removeData:function(a,b){return f(a,b)},_data:function(a,b,c){return e(a,b,c,!0)},_removeData:function(a,b){return f(a,b,!0)},acceptData:function(a){if(a.nodeType&&1!==a.nodeType&&9!==a.nodeType)return!1;var b=a.nodeName&&db.noData[a.nodeName.toLowerCase()];return!b||!0!==b&&a.getAttribute("classid")===b}}),db.fn.extend({data:function(a,b){var d,e,f=null,h=0,i=this[0];if(a===c){if(this.length&&(f=db.data(i),1===i.nodeType&&!db._data(i,"parsedAttrs"))){for(d=i.attributes;h<d.length;h++)e=d[h].name,0===e.indexOf("data-")&&(e=db.camelCase(e.slice(5)),g(i,e,f[e]));db._data(i,"parsedAttrs",!0)}return f}return"object"==typeof a?this.each(function(){db.data(this,a)}):1<arguments.length?this.each(function(){db.data(this,a,b)}):i?g(i,a,db.data(i,a)):null},removeData:function(a){return this.each(function(){db.removeData(this,a)})}}),db.extend({queue:function(a,b,c){var d;return a?(b=(b||"fx")+"queue",d=db._data(a,b),c&&(!d||db.isArray(c)?d=db._data(a,b,db.makeArray(c)):d.push(c)),d||[]):void 0},dequeue:function(a,b){b=b||"fx";var c=db.queue(a,b),d=c.length,e=c.shift(),f=db._queueHooks(a,b),g=function(){db.dequeue(a,b)};"inprogress"===e&&(e=c.shift(),d--),e&&("fx"===b&&c.unshift("inprogress"),delete f.stop,e.call(a,g,f)),!d&&f&&f.empty.fire()},_queueHooks:function(a,b){var c=b+"queueHooks";return db._data(a,c)||db._data(a,c,{empty:db.Callbacks("once memory").add(function(){db._removeData(a,b+"queue"),db._removeData(a,c)})})}}),db.fn.extend({queue:function(a,b){var d=2;return"string"!=typeof a&&(b=a,a="fx",d--),arguments.length<d?db.queue(this[0],a):b===c?this:this.each(function(){var c=db.queue(this,a,b);db._queueHooks(this,a),"fx"===a&&"inprogress"!==c[0]&&db.dequeue(this,a)})},dequeue:function(a){return this.each(function(){db.dequeue(this,a)})},delay:function(a,b){return a=db.fx?db.fx.speeds[a]||a:a,this.queue(b||"fx",function(b,c){var d=setTimeout(b,a);c.stop=function(){clearTimeout(d)}})},clearQueue:function(a){return this.queue(a||"fx",[])},promise:function(a,b){var d,e=1,f=db.Deferred(),g=this,h=this.length,i=function(){--e||f.resolveWith(g,[g])};for("string"!=typeof a&&(b=a,a=c),a=a||"fx";h--;)(d=db._data(g[h],a+"queueHooks"))&&d.empty&&(e++,d.empty.add(i));return i(),f.promise(b)}});var Zc,$c,_c=/[\t\r\n\f]/g,ad=/\r/g,bd=/^(?:input|select|textarea|button|object)$/i,cd=/^(?:a|area)$/i,dd=/^(?:checked|selected)$/i,ed=db.support.getSetAttribute,fd=db.support.input;db.fn.extend({attr:function(a,b){return db.access(this,db.attr,a,b,1<arguments.length)},removeAttr:function(a){return this.each(function(){db.removeAttr(this,a)})},prop:function(a,b){return db.access(this,db.prop,a,b,1<arguments.length)},removeProp:function(a){return a=db.propFix[a]||a,this.each(function(){try{this[a]=c,delete this[a]}catch(b){}})},addClass:function(a){var b,c,d,e,f,g=0,h=this.length;if(b="string"==typeof a&&a,db.isFunction(a))return this.each(function(b){db(this).addClass(a.call(this,b,this.className))});if(b)for(b=(a||"").match(fb)||[];h>g;g++)if(c=this[g],d=1===c.nodeType&&(c.className?(" "+c.className+" ").replace(_c," "):" ")){for(f=0;e=b[f++];)0>d.indexOf(" "+e+" ")&&(d+=e+" ");c.className=db.trim(d)}return this},removeClass:function(a){var b,c,d,e,f,g=0,h=this.length;if(b=0===arguments.length||"string"==typeof a&&a,db.isFunction(a))return this.each(function(b){db(this).removeClass(a.call(this,b,this.className))});if(b)for(b=(a||"").match(fb)||[];h>g;g++)if(c=this[g],d=1===c.nodeType&&(c.className?(" "+c.className+" ").replace(_c," "):"")){for(f=0;e=b[f++];)for(;0<=d.indexOf(" "+e+" ");)d=d.replace(" "+e+" "," ");c.className=a?db.trim(d):""}return this},toggleClass:function(a,b){var c=typeof a;return"boolean"==typeof b&&"string"===c?b?this.addClass(a):this.removeClass(a):this.each(db.isFunction(a)?function(c){db(this).toggleClass(a.call(this,c,this.className,b),b)}:function(){if("string"===c)for(var b,d=0,e=db(this),f=a.match(fb)||[];b=f[d++];)e.hasClass(b)?e.removeClass(b):e.addClass(b);else(c===Q||"boolean"===c)&&(this.className&&db._data(this,"__className__",this.className),this.className=this.className||!1===a?"":db._data(this,"__className__")||"")})},hasClass:function(a){a=" "+a+" ";for(var b=0,c=this.length;c>b;b++)if(1===this[b].nodeType&&0<=(" "+this[b].className+" ").replace(_c," ").indexOf(a))return!0;return!1},val:function(a){var b,d,e,f=this[0];return arguments.length?(e=db.isFunction(a),this.each(function(b){1!==this.nodeType||(b=e?a.call(this,b,db(this).val()):a,null==b?b="":"number"==typeof b?b+="":db.isArray(b)&&(b=db.map(b,function(a){return null==a?"":a+""})),d=db.valHooks[this.type]||db.valHooks[this.nodeName.toLowerCase()],d&&"set"in d&&d.set(this,b,"value")!==c)||(this.value=b)})):f?(d=db.valHooks[f.type]||db.valHooks[f.nodeName.toLowerCase()])&&"get"in d&&(b=d.get(f,"value"))!==c?b:(b=f.value,"string"==typeof b?b.replace(ad,""):null==b?"":b):void 0}}),db.extend({valHooks:{option:{get:function(a){var b=db.find.attr(a,"value");return null!=b?b:a.text}},select:{get:function(a){for(var b,c=a.options,d=a.selectedIndex,e=(a="select-one"===a.type||0>d)?null:[],f=a?d+1:c.length,g=0>d?f:a?d:0;f>g;g++)if(b=c[g],!(!b.selected&&g!==d||(db.support.optDisabled?b.disabled:null!==b.getAttribute("disabled"))||b.parentNode.disabled&&db.nodeName(b.parentNode,"optgroup"))){if(b=db(b).val(),a)return b;e.push(b)}return e},set:function(a,b){for(var c,d,e=a.options,f=db.makeArray(b),g=e.length;g--;)d=e[g],(d.selected=0<=db.inArray(db(d).val(),f))&&(c=!0);return c||(a.selectedIndex=-1),f}}},attr:function(a,b,d){var e,f,g=a.nodeType;if(a&&3!==g&&8!==g&&2!==g){if(typeof a.getAttribute===Q)return db.prop(a,b,d);if(1===g&&db.isXMLDoc(a)||(b=b.toLowerCase(),e=db.attrHooks[b]||(db.expr.match.bool.test(b)?$c:Zc)),d===c)return e&&"get"in e&&null!==(f=e.get(a,b))?f:(f=db.find.attr(a,b),null==f?c:f);if(null!==d)return e&&"set"in e&&(f=e.set(a,d,b))!==c?f:(a.setAttribute(b,d+""),d);db.removeAttr(a,b)}},removeAttr:function(a,b){var c,d,e=0,f=b&&b.match(fb);if(f&&1===a.nodeType)for(;c=f[e++];)d=db.propFix[c]||c,db.expr.match.bool.test(c)?fd&&ed||!dd.test(c)?a[d]=!1:a[db.camelCase("default-"+c)]=a[d]=!1:db.attr(a,c,""),a.removeAttribute(ed?c:d)},attrHooks:{type:{set:function(a,b){if(!db.support.radioValue&&"radio"===b&&db.nodeName(a,"input")){var c=a.value;return a.setAttribute("type",b),c&&(a.value=c),b}}}},propFix:{"for":"htmlFor","class":"className"},prop:function(a,b,d){var e,f,g;return g=a.nodeType,a&&3!==g&&8!==g&&2!==g?((g=1!==g||!db.isXMLDoc(a))&&(b=db.propFix[b]||b,f=db.propHooks[b]),d!==c?f&&"set"in f&&(e=f.set(a,d,b))!==c?e:a[b]=d:f&&"get"in f&&null!==(e=f.get(a,b))?e:a[b]):void 0},propHooks:{tabIndex:{get:function(a){var b=db.find.attr(a,"tabindex");return b?parseInt(b,10):bd.test(a.nodeName)||cd.test(a.nodeName)&&a.href?0:-1}}}}),$c={set:function(a,b,c){return!1===b?db.removeAttr(a,c):fd&&ed||!dd.test(c)?a.setAttribute(!ed&&db.propFix[c]||c,c):a[db.camelCase("default-"+c)]=a[c]=!0,c}},db.each(db.expr.match.bool.source.match(/\w+/g),function(a,b){var d=db.expr.attrHandle[b]||db.find.attr;db.expr.attrHandle[b]=fd&&ed||!dd.test(b)?function(a,b,e){var f=db.expr.attrHandle[b];return a=e?c:(db.expr.attrHandle[b]=c)!=d(a,b,e)?b.toLowerCase():null,db.expr.attrHandle[b]=f,a}:function(a,b,d){return d?c:a[db.camelCase("default-"+b)]?b.toLowerCase():null}}),fd&&ed||(db.attrHooks.value={set:function(a,b,c){return db.nodeName(a,"input")?void(a.defaultValue=b):Zc&&Zc.set(a,b,c)}}),ed||(Zc={set:function(a,b,d){var e=a.getAttributeNode(d);return e||a.setAttributeNode(e=a.ownerDocument.createAttribute(d)),e.value=b+="","value"===d||b===a.getAttribute(d)?b:c}},db.expr.attrHandle.id=db.expr.attrHandle.name=db.expr.attrHandle.coords=function(a,b,d){var e;return d?c:(e=a.getAttributeNode(b))&&""!==e.value?e.value:null},db.valHooks.button={get:function(a,b){var d=a.getAttributeNode(b);return d&&d.specified?d.value:c},set:Zc.set},db.attrHooks.contenteditable={set:function(a,b,c){Zc.set(a,""===b?!1:b,c)}},db.each(["width","height"],function(a,b){db.attrHooks[b]={set:function(a,c){return""===c?(a.setAttribute(b,"auto"),c):void 0}}})),db.support.hrefNormalized||db.each(["href","src"],function(a,b){db.propHooks[b]={get:function(a){return a.getAttribute(b,4)}}}),db.support.style||(db.attrHooks.style={get:function(a){return a.style.cssText||c},set:function(a,b){return a.style.cssText=b+""}}),db.support.optSelected||(db.propHooks.selected={get:function(a){return(a=a.parentNode)&&(a.selectedIndex,a.parentNode&&a.parentNode.selectedIndex),null}}),db.each("tabIndex readOnly maxLength cellSpacing cellPadding rowSpan colSpan useMap frameBorder contentEditable".split(" "),function(){db.propFix[this.toLowerCase()]=this
}),db.support.enctype||(db.propFix.enctype="encoding"),db.each(["radio","checkbox"],function(){db.valHooks[this]={set:function(a,b){return db.isArray(b)?a.checked=0<=db.inArray(db(a).val(),b):void 0}},db.support.checkOn||(db.valHooks[this].get=function(a){return null===a.getAttribute("value")?"on":a.value})});var gd=/^(?:input|select|textarea)$/i,hd=/^key/,id=/^(?:mouse|contextmenu)|click/,jd=/^(?:focusinfocus|focusoutblur)$/,kd=/^([^.]*)(?:\.(.+)|)$/;db.event={global:{},add:function(a,b,d,e,f){var g,h,i,j,k,l,m,n,o;if(i=db._data(a)){for(d.handler&&(j=d,d=j.handler,f=j.selector),d.guid||(d.guid=db.guid++),(h=i.events)||(h=i.events={}),(k=i.handle)||(k=i.handle=function(a){return typeof db===Q||a&&db.event.triggered===a.type?c:db.event.dispatch.apply(k.elem,arguments)},k.elem=a),b=(b||"").match(fb)||[""],i=b.length;i--;)g=kd.exec(b[i])||[],n=l=g[1],o=(g[2]||"").split(".").sort(),n&&(g=db.event.special[n]||{},n=(f?g.delegateType:g.bindType)||n,g=db.event.special[n]||{},l=db.extend({type:n,origType:l,data:e,handler:d,guid:d.guid,selector:f,needsContext:f&&db.expr.match.needsContext.test(f),namespace:o.join(".")},j),(m=h[n])||(m=h[n]=[],m.delegateCount=0,g.setup&&!1!==g.setup.call(a,e,o,k)||(a.addEventListener?a.addEventListener(n,k,!1):a.attachEvent&&a.attachEvent("on"+n,k))),g.add&&(g.add.call(a,l),l.handler.guid||(l.handler.guid=d.guid)),f?m.splice(m.delegateCount++,0,l):m.push(l),db.event.global[n]=!0);a=null}},remove:function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q=db.hasData(a)&&db._data(a);if(q&&(k=q.events)){for(b=(b||"").match(fb)||[""],j=b.length;j--;)if(h=kd.exec(b[j])||[],n=p=h[1],o=(h[2]||"").split(".").sort(),n){for(l=db.event.special[n]||{},n=(d?l.delegateType:l.bindType)||n,m=k[n]||[],h=h[2]&&RegExp("(^|\\.)"+o.join("\\.(?:.*\\.|)")+"(\\.|$)"),i=f=m.length;f--;)g=m[f],!e&&p!==g.origType||c&&c.guid!==g.guid||h&&!h.test(g.namespace)||d&&d!==g.selector&&("**"!==d||!g.selector)||(m.splice(f,1),g.selector&&m.delegateCount--,l.remove&&l.remove.call(a,g));i&&!m.length&&((!l.teardown||!1===l.teardown.call(a,o,q.handle))&&db.removeEvent(a,n,q.handle),delete k[n])}else for(n in k)db.event.remove(a,n+b[j],c,d,!0);db.isEmptyObject(k)&&(delete q.handle,db._removeData(a,"events"))}},trigger:function(b,d,e,f){var g,h,i,j,k,l,m=[e||S],n=bb.call(b,"type")?b.type:b;if(k=bb.call(b,"namespace")?b.namespace.split("."):[],i=g=e=e||S,3!==e.nodeType&&8!==e.nodeType&&!jd.test(n+db.event.triggered)&&(0<=n.indexOf(".")&&(k=n.split("."),n=k.shift(),k.sort()),h=0>n.indexOf(":")&&"on"+n,b=b[db.expando]?b:new db.Event(n,"object"==typeof b&&b),b.isTrigger=f?2:3,b.namespace=k.join("."),b.namespace_re=b.namespace?RegExp("(^|\\.)"+k.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,b.result=c,b.target||(b.target=e),d=null==d?[b]:db.makeArray(d,[b]),k=db.event.special[n]||{},f||!(k.trigger&&!1===k.trigger.apply(e,d)))){if(!f&&!k.noBubble&&!db.isWindow(e)){for(j=k.delegateType||n,jd.test(j+n)||(i=i.parentNode);i;i=i.parentNode)m.push(i),g=i;g===(e.ownerDocument||S)&&m.push(g.defaultView||g.parentWindow||a)}for(l=0;(i=m[l++])&&!b.isPropagationStopped();)b.type=l>1?j:k.bindType||n,(g=(db._data(i,"events")||{})[b.type]&&db._data(i,"handle"))&&g.apply(i,d),(g=h&&i[h])&&db.acceptData(i)&&g.apply&&!1===g.apply(i,d)&&b.preventDefault();if(b.type=n,!f&&!b.isDefaultPrevented()&&(!k._default||!1===k._default.apply(m.pop(),d))&&db.acceptData(e)&&h&&e[n]&&!db.isWindow(e)){(g=e[h])&&(e[h]=null),db.event.triggered=n;try{e[n]()}catch(o){}db.event.triggered=c,g&&(e[h]=g)}return b.result}},dispatch:function(a){a=db.event.fix(a);var b,d,e,f,g=[],h=$.call(arguments);b=(db._data(this,"events")||{})[a.type]||[];var i=db.event.special[a.type]||{};if(h[0]=a,a.delegateTarget=this,!i.preDispatch||!1!==i.preDispatch.call(this,a)){for(g=db.event.handlers.call(this,a,b),b=0;(e=g[b++])&&!a.isPropagationStopped();)for(a.currentTarget=e.elem,f=0;(d=e.handlers[f++])&&!a.isImmediatePropagationStopped();)(!a.namespace_re||a.namespace_re.test(d.namespace))&&(a.handleObj=d,a.data=d.data,d=((db.event.special[d.origType]||{}).handle||d.handler).apply(e.elem,h),d!==c&&!1===(a.result=d)&&(a.preventDefault(),a.stopPropagation()));return i.postDispatch&&i.postDispatch.call(this,a),a.result}},handlers:function(a,b){var d,e,f,g,h=[],i=b.delegateCount,j=a.target;if(i&&j.nodeType&&(!a.button||"click"!==a.type))for(;j!=this;j=j.parentNode||this)if(1===j.nodeType&&(!0!==j.disabled||"click"!==a.type)){for(f=[],g=0;i>g;g++)e=b[g],d=e.selector+" ",f[d]===c&&(f[d]=e.needsContext?0<=db(d,this).index(j):db.find(d,this,null,[j]).length),f[d]&&f.push(e);f.length&&h.push({elem:j,handlers:f})}return i<b.length&&h.push({elem:this,handlers:b.slice(i)}),h},fix:function(a){if(a[db.expando])return a;var b,c,d;b=a.type;var e=a,f=this.fixHooks[b];for(f||(this.fixHooks[b]=f=id.test(b)?this.mouseHooks:hd.test(b)?this.keyHooks:{}),d=f.props?this.props.concat(f.props):this.props,a=new db.Event(e),b=d.length;b--;)c=d[b],a[c]=e[c];return a.target||(a.target=e.srcElement||S),3===a.target.nodeType&&(a.target=a.target.parentNode),a.metaKey=!!a.metaKey,f.filter?f.filter(a,e):a},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:["char","charCode","key","keyCode"],filter:function(a,b){return null==a.which&&(a.which=null!=b.charCode?b.charCode:b.keyCode),a}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(a,b){var d,e,f=b.button,g=b.fromElement;return null==a.pageX&&null!=b.clientX&&(d=a.target.ownerDocument||S,e=d.documentElement,d=d.body,a.pageX=b.clientX+(e&&e.scrollLeft||d&&d.scrollLeft||0)-(e&&e.clientLeft||d&&d.clientLeft||0),a.pageY=b.clientY+(e&&e.scrollTop||d&&d.scrollTop||0)-(e&&e.clientTop||d&&d.clientTop||0)),!a.relatedTarget&&g&&(a.relatedTarget=g===a.target?b.toElement:g),!a.which&&f!==c&&(a.which=1&f?1:2&f?3:4&f?2:0),a}},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==k()&&this.focus)try{return this.focus(),!1}catch(a){}},delegateType:"focusin"},blur:{trigger:function(){return this===k()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return db.nodeName(this,"input")&&"checkbox"===this.type&&this.click?(this.click(),!1):void 0},_default:function(a){return db.nodeName(a.target,"a")}},beforeunload:{postDispatch:function(a){a.result!==c&&(a.originalEvent.returnValue=a.result)}}},simulate:function(a,b,c,d){a=db.extend(new db.Event,c,{type:a,isSimulated:!0,originalEvent:{}}),d?db.event.trigger(a,null,b):db.event.dispatch.call(b,a),a.isDefaultPrevented()&&c.preventDefault()}},db.removeEvent=S.removeEventListener?function(a,b,c){a.removeEventListener&&a.removeEventListener(b,c,!1)}:function(a,b,c){b="on"+b,a.detachEvent&&(typeof a[b]===Q&&(a[b]=null),a.detachEvent(b,c))},db.Event=function(a,b){return this instanceof db.Event?(a&&a.type?(this.originalEvent=a,this.type=a.type,this.isDefaultPrevented=a.defaultPrevented||!1===a.returnValue||a.getPreventDefault&&a.getPreventDefault()?i:j):this.type=a,b&&db.extend(this,b),this.timeStamp=a&&a.timeStamp||db.now(),void(this[db.expando]=!0)):new db.Event(a,b)},db.Event.prototype={isDefaultPrevented:j,isPropagationStopped:j,isImmediatePropagationStopped:j,preventDefault:function(){var a=this.originalEvent;this.isDefaultPrevented=i,a&&(a.preventDefault?a.preventDefault():a.returnValue=!1)},stopPropagation:function(){var a=this.originalEvent;this.isPropagationStopped=i,a&&(a.stopPropagation&&a.stopPropagation(),a.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=i,this.stopPropagation()}},db.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(a,b){db.event.special[a]={delegateType:b,bindType:b,handle:function(a){var c,d=a.relatedTarget,e=a.handleObj;return(!d||d!==this&&!db.contains(this,d))&&(a.type=e.origType,c=e.handler.apply(this,arguments),a.type=b),c}}}),db.support.submitBubbles||(db.event.special.submit={setup:function(){return db.nodeName(this,"form")?!1:void db.event.add(this,"click._submit keypress._submit",function(a){a=a.target,(a=db.nodeName(a,"input")||db.nodeName(a,"button")?a.form:c)&&!db._data(a,"submitBubbles")&&(db.event.add(a,"submit._submit",function(a){a._submit_bubble=!0}),db._data(a,"submitBubbles",!0))})},postDispatch:function(a){a._submit_bubble&&(delete a._submit_bubble,this.parentNode&&!a.isTrigger&&db.event.simulate("submit",this.parentNode,a,!0))},teardown:function(){return db.nodeName(this,"form")?!1:void db.event.remove(this,"._submit")}}),db.support.changeBubbles||(db.event.special.change={setup:function(){return gd.test(this.nodeName)?(("checkbox"===this.type||"radio"===this.type)&&(db.event.add(this,"propertychange._change",function(a){"checked"===a.originalEvent.propertyName&&(this._just_changed=!0)}),db.event.add(this,"click._change",function(a){this._just_changed&&!a.isTrigger&&(this._just_changed=!1),db.event.simulate("change",this,a,!0)})),!1):void db.event.add(this,"beforeactivate._change",function(a){a=a.target,gd.test(a.nodeName)&&!db._data(a,"changeBubbles")&&(db.event.add(a,"change._change",function(a){this.parentNode&&!a.isSimulated&&!a.isTrigger&&db.event.simulate("change",this.parentNode,a,!0)}),db._data(a,"changeBubbles",!0))})},handle:function(a){var b=a.target;return this!==b||a.isSimulated||a.isTrigger||"radio"!==b.type&&"checkbox"!==b.type?a.handleObj.handler.apply(this,arguments):void 0},teardown:function(){return db.event.remove(this,"._change"),!gd.test(this.nodeName)}}),db.support.focusinBubbles||db.each({focus:"focusin",blur:"focusout"},function(a,b){var c=0,d=function(a){db.event.simulate(b,a.target,db.event.fix(a),!0)};db.event.special[b]={setup:function(){0===c++&&S.addEventListener(a,d,!0)},teardown:function(){0===--c&&S.removeEventListener(a,d,!0)}}}),db.fn.extend({on:function(a,b,d,e,f){var g,h;if("object"==typeof a){"string"!=typeof b&&(d=d||b,b=c);for(g in a)this.on(g,b,d,a[g],f);return this}if(null==d&&null==e?(e=b,d=b=c):null==e&&("string"==typeof b?(e=d,d=c):(e=d,d=b,b=c)),!1===e)e=j;else if(!e)return this;return 1===f&&(h=e,e=function(a){return db().off(a),h.apply(this,arguments)},e.guid=h.guid||(h.guid=db.guid++)),this.each(function(){db.event.add(this,a,e,d,b)})},one:function(a,b,c,d){return this.on(a,b,c,d,1)},off:function(a,b,d){var e;if(a&&a.preventDefault&&a.handleObj)return e=a.handleObj,db(a.delegateTarget).off(e.namespace?e.origType+"."+e.namespace:e.origType,e.selector,e.handler),this;if("object"==typeof a){for(e in a)this.off(e,b,a[e]);return this}return(!1===b||"function"==typeof b)&&(d=b,b=c),!1===d&&(d=j),this.each(function(){db.event.remove(this,a,d,b)})},trigger:function(a,b){return this.each(function(){db.event.trigger(a,b,this)})},triggerHandler:function(a,b){var c=this[0];return c?db.event.trigger(a,b,c,!0):void 0}});var ld=/^.[^:#\[\.,]*$/,md=/^(?:parents|prev(?:Until|All))/,nd=db.expr.match.needsContext,od={children:!0,contents:!0,next:!0,prev:!0};db.fn.extend({find:function(a){var b,c=[],d=this,e=d.length;if("string"!=typeof a)return this.pushStack(db(a).filter(function(){for(b=0;e>b;b++)if(db.contains(d[b],this))return!0}));for(b=0;e>b;b++)db.find(a,d[b],c);return c=this.pushStack(e>1?db.unique(c):c),c.selector=this.selector?this.selector+" "+a:a,c},has:function(a){var b,c=db(a,this),d=c.length;return this.filter(function(){for(b=0;d>b;b++)if(db.contains(this,c[b]))return!0})},not:function(a){return this.pushStack(m(this,a||[],!0))},filter:function(a){return this.pushStack(m(this,a||[],!1))},is:function(a){return!!m(this,"string"==typeof a&&nd.test(a)?db(a):a||[],!1).length},closest:function(a,b){for(var c,d=0,e=this.length,f=[],g=nd.test(a)||"string"!=typeof a?db(a,b||this.context):0;e>d;d++)for(c=this[d];c&&c!==b;c=c.parentNode)if(11>c.nodeType&&(g?-1<g.index(c):1===c.nodeType&&db.find.matchesSelector(c,a))){f.push(c);break}return this.pushStack(1<f.length?db.unique(f):f)},index:function(a){return a?"string"==typeof a?db.inArray(this[0],db(a)):db.inArray(a.jquery?a[0]:a,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(a,b){var c="string"==typeof a?db(a,b):db.makeArray(a&&a.nodeType?[a]:a),c=db.merge(this.get(),c);return this.pushStack(db.unique(c))},addBack:function(a){return this.add(null==a?this.prevObject:this.prevObject.filter(a))}}),db.each({parent:function(a){return(a=a.parentNode)&&11!==a.nodeType?a:null},parents:function(a){return db.dir(a,"parentNode")},parentsUntil:function(a,b,c){return db.dir(a,"parentNode",c)},next:function(a){return l(a,"nextSibling")},prev:function(a){return l(a,"previousSibling")},nextAll:function(a){return db.dir(a,"nextSibling")},prevAll:function(a){return db.dir(a,"previousSibling")},nextUntil:function(a,b,c){return db.dir(a,"nextSibling",c)},prevUntil:function(a,b,c){return db.dir(a,"previousSibling",c)},siblings:function(a){return db.sibling((a.parentNode||{}).firstChild,a)},children:function(a){return db.sibling(a.firstChild)},contents:function(a){return db.nodeName(a,"iframe")?a.contentDocument||a.contentWindow.document:db.merge([],a.childNodes)}},function(a,b){db.fn[a]=function(c,d){var e=db.map(this,b,c);return"Until"!==a.slice(-5)&&(d=c),d&&"string"==typeof d&&(e=db.filter(d,e)),1<this.length&&(od[a]||(e=db.unique(e)),md.test(a)&&(e=e.reverse())),this.pushStack(e)}}),db.extend({filter:function(a,b,c){var d=b[0];return c&&(a=":not("+a+")"),1===b.length&&1===d.nodeType?db.find.matchesSelector(d,a)?[d]:[]:db.find.matches(a,db.grep(b,function(a){return 1===a.nodeType}))},dir:function(a,b,d){var e=[];for(a=a[b];a&&9!==a.nodeType&&(d===c||1!==a.nodeType||!db(a).is(d));)1===a.nodeType&&e.push(a),a=a[b];return e},sibling:function(a,b){for(var c=[];a;a=a.nextSibling)1===a.nodeType&&a!==b&&c.push(a);return c}});var pd="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",qd=/ jQuery\d+="(?:null|\d+)"/g,rd=RegExp("<(?:"+pd+")[\\s/>]","i"),sd=/^\s+/,td=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,ud=/<([\w:]+)/,vd=/<tbody/i,wd=/<|&#?\w+;/,xd=/<(?:script|style|link)/i,yd=/^(?:checkbox|radio)$/i,zd=/checked\s*(?:[^=]|=\s*.checked.)/i,Ad=/^$|\/(?:java|ecma)script/i,Bd=/^true\/(.*)/,Cd=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,Dd={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:db.support.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},Ed=n(S).appendChild(S.createElement("div"));Dd.optgroup=Dd.option,Dd.tbody=Dd.tfoot=Dd.colgroup=Dd.caption=Dd.thead,Dd.th=Dd.td,db.fn.extend({text:function(a){return db.access(this,function(a){return a===c?db.text(this):this.empty().append((this[0]&&this[0].ownerDocument||S).createTextNode(a))},null,a,arguments.length)},append:function(){return this.domManip(arguments,function(a){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&o(this,a).appendChild(a)})},prepend:function(){return this.domManip(arguments,function(a){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var b=o(this,a);b.insertBefore(a,b.firstChild)}})},before:function(){return this.domManip(arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this)})},after:function(){return this.domManip(arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this.nextSibling)})},remove:function(a,b){for(var c,d=a?db.filter(a,this):this,e=0;null!=(c=d[e]);e++)!b&&1===c.nodeType&&db.cleanData(t(c)),c.parentNode&&(b&&db.contains(c.ownerDocument,c)&&r(t(c,"script")),c.parentNode.removeChild(c));return this},empty:function(){for(var a,b=0;null!=(a=this[b]);b++){for(1===a.nodeType&&db.cleanData(t(a,!1));a.firstChild;)a.removeChild(a.firstChild);a.options&&db.nodeName(a,"select")&&(a.options.length=0)}return this},clone:function(a,b){return a=null==a?!1:a,b=null==b?a:b,this.map(function(){return db.clone(this,a,b)})},html:function(a){return db.access(this,function(a){var b=this[0]||{},d=0,e=this.length;if(a===c)return 1===b.nodeType?b.innerHTML.replace(qd,""):c;if(!("string"!=typeof a||xd.test(a)||!db.support.htmlSerialize&&rd.test(a)||!db.support.leadingWhitespace&&sd.test(a)||Dd[(ud.exec(a)||["",""])[1].toLowerCase()])){a=a.replace(td,"<$1></$2>");try{for(;e>d;d++)b=this[d]||{},1===b.nodeType&&(db.cleanData(t(b,!1)),b.innerHTML=a);b=0}catch(f){}}b&&this.empty().append(a)},null,a,arguments.length)},replaceWith:function(){var a=db.map(this,function(a){return[a.nextSibling,a.parentNode]}),b=0;return this.domManip(arguments,function(c){var d=a[b++],e=a[b++];e&&(d&&d.parentNode!==e&&(d=this.nextSibling),db(this).remove(),e.insertBefore(c,d))},!0),b?this:this.remove()},detach:function(a){return this.remove(a,!0)},domManip:function(a,b,c){a=Y.apply([],a);var d,e,f,g,h=0,i=this.length,j=this,k=i-1,l=a[0],m=db.isFunction(l);if(m||!(1>=i||"string"!=typeof l||db.support.checkClone)&&zd.test(l))return this.each(function(d){var e=j.eq(d);m&&(a[0]=l.call(this,d,e.html())),e.domManip(a,b,c)});if(i&&(g=db.buildFragment(a,this[0].ownerDocument,!1,!c&&this),d=g.firstChild,1===g.childNodes.length&&(g=d),d)){for(f=db.map(t(g,"script"),p),e=f.length;i>h;h++)d=g,h!==k&&(d=db.clone(d,!0,!0),e&&db.merge(f,t(d,"script"))),b.call(this[h],d,h);if(e)for(g=f[f.length-1].ownerDocument,db.map(f,q),h=0;e>h;h++)d=f[h],Ad.test(d.type||"")&&!db._data(d,"globalEval")&&db.contains(g,d)&&(d.src?db._evalUrl(d.src):db.globalEval((d.text||d.textContent||d.innerHTML||"").replace(Cd,"")));g=d=null}return this}}),db.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(a,b){db.fn[a]=function(a){for(var c=0,d=[],e=db(a),f=e.length-1;f>=c;c++)a=c===f?this:this.clone(!0),db(e[c])[b](a),Z.apply(d,a.get());return this.pushStack(d)}}),db.extend({clone:function(a,b,c){var d,e,f,g,h,i=db.contains(a.ownerDocument,a);if(db.support.html5Clone||db.isXMLDoc(a)||!rd.test("<"+a.nodeName+">")?f=a.cloneNode(!0):(Ed.innerHTML=a.outerHTML,Ed.removeChild(f=Ed.firstChild)),!(db.support.noCloneEvent&&db.support.noCloneChecked||1!==a.nodeType&&11!==a.nodeType||db.isXMLDoc(a)))for(d=t(f),h=t(a),g=0;null!=(e=h[g]);++g)if(d[g]){var j=d[g],k=void 0,l=void 0,m=void 0;if(1===j.nodeType){if(k=j.nodeName.toLowerCase(),!db.support.noCloneEvent&&j[db.expando]){m=db._data(j);for(l in m.events)db.removeEvent(j,l,m.handle);j.removeAttribute(db.expando)}"script"===k&&j.text!==e.text?(p(j).text=e.text,q(j)):"object"===k?(j.parentNode&&(j.outerHTML=e.outerHTML),db.support.html5Clone&&e.innerHTML&&!db.trim(j.innerHTML)&&(j.innerHTML=e.innerHTML)):"input"===k&&yd.test(e.type)?(j.defaultChecked=j.checked=e.checked,j.value!==e.value&&(j.value=e.value)):"option"===k?j.defaultSelected=j.selected=e.defaultSelected:("input"===k||"textarea"===k)&&(j.defaultValue=e.defaultValue)}}if(b)if(c)for(h=h||t(a),d=d||t(f),g=0;null!=(e=h[g]);g++)s(e,d[g]);else s(a,f);return d=t(f,"script"),0<d.length&&r(d,!i&&t(a,"script")),f},buildFragment:function(a,b,c,d){for(var e,f,g,h,i,j,k=a.length,l=n(b),m=[],o=0;k>o;o++)if((f=a[o])||0===f)if("object"===db.type(f))db.merge(m,f.nodeType?[f]:f);else if(wd.test(f)){for(g=g||l.appendChild(b.createElement("div")),h=(ud.exec(f)||["",""])[1].toLowerCase(),j=Dd[h]||Dd._default,g.innerHTML=j[1]+f.replace(td,"<$1></$2>")+j[2],e=j[0];e--;)g=g.lastChild;if(!db.support.leadingWhitespace&&sd.test(f)&&m.push(b.createTextNode(sd.exec(f)[0])),!db.support.tbody)for(e=(f="table"!==h||vd.test(f)?"<table>"!==j[1]||vd.test(f)?0:g:g.firstChild)&&f.childNodes.length;e--;)db.nodeName(i=f.childNodes[e],"tbody")&&!i.childNodes.length&&f.removeChild(i);for(db.merge(m,g.childNodes),g.textContent="";g.firstChild;)g.removeChild(g.firstChild);g=l.lastChild}else m.push(b.createTextNode(f));for(g&&l.removeChild(g),db.support.appendChecked||db.grep(t(m,"input"),u),o=0;f=m[o++];)if((!d||-1===db.inArray(f,d))&&(a=db.contains(f.ownerDocument,f),g=t(l.appendChild(f),"script"),a&&r(g),c))for(e=0;f=g[e++];)Ad.test(f.type||"")&&c.push(f);return l},cleanData:function(a,b){for(var c,d,e,f,g=0,h=db.expando,i=db.cache,j=db.support.deleteExpando,k=db.event.special;null!=(c=a[g]);g++)if((b||db.acceptData(c))&&(f=(e=c[h])&&i[e])){if(f.events)for(d in f.events)k[d]?db.event.remove(c,d):db.removeEvent(c,d,f.handle);i[e]&&(delete i[e],j?delete c[h]:typeof c.removeAttribute!==Q?c.removeAttribute(h):c[h]=null,X.push(e))}},_evalUrl:function(a){return db.ajax({url:a,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})}}),db.fn.extend({wrapAll:function(a){if(db.isFunction(a))return this.each(function(b){db(this).wrapAll(a.call(this,b))});if(this[0]){var b=db(a,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&b.insertBefore(this[0]),b.map(function(){for(var a=this;a.firstChild&&1===a.firstChild.nodeType;)a=a.firstChild;return a}).append(this)}return this},wrapInner:function(a){return this.each(db.isFunction(a)?function(b){db(this).wrapInner(a.call(this,b))}:function(){var b=db(this),c=b.contents();c.length?c.wrapAll(a):b.append(a)})},wrap:function(a){var b=db.isFunction(a);return this.each(function(c){db(this).wrapAll(b?a.call(this,c):a)})},unwrap:function(){return this.parent().each(function(){db.nodeName(this,"body")||db(this).replaceWith(this.childNodes)}).end()}});var Fd,Gd,Hd,Id=/alpha\([^)]*\)/i,Jd=/opacity\s*=\s*([^)]*)/,Kd=/^(top|right|bottom|left)$/,Ld=/^(none|table(?!-c[ea]).+)/,Md=/^margin/,Nd=RegExp("^("+eb+")(.*)$","i"),Od=RegExp("^("+eb+")(?!px)[a-z%]+$","i"),Pd=RegExp("^([+-])=("+eb+")","i"),Qd={BODY:"block"},Rd={position:"absolute",visibility:"hidden",display:"block"},Sd={letterSpacing:0,fontWeight:400},Td=["Top","Right","Bottom","Left"],Ud=["Webkit","O","Moz","ms"];db.fn.extend({css:function(a,b){return db.access(this,function(a,b,d){var e,f={},g=0;if(db.isArray(b)){for(e=Gd(a),d=b.length;d>g;g++)f[b[g]]=db.css(a,b[g],!1,e);return f}return d!==c?db.style(a,b,d):db.css(a,b)},a,b,1<arguments.length)},show:function(){return x(this,!0)},hide:function(){return x(this)},toggle:function(a){return"boolean"==typeof a?a?this.show():this.hide():this.each(function(){w(this)?db(this).show():db(this).hide()})}}),db.extend({cssHooks:{opacity:{get:function(a,b){if(b){var c=Hd(a,"opacity");return""===c?"1":c}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":db.support.cssFloat?"cssFloat":"styleFloat"},style:function(a,b,d,e){if(a&&3!==a.nodeType&&8!==a.nodeType&&a.style){var f,g,h,i=db.camelCase(b),j=a.style;if(b=db.cssProps[i]||(db.cssProps[i]=v(j,i)),h=db.cssHooks[b]||db.cssHooks[i],d===c)return h&&"get"in h&&(f=h.get(a,!1,e))!==c?f:j[b];if(g=typeof d,"string"===g&&(f=Pd.exec(d))&&(d=(f[1]+1)*f[2]+parseFloat(db.css(a,b)),g="number"),!(null==d||"number"===g&&isNaN(d)||("number"===g&&!db.cssNumber[i]&&(d+="px"),!db.support.clearCloneStyle&&""===d&&0===b.indexOf("background")&&(j[b]="inherit"),h&&"set"in h&&(d=h.set(a,d,e))===c)))try{j[b]=d}catch(k){}}},css:function(a,b,d,e){var f,g;return g=db.camelCase(b),b=db.cssProps[g]||(db.cssProps[g]=v(a.style,g)),(g=db.cssHooks[b]||db.cssHooks[g])&&"get"in g&&(f=g.get(a,!0,d)),f===c&&(f=Hd(a,b,e)),"normal"===f&&b in Sd&&(f=Sd[b]),""===d||d?(a=parseFloat(f),!0===d||db.isNumeric(a)?a||0:f):f}}),a.getComputedStyle?(Gd=function(b){return a.getComputedStyle(b,null)},Hd=function(a,b,d){var e,f=(d=d||Gd(a))?d.getPropertyValue(b)||d[b]:c,g=a.style;return d&&(""===f&&!db.contains(a.ownerDocument,a)&&(f=db.style(a,b)),Od.test(f)&&Md.test(b)&&(a=g.width,b=g.minWidth,e=g.maxWidth,g.minWidth=g.maxWidth=g.width=f,f=d.width,g.width=a,g.minWidth=b,g.maxWidth=e)),f}):S.documentElement.currentStyle&&(Gd=function(a){return a.currentStyle},Hd=function(a,b,d){var e,f,g=(d=d||Gd(a))?d[b]:c,h=a.style;return null==g&&h&&h[b]&&(g=h[b]),Od.test(g)&&!Kd.test(b)&&(d=h.left,(f=(e=a.runtimeStyle)&&e.left)&&(e.left=a.currentStyle.left),h.left="fontSize"===b?"1em":g,g=h.pixelLeft+"px",h.left=d,f&&(e.left=f)),""===g?"auto":g}),db.each(["height","width"],function(a,b){db.cssHooks[b]={get:function(a,c,d){return c?0===a.offsetWidth&&Ld.test(db.css(a,"display"))?db.swap(a,Rd,function(){return A(a,b,d)}):A(a,b,d):void 0},set:function(a,c,d){var e=d&&Gd(a);return y(a,c,d?z(a,b,d,db.support.boxSizing&&"border-box"===db.css(a,"boxSizing",!1,e),e):0)}}}),db.support.opacity||(db.cssHooks.opacity={get:function(a,b){return Jd.test((b&&a.currentStyle?a.currentStyle.filter:a.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":b?"1":""},set:function(a,b){var c=a.style,d=a.currentStyle,e=db.isNumeric(b)?"alpha(opacity="+100*b+")":"",f=d&&d.filter||c.filter||"";c.zoom=1,(b>=1||""===b)&&""===db.trim(f.replace(Id,""))&&c.removeAttribute&&(c.removeAttribute("filter"),""===b||d&&!d.filter)||(c.filter=Id.test(f)?f.replace(Id,e):f+" "+e)}}),db(function(){db.support.reliableMarginRight||(db.cssHooks.marginRight={get:function(a,b){return b?db.swap(a,{display:"inline-block"},Hd,[a,"marginRight"]):void 0}}),!db.support.pixelPosition&&db.fn.position&&db.each(["top","left"],function(a,b){db.cssHooks[b]={get:function(a,c){return c?(c=Hd(a,b),Od.test(c)?db(a).position()[b]+"px":c):void 0}}})}),db.expr&&db.expr.filters&&(db.expr.filters.hidden=function(a){return 0>=a.offsetWidth&&0>=a.offsetHeight||!db.support.reliableHiddenOffsets&&"none"===(a.style&&a.style.display||db.css(a,"display"))},db.expr.filters.visible=function(a){return!db.expr.filters.hidden(a)}),db.each({margin:"",padding:"",border:"Width"},function(a,b){db.cssHooks[a+b]={expand:function(c){var d=0,e={};for(c="string"==typeof c?c.split(" "):[c];4>d;d++)e[a+Td[d]+b]=c[d]||c[d-2]||c[0];return e}},Md.test(a)||(db.cssHooks[a+b].set=y)});var Vd=/%20/g,Wd=/\[\]$/,Xd=/\r?\n/g,Yd=/^(?:submit|button|image|reset|file)$/i,Zd=/^(?:input|select|textarea|keygen)/i;db.fn.extend({serialize:function(){return db.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var a=db.prop(this,"elements");return a?db.makeArray(a):this}).filter(function(){var a=this.type;return this.name&&!db(this).is(":disabled")&&Zd.test(this.nodeName)&&!Yd.test(a)&&(this.checked||!yd.test(a))}).map(function(a,b){var c=db(this).val();return null==c?null:db.isArray(c)?db.map(c,function(a){return{name:b.name,value:a.replace(Xd,"\r\n")}}):{name:b.name,value:c.replace(Xd,"\r\n")}}).get()}}),db.param=function(a,b){var d,e=[],f=function(a,b){b=db.isFunction(b)?b():null==b?"":b,e[e.length]=encodeURIComponent(a)+"="+encodeURIComponent(b)};if(b===c&&(b=db.ajaxSettings&&db.ajaxSettings.traditional),db.isArray(a)||a.jquery&&!db.isPlainObject(a))db.each(a,function(){f(this.name,this.value)});else for(d in a)D(d,a[d],b,f);return e.join("&").replace(Vd,"+")},db.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(a,b){db.fn[b]=function(a,c){return 0<arguments.length?this.on(b,null,a,c):this.trigger(b)}}),db.fn.extend({hover:function(a,b){return this.mouseenter(a).mouseleave(b||a)},bind:function(a,b,c){return this.on(a,null,b,c)},unbind:function(a,b){return this.off(a,null,b)},delegate:function(a,b,c,d){return this.on(b,a,c,d)},undelegate:function(a,b,c){return 1===arguments.length?this.off(a,"**"):this.off(b,a||"**",c)}});var $d,_d,ae=db.now(),be=/\?/,ce=/#.*$/,de=/([?&])_=[^&]*/,ee=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,fe=/^(?:GET|HEAD)$/,ge=/^\/\//,he=/^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,ie=db.fn.load,je={},ke={},le="*/".concat("*");try{_d=R.href}catch(me){_d=S.createElement("a"),_d.href="",_d=_d.href}$d=he.exec(_d.toLowerCase())||[],db.fn.load=function(a,b,d){if("string"!=typeof a&&ie)return ie.apply(this,arguments);var e,f,g,h=this,i=a.indexOf(" ");return i>=0&&(e=a.slice(i,a.length),a=a.slice(0,i)),db.isFunction(b)?(d=b,b=c):b&&"object"==typeof b&&(g="POST"),0<h.length&&db.ajax({url:a,type:g,dataType:"html",data:b}).done(function(a){f=arguments,h.html(e?db("<div>").append(db.parseHTML(a)).find(e):a)}).complete(d&&function(a,b){h.each(d,f||[a.responseText,b,a])}),this},db.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(a,b){db.fn[b]=function(a){return this.on(b,a)}}),db.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:_d,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test($d[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":le,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":db.parseJSON,"text xml":db.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(a,b){return b?G(G(a,db.ajaxSettings),b):G(db.ajaxSettings,a)},ajaxPrefilter:E(je),ajaxTransport:E(ke),ajax:function(a,b){function d(a,b,d,e){var f,l,s,t;if(t=b,2!==u){if(u=2,i&&clearTimeout(i),k=c,h=e||"",w.readyState=a>0?4:0,e=a>=200&&300>a||304===a,d){s=m;for(var v,x,y,z,A=w,B=s.contents,C=s.dataTypes;"*"===C[0];)C.shift(),x===c&&(x=s.mimeType||A.getResponseHeader("Content-Type"));if(x)for(z in B)if(B[z]&&B[z].test(x)){C.unshift(z);break}if(C[0]in d)y=C[0];else{for(z in d){if(!C[0]||s.converters[z+" "+C[0]]){y=z;break}v||(v=z)}y=y||v}y?(y!==C[0]&&C.unshift(y),s=d[y]):s=void 0}a:{d=m,v=s,x=w,y=e;var D,E,F,A={},B=d.dataTypes.slice();if(B[1])for(E in d.converters)A[E.toLowerCase()]=d.converters[E];for(z=B.shift();z;)if(d.responseFields[z]&&(x[d.responseFields[z]]=v),!F&&y&&d.dataFilter&&(v=d.dataFilter(v,d.dataType)),F=z,z=B.shift())if("*"===z)z=F;else if("*"!==F&&F!==z){if(E=A[F+" "+z]||A["* "+z],!E)for(D in A)if(s=D.split(" "),s[1]===z&&(E=A[F+" "+s[0]]||A["* "+s[0]])){!0===E?E=A[D]:!0!==A[D]&&(z=s[0],B.unshift(s[1]));break}if(!0!==E)if(E&&d["throws"])v=E(v);else try{v=E(v)}catch(G){s={state:"parsererror",error:E?G:"No conversion from "+F+" to "+z};break a}}s={state:"success",data:v}}e?(m.ifModified&&((t=w.getResponseHeader("Last-Modified"))&&(db.lastModified[g]=t),(t=w.getResponseHeader("etag"))&&(db.etag[g]=t)),204===a||"HEAD"===m.type?t="nocontent":304===a?t="notmodified":(t=s.state,f=s.data,l=s.error,e=!l)):(l=t,(a||!t)&&(t="error",0>a&&(a=0))),w.status=a,w.statusText=(b||t)+"",e?p.resolveWith(n,[f,t,w]):p.rejectWith(n,[w,t,l]),w.statusCode(r),r=c,j&&o.trigger(e?"ajaxSuccess":"ajaxError",[w,m,e?f:l]),q.fireWith(n,[w,t]),j&&(o.trigger("ajaxComplete",[w,m]),--db.active||db.event.trigger("ajaxStop"))}}"object"==typeof a&&(b=a,a=c),b=b||{};var e,f,g,h,i,j,k,l,m=db.ajaxSetup({},b),n=m.context||m,o=m.context&&(n.nodeType||n.jquery)?db(n):db.event,p=db.Deferred(),q=db.Callbacks("once memory"),r=m.statusCode||{},s={},t={},u=0,v="canceled",w={readyState:0,getResponseHeader:function(a){var b;if(2===u){if(!l)for(l={};b=ee.exec(h);)l[b[1].toLowerCase()]=b[2];b=l[a.toLowerCase()]}return null==b?null:b},getAllResponseHeaders:function(){return 2===u?h:null},setRequestHeader:function(a,b){var c=a.toLowerCase();return u||(a=t[c]=t[c]||a,s[a]=b),this},overrideMimeType:function(a){return u||(m.mimeType=a),this},statusCode:function(a){var b;if(a)if(2>u)for(b in a)r[b]=[r[b],a[b]];else w.always(a[w.status]);return this},abort:function(a){return a=a||v,k&&k.abort(a),d(0,a),this}};if(p.promise(w).complete=q.add,w.success=w.done,w.error=w.fail,m.url=((a||m.url||_d)+"").replace(ce,"").replace(ge,$d[1]+"//"),m.type=b.method||b.type||m.method||m.type,m.dataTypes=db.trim(m.dataType||"*").toLowerCase().match(fb)||[""],null==m.crossDomain&&(e=he.exec(m.url.toLowerCase()),m.crossDomain=!(!e||e[1]===$d[1]&&e[2]===$d[2]&&(e[3]||("http:"===e[1]?"80":"443"))===($d[3]||("http:"===$d[1]?"80":"443")))),m.data&&m.processData&&"string"!=typeof m.data&&(m.data=db.param(m.data,m.traditional)),F(je,m,b,w),2===u)return w;
(j=m.global)&&0===db.active++&&db.event.trigger("ajaxStart"),m.type=m.type.toUpperCase(),m.hasContent=!fe.test(m.type),g=m.url,m.hasContent||(m.data&&(g=m.url+=(be.test(g)?"&":"?")+m.data,delete m.data),!1===m.cache&&(m.url=de.test(g)?g.replace(de,"$1_="+ae++):g+(be.test(g)?"&":"?")+"_="+ae++)),m.ifModified&&(db.lastModified[g]&&w.setRequestHeader("If-Modified-Since",db.lastModified[g]),db.etag[g]&&w.setRequestHeader("If-None-Match",db.etag[g])),(m.data&&m.hasContent&&!1!==m.contentType||b.contentType)&&w.setRequestHeader("Content-Type",m.contentType),w.setRequestHeader("Accept",m.dataTypes[0]&&m.accepts[m.dataTypes[0]]?m.accepts[m.dataTypes[0]]+("*"!==m.dataTypes[0]?", "+le+"; q=0.01":""):m.accepts["*"]);for(f in m.headers)w.setRequestHeader(f,m.headers[f]);if(m.beforeSend&&(!1===m.beforeSend.call(n,w,m)||2===u))return w.abort();v="abort";for(f in{success:1,error:1,complete:1})w[f](m[f]);if(k=F(ke,m,b,w)){w.readyState=1,j&&o.trigger("ajaxSend",[w,m]),m.async&&0<m.timeout&&(i=setTimeout(function(){w.abort("timeout")},m.timeout));try{u=1,k.send(s,d)}catch(x){if(!(2>u))throw x;d(-1,x)}}else d(-1,"No Transport");return w},getJSON:function(a,b,c){return db.get(a,b,c,"json")},getScript:function(a,b){return db.get(a,c,b,"script")}}),db.each(["get","post"],function(a,b){db[b]=function(a,d,e,f){return db.isFunction(d)&&(f=f||e,e=d,d=c),db.ajax({url:a,type:b,dataType:f,data:d,success:e})}}),db.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(a){return db.globalEval(a),a}}}),db.ajaxPrefilter("script",function(a){a.cache===c&&(a.cache=!1),a.crossDomain&&(a.type="GET",a.global=!1)}),db.ajaxTransport("script",function(a){if(a.crossDomain){var b,d=S.head||db("head")[0]||S.documentElement;return{send:function(c,e){b=S.createElement("script"),b.async=!0,a.scriptCharset&&(b.charset=a.scriptCharset),b.src=a.url,b.onload=b.onreadystatechange=function(a,c){(c||!b.readyState||/loaded|complete/.test(b.readyState))&&(b.onload=b.onreadystatechange=null,b.parentNode&&b.parentNode.removeChild(b),b=null,c||e(200,"success"))},d.insertBefore(b,d.firstChild)},abort:function(){b&&b.onload(c,!0)}}}});var ne=[],oe=/(=)\?(?=&|$)|\?\?/;db.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var a=ne.pop()||db.expando+"_"+ae++;return this[a]=!0,a}}),db.ajaxPrefilter("json jsonp",function(b,d,e){var f,g,h,i=!1!==b.jsonp&&(oe.test(b.url)?"url":"string"==typeof b.data&&!(b.contentType||"").indexOf("application/x-www-form-urlencoded")&&oe.test(b.data)&&"data");return i||"jsonp"===b.dataTypes[0]?(f=b.jsonpCallback=db.isFunction(b.jsonpCallback)?b.jsonpCallback():b.jsonpCallback,i?b[i]=b[i].replace(oe,"$1"+f):!1!==b.jsonp&&(b.url+=(be.test(b.url)?"&":"?")+b.jsonp+"="+f),b.converters["script json"]=function(){return h||db.error(f+" was not called"),h[0]},b.dataTypes[0]="json",g=a[f],a[f]=function(){h=arguments},e.always(function(){a[f]=g,b[f]&&(b.jsonpCallback=d.jsonpCallback,ne.push(f)),h&&db.isFunction(g)&&g(h[0]),h=g=c}),"script"):void 0});var pe,qe,re=0,se=a.ActiveXObject&&function(){for(var a in pe)pe[a](c,!0)};db.ajaxSettings.xhr=a.ActiveXObject?function(){var b;if(!(b=!this.isLocal&&H()))a:{try{b=new a.ActiveXObject("Microsoft.XMLHTTP");break a}catch(c){}b=void 0}return b}:H,qe=db.ajaxSettings.xhr(),db.support.cors=!!qe&&"withCredentials"in qe,(qe=db.support.ajax=!!qe)&&db.ajaxTransport(function(b){if(!b.crossDomain||db.support.cors){var d;return{send:function(e,f){var g,h,i=b.xhr();if(b.username?i.open(b.type,b.url,b.async,b.username,b.password):i.open(b.type,b.url,b.async),b.xhrFields)for(h in b.xhrFields)i[h]=b.xhrFields[h];b.mimeType&&i.overrideMimeType&&i.overrideMimeType(b.mimeType),!b.crossDomain&&!e["X-Requested-With"]&&(e["X-Requested-With"]="XMLHttpRequest");try{for(h in e)i.setRequestHeader(h,e[h])}catch(j){}i.send(b.hasContent&&b.data||null),d=function(a,e){var h,j,k,l;try{if(d&&(e||4===i.readyState))if(d=c,g&&(i.onreadystatechange=db.noop,se&&delete pe[g]),e)4!==i.readyState&&i.abort();else{l={},h=i.status,j=i.getAllResponseHeaders(),"string"==typeof i.responseText&&(l.text=i.responseText);try{k=i.statusText}catch(m){k=""}h||!b.isLocal||b.crossDomain?1223===h&&(h=204):h=l.text?200:404}}catch(n){e||f(-1,n)}l&&f(h,k,l,j)},b.async?4===i.readyState?setTimeout(d):(g=++re,se&&(pe||(pe={},db(a).unload(se)),pe[g]=d),i.onreadystatechange=d):d()},abort:function(){d&&d(c,!0)}}}});var te,ue,ve=/^(?:toggle|show|hide)$/,we=RegExp("^(?:([+-])=|)("+eb+")([a-z%]*)$","i"),xe=/queueHooks$/,ye=[function(a,b,c){var d,e,f,g,h,i=this,j={},k=a.style,l=a.nodeType&&w(a),m=db._data(a,"fxshow");c.queue||(g=db._queueHooks(a,"fx"),null==g.unqueued&&(g.unqueued=0,h=g.empty.fire,g.empty.fire=function(){g.unqueued||h()}),g.unqueued++,i.always(function(){i.always(function(){g.unqueued--,db.queue(a,"fx").length||g.empty.fire()})})),1===a.nodeType&&("height"in b||"width"in b)&&(c.overflow=[k.overflow,k.overflowX,k.overflowY],"inline"===db.css(a,"display")&&"none"===db.css(a,"float")&&(db.support.inlineBlockNeedsLayout&&"inline"!==B(a.nodeName)?k.zoom=1:k.display="inline-block")),c.overflow&&(k.overflow="hidden",db.support.shrinkWrapBlocks||i.always(function(){k.overflow=c.overflow[0],k.overflowX=c.overflow[1],k.overflowY=c.overflow[2]}));for(d in b)e=b[d],ve.exec(e)&&(delete b[d],f=f||"toggle"===e,e!==(l?"hide":"show"))&&(j[d]=m&&m[d]||db.style(a,d));if(!db.isEmptyObject(j))for(d in m?"hidden"in m&&(l=m.hidden):m=db._data(a,"fxshow",{}),f&&(m.hidden=!l),l?db(a).show():i.done(function(){db(a).hide()}),i.done(function(){var b;db._removeData(a,"fxshow");for(b in j)db.style(a,b,j[b])}),j)b=J(l?m[d]:0,d,i),d in m||(m[d]=b.start,l&&(b.end=b.start,b.start="width"===d||"height"===d?1:0))}],ze={"*":[function(a,b){var c=this.createTween(a,b),d=c.cur(),e=we.exec(b),f=e&&e[3]||(db.cssNumber[a]?"":"px"),g=(db.cssNumber[a]||"px"!==f&&+d)&&we.exec(db.css(c.elem,a)),h=1,i=20;if(g&&g[3]!==f){f=f||g[3],e=e||[],g=+d||1;do h=h||".5",g/=h,db.style(c.elem,a,g+f);while(h!==(h=c.cur()/d)&&1!==h&&--i)}return e&&(g=c.start=+g||+d||0,c.unit=f,c.end=e[1]?g+(e[1]+1)*e[2]:+e[2]),c}]};db.Animation=db.extend(K,{tweener:function(a,b){db.isFunction(a)?(b=a,a=["*"]):a=a.split(" ");for(var c,d=0,e=a.length;e>d;d++)c=a[d],ze[c]=ze[c]||[],ze[c].unshift(b)},prefilter:function(a,b){b?ye.unshift(a):ye.push(a)}}),db.Tween=L,L.prototype={constructor:L,init:function(a,b,c,d,e,f){this.elem=a,this.prop=c,this.easing=e||"swing",this.options=b,this.start=this.now=this.cur(),this.end=d,this.unit=f||(db.cssNumber[c]?"":"px")},cur:function(){var a=L.propHooks[this.prop];return a&&a.get?a.get(this):L.propHooks._default.get(this)},run:function(a){var b,c=L.propHooks[this.prop];return this.pos=b=this.options.duration?db.easing[this.easing](a,this.options.duration*a,0,1,this.options.duration):a,this.now=(this.end-this.start)*b+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),c&&c.set?c.set(this):L.propHooks._default.set(this),this}},L.prototype.init.prototype=L.prototype,L.propHooks={_default:{get:function(a){return null==a.elem[a.prop]||a.elem.style&&null!=a.elem.style[a.prop]?(a=db.css(a.elem,a.prop,""),a&&"auto"!==a?a:0):a.elem[a.prop]},set:function(a){db.fx.step[a.prop]?db.fx.step[a.prop](a):a.elem.style&&(null!=a.elem.style[db.cssProps[a.prop]]||db.cssHooks[a.prop])?db.style(a.elem,a.prop,a.now+a.unit):a.elem[a.prop]=a.now}}},L.propHooks.scrollTop=L.propHooks.scrollLeft={set:function(a){a.elem.nodeType&&a.elem.parentNode&&(a.elem[a.prop]=a.now)}},db.each(["toggle","show","hide"],function(a,b){var c=db.fn[b];db.fn[b]=function(a,d,e){return null==a||"boolean"==typeof a?c.apply(this,arguments):this.animate(M(b,!0),a,d,e)}}),db.fn.extend({fadeTo:function(a,b,c,d){return this.filter(w).css("opacity",0).show().end().animate({opacity:b},a,c,d)},animate:function(a,b,c,d){var e=db.isEmptyObject(a),f=db.speed(b,c,d);return b=function(){var b=K(this,db.extend({},a),f);(e||db._data(this,"finish"))&&b.stop(!0)},b.finish=b,e||!1===f.queue?this.each(b):this.queue(f.queue,b)},stop:function(a,b,d){var e=function(a){var b=a.stop;delete a.stop,b(d)};return"string"!=typeof a&&(d=b,b=a,a=c),b&&!1!==a&&this.queue(a||"fx",[]),this.each(function(){var b=!0,c=null!=a&&a+"queueHooks",f=db.timers,g=db._data(this);if(c)g[c]&&g[c].stop&&e(g[c]);else for(c in g)g[c]&&g[c].stop&&xe.test(c)&&e(g[c]);for(c=f.length;c--;)f[c].elem!==this||null!=a&&f[c].queue!==a||(f[c].anim.stop(d),b=!1,f.splice(c,1));(b||!d)&&db.dequeue(this,a)})},finish:function(a){return!1!==a&&(a=a||"fx"),this.each(function(){var b,c=db._data(this),d=c[a+"queue"];b=c[a+"queueHooks"];var e=db.timers,f=d?d.length:0;for(c.finish=!0,db.queue(this,a,[]),b&&b.stop&&b.stop.call(this,!0),b=e.length;b--;)e[b].elem===this&&e[b].queue===a&&(e[b].anim.stop(!0),e.splice(b,1));for(b=0;f>b;b++)d[b]&&d[b].finish&&d[b].finish.call(this);delete c.finish})}}),db.each({slideDown:M("show"),slideUp:M("hide"),slideToggle:M("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(a,b){db.fn[a]=function(a,c,d){return this.animate(b,a,c,d)}}),db.speed=function(a,b,c){var d=a&&"object"==typeof a?db.extend({},a):{complete:c||!c&&b||db.isFunction(a)&&a,duration:a,easing:c&&b||b&&!db.isFunction(b)&&b};return d.duration=db.fx.off?0:"number"==typeof d.duration?d.duration:d.duration in db.fx.speeds?db.fx.speeds[d.duration]:db.fx.speeds._default,(null==d.queue||!0===d.queue)&&(d.queue="fx"),d.old=d.complete,d.complete=function(){db.isFunction(d.old)&&d.old.call(this),d.queue&&db.dequeue(this,d.queue)},d},db.easing={linear:function(a){return a},swing:function(a){return.5-Math.cos(a*Math.PI)/2}},db.timers=[],db.fx=L.prototype.init,db.fx.tick=function(){var a,b=db.timers,d=0;for(te=db.now();d<b.length;d++)a=b[d],!a()&&b[d]===a&&b.splice(d--,1);b.length||db.fx.stop(),te=c},db.fx.timer=function(a){a()&&db.timers.push(a)&&db.fx.start()},db.fx.interval=13,db.fx.start=function(){ue||(ue=setInterval(db.fx.tick,db.fx.interval))},db.fx.stop=function(){clearInterval(ue),ue=null},db.fx.speeds={slow:600,fast:200,_default:400},db.fx.step={},db.expr&&db.expr.filters&&(db.expr.filters.animated=function(a){return db.grep(db.timers,function(b){return a===b.elem}).length}),db.fn.offset=function(a){if(arguments.length)return a===c?this:this.each(function(b){db.offset.setOffset(this,a,b)});var b,d,e={top:0,left:0},f=(d=this[0])&&d.ownerDocument;return f?(b=f.documentElement,db.contains(b,d)?(typeof d.getBoundingClientRect!==Q&&(e=d.getBoundingClientRect()),d=N(f),{top:e.top+(d.pageYOffset||b.scrollTop)-(b.clientTop||0),left:e.left+(d.pageXOffset||b.scrollLeft)-(b.clientLeft||0)}):e):void 0},db.offset={setOffset:function(a,b,c){var d=db.css(a,"position");"static"===d&&(a.style.position="relative");var e=db(a),f=e.offset(),g=db.css(a,"top"),h=db.css(a,"left"),i={},j={};("absolute"===d||"fixed"===d)&&-1<db.inArray("auto",[g,h])?(j=e.position(),d=j.top,h=j.left):(d=parseFloat(g)||0,h=parseFloat(h)||0),db.isFunction(b)&&(b=b.call(a,c,f)),null!=b.top&&(i.top=b.top-f.top+d),null!=b.left&&(i.left=b.left-f.left+h),"using"in b?b.using.call(a,i):e.css(i)}},db.fn.extend({position:function(){if(this[0]){var a,b,c={top:0,left:0},d=this[0];return"fixed"===db.css(d,"position")?b=d.getBoundingClientRect():(a=this.offsetParent(),b=this.offset(),db.nodeName(a[0],"html")||(c=a.offset()),c.top+=db.css(a[0],"borderTopWidth",!0),c.left+=db.css(a[0],"borderLeftWidth",!0)),{top:b.top-c.top-db.css(d,"marginTop",!0),left:b.left-c.left-db.css(d,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var a=this.offsetParent||T;a&&!db.nodeName(a,"html")&&"static"===db.css(a,"position");)a=a.offsetParent;return a||T})}}),db.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(a,b){var d=/Y/.test(b);db.fn[a]=function(e){return db.access(this,function(a,e,f){var g=N(a);return f===c?g?b in g?g[b]:g.document.documentElement[e]:a[e]:void(g?g.scrollTo(d?db(g).scrollLeft():f,d?f:db(g).scrollTop()):a[e]=f)},a,e,arguments.length,null)}}),db.each({Height:"height",Width:"width"},function(a,b){db.each({padding:"inner"+a,content:b,"":"outer"+a},function(d,e){db.fn[e]=function(e,f){var g=arguments.length&&(d||"boolean"!=typeof e),h=d||(!0===e||!0===f?"margin":"border");return db.access(this,function(b,d,e){return db.isWindow(b)?b.document.documentElement["client"+a]:9===b.nodeType?(d=b.documentElement,Math.max(b.body["scroll"+a],d["scroll"+a],b.body["offset"+a],d["offset"+a],d["client"+a])):e===c?db.css(b,d,h):db.style(b,d,e,h)},b,g?e:c,g,null)}})}),db.fn.size=function(){return this.length},db.fn.andSelf=db.fn.addBack,b.jQuery=db}(window,ChemDoodle.lib),function(a){"function"==typeof define&&define.amd?define(["jquery"],a):"object"==typeof exports?module.exports=a:a(ChemDoodle.lib.jQuery)}(function(a){function b(b){var g=b||window.event,h=i.call(arguments,1),j=0,k=0,l=0,m=0;return b=a.event.fix(g),b.type="mousewheel","detail"in g&&(l=-1*g.detail),"wheelDelta"in g&&(l=g.wheelDelta),"wheelDeltaY"in g&&(l=g.wheelDeltaY),"wheelDeltaX"in g&&(k=-1*g.wheelDeltaX),"axis"in g&&g.axis===g.HORIZONTAL_AXIS&&(k=-1*l,l=0),j=0===l?k:l,"deltaY"in g&&(j=l=-1*g.deltaY),"deltaX"in g&&(k=g.deltaX,0===l&&(j=-1*k)),0!==l||0!==k?(1===g.deltaMode?(g=a.data(this,"mousewheel-line-height"),j*=g,l*=g,k*=g):2===g.deltaMode&&(g=a.data(this,"mousewheel-page-height"),j*=g,l*=g,k*=g),m=Math.max(Math.abs(l),Math.abs(k)),(!f||f>m)&&(f=m,120===f&&(d=!0,f/=40)),d&&(j/=40,k/=40,l/=40),j=Math[j>=1?"floor":"ceil"](j/f),k=Math[k>=1?"floor":"ceil"](k/f),l=Math[l>=1?"floor":"ceil"](l/f),b.deltaX=k,b.deltaY=l,b.deltaFactor=f,b.deltaMode=0,h.unshift(b,j,k,l),e&&clearTimeout(e),e=setTimeout(c,200),(a.event.dispatch||a.event.handle).apply(this,h)):void 0}function c(){d=f=null}var d,e,f,g=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],h="onwheel"in document||9<=document.documentMode?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],i=Array.prototype.slice;if(a.event.fixHooks)for(var j=g.length;j;)a.event.fixHooks[g[--j]]=a.event.mouseHooks;var k=a.event.special.mousewheel={version:"3.1.8",setup:function(){if(this.addEventListener)for(var c=h.length;c;)this.addEventListener(h[--c],b,!1);else this.onmousewheel=b;a.data(this,"mousewheel-line-height",k.getLineHeight(this)),a.data(this,"mousewheel-page-height",k.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var a=h.length;a;)this.removeEventListener(h[--a],b,!1);else this.onmousewheel=null},getLineHeight:function(b){return parseInt(a(b)["offsetParent"in a.fn?"offsetParent":"parent"]().css("fontSize"),10)},getPageHeight:function(b){return a(b).height()}};a.fn.extend({mousewheel:function(a){return a?this.bind("mousewheel",a):this.trigger("mousewheel")},unmousewheel:function(a){return this.unbind("mousewheel",a)}})}),function(a,b){"object"==typeof exports?module.exports=b(global):"function"==typeof define&&define.amd?define([],function(){return b(a)}):b(a)}(ChemDoodle.lib,function(a){function b(a){return g=a}function c(){return g="undefined"!=typeof Float32Array?Float32Array:Array}var d={};if("undefined"!=typeof Float32Array){var e=new Float32Array(1),f=new Int32Array(e.buffer);d.invsqrt=function(a){e[0]=a,f[0]=1597463007-(f[0]>>1);var b=e[0];return b*(1.5-.5*a*b*b)}}else d.invsqrt=function(a){return 1/Math.sqrt(a)};var g=null;c();var h={create:function(a){var b=new g(3);return a?(b[0]=a[0],b[1]=a[1],b[2]=a[2]):b[0]=b[1]=b[2]=0,b},createFrom:function(a,b,c){var d=new g(3);return d[0]=a,d[1]=b,d[2]=c,d},set:function(a,b){return b[0]=a[0],b[1]=a[1],b[2]=a[2],b},equal:function(a,b){return a===b||1e-6>Math.abs(a[0]-b[0])&&1e-6>Math.abs(a[1]-b[1])&&1e-6>Math.abs(a[2]-b[2])},add:function(a,b,c){return c&&a!==c?(c[0]=a[0]+b[0],c[1]=a[1]+b[1],c[2]=a[2]+b[2],c):(a[0]+=b[0],a[1]+=b[1],a[2]+=b[2],a)},subtract:function(a,b,c){return c&&a!==c?(c[0]=a[0]-b[0],c[1]=a[1]-b[1],c[2]=a[2]-b[2],c):(a[0]-=b[0],a[1]-=b[1],a[2]-=b[2],a)},multiply:function(a,b,c){return c&&a!==c?(c[0]=a[0]*b[0],c[1]=a[1]*b[1],c[2]=a[2]*b[2],c):(a[0]*=b[0],a[1]*=b[1],a[2]*=b[2],a)},negate:function(a,b){return b||(b=a),b[0]=-a[0],b[1]=-a[1],b[2]=-a[2],b},scale:function(a,b,c){return c&&a!==c?(c[0]=a[0]*b,c[1]=a[1]*b,c[2]=a[2]*b,c):(a[0]*=b,a[1]*=b,a[2]*=b,a)},normalize:function(a,b){b||(b=a);var c=a[0],d=a[1],e=a[2],f=Math.sqrt(c*c+d*d+e*e);return f?1===f?(b[0]=c,b[1]=d,b[2]=e,b):(f=1/f,b[0]=c*f,b[1]=d*f,b[2]=e*f,b):(b[0]=0,b[1]=0,b[2]=0,b)},cross:function(a,b,c){c||(c=a);var d=a[0],e=a[1];a=a[2];var f=b[0],g=b[1];return b=b[2],c[0]=e*b-a*g,c[1]=a*f-d*b,c[2]=d*g-e*f,c},length:function(a){var b=a[0],c=a[1];return a=a[2],Math.sqrt(b*b+c*c+a*a)},squaredLength:function(a){var b=a[0],c=a[1];return a=a[2],b*b+c*c+a*a},dot:function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]},direction:function(a,b,c){c||(c=a);var d=a[0]-b[0],e=a[1]-b[1];return a=a[2]-b[2],(b=Math.sqrt(d*d+e*e+a*a))?(b=1/b,c[0]=d*b,c[1]=e*b,c[2]=a*b,c):(c[0]=0,c[1]=0,c[2]=0,c)},lerp:function(a,b,c,d){return d||(d=a),d[0]=a[0]+c*(b[0]-a[0]),d[1]=a[1]+c*(b[1]-a[1]),d[2]=a[2]+c*(b[2]-a[2]),d},dist:function(a,b){var c=b[0]-a[0],d=b[1]-a[1],e=b[2]-a[2];return Math.sqrt(c*c+d*d+e*e)}},i=null,j=new g(4);h.unproject=function(a,b,c,d,e){e||(e=a),i||(i=p.create());var f=i;return j[0]=2*(a[0]-d[0])/d[2]-1,j[1]=2*(a[1]-d[1])/d[3]-1,j[2]=2*a[2]-1,j[3]=1,p.multiply(c,b,f),p.inverse(f)?(p.multiplyVec4(f,j),0===j[3]?null:(e[0]=j[0]/j[3],e[1]=j[1]/j[3],e[2]=j[2]/j[3],e)):null};var k=h.createFrom(1,0,0),l=h.createFrom(0,1,0),m=h.createFrom(0,0,1),n=h.create();h.rotationTo=function(a,b,c){c||(c=q.create());var d=h.dot(a,b);if(d>=1)q.set(r,c);else if(-.999999>d)h.cross(k,a,n),1e-6>h.length(n)&&h.cross(l,a,n),1e-6>h.length(n)&&h.cross(m,a,n),h.normalize(n),q.fromAngleAxis(Math.PI,n,c);else{var d=Math.sqrt(2*(1+d)),e=1/d;h.cross(a,b,n),c[0]=n[0]*e,c[1]=n[1]*e,c[2]=n[2]*e,c[3]=.5*d,q.normalize(c)}return 1<c[3]?c[3]=1:-1>c[3]&&(c[3]=-1),c},h.str=function(a){return"["+a[0]+", "+a[1]+", "+a[2]+"]"};var o={create:function(a){var b=new g(9);return a?(b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b[4]=a[4],b[5]=a[5],b[6]=a[6],b[7]=a[7],b[8]=a[8]):b[0]=b[1]=b[2]=b[3]=b[4]=b[5]=b[6]=b[7]=b[8]=0,b},createFrom:function(a,b,c,d,e,f,h,i,j){var k=new g(9);return k[0]=a,k[1]=b,k[2]=c,k[3]=d,k[4]=e,k[5]=f,k[6]=h,k[7]=i,k[8]=j,k},determinant:function(a){var b=a[3],c=a[4],d=a[5],e=a[6],f=a[7],g=a[8];return a[0]*(g*c-d*f)+a[1]*(-g*b+d*e)+a[2]*(f*b-c*e)},inverse:function(a,b){var c=a[0],d=a[1],e=a[2],f=a[3],g=a[4],h=a[5],i=a[6],j=a[7],k=a[8],l=k*g-h*j,m=-k*f+h*i,n=j*f-g*i,p=c*l+d*m+e*n;return p?(p=1/p,b||(b=o.create()),b[0]=l*p,b[1]=(-k*d+e*j)*p,b[2]=(h*d-e*g)*p,b[3]=m*p,b[4]=(k*c-e*i)*p,b[5]=(-h*c+e*f)*p,b[6]=n*p,b[7]=(-j*c+d*i)*p,b[8]=(g*c-d*f)*p,b):null},multiply:function(a,b,c){c||(c=a);var d=a[0],e=a[1],f=a[2],g=a[3],h=a[4],i=a[5],j=a[6],k=a[7];a=a[8];var l=b[0],m=b[1],n=b[2],o=b[3],p=b[4],q=b[5],r=b[6],s=b[7];return b=b[8],c[0]=l*d+m*g+n*j,c[1]=l*e+m*h+n*k,c[2]=l*f+m*i+n*a,c[3]=o*d+p*g+q*j,c[4]=o*e+p*h+q*k,c[5]=o*f+p*i+q*a,c[6]=r*d+s*g+b*j,c[7]=r*e+s*h+b*k,c[8]=r*f+s*i+b*a,c},multiplyVec2:function(a,b,c){c||(c=b);var d=b[0];return b=b[1],c[0]=d*a[0]+b*a[3]+a[6],c[1]=d*a[1]+b*a[4]+a[7],c},multiplyVec3:function(a,b,c){c||(c=b);var d=b[0],e=b[1];return b=b[2],c[0]=d*a[0]+e*a[3]+b*a[6],c[1]=d*a[1]+e*a[4]+b*a[7],c[2]=d*a[2]+e*a[5]+b*a[8],c},set:function(a,b){return b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b[4]=a[4],b[5]=a[5],b[6]=a[6],b[7]=a[7],b[8]=a[8],b},equal:function(a,b){return a===b||1e-6>Math.abs(a[0]-b[0])&&1e-6>Math.abs(a[1]-b[1])&&1e-6>Math.abs(a[2]-b[2])&&1e-6>Math.abs(a[3]-b[3])&&1e-6>Math.abs(a[4]-b[4])&&1e-6>Math.abs(a[5]-b[5])&&1e-6>Math.abs(a[6]-b[6])&&1e-6>Math.abs(a[7]-b[7])&&1e-6>Math.abs(a[8]-b[8])},identity:function(a){return a||(a=o.create()),a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=1,a[5]=0,a[6]=0,a[7]=0,a[8]=1,a},transpose:function(a,b){if(!b||a===b){var c=a[1],d=a[2],e=a[5];return a[1]=a[3],a[2]=a[6],a[3]=c,a[5]=a[7],a[6]=d,a[7]=e,a}return b[0]=a[0],b[1]=a[3],b[2]=a[6],b[3]=a[1],b[4]=a[4],b[5]=a[7],b[6]=a[2],b[7]=a[5],b[8]=a[8],b},toMat4:function(a,b){return b||(b=p.create()),b[15]=1,b[14]=0,b[13]=0,b[12]=0,b[11]=0,b[10]=a[8],b[9]=a[7],b[8]=a[6],b[7]=0,b[6]=a[5],b[5]=a[4],b[4]=a[3],b[3]=0,b[2]=a[2],b[1]=a[1],b[0]=a[0],b},str:function(a){return"["+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+"]"}},p={create:function(a){var b=new g(16);return a&&(b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b[4]=a[4],b[5]=a[5],b[6]=a[6],b[7]=a[7],b[8]=a[8],b[9]=a[9],b[10]=a[10],b[11]=a[11],b[12]=a[12],b[13]=a[13],b[14]=a[14],b[15]=a[15]),b},createFrom:function(a,b,c,d,e,f,h,i,j,k,l,m,n,o,p,q){var r=new g(16);return r[0]=a,r[1]=b,r[2]=c,r[3]=d,r[4]=e,r[5]=f,r[6]=h,r[7]=i,r[8]=j,r[9]=k,r[10]=l,r[11]=m,r[12]=n,r[13]=o,r[14]=p,r[15]=q,r},set:function(a,b){return b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b[4]=a[4],b[5]=a[5],b[6]=a[6],b[7]=a[7],b[8]=a[8],b[9]=a[9],b[10]=a[10],b[11]=a[11],b[12]=a[12],b[13]=a[13],b[14]=a[14],b[15]=a[15],b},equal:function(a,b){return a===b||1e-6>Math.abs(a[0]-b[0])&&1e-6>Math.abs(a[1]-b[1])&&1e-6>Math.abs(a[2]-b[2])&&1e-6>Math.abs(a[3]-b[3])&&1e-6>Math.abs(a[4]-b[4])&&1e-6>Math.abs(a[5]-b[5])&&1e-6>Math.abs(a[6]-b[6])&&1e-6>Math.abs(a[7]-b[7])&&1e-6>Math.abs(a[8]-b[8])&&1e-6>Math.abs(a[9]-b[9])&&1e-6>Math.abs(a[10]-b[10])&&1e-6>Math.abs(a[11]-b[11])&&1e-6>Math.abs(a[12]-b[12])&&1e-6>Math.abs(a[13]-b[13])&&1e-6>Math.abs(a[14]-b[14])&&1e-6>Math.abs(a[15]-b[15])},identity:function(a){return a||(a=p.create()),a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},transpose:function(a,b){if(!b||a===b){var c=a[1],d=a[2],e=a[3],f=a[6],g=a[7],h=a[11];return a[1]=a[4],a[2]=a[8],a[3]=a[12],a[4]=c,a[6]=a[9],a[7]=a[13],a[8]=d,a[9]=f,a[11]=a[14],a[12]=e,a[13]=g,a[14]=h,a}return b[0]=a[0],b[1]=a[4],b[2]=a[8],b[3]=a[12],b[4]=a[1],b[5]=a[5],b[6]=a[9],b[7]=a[13],b[8]=a[2],b[9]=a[6],b[10]=a[10],b[11]=a[14],b[12]=a[3],b[13]=a[7],b[14]=a[11],b[15]=a[15],b},determinant:function(a){var b=a[0],c=a[1],d=a[2],e=a[3],f=a[4],g=a[5],h=a[6],i=a[7],j=a[8],k=a[9],l=a[10],m=a[11],n=a[12],o=a[13],p=a[14];return a=a[15],n*k*h*e-j*o*h*e-n*g*l*e+f*o*l*e+j*g*p*e-f*k*p*e-n*k*d*i+j*o*d*i+n*c*l*i-b*o*l*i-j*c*p*i+b*k*p*i+n*g*d*m-f*o*d*m-n*c*h*m+b*o*h*m+f*c*p*m-b*g*p*m-j*g*d*a+f*k*d*a+j*c*h*a-b*k*h*a-f*c*l*a+b*g*l*a},inverse:function(a,b){b||(b=a);var c=a[0],d=a[1],e=a[2],f=a[3],g=a[4],h=a[5],i=a[6],j=a[7],k=a[8],l=a[9],m=a[10],n=a[11],o=a[12],p=a[13],q=a[14],r=a[15],s=c*h-d*g,t=c*i-e*g,u=c*j-f*g,v=d*i-e*h,w=d*j-f*h,x=e*j-f*i,y=k*p-l*o,z=k*q-m*o,A=k*r-n*o,B=l*q-m*p,C=l*r-n*p,D=m*r-n*q,E=s*D-t*C+u*B+v*A-w*z+x*y;return E?(E=1/E,b[0]=(h*D-i*C+j*B)*E,b[1]=(-d*D+e*C-f*B)*E,b[2]=(p*x-q*w+r*v)*E,b[3]=(-l*x+m*w-n*v)*E,b[4]=(-g*D+i*A-j*z)*E,b[5]=(c*D-e*A+f*z)*E,b[6]=(-o*x+q*u-r*t)*E,b[7]=(k*x-m*u+n*t)*E,b[8]=(g*C-h*A+j*y)*E,b[9]=(-c*C+d*A-f*y)*E,b[10]=(o*w-p*u+r*s)*E,b[11]=(-k*w+l*u-n*s)*E,b[12]=(-g*B+h*z-i*y)*E,b[13]=(c*B-d*z+e*y)*E,b[14]=(-o*v+p*t-q*s)*E,b[15]=(k*v-l*t+m*s)*E,b):null},toRotationMat:function(a,b){return b||(b=p.create()),b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b[4]=a[4],b[5]=a[5],b[6]=a[6],b[7]=a[7],b[8]=a[8],b[9]=a[9],b[10]=a[10],b[11]=a[11],b[12]=0,b[13]=0,b[14]=0,b[15]=1,b},toMat3:function(a,b){return b||(b=o.create()),b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[4],b[4]=a[5],b[5]=a[6],b[6]=a[8],b[7]=a[9],b[8]=a[10],b},toInverseMat3:function(a,b){var c=a[0],d=a[1],e=a[2],f=a[4],g=a[5],h=a[6],i=a[8],j=a[9],k=a[10],l=k*g-h*j,m=-k*f+h*i,n=j*f-g*i,p=c*l+d*m+e*n;return p?(p=1/p,b||(b=o.create()),b[0]=l*p,b[1]=(-k*d+e*j)*p,b[2]=(h*d-e*g)*p,b[3]=m*p,b[4]=(k*c-e*i)*p,b[5]=(-h*c+e*f)*p,b[6]=n*p,b[7]=(-j*c+d*i)*p,b[8]=(g*c-d*f)*p,b):null},multiply:function(a,b,c){c||(c=a);var d=a[0],e=a[1],f=a[2],g=a[3],h=a[4],i=a[5],j=a[6],k=a[7],l=a[8],m=a[9],n=a[10],o=a[11],p=a[12],q=a[13],r=a[14];a=a[15];var s=b[0],t=b[1],u=b[2],v=b[3];return c[0]=s*d+t*h+u*l+v*p,c[1]=s*e+t*i+u*m+v*q,c[2]=s*f+t*j+u*n+v*r,c[3]=s*g+t*k+u*o+v*a,s=b[4],t=b[5],u=b[6],v=b[7],c[4]=s*d+t*h+u*l+v*p,c[5]=s*e+t*i+u*m+v*q,c[6]=s*f+t*j+u*n+v*r,c[7]=s*g+t*k+u*o+v*a,s=b[8],t=b[9],u=b[10],v=b[11],c[8]=s*d+t*h+u*l+v*p,c[9]=s*e+t*i+u*m+v*q,c[10]=s*f+t*j+u*n+v*r,c[11]=s*g+t*k+u*o+v*a,s=b[12],t=b[13],u=b[14],v=b[15],c[12]=s*d+t*h+u*l+v*p,c[13]=s*e+t*i+u*m+v*q,c[14]=s*f+t*j+u*n+v*r,c[15]=s*g+t*k+u*o+v*a,c},multiplyVec3:function(a,b,c){c||(c=b);var d=b[0],e=b[1];return b=b[2],c[0]=a[0]*d+a[4]*e+a[8]*b+a[12],c[1]=a[1]*d+a[5]*e+a[9]*b+a[13],c[2]=a[2]*d+a[6]*e+a[10]*b+a[14],c},multiplyVec4:function(a,b,c){c||(c=b);var d=b[0],e=b[1],f=b[2];return b=b[3],c[0]=a[0]*d+a[4]*e+a[8]*f+a[12]*b,c[1]=a[1]*d+a[5]*e+a[9]*f+a[13]*b,c[2]=a[2]*d+a[6]*e+a[10]*f+a[14]*b,c[3]=a[3]*d+a[7]*e+a[11]*f+a[15]*b,c},translate:function(a,b,c){var d=b[0],e=b[1];b=b[2];var f,g,h,i,j,k,l,m,n,o,p,q;return c&&a!==c?(f=a[0],g=a[1],h=a[2],i=a[3],j=a[4],k=a[5],l=a[6],m=a[7],n=a[8],o=a[9],p=a[10],q=a[11],c[0]=f,c[1]=g,c[2]=h,c[3]=i,c[4]=j,c[5]=k,c[6]=l,c[7]=m,c[8]=n,c[9]=o,c[10]=p,c[11]=q,c[12]=f*d+j*e+n*b+a[12],c[13]=g*d+k*e+o*b+a[13],c[14]=h*d+l*e+p*b+a[14],c[15]=i*d+m*e+q*b+a[15],c):(a[12]=a[0]*d+a[4]*e+a[8]*b+a[12],a[13]=a[1]*d+a[5]*e+a[9]*b+a[13],a[14]=a[2]*d+a[6]*e+a[10]*b+a[14],a[15]=a[3]*d+a[7]*e+a[11]*b+a[15],a)},scale:function(a,b,c){var d=b[0],e=b[1];return b=b[2],c&&a!==c?(c[0]=a[0]*d,c[1]=a[1]*d,c[2]=a[2]*d,c[3]=a[3]*d,c[4]=a[4]*e,c[5]=a[5]*e,c[6]=a[6]*e,c[7]=a[7]*e,c[8]=a[8]*b,c[9]=a[9]*b,c[10]=a[10]*b,c[11]=a[11]*b,c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15],c):(a[0]*=d,a[1]*=d,a[2]*=d,a[3]*=d,a[4]*=e,a[5]*=e,a[6]*=e,a[7]*=e,a[8]*=b,a[9]*=b,a[10]*=b,a[11]*=b,a)},rotate:function(a,b,c,d){var e=c[0],f=c[1];c=c[2];var g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A=Math.sqrt(e*e+f*f+c*c);return A?(1!==A&&(A=1/A,e*=A,f*=A,c*=A),g=Math.sin(b),h=Math.cos(b),i=1-h,b=a[0],A=a[1],j=a[2],k=a[3],l=a[4],m=a[5],n=a[6],o=a[7],p=a[8],q=a[9],r=a[10],s=a[11],t=e*e*i+h,u=f*e*i+c*g,v=c*e*i-f*g,w=e*f*i-c*g,x=f*f*i+h,y=c*f*i+e*g,z=e*c*i+f*g,e=f*c*i-e*g,f=c*c*i+h,d?a!==d&&(d[12]=a[12],d[13]=a[13],d[14]=a[14],d[15]=a[15]):d=a,d[0]=b*t+l*u+p*v,d[1]=A*t+m*u+q*v,d[2]=j*t+n*u+r*v,d[3]=k*t+o*u+s*v,d[4]=b*w+l*x+p*y,d[5]=A*w+m*x+q*y,d[6]=j*w+n*x+r*y,d[7]=k*w+o*x+s*y,d[8]=b*z+l*e+p*f,d[9]=A*z+m*e+q*f,d[10]=j*z+n*e+r*f,d[11]=k*z+o*e+s*f,d):null},rotateX:function(a,b,c){var d=Math.sin(b);b=Math.cos(b);var e=a[4],f=a[5],g=a[6],h=a[7],i=a[8],j=a[9],k=a[10],l=a[11];return c?a!==c&&(c[0]=a[0],c[1]=a[1],c[2]=a[2],c[3]=a[3],c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15]):c=a,c[4]=e*b+i*d,c[5]=f*b+j*d,c[6]=g*b+k*d,c[7]=h*b+l*d,c[8]=e*-d+i*b,c[9]=f*-d+j*b,c[10]=g*-d+k*b,c[11]=h*-d+l*b,c},rotateY:function(a,b,c){var d=Math.sin(b);b=Math.cos(b);var e=a[0],f=a[1],g=a[2],h=a[3],i=a[8],j=a[9],k=a[10],l=a[11];return c?a!==c&&(c[4]=a[4],c[5]=a[5],c[6]=a[6],c[7]=a[7],c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15]):c=a,c[0]=e*b+i*-d,c[1]=f*b+j*-d,c[2]=g*b+k*-d,c[3]=h*b+l*-d,c[8]=e*d+i*b,c[9]=f*d+j*b,c[10]=g*d+k*b,c[11]=h*d+l*b,c},rotateZ:function(a,b,c){var d=Math.sin(b);b=Math.cos(b);var e=a[0],f=a[1],g=a[2],h=a[3],i=a[4],j=a[5],k=a[6],l=a[7];return c?a!==c&&(c[8]=a[8],c[9]=a[9],c[10]=a[10],c[11]=a[11],c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15]):c=a,c[0]=e*b+i*d,c[1]=f*b+j*d,c[2]=g*b+k*d,c[3]=h*b+l*d,c[4]=e*-d+i*b,c[5]=f*-d+j*b,c[6]=g*-d+k*b,c[7]=h*-d+l*b,c},frustum:function(a,b,c,d,e,f,g){g||(g=p.create());var h=b-a,i=d-c,j=f-e;return g[0]=2*e/h,g[1]=0,g[2]=0,g[3]=0,g[4]=0,g[5]=2*e/i,g[6]=0,g[7]=0,g[8]=(b+a)/h,g[9]=(d+c)/i,g[10]=-(f+e)/j,g[11]=-1,g[12]=0,g[13]=0,g[14]=-(2*f*e)/j,g[15]=0,g},perspective:function(a,b,c,d,e){return a=c*Math.tan(a*Math.PI/360),b*=a,p.frustum(-b,b,-a,a,c,d,e)},ortho:function(a,b,c,d,e,f,g){g||(g=p.create());var h=b-a,i=d-c,j=f-e;return g[0]=2/h,g[1]=0,g[2]=0,g[3]=0,g[4]=0,g[5]=2/i,g[6]=0,g[7]=0,g[8]=0,g[9]=0,g[10]=-2/j,g[11]=0,g[12]=-(a+b)/h,g[13]=-(d+c)/i,g[14]=-(f+e)/j,g[15]=1,g},lookAt:function(a,b,c,d){d||(d=p.create());var e,f,g,h,i,j,k,l,m=a[0],n=a[1];return a=a[2],g=c[0],h=c[1],f=c[2],k=b[0],c=b[1],e=b[2],m===k&&n===c&&a===e?p.identity(d):(b=m-k,c=n-c,k=a-e,l=1/Math.sqrt(b*b+c*c+k*k),b*=l,c*=l,k*=l,e=h*k-f*c,f=f*b-g*k,g=g*c-h*b,(l=Math.sqrt(e*e+f*f+g*g))?(l=1/l,e*=l,f*=l,g*=l):g=f=e=0,h=c*g-k*f,i=k*e-b*g,j=b*f-c*e,(l=Math.sqrt(h*h+i*i+j*j))?(l=1/l,h*=l,i*=l,j*=l):j=i=h=0,d[0]=e,d[1]=h,d[2]=b,d[3]=0,d[4]=f,d[5]=i,d[6]=c,d[7]=0,d[8]=g,d[9]=j,d[10]=k,d[11]=0,d[12]=-(e*m+f*n+g*a),d[13]=-(h*m+i*n+j*a),d[14]=-(b*m+c*n+k*a),d[15]=1,d)},fromRotationTranslation:function(a,b,c){c||(c=p.create());var d=a[0],e=a[1],f=a[2],g=a[3],h=d+d,i=e+e,j=f+f;a=d*h;var k=d*i,d=d*j,l=e*i,e=e*j,f=f*j,h=g*h,i=g*i,g=g*j;return c[0]=1-(l+f),c[1]=k+g,c[2]=d-i,c[3]=0,c[4]=k-g,c[5]=1-(a+f),c[6]=e+h,c[7]=0,c[8]=d+i,c[9]=e-h,c[10]=1-(a+l),c[11]=0,c[12]=b[0],c[13]=b[1],c[14]=b[2],c[15]=1,c},str:function(a){return"["+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+", "+a[9]+", "+a[10]+", "+a[11]+", "+a[12]+", "+a[13]+", "+a[14]+", "+a[15]+"]"}},q={create:function(a){var b=new g(4);return a?(b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3]):b[0]=b[1]=b[2]=b[3]=0,b},createFrom:function(a,b,c,d){var e=new g(4);return e[0]=a,e[1]=b,e[2]=c,e[3]=d,e},set:function(a,b){return b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b},equal:function(a,b){return a===b||1e-6>Math.abs(a[0]-b[0])&&1e-6>Math.abs(a[1]-b[1])&&1e-6>Math.abs(a[2]-b[2])&&1e-6>Math.abs(a[3]-b[3])},identity:function(a){return a||(a=q.create()),a[0]=0,a[1]=0,a[2]=0,a[3]=1,a}},r=q.identity();q.calculateW=function(a,b){var c=a[0],d=a[1],e=a[2];return b&&a!==b?(b[0]=c,b[1]=d,b[2]=e,b[3]=-Math.sqrt(Math.abs(1-c*c-d*d-e*e)),b):(a[3]=-Math.sqrt(Math.abs(1-c*c-d*d-e*e)),a)},q.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3]},q.inverse=function(a,b){var c=a[0],d=a[1],e=a[2],f=a[3],c=(c=c*c+d*d+e*e+f*f)?1/c:0;return b&&a!==b?(b[0]=-a[0]*c,b[1]=-a[1]*c,b[2]=-a[2]*c,b[3]=a[3]*c,b):(a[0]*=-c,a[1]*=-c,a[2]*=-c,a[3]*=c,a)},q.conjugate=function(a,b){return b&&a!==b?(b[0]=-a[0],b[1]=-a[1],b[2]=-a[2],b[3]=a[3],b):(a[0]*=-1,a[1]*=-1,a[2]*=-1,a)},q.length=function(a){var b=a[0],c=a[1],d=a[2];return a=a[3],Math.sqrt(b*b+c*c+d*d+a*a)},q.normalize=function(a,b){b||(b=a);var c=a[0],d=a[1],e=a[2],f=a[3],g=Math.sqrt(c*c+d*d+e*e+f*f);return 0===g?(b[0]=0,b[1]=0,b[2]=0,b[3]=0,b):(g=1/g,b[0]=c*g,b[1]=d*g,b[2]=e*g,b[3]=f*g,b)},q.add=function(a,b,c){return c&&a!==c?(c[0]=a[0]+b[0],c[1]=a[1]+b[1],c[2]=a[2]+b[2],c[3]=a[3]+b[3],c):(a[0]+=b[0],a[1]+=b[1],a[2]+=b[2],a[3]+=b[3],a)},q.multiply=function(a,b,c){c||(c=a);var d=a[0],e=a[1],f=a[2];a=a[3];var g=b[0],h=b[1],i=b[2];return b=b[3],c[0]=d*b+a*g+e*i-f*h,c[1]=e*b+a*h+f*g-d*i,c[2]=f*b+a*i+d*h-e*g,c[3]=a*b-d*g-e*h-f*i,c},q.multiplyVec3=function(a,b,c){c||(c=b);var d=b[0],e=b[1],f=b[2];b=a[0];var g=a[1],h=a[2];a=a[3];var i=a*d+g*f-h*e,j=a*e+h*d-b*f,k=a*f+b*e-g*d,d=-b*d-g*e-h*f;return c[0]=i*a+d*-b+j*-h-k*-g,c[1]=j*a+d*-g+k*-b-i*-h,c[2]=k*a+d*-h+i*-g-j*-b,c},q.scale=function(a,b,c){return c&&a!==c?(c[0]=a[0]*b,c[1]=a[1]*b,c[2]=a[2]*b,c[3]=a[3]*b,c):(a[0]*=b,a[1]*=b,a[2]*=b,a[3]*=b,a)},q.toMat3=function(a,b){b||(b=o.create());var c=a[0],d=a[1],e=a[2],f=a[3],g=c+c,h=d+d,i=e+e,j=c*g,k=c*h,c=c*i,l=d*h,d=d*i,e=e*i,g=f*g,h=f*h,f=f*i;return b[0]=1-(l+e),b[1]=k+f,b[2]=c-h,b[3]=k-f,b[4]=1-(j+e),b[5]=d+g,b[6]=c+h,b[7]=d-g,b[8]=1-(j+l),b},q.toMat4=function(a,b){b||(b=p.create());var c=a[0],d=a[1],e=a[2],f=a[3],g=c+c,h=d+d,i=e+e,j=c*g,k=c*h,c=c*i,l=d*h,d=d*i,e=e*i,g=f*g,h=f*h,f=f*i;return b[0]=1-(l+e),b[1]=k+f,b[2]=c-h,b[3]=0,b[4]=k-f,b[5]=1-(j+e),b[6]=d+g,b[7]=0,b[8]=c+h,b[9]=d-g,b[10]=1-(j+l),b[11]=0,b[12]=0,b[13]=0,b[14]=0,b[15]=1,b},q.slerp=function(a,b,c,d){d||(d=a);var e,f,g=a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3];return 1<=Math.abs(g)?(d!==a&&(d[0]=a[0],d[1]=a[1],d[2]=a[2],d[3]=a[3]),d):(e=Math.acos(g),f=Math.sqrt(1-g*g),.001>Math.abs(f)?(d[0]=.5*a[0]+.5*b[0],d[1]=.5*a[1]+.5*b[1],d[2]=.5*a[2]+.5*b[2],d[3]=.5*a[3]+.5*b[3],d):(g=Math.sin((1-c)*e)/f,c=Math.sin(c*e)/f,d[0]=a[0]*g+b[0]*c,d[1]=a[1]*g+b[1]*c,d[2]=a[2]*g+b[2]*c,d[3]=a[3]*g+b[3]*c,d))},q.fromRotationMatrix=function(a,b){b||(b=q.create());var c,d=a[0]+a[4]+a[8];if(d>0)c=Math.sqrt(d+1),b[3]=.5*c,c=.5/c,b[0]=(a[7]-a[5])*c,b[1]=(a[2]-a[6])*c,b[2]=(a[3]-a[1])*c;
else{c=q.fromRotationMatrix.s_iNext=q.fromRotationMatrix.s_iNext||[1,2,0],d=0,a[4]>a[0]&&(d=1),a[8]>a[3*d+d]&&(d=2);var e=c[d],f=c[e];c=Math.sqrt(a[3*d+d]-a[3*e+e]-a[3*f+f]+1),b[d]=.5*c,c=.5/c,b[3]=(a[3*f+e]-a[3*e+f])*c,b[e]=(a[3*e+d]+a[3*d+e])*c,b[f]=(a[3*f+d]+a[3*d+f])*c}return b},o.toQuat4=q.fromRotationMatrix;var s=o.create();q.fromAxes=function(a,b,c,d){return s[0]=b[0],s[3]=b[1],s[6]=b[2],s[1]=c[0],s[4]=c[1],s[7]=c[2],s[2]=a[0],s[5]=a[1],s[8]=a[2],q.fromRotationMatrix(s,d)},q.identity=function(a){return a||(a=q.create()),a[0]=0,a[1]=0,a[2]=0,a[3]=1,a},q.fromAngleAxis=function(a,b,c){c||(c=q.create()),a*=.5;var d=Math.sin(a);return c[3]=Math.cos(a),c[0]=d*b[0],c[1]=d*b[1],c[2]=d*b[2],c},q.toAngleAxis=function(a,b){b||(b=a);var c=a[0]*a[0]+a[1]*a[1]+a[2]*a[2];return c>0?(b[3]=2*Math.acos(a[3]),c=d.invsqrt(c),b[0]=a[0]*c,b[1]=a[1]*c,b[2]=a[2]*c):(b[3]=0,b[0]=1,b[1]=0,b[2]=0),b},q.str=function(a){return"["+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+"]"};var t={create:function(a){var b=new g(2);return a?(b[0]=a[0],b[1]=a[1]):(b[0]=0,b[1]=0),b},createFrom:function(a,b){var c=new g(2);return c[0]=a,c[1]=b,c},add:function(a,b,c){return c||(c=b),c[0]=a[0]+b[0],c[1]=a[1]+b[1],c},subtract:function(a,b,c){return c||(c=b),c[0]=a[0]-b[0],c[1]=a[1]-b[1],c},multiply:function(a,b,c){return c||(c=b),c[0]=a[0]*b[0],c[1]=a[1]*b[1],c},divide:function(a,b,c){return c||(c=b),c[0]=a[0]/b[0],c[1]=a[1]/b[1],c},scale:function(a,b,c){return c||(c=a),c[0]=a[0]*b,c[1]=a[1]*b,c},dist:function(a,b){var c=b[0]-a[0],d=b[1]-a[1];return Math.sqrt(c*c+d*d)},set:function(a,b){return b[0]=a[0],b[1]=a[1],b},equal:function(a,b){return a===b||1e-6>Math.abs(a[0]-b[0])&&1e-6>Math.abs(a[1]-b[1])},negate:function(a,b){return b||(b=a),b[0]=-a[0],b[1]=-a[1],b},normalize:function(a,b){b||(b=a);var c=a[0]*a[0]+a[1]*a[1];return c>0?(c=Math.sqrt(c),b[0]=a[0]/c,b[1]=a[1]/c):b[0]=b[1]=0,b},cross:function(a,b,c){return a=a[0]*b[1]-a[1]*b[0],c?(c[0]=c[1]=0,c[2]=a,c):a},length:function(a){var b=a[0];return a=a[1],Math.sqrt(b*b+a*a)},squaredLength:function(a){var b=a[0];return a=a[1],b*b+a*a},dot:function(a,b){return a[0]*b[0]+a[1]*b[1]},direction:function(a,b,c){c||(c=a);var d=a[0]-b[0];return a=a[1]-b[1],(b=d*d+a*a)?(b=1/Math.sqrt(b),c[0]=d*b,c[1]=a*b,c):(c[0]=0,c[1]=0,c[2]=0,c)},lerp:function(a,b,c,d){return d||(d=a),d[0]=a[0]+c*(b[0]-a[0]),d[1]=a[1]+c*(b[1]-a[1]),d},str:function(a){return"["+a[0]+", "+a[1]+"]"}},u={create:function(a){var b=new g(4);return a?(b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3]):b[0]=b[1]=b[2]=b[3]=0,b},createFrom:function(a,b,c,d){var e=new g(4);return e[0]=a,e[1]=b,e[2]=c,e[3]=d,e},set:function(a,b){return b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b},equal:function(a,b){return a===b||1e-6>Math.abs(a[0]-b[0])&&1e-6>Math.abs(a[1]-b[1])&&1e-6>Math.abs(a[2]-b[2])&&1e-6>Math.abs(a[3]-b[3])},identity:function(a){return a||(a=u.create()),a[0]=1,a[1]=0,a[2]=0,a[3]=1,a},transpose:function(a,b){if(!b||a===b){var c=a[1];return a[1]=a[2],a[2]=c,a}return b[0]=a[0],b[1]=a[2],b[2]=a[1],b[3]=a[3],b},determinant:function(a){return a[0]*a[3]-a[2]*a[1]},inverse:function(a,b){b||(b=a);var c=a[0],d=a[1],e=a[2],f=a[3],g=c*f-e*d;return g?(g=1/g,b[0]=f*g,b[1]=-d*g,b[2]=-e*g,b[3]=c*g,b):null},multiply:function(a,b,c){c||(c=a);var d=a[0],e=a[1],f=a[2];return a=a[3],c[0]=d*b[0]+e*b[2],c[1]=d*b[1]+e*b[3],c[2]=f*b[0]+a*b[2],c[3]=f*b[1]+a*b[3],c},rotate:function(a,b,c){c||(c=a);var d=a[0],e=a[1],f=a[2];a=a[3];var g=Math.sin(b);return b=Math.cos(b),c[0]=d*b+e*g,c[1]=d*-g+e*b,c[2]=f*b+a*g,c[3]=f*-g+a*b,c},multiplyVec2:function(a,b,c){c||(c=b);var d=b[0];return b=b[1],c[0]=d*a[0]+b*a[1],c[1]=d*a[2]+b*a[3],c},scale:function(a,b,c){c||(c=a);var d=a[1],e=a[2],f=a[3],g=b[0];return b=b[1],c[0]=a[0]*g,c[1]=d*b,c[2]=e*g,c[3]=f*b,c},str:function(a){return"["+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+"]"}},v={create:function(a){var b=new g(4);return a?(b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3]):(b[0]=0,b[1]=0,b[2]=0,b[3]=0),b},createFrom:function(a,b,c,d){var e=new g(4);return e[0]=a,e[1]=b,e[2]=c,e[3]=d,e},add:function(a,b,c){return c||(c=b),c[0]=a[0]+b[0],c[1]=a[1]+b[1],c[2]=a[2]+b[2],c[3]=a[3]+b[3],c},subtract:function(a,b,c){return c||(c=b),c[0]=a[0]-b[0],c[1]=a[1]-b[1],c[2]=a[2]-b[2],c[3]=a[3]-b[3],c},multiply:function(a,b,c){return c||(c=b),c[0]=a[0]*b[0],c[1]=a[1]*b[1],c[2]=a[2]*b[2],c[3]=a[3]*b[3],c},divide:function(a,b,c){return c||(c=b),c[0]=a[0]/b[0],c[1]=a[1]/b[1],c[2]=a[2]/b[2],c[3]=a[3]/b[3],c},scale:function(a,b,c){return c||(c=a),c[0]=a[0]*b,c[1]=a[1]*b,c[2]=a[2]*b,c[3]=a[3]*b,c},set:function(a,b){return b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b},equal:function(a,b){return a===b||1e-6>Math.abs(a[0]-b[0])&&1e-6>Math.abs(a[1]-b[1])&&1e-6>Math.abs(a[2]-b[2])&&1e-6>Math.abs(a[3]-b[3])},negate:function(a,b){return b||(b=a),b[0]=-a[0],b[1]=-a[1],b[2]=-a[2],b[3]=-a[3],b},length:function(a){var b=a[0],c=a[1],d=a[2];return a=a[3],Math.sqrt(b*b+c*c+d*d+a*a)},squaredLength:function(a){var b=a[0],c=a[1],d=a[2];return a=a[3],b*b+c*c+d*d+a*a},lerp:function(a,b,c,d){return d||(d=a),d[0]=a[0]+c*(b[0]-a[0]),d[1]=a[1]+c*(b[1]-a[1]),d[2]=a[2]+c*(b[2]-a[2]),d[3]=a[3]+c*(b[3]-a[3]),d},str:function(a){return"["+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+"]"}};return a&&(a.glMatrixArrayType=g,a.MatrixArray=g,a.setMatrixArrayType=b,a.determineMatrixArrayType=c,a.glMath=d,a.vec2=t,a.vec3=h,a.vec4=v,a.mat2=u,a.mat3=o,a.mat4=p,a.quat4=q),{glMatrixArrayType:g,MatrixArray:g,setMatrixArrayType:b,determineMatrixArrayType:c,glMath:d,vec2:t,vec3:h,vec4:v,mat2:u,mat3:o,mat4:p,quat4:q}}),ChemDoodle.animations=function(a){var b={};return a.requestAnimFrame=a.requestAnimationFrame||a.webkitRequestAnimationFrame||a.mozRequestAnimationFrame||a.oRequestAnimationFrame||a.msRequestAnimationFrame||function(b){a.setTimeout(b,1e3/60)},b.requestInterval=function(b,c){function d(){(new Date).getTime()-e>=c&&(b.call(),e=(new Date).getTime()),f.value=a.requestAnimFrame(d)}if(!(a.requestAnimationFrame||a.webkitRequestAnimationFrame||a.mozRequestAnimationFrame&&a.mozCancelRequestAnimationFrame||a.oRequestAnimationFrame||a.msRequestAnimationFrame))return a.setInterval(b,c);var e=(new Date).getTime(),f={};return f.value=a.requestAnimFrame(d),f},b.clearRequestInterval=function(b){a.cancelAnimationFrame?a.cancelAnimationFrame(b.value):a.webkitCancelAnimationFrame?a.webkitCancelAnimationFrame(b.value):a.webkitCancelRequestAnimationFrame?a.webkitCancelRequestAnimationFrame(b.value):a.mozCancelRequestAnimationFrame?a.mozCancelRequestAnimationFrame(b.value):a.oCancelRequestAnimationFrame?a.oCancelRequestAnimationFrame(b.value):a.msCancelRequestAnimationFrame?a.msCancelRequestAnimationFrame(b.value):clearInterval(b)},b.requestTimeout=function(b,c){function d(){(new Date).getTime()-e>=c?b.call():f.value=a.requestAnimFrame(d)}if(!(a.requestAnimationFrame||a.webkitRequestAnimationFrame||a.mozRequestAnimationFrame&&a.mozCancelRequestAnimationFrame||a.oRequestAnimationFrame||a.msRequestAnimationFrame))return a.setTimeout(b,c);var e=(new Date).getTime(),f={};return f.value=a.requestAnimFrame(d),f},b.clearRequestTimeout=function(b){a.cancelAnimationFrame?a.cancelAnimationFrame(b.value):a.webkitCancelAnimationFrame?a.webkitCancelAnimationFrame(b.value):a.webkitCancelRequestAnimationFrame?a.webkitCancelRequestAnimationFrame(b.value):a.mozCancelRequestAnimationFrame?a.mozCancelRequestAnimationFrame(b.value):a.oCancelRequestAnimationFrame?a.oCancelRequestAnimationFrame(b.value):a.msCancelRequestAnimationFrame?a.msCancelRequestAnimationFrame(b.value):clearTimeout(b)},b}(window),ChemDoodle.extensions=function(a,b,c){return{stringStartsWith:function(a,b){return a.slice(0,b.length)===b},vec3AngleFrom:function(a,d){var e=b.length(a),f=b.length(d),e=b.dot(a,d)/e/f;return c.acos(e)},contextHashTo:function(b,c,d,e,f,g,h){var i=0,j=new a.Point(c,d).distance(new a.Point(e,f)),k=!1,l=c,m=d;for(c=e-c,d=f-d;j>i;){if(k){if(i+h>j){b.moveTo(e,f);break}var n=h/j,l=l+n*c,m=m+n*d;b.moveTo(l,m),i+=h}else{if(i+g>j){b.lineTo(e,f);break}n=g/j,l+=n*c,m+=n*d,b.lineTo(l,m),i+=g}k=!k}},contextRoundRect:function(a,b,c,d,e,f){a.beginPath(),a.moveTo(b+f,c),a.lineTo(b+d-f,c),a.quadraticCurveTo(b+d,c,b+d,c+f),a.lineTo(b+d,c+e-f),a.quadraticCurveTo(b+d,c+e,b+d-f,c+e),a.lineTo(b+f,c+e),a.quadraticCurveTo(b,c+e,b,c+e-f),a.lineTo(b,c+f),a.quadraticCurveTo(b,c,b+f,c),a.closePath()},contextEllipse:function(a,b,c,d,e){var f=.5522848*(d/2),g=.5522848*(e/2),h=b+d,i=c+e;d=b+d/2,e=c+e/2,a.beginPath(),a.moveTo(b,e),a.bezierCurveTo(b,e-g,d-f,c,d,c),a.bezierCurveTo(d+f,c,h,e-g,h,e),a.bezierCurveTo(h,e+g,d+f,i,d,i),a.bezierCurveTo(d-f,i,b,e+g,b,e),a.closePath()},getFontString:function(a,b,c,d){var e=[];for(c&&e.push("bold "),d&&e.push("italic "),e.push(a+"px "),a=0,c=b.length;c>a;a++)d=b[a],-1!==d.indexOf(" ")&&(d='"'+d+'"'),e.push((0!==a?",":"")+d);return e.join("")}}}(ChemDoodle.structures,ChemDoodle.lib.vec3,Math),ChemDoodle.math=function(a,b,c,d,e){var f={},g={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4","indianred ":"#cd5c5c","indigo ":"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};return f.angleBetweenLargest=function(a){if(0===a.length)return{angle:0,largest:2*e.PI};if(1===a.length)return{angle:a[0]+e.PI,largest:2*e.PI};for(var b=0,c=0,d=0,f=a.length-1;f>d;d++){var g=a[d+1]-a[d];g>b&&(b=g,c=(a[d+1]+a[d])/2)}return d=a[0]+2*e.PI-a[a.length-1],d>b&&(c=a[0]-d/2,b=d,0>c&&(c+=2*e.PI)),{angle:c,largest:b}},f.isBetween=function(a,b,c){if(b>c){var d=b;b=c,c=d}return a>=b&&c>=a},d(document).ready(function(){a.iChemLabs.checkForUpdates({})}),f.getRGB=function(a,c){var d=[0,0,0];if(g[a.toLowerCase()]&&(a=g[a.toLowerCase()]),"#"===a.charAt(0))return 4===a.length&&(a="#"+a.charAt(1)+a.charAt(1)+a.charAt(2)+a.charAt(2)+a.charAt(3)+a.charAt(3)),[parseInt(a.substring(1,3),16)/255*c,parseInt(a.substring(3,5),16)/255*c,parseInt(a.substring(5,7),16)/255*c];if(b.stringStartsWith(a,"rgb")){var e=a.replace(/rgb\(|\)/g,"").split(",");return 3!==e.length?d:[parseInt(e[0])/255*c,parseInt(e[1])/255*c,parseInt(e[2])/255*c]}return d},f.idx2color=function(a){a=a.toString(16);for(var b=0,c=6-a.length;c>b;b++)a="0"+a;return"#"+a},f.distanceFromPointToLineInclusive=function(a,b,d){var g=b.distance(d);return d=b.angle(d),d=e.PI/2-d,d=b.angle(a)+d,a=b.distance(a),a=new c.Point(a*e.cos(d),-a*e.sin(d)),f.isBetween(-a.y,0,g)?e.abs(a.x):-1},f.calculateDistanceInterior=function(a,b,c){if(this.isBetween(b.x,c.x,c.x+c.w)&&this.isBetween(b.y,c.y,c.y+c.w))return a.distance(b);var d=[];d.push({x1:c.x,y1:c.y,x2:c.x+c.w,y2:c.y}),d.push({x1:c.x,y1:c.y+c.h,x2:c.x+c.w,y2:c.y+c.h}),d.push({x1:c.x,y1:c.y,x2:c.x,y2:c.y+c.h}),d.push({x1:c.x+c.w,y1:c.y,x2:c.x+c.w,y2:c.y+c.h}),c=[];for(var f=0;4>f;f++){var g=d[f];(g=this.intersectLines(b.x,b.y,a.x,a.y,g.x1,g.y1,g.x2,g.y2))&&c.push(g)}if(0===c.length)return 0;for(f=b=0,d=c.length;d>f;f++){var g=c[f],h=a.x-g.x,g=a.y-g.y;b=e.max(b,e.sqrt(h*h+g*g))}return b},f.intersectLines=function(a,b,c,d,e,f,g,h){c-=a,d-=b,g-=e,h-=f;var i=d*g-c*h;return 0===i?!1:(g=(h*(a-e)-g*(b-f))/i,e=(d*(a-e)-c*(b-f))/i,e>=0&&1>=e&&g>=0&&1>=g?{x:a+g*c,y:b+g*d}:!1)},f.hsl2rgb=function(a,b,c){var d=function(a,b,c){return 0>c?c+=1:c>1&&(c-=1),1/6>c?a+6*(b-a)*c:.5>c?b:2/3>c?a+6*(b-a)*(2/3-c):a};if(0===b)c=b=a=c;else{var e=.5>c?c*(1+b):c+b-c*b,f=2*c-e;c=d(f,e,a+1/3),b=d(f,e,a),a=d(f,e,a-1/3)}return[255*c,255*b,255*a]},f.isPointInPoly=function(a,b){for(var c=!1,d=-1,e=a.length,f=e-1;++d<e;f=d)(a[d].y<=b.y&&b.y<a[f].y||a[f].y<=b.y&&b.y<a[d].y)&&b.x<(a[f].x-a[d].x)*(b.y-a[d].y)/(a[f].y-a[d].y)+a[d].x&&(c=!c);return c},f.clamp=function(a,b,c){return b>a?b:a>c?c:a},f.rainbowAt=function(a,b,c){1>c.length?c.push("#000000","#FFFFFF"):2>c.length&&c.push("#FFFFFF");var d=b/(c.length-1);return b=e.floor(a/d),a=(a-b*d)/d,d=f.getRGB(c[b],1),c=f.getRGB(c[b+1],1),"rgb("+[255*(d[0]+(c[0]-d[0])*a),255*(d[1]+(c[1]-d[1])*a),255*(d[2]+(c[2]-d[2])*a)].join()+")"},f.angleBounds=function(a,b,c){for(var d=2*e.PI;0>a;)a+=d;for(;a>d;)a-=d;return c&&a>e.PI&&(a=2*e.PI-a),b&&(a=180*a/e.PI),a},f}(ChemDoodle,ChemDoodle.extensions,ChemDoodle.structures,ChemDoodle.lib.jQuery,Math),function(a,b){a.Bounds=function(){};var c=a.Bounds.prototype;c.minX=c.minY=c.minZ=1/0,c.maxX=c.maxY=c.maxZ=-1/0,c.expand=function(c,d,e,f){c instanceof a.Bounds?(this.minX=b.min(this.minX,c.minX),this.minY=b.min(this.minY,c.minY),this.maxX=b.max(this.maxX,c.maxX),this.maxY=b.max(this.maxY,c.maxY),1/0!==c.maxZ&&(this.minZ=b.min(this.minZ,c.minZ),this.maxZ=b.max(this.maxZ,c.maxZ))):(this.minX=b.min(this.minX,c),this.maxX=b.max(this.maxX,c),this.minY=b.min(this.minY,d),this.maxY=b.max(this.maxY,d),void 0!==e&&void 0!==f&&(this.minX=b.min(this.minX,e),this.maxX=b.max(this.maxX,e),this.minY=b.min(this.minY,f),this.maxY=b.max(this.maxY,f)))},c.expand3D=function(a,c,d,e,f,g){this.minX=b.min(this.minX,a),this.maxX=b.max(this.maxX,a),this.minY=b.min(this.minY,c),this.maxY=b.max(this.maxY,c),this.minZ=b.min(this.minZ,d),this.maxZ=b.max(this.maxZ,d),void 0!==e&&void 0!==f&&void 0!==g&&(this.minX=b.min(this.minX,e),this.maxX=b.max(this.maxX,e),this.minY=b.min(this.minY,f),this.maxY=b.max(this.maxY,f),this.minZ=b.min(this.minZ,g),this.maxZ=b.max(this.maxZ,g))}}(ChemDoodle.math,Math),function(){var a={subtract:function(a,b){return{x:a.x-b.x,y:a.y-b.y}},dotProduct:function(a,b){return a.x*b.x+a.y*b.y},square:function(a){return Math.sqrt(a.x*a.x+a.y*a.y)},scale:function(a,b){return{x:a.x*b,y:a.y*b}}},b=Math.pow(2,-65),c=function(b,c){for(var f=[],g=c.length-1,h=2*g-1,i=[],j=[],k=[],l=[],m=[[1,.6,.3,.1],[.4,.6,.6,.4],[.1,.3,.6,1]],n=0;g>=n;n++)i[n]=a.subtract(c[n],b);for(n=0;g-1>=n;n++)j[n]=a.subtract(c[n+1],c[n]),j[n]=a.scale(j[n],3);for(n=0;g-1>=n;n++)for(var o=0;g>=o;o++)k[n]||(k[n]=[]),k[n][o]=a.dotProduct(j[n],i[o]);for(n=0;h>=n;n++)l[n]||(l[n]=[]),l[n].y=0,l[n].x=parseFloat(n)/h;for(h=g-1,i=0;g+h>=i;i++)for(n=Math.max(0,i-h),j=Math.min(i,g);j>=n;n++)o=i-n,l[n+o].y+=k[o][n]*m[o][n];for(g=c.length-1,l=d(l,2*g-1,f,0),h=a.subtract(b,c[0]),k=a.square(h),n=m=0;l>n;n++)h=a.subtract(b,e(c,g,f[n],null,null)),h=a.square(h),k>h&&(k=h,m=f[n]);return h=a.subtract(b,c[g]),h=a.square(h),k>h&&(k=h,m=1),{location:m,distance:k}},d=function(a,c,f,g){var h,i,j=[],k=[],l=[],m=[],n=0;i=0==a[0].y?0:0<a[0].y?1:-1;for(var o=1;c>=o;o++)h=0==a[o].y?0:0<a[o].y?1:-1,h!=i&&n++,i=h;switch(n){case 0:return 0;case 1:if(g>=64)return f[0]=(a[0].x+a[c].x)/2,1;var p,q,r,n=a[0].y-a[c].y;for(h=a[c].x-a[0].x,i=a[0].x*a[c].y-a[c].x*a[0].y,o=p=0,q=1;c>q;q++)r=n*a[q].x+h*a[q].y+i,r>p?p=r:o>r&&(o=r);if(r=h,q=0*r-1*n,p=(1*(i-p)-0*r)*(1/q),r=h,q=0*r-1*n,n=(1*(i-o)-0*r)*(1/q),h=Math.min(p,n),Math.max(p,n)-h<b)return l=a[c].x-a[0].x,m=a[c].y-a[0].y,f[0]=0+1*(l*(a[0].y-0)-m*(a[0].x-0))*(1/(0*l-1*m)),1}for(e(a,c,.5,j,k),a=d(j,c,l,g+1),c=d(k,c,m,g+1),g=0;a>g;g++)f[g]=l[g];for(g=0;c>g;g++)f[g+a]=m[g];return a+c},e=function(a,b,c,d,e){for(var f=[[]],g=0;b>=g;g++)f[0][g]=a[g];for(a=1;b>=a;a++)for(g=0;b-a>=g;g++)f[a]||(f[a]=[]),f[a][g]||(f[a][g]={}),f[a][g].x=(1-c)*f[a-1][g].x+c*f[a-1][g+1].x,f[a][g].y=(1-c)*f[a-1][g].y+c*f[a-1][g+1].y;if(null!=d)for(g=0;b>=g;g++)d[g]=f[g][0];if(null!=e)for(g=0;b>=g;g++)e[g]=f[b-g][g];return f[b][0]},f={},g=function(a,b){var c,d=a.length-1;if(c=f[d],!c){c=[];var e=function(a){return function(){return a}},g=function(){return function(a){return a}},h=function(){return function(a){return 1-a}},i=function(a){return function(b){for(var c=1,d=0;d<a.length;d++)c*=a[d](b);return c}};c.push(new function(){return function(a){return Math.pow(a,d)}});for(var j=1;d>j;j++){for(var k=[new e(d)],l=0;d-j>l;l++)k.push(new g);for(l=0;j>l;l++)k.push(new h);c.push(new i(k))}c.push(new function(){return function(a){return Math.pow(1-a,d)}}),f[d]=c}for(h=g=e=0;h<a.length;h++)e+=a[h].x*c[h](b),g+=a[h].y*c[h](b);return{x:e,y:g}},h=function(a,b){return Math.sqrt(Math.pow(a.x-b.x,2)+Math.pow(a.y-b.y,2))},i=function(a,b,c){for(var d=g(a,b),e=0,f=c>0?1:-1,i=null;e<Math.abs(c);)b+=.005*f,i=g(a,b),e+=h(i,d),d=i;return{point:i,location:b}},j=function(a,b){var c=g(a,b),d=g(a.slice(0,a.length-1),b),e=d.y-c.y,c=d.x-c.x;return 0==e?1/0:Math.atan(e/c)};ChemDoodle.math.jsBezier={distanceFromCurve:c,gradientAtPoint:j,gradientAtPointAlongCurveFrom:function(a,b,c){return b=i(a,b,c),1<b.location&&(b.location=1),0>b.location&&(b.location=0),j(a,b.location)},nearestPointOnCurve:function(a,b){var d=c(a,b);return{point:e(b,b.length-1,d.location,null,null),location:d.location}},pointOnCurve:g,pointAlongCurveFrom:function(a,b,c){return i(a,b,c).point},perpendicularToCurveAt:function(a,b,c,d){return b=i(a,b,null==d?0:d),a=j(a,b.location),d=Math.atan(-1/a),a=c/2*Math.sin(d),c=c/2*Math.cos(d),[{x:b.point.x+c,y:b.point.y+a},{x:b.point.x-c,y:b.point.y-a}]},locationAlongCurveFrom:function(a,b,c){return i(a,b,c).location},getLength:function(a){for(var b=g(a,0),c=0,d=0,e=null;1>d;)d+=.005,e=g(a,d),c+=h(e,b),b=e;return c}}}(ChemDoodle.math),ChemDoodle.featureDetection=function(a,b,c,d){var e={supports_canvas:function(){return!!c.createElement("canvas").getContext},supports_canvas_text:function(){return e.supports_canvas()?"function"==typeof c.createElement("canvas").getContext("2d").fillText:!1},supports_webgl:function(){var a=c.createElement("canvas");try{if(a.getContext("webgl")||a.getContext("experimental-webgl"))return!0}catch(b){}return!1},supports_xhr2:function(){return b.support.cors},supports_touch:function(){return"ontouchstart"in d&&navigator.userAgent.match(/iPhone|iPad|iPod|Android|BlackBerry|BB10/i)},supports_gesture:function(){return"ongesturestart"in d}};return e}(ChemDoodle.iChemLabs,ChemDoodle.lib.jQuery,document,window),ChemDoodle.SYMBOLS="H He Li Be B C N O F Ne Na Mg Al Si P S Cl Ar K Ca Sc Ti V Cr Mn Fe Co Ni Cu Zn Ga Ge As Se Br Kr Rb Sr Y Zr Nb Mo Tc Ru Rh Pd Ag Cd In Sn Sb Te I Xe Cs Ba La Ce Pr Nd Pm Sm Eu Gd Tb Dy Ho Er Tm Yb Lu Hf Ta W Re Os Ir Pt Au Hg Tl Pb Bi Po At Rn Fr Ra Ac Th Pa U Np Pu Am Cm Bk Cf Es Fm Md No Lr Rf Db Sg Bh Hs Mt Ds Rg Cn Uut Uuq Uup Uuh Uus Uuo".split(" "),ChemDoodle.ELEMENT=function(){function a(a,b,c,d,e,f,g,h,i){this.symbol=a,this.name=b,this.atomicNumber=c,this.addH=d,this.jmolColor=this.pymolColor=e,this.covalentRadius=f,this.vdWRadius=g,this.valency=h,this.mass=i}var b=[];return b.H=new a("H","Hydrogen",1,!1,"#FFFFFF",.31,1.2,1,1),b.He=new a("He","Helium",2,!1,"#D9FFFF",.28,1.4,0,4),b.Li=new a("Li","Lithium",3,!1,"#CC80FF",1.28,1.82,1,7),b.Be=new a("Be","Beryllium",4,!1,"#C2FF00",.96,0,2,9),b.B=new a("B","Boron",5,!0,"#FFB5B5",.84,0,3,11),b.C=new a("C","Carbon",6,!0,"#909090",.76,1.7,4,12),b.N=new a("N","Nitrogen",7,!0,"#3050F8",.71,1.55,3,14),b.O=new a("O","Oxygen",8,!0,"#FF0D0D",.66,1.52,2,16),b.F=new a("F","Fluorine",9,!0,"#90E050",.57,1.47,1,19),b.Ne=new a("Ne","Neon",10,!1,"#B3E3F5",.58,1.54,0,20),b.Na=new a("Na","Sodium",11,!1,"#AB5CF2",1.66,2.27,1,23),b.Mg=new a("Mg","Magnesium",12,!1,"#8AFF00",1.41,1.73,0,24),b.Al=new a("Al","Aluminum",13,!1,"#BFA6A6",1.21,0,0,27),b.Si=new a("Si","Silicon",14,!0,"#F0C8A0",1.11,2.1,4,28),b.P=new a("P","Phosphorus",15,!0,"#FF8000",1.07,1.8,3,31),b.S=new a("S","Sulfur",16,!0,"#FFFF30",1.05,1.8,2,32),b.Cl=new a("Cl","Chlorine",17,!0,"#1FF01F",1.02,1.75,1,35),b.Ar=new a("Ar","Argon",18,!1,"#80D1E3",1.06,1.88,0,40),b.K=new a("K","Potassium",19,!1,"#8F40D4",2.03,2.75,0,39),b.Ca=new a("Ca","Calcium",20,!1,"#3DFF00",1.76,0,0,40),b.Sc=new a("Sc","Scandium",21,!1,"#E6E6E6",1.7,0,0,45),b.Ti=new a("Ti","Titanium",22,!1,"#BFC2C7",1.6,0,1,48),b.V=new a("V","Vanadium",23,!1,"#A6A6AB",1.53,0,1,51),b.Cr=new a("Cr","Chromium",24,!1,"#8A99C7",1.39,0,2,52),b.Mn=new a("Mn","Manganese",25,!1,"#9C7AC7",1.39,0,3,55),b.Fe=new a("Fe","Iron",26,!1,"#E06633",1.32,0,2,56),b.Co=new a("Co","Cobalt",27,!1,"#F090A0",1.26,0,1,59),b.Ni=new a("Ni","Nickel",28,!1,"#50D050",1.24,1.63,1,58),b.Cu=new a("Cu","Copper",29,!1,"#C88033",1.32,1.4,0,63),b.Zn=new a("Zn","Zinc",30,!1,"#7D80B0",1.22,1.39,0,64),b.Ga=new a("Ga","Gallium",31,!1,"#C28F8F",1.22,1.87,0,69),b.Ge=new a("Ge","Germanium",32,!1,"#668F8F",1.2,0,4,74),b.As=new a("As","Arsenic",33,!0,"#BD80E3",1.19,1.85,3,75),b.Se=new a("Se","Selenium",34,!0,"#FFA100",1.2,1.9,2,80),b.Br=new a("Br","Bromine",35,!0,"#A62929",1.2,1.85,1,79),b.Kr=new a("Kr","Krypton",36,!1,"#5CB8D1",1.16,2.02,0,84),b.Rb=new a("Rb","Rubidium",37,!1,"#702EB0",2.2,0,0,85),b.Sr=new a("Sr","Strontium",38,!1,"#00FF00",1.95,0,0,88),b.Y=new a("Y","Yttrium",39,!1,"#94FFFF",1.9,0,0,89),b.Zr=new a("Zr","Zirconium",40,!1,"#94E0E0",1.75,0,0,90),b.Nb=new a("Nb","Niobium",41,!1,"#73C2C9",1.64,0,1,93),b.Mo=new a("Mo","Molybdenum",42,!1,"#54B5B5",1.54,0,2,98),b.Tc=new a("Tc","Technetium",43,!1,"#3B9E9E",1.47,0,3,0),b.Ru=new a("Ru","Ruthenium",44,!1,"#248F8F",1.46,0,2,102),b.Rh=new a("Rh","Rhodium",45,!1,"#0A7D8C",1.42,0,1,103),b.Pd=new a("Pd","Palladium",46,!1,"#006985",1.39,1.63,0,106),b.Ag=new a("Ag","Silver",47,!1,"#C0C0C0",1.45,1.72,0,107),b.Cd=new a("Cd","Cadmium",48,!1,"#FFD98F",1.44,1.58,0,114),b.In=new a("In","Indium",49,!1,"#A67573",1.42,1.93,0,115),b.Sn=new a("Sn","Tin",50,!1,"#668080",1.39,2.17,4,120),b.Sb=new a("Sb","Antimony",51,!1,"#9E63B5",1.39,0,3,121),b.Te=new a("Te","Tellurium",52,!0,"#D47A00",1.38,2.06,2,130),b.I=new a("I","Iodine",53,!0,"#940094",1.39,1.98,1,127),b.Xe=new a("Xe","Xenon",54,!1,"#429EB0",1.4,2.16,0,132),b.Cs=new a("Cs","Cesium",55,!1,"#57178F",2.44,0,0,133),b.Ba=new a("Ba","Barium",56,!1,"#00C900",2.15,0,0,138),b.La=new a("La","Lanthanum",57,!1,"#70D4FF",2.07,0,0,139),b.Ce=new a("Ce","Cerium",58,!1,"#FFFFC7",2.04,0,0,140),b.Pr=new a("Pr","Praseodymium",59,!1,"#D9FFC7",2.03,0,0,141),b.Nd=new a("Nd","Neodymium",60,!1,"#C7FFC7",2.01,0,0,142),b.Pm=new a("Pm","Promethium",61,!1,"#A3FFC7",1.99,0,0,0),b.Sm=new a("Sm","Samarium",62,!1,"#8FFFC7",1.98,0,0,152),b.Eu=new a("Eu","Europium",63,!1,"#61FFC7",1.98,0,0,153),b.Gd=new a("Gd","Gadolinium",64,!1,"#45FFC7",1.96,0,0,158),b.Tb=new a("Tb","Terbium",65,!1,"#30FFC7",1.94,0,0,159),b.Dy=new a("Dy","Dysprosium",66,!1,"#1FFFC7",1.92,0,0,164),b.Ho=new a("Ho","Holmium",67,!1,"#00FF9C",1.92,0,0,165),b.Er=new a("Er","Erbium",68,!1,"#00E675",1.89,0,0,166),b.Tm=new a("Tm","Thulium",69,!1,"#00D452",1.9,0,0,169),b.Yb=new a("Yb","Ytterbium",70,!1,"#00BF38",1.87,0,0,174),b.Lu=new a("Lu","Lutetium",71,!1,"#00AB24",1.87,0,0,175),b.Hf=new a("Hf","Hafnium",72,!1,"#4DC2FF",1.75,0,0,180),b.Ta=new a("Ta","Tantalum",73,!1,"#4DA6FF",1.7,0,1,181),b.W=new a("W","Tungsten",74,!1,"#2194D6",1.62,0,2,184),b.Re=new a("Re","Rhenium",75,!1,"#267DAB",1.51,0,3,187),b.Os=new a("Os","Osmium",76,!1,"#266696",1.44,0,2,192),b.Ir=new a("Ir","Iridium",77,!1,"#175487",1.41,0,3,193),b.Pt=new a("Pt","Platinum",78,!1,"#D0D0E0",1.36,1.75,0,195),b.Au=new a("Au","Gold",79,!1,"#FFD123",1.36,1.66,1,197),b.Hg=new a("Hg","Mercury",80,!1,"#B8B8D0",1.32,1.55,0,202),b.Tl=new a("Tl","Thallium",81,!1,"#A6544D",1.45,1.96,0,205),b.Pb=new a("Pb","Lead",82,!1,"#575961",1.46,2.02,4,208),b.Bi=new a("Bi","Bismuth",83,!1,"#9E4FB5",1.48,0,3,209),b.Po=new a("Po","Polonium",84,!1,"#AB5C00",1.4,0,2,0),b.At=new a("At","Astatine",85,!0,"#754F45",1.5,0,1,0),b.Rn=new a("Rn","Radon",86,!1,"#428296",1.5,0,0,0),b.Fr=new a("Fr","Francium",87,!1,"#420066",2.6,0,0,0),b.Ra=new a("Ra","Radium",88,!1,"#007D00",2.21,0,0,0),b.Ac=new a("Ac","Actinium",89,!1,"#70ABFA",2.15,0,0,0),b.Th=new a("Th","Thorium",90,!1,"#00BAFF",2.06,0,0,232),b.Pa=new a("Pa","Protactinium",91,!1,"#00A1FF",2,0,0,231),b.U=new a("U","Uranium",92,!1,"#008FFF",1.96,1.86,0,238),b.Np=new a("Np","Neptunium",93,!1,"#0080FF",1.9,0,0,0),b.Pu=new a("Pu","Plutonium",94,!1,"#006BFF",1.87,0,0,0),b.Am=new a("Am","Americium",95,!1,"#545CF2",1.8,0,0,0),b.Cm=new a("Cm","Curium",96,!1,"#785CE3",1.69,0,0,0),b.Bk=new a("Bk","Berkelium",97,!1,"#8A4FE3",0,0,0,0),b.Cf=new a("Cf","Californium",98,!1,"#A136D4",0,0,0,0),b.Es=new a("Es","Einsteinium",99,!1,"#B31FD4",0,0,0,0),b.Fm=new a("Fm","Fermium",100,!1,"#B31FBA",0,0,0,0),b.Md=new a("Md","Mendelevium",101,!1,"#B30DA6",0,0,0,0),b.No=new a("No","Nobelium",102,!1,"#BD0D87",0,0,0,0),b.Lr=new a("Lr","Lawrencium",103,!1,"#C70066",0,0,0,0),b.Rf=new a("Rf","Rutherfordium",104,!1,"#CC0059",0,0,0,0),b.Db=new a("Db","Dubnium",105,!1,"#D1004F",0,0,0,0),b.Sg=new a("Sg","Seaborgium",106,!1,"#D90045",0,0,0,0),b.Bh=new a("Bh","Bohrium",107,!1,"#E00038",0,0,0,0),b.Hs=new a("Hs","Hassium",108,!1,"#E6002E",0,0,0,0),b.Mt=new a("Mt","Meitnerium",109,!1,"#EB0026",0,0,0,0),b.Ds=new a("Ds","Darmstadtium",110,!1,"#000000",0,0,0,0),b.Rg=new a("Rg","Roentgenium",111,!1,"#000000",0,0,0,0),b.Cn=new a("Cn","Copernicium",112,!1,"#000000",0,0,0,0),b.Uut=new a("Uut","Ununtrium",113,!1,"#000000",0,0,0,0),b.Uuq=new a("Uuq","Ununquadium",114,!1,"#000000",0,0,0,0),b.Uup=new a("Uup","Ununpentium",115,!1,"#000000",0,0,0,0),b.Uuh=new a("Uuh","Ununhexium",116,!1,"#000000",0,0,0,0),b.Uus=new a("Uus","Ununseptium",117,!1,"#000000",0,0,0,0),b.Uuo=new a("Uuo","Ununoctium",118,!1,"#000000",0,0,0,0),b.H.pymolColor="#E6E6E6",b.C.pymolColor="#33FF33",b.N.pymolColor="#3333FF",b.O.pymolColor="#FF4D4D",b.F.pymolColor="#B3FFFF",b.S.pymolColor="#E6C640",b}(ChemDoodle.SYMBOLS),ChemDoodle.RESIDUE=function(){function a(a,b,c,d,e,f){this.symbol=a,this.name=b,this.polar=c,this.aminoColor=d,this.shapelyColor=e,this.acidity=f}var b=[];return b.Ala=new a("Ala","Alanine",!1,"#C8C8C8","#8CFF8C",0),b.Arg=new a("Arg","Arginine",!0,"#145AFF","#00007C",1),b.Asn=new a("Asn","Asparagine",!0,"#00DCDC","#FF7C70",0),b.Asp=new a("Asp","Aspartic Acid",!0,"#E60A0A","#A00042",-1),b.Cys=new a("Cys","Cysteine",!0,"#E6E600","#FFFF70",0),b.Gln=new a("Gln","Glutamine",!0,"#00DCDC","#FF4C4C",0),b.Glu=new a("Glu","Glutamic Acid",!0,"#E60A0A","#660000",-1),b.Gly=new a("Gly","Glycine",!1,"#EBEBEB","#FFFFFF",0),b.His=new a("His","Histidine",!0,"#8282D2","#7070FF",1),b.Ile=new a("Ile","Isoleucine",!1,"#0F820F","#004C00",0),b.Leu=new a("Leu","Leucine",!1,"#0F820F","#455E45",0),b.Lys=new a("Lys","Lysine",!0,"#145AFF","#4747B8",1),b.Met=new a("Met","Methionine",!1,"#E6E600","#B8A042",0),b.Phe=new a("Phe","Phenylalanine",!1,"#3232AA","#534C52",0),b.Pro=new a("Pro","Proline",!1,"#DC9682","#525252",0),b.Ser=new a("Ser","Serine",!0,"#FA9600","#FF7042",0),b.Thr=new a("Thr","Threonine",!0,"#FA9600","#B84C00",0),b.Trp=new a("Trp","Tryptophan",!0,"#B45AB4","#4F4600",0),b.Tyr=new a("Tyr","Tyrosine",!0,"#3232AA","#8C704C",0),b.Val=new a("Val","Valine",!1,"#0F820F","#FF8CFF",0),b.Asx=new a("Asx","Asparagine/Aspartic Acid",!0,"#FF69B4","#FF00FF",0),b.Glx=new a("Glx","Glutamine/Glutamic Acid",!0,"#FF69B4","#FF00FF",0),b["*"]=new a("*","Other",!1,"#BEA06E","#FF00FF",0),b.A=new a("A","Adenine",!1,"#BEA06E","#A0A0FF",0),b.G=new a("G","Guanine",!1,"#BEA06E","#FF7070",0),b.I=new a("I","",!1,"#BEA06E","#80FFFF",0),b.C=new a("C","Cytosine",!1,"#BEA06E","#FF8C4B",0),b.T=new a("T","Thymine",!1,"#BEA06E","#A0FFA0",0),b.U=new a("U","Uracil",!1,"#BEA06E","#FF8080",0),b}(),function(a){a.Queue=function(){this.queue=[]},a=a.Queue.prototype,a.queueSpace=0,a.getSize=function(){return this.queue.length-this.queueSpace},a.isEmpty=function(){return 0===this.queue.length},a.enqueue=function(a){this.queue.push(a)},a.dequeue=function(){var a;return this.queue.length&&(a=this.queue[this.queueSpace],2*++this.queueSpace>=this.queue.length&&(this.queue=this.queue.slice(this.queueSpace),this.queueSpace=0)),a},a.getOldestElement=function(){var a;return this.queue.length&&(a=this.queue[this.queueSpace]),a}}(ChemDoodle.structures),function(a,b){a.Point=function(a,b){this.x=a?a:0,this.y=b?b:0};var c=a.Point.prototype;c.sub=function(a){this.x-=a.x,this.y-=a.y},c.add=function(a){this.x+=a.x,this.y+=a.y},c.distance=function(a){var c=a.x-this.x;return a=a.y-this.y,b.sqrt(c*c+a*a)},c.angleForStupidCanvasArcs=function(a){var c=a.x-this.x;a=a.y-this.y;for(var d=0,d=0===c?0===a?0:a>0?b.PI/2:3*b.PI/2:0===a?c>0?0:b.PI:0>c?b.atan(a/c)+b.PI:0>a?b.atan(a/c)+2*b.PI:b.atan(a/c);0>d;)d+=2*b.PI;return d%=2*b.PI},c.angle=function(a){var c=a.x-this.x;a=this.y-a.y;for(var d=0,d=0===c?0===a?0:a>0?b.PI/2:3*b.PI/2:0===a?c>0?0:b.PI:0>c?b.atan(a/c)+b.PI:0>a?b.atan(a/c)+2*b.PI:b.atan(a/c);0>d;)d+=2*b.PI;return d%=2*b.PI}}(ChemDoodle.structures,Math),function(a,b,c,d,e,f){d.Atom=function(b,c,d,e){this.label=b?b.replace(/\s/g,""):"C",a[this.label]||(this.label="C"),this.x=c?c:0,this.y=d?d:0,this.z=e?e:0},d=d.Atom.prototype=new d.Point(0,0),d.charge=0,d.numLonePair=0,d.numRadical=0,d.mass=-1,d.coordinationNumber=0,d.bondNumber=0,d.angleOfLeastInterference=0,d.isHidden=!1,d.altLabel=void 0,d.any=!1,d.rgroup=-1,d.isLone=!1,d.isHover=!1,d.isSelected=!1,d.add3D=function(a){this.x+=a.x,this.y+=a.y,this.z+=a.z},d.sub3D=function(a){this.x-=a.x,this.y-=a.y,this.z-=a.z},d.distance3D=function(a){var b=a.x-this.x,c=a.y-this.y;return a=a.z-this.z,e.sqrt(b*b+c*c+a*a)},d.draw=function(a,d){if(this.isLassoed){var f=a.createRadialGradient(this.x-1,this.y-1,0,this.x,this.y,7);f.addColorStop(0,"rgba(212, 99, 0, 0)"),f.addColorStop(.7,"rgba(212, 99, 0, 0.8)"),a.fillStyle=f,a.beginPath(),a.arc(this.x,this.y,5,0,2*e.PI,!1),a.fill()}this.textBounds=[],this.specs&&(d=this.specs);var g=b.getFontString(d.atoms_font_size_2D,d.atoms_font_families_2D,d.atoms_font_bold_2D,d.atoms_font_italic_2D);a.font=g,a.fillStyle=this.getElementColor(d.atoms_useJMOLColors,d.atoms_usePYMOLColors,d.atoms_color,2),"H"===this.label&&d.atoms_HBlack_2D&&(a.fillStyle="black");var h;if(this.isLone&&!d.atoms_displayAllCarbonLabels_2D||d.atoms_circles_2D)a.beginPath(),a.arc(this.x,this.y,d.atoms_circleDiameter_2D/2,0,2*e.PI,!1),a.fill(),0<d.atoms_circleBorderWidth_2D&&(a.lineWidth=d.atoms_circleBorderWidth_2D,a.strokeStyle="black",a.stroke());else if(this.isLabelVisible(d))if(a.textAlign="center",a.textBaseline="middle",void 0!==this.altLabel){a.fillText(this.altLabel,this.x,this.y);
var i=a.measureText(this.altLabel).width;this.textBounds.push({x:this.x-i/2,y:this.y-d.atoms_font_size_2D/2+1,w:i,h:d.atoms_font_size_2D-2})}else if(this.any)a.font=b.getFontString(d.atoms_font_size_2D+5,d.atoms_font_families_2D,!0),a.fillText("*",this.x+1,this.y+3),i=a.measureText("*").width,this.textBounds.push({x:this.x-i/2,y:this.y-d.atoms_font_size_2D/2+1,w:i,h:d.atoms_font_size_2D-2});else if(-1!==this.rgroup)f="R"+this.rgroup,a.fillText(f,this.x,this.y),i=a.measureText(f).width,this.textBounds.push({x:this.x-i/2,y:this.y-d.atoms_font_size_2D/2+1,w:i,h:d.atoms_font_size_2D-2});else{a.fillText(this.label,this.x,this.y),i=a.measureText(this.label).width,this.textBounds.push({x:this.x-i/2,y:this.y-d.atoms_font_size_2D/2+1,w:i,h:d.atoms_font_size_2D-2});var j=0;-1!==this.mass&&(f=a.font,a.font=b.getFontString(.7*d.atoms_font_size_2D,d.atoms_font_families_2D,d.atoms_font_bold_2D,d.atoms_font_italic_2D),j=a.measureText(this.mass).width,a.fillText(this.mass,this.x-j-.5,this.y-d.atoms_font_size_2D/2+1),this.textBounds.push({x:this.x-i/2-j-.5,y:this.y-1.7*d.atoms_font_size_2D/2+1,w:j,h:d.atoms_font_size_2D/2-1}),a.font=f);var f=i/2,k=this.getImplicitHydrogenCount();if(d.atoms_implicitHydrogens_2D&&k>0){h=0;var l=a.measureText("H").width,m=!0;if(k>1){var n=i/2+l/2,o=0,p=b.getFontString(.8*d.atoms_font_size_2D,d.atoms_font_families_2D,d.atoms_font_bold_2D,d.atoms_font_italic_2D);a.font=p;var q=a.measureText(k).width;1===this.bondNumber?this.angleOfLeastInterference>e.PI/2&&this.angleOfLeastInterference<3*e.PI/2&&(n=-i/2-q-l/2-j/2,m=!1,h=e.PI):this.angleOfLeastInterference<=e.PI/4||(this.angleOfLeastInterference<3*e.PI/4?(n=0,o=.9*-d.atoms_font_size_2D,0!==this.charge&&(o-=.3*d.atoms_font_size_2D),m=!1,h=e.PI/2):this.angleOfLeastInterference<=5*e.PI/4?(n=-i/2-q-l/2-j/2,m=!1,h=e.PI):this.angleOfLeastInterference<7*e.PI/4&&(n=0,o=.9*d.atoms_font_size_2D,m=!1,h=3*e.PI/2)),a.font=g,a.fillText("H",this.x+n,this.y+o),a.font=p,a.fillText(k,this.x+n+l/2+q/2,this.y+o+.3*d.atoms_font_size_2D),this.textBounds.push({x:this.x+n-l/2,y:this.y+o-d.atoms_font_size_2D/2+1,w:l,h:d.atoms_font_size_2D-2}),this.textBounds.push({x:this.x+n+l/2,y:this.y+o+.3*d.atoms_font_size_2D-d.atoms_font_size_2D/2+1,w:q,h:.8*d.atoms_font_size_2D-2})}else n=i/2+l/2,o=0,1===this.bondNumber?this.angleOfLeastInterference>e.PI/2&&this.angleOfLeastInterference<3*e.PI/2&&(n=-i/2-l/2-j/2,m=!1,h=e.PI):this.angleOfLeastInterference<=e.PI/4||(this.angleOfLeastInterference<3*e.PI/4?(n=0,o=.9*-d.atoms_font_size_2D,m=!1,h=e.PI/2):this.angleOfLeastInterference<=5*e.PI/4?(n=-i/2-l/2-j/2,m=!1,h=e.PI):this.angleOfLeastInterference<7*e.PI/4&&(n=0,o=.9*d.atoms_font_size_2D,m=!1,h=3*e.PI/2)),a.fillText("H",this.x+n,this.y+o),this.textBounds.push({x:this.x+n-l/2,y:this.y+o-d.atoms_font_size_2D/2+1,w:l,h:d.atoms_font_size_2D-2});m&&(f+=l)}0!==this.charge&&(g=this.charge.toFixed(0),g="1"===g?"+":"-1"===g?"–":b.stringStartsWith(g,"-")?g.substring(1)+"–":g+"+",i=a.measureText(g).width,f+=i/2,a.textAlign="center",a.textBaseline="middle",a.font=b.getFontString(e.floor(.8*d.atoms_font_size_2D),d.atoms_font_families_2D,d.atoms_font_bold_2D,d.atoms_font_italic_2D),a.fillText(g,this.x+f-1,this.y-d.atoms_font_size_2D/2+1),this.textBounds.push({x:this.x+f-i/2-1,y:this.y-1.8*d.atoms_font_size_2D/2+5,w:i,h:d.atoms_font_size_2D/2-1}))}if(0<this.numLonePair||0<this.numRadical){for(a.fillStyle="black",k=this.angles.slice(0),f=this.angleOfLeastInterference,g=this.largestAngle,void 0!==h&&(k.push(h),k.sort(),g=c.angleBetweenLargest(k),f=g.angle%(2*e.PI),g=g.largest),i=[],j=0;j<this.numLonePair;j++)i.push({t:2});for(j=0;j<this.numRadical;j++)i.push({t:1});if(void 0===h&&e.abs(g-2*e.PI/k.length)<e.PI/60)for(k=e.ceil(i.length/k.length),j=0,l=i.length;l>j;j+=k,f+=g)this.drawElectrons(a,d,i.slice(j,e.min(i.length,j+k)),f,g,h);else this.drawElectrons(a,d,i,f,g,h)}},d.drawElectrons=function(a,b,c,d,f,g){g=f/(c.length+(0===this.bonds.length&&void 0===g?0:1)),f=d-f/2+g;for(var h=0;h<c.length;h++){var i=c[h];d=f+h*g;var j=this.x+Math.cos(d)*b.atoms_lonePairDistance_2D,k=this.y-Math.sin(d)*b.atoms_lonePairDistance_2D;2===i.t?(i=d+Math.PI/2,d=Math.cos(i)*b.atoms_lonePairSpread_2D/2,i=-Math.sin(i)*b.atoms_lonePairSpread_2D/2,a.beginPath(),a.arc(j+d,k+i,b.atoms_lonePairDiameter_2D,0,2*e.PI,!1),a.fill(),a.beginPath(),a.arc(j-d,k-i,b.atoms_lonePairDiameter_2D,0,2*e.PI,!1),a.fill()):1===i.t&&(a.beginPath(),a.arc(j,k,b.atoms_lonePairDiameter_2D,0,2*e.PI,!1),a.fill())}},d.drawDecorations=function(a){(this.isHover||this.isSelected)&&(a.strokeStyle=this.isHover?"#885110":"#0060B2",a.lineWidth=1.2,a.beginPath(),a.arc(this.x,this.y,this.isHover?7:15,0,2*e.PI,!1),a.stroke()),this.isOverlap&&(a.strokeStyle="#C10000",a.lineWidth=1.2,a.beginPath(),a.arc(this.x,this.y,7,0,2*e.PI,!1),a.stroke())},d.render=function(b,c,d){this.specs&&(c=this.specs);var e=f.translate(b.modelViewMatrix,[this.x,this.y,this.z],[]),g=c.atoms_useVDWDiameters_3D?a[this.label].vdWRadius*c.atoms_vdwMultiplier_3D:c.atoms_sphereDiameter_3D/2;0===g&&(g=1),f.scale(e,[g,g,g]),d||(d=c.atoms_color,c.atoms_useJMOLColors?d=a[this.label].jmolColor:c.atoms_usePYMOLColors&&(d=a[this.label].pymolColor),b.material.setDiffuseColor(d)),b.setMatrixUniforms(e),b.drawElements(b.TRIANGLES,(this.renderAsStar?b.starBuffer:b.sphereBuffer).vertexIndexBuffer.numItems,b.UNSIGNED_SHORT,0)},d.renderHighlight=function(b,c){if(this.isSelected||this.isHover){this.specs&&(c=this.specs);var d=f.translate(b.modelViewMatrix,[this.x,this.y,this.z],[]),e=c.atoms_useVDWDiameters_3D?a[this.label].vdWRadius*c.atoms_vdwMultiplier_3D:c.atoms_sphereDiameter_3D/2;0===e&&(e=1),e*=1.3,f.scale(d,[e,e,e]),b.setMatrixUniforms(d),b.material.setDiffuseColor(this.isHover?"#885110":"#0060B2"),b.drawElements(b.TRIANGLES,(this.renderAsStar?b.starBuffer:b.sphereBuffer).vertexIndexBuffer.numItems,b.UNSIGNED_SHORT,0)}},d.isLabelVisible=function(a){return a.atoms_displayAllCarbonLabels_2D||"C"!==this.label||this.altLabel||this.any||-1!==this.rgroup||-1!==this.mass||0!==this.charge||a.atoms_showAttributedCarbons_2D&&(0!==this.numRadical||0!==this.numLonePair)||this.isHidden&&a.atoms_showHiddenCarbons_2D||a.atoms_displayTerminalCarbonLabels_2D&&1===this.bondNumber?!0:!1},d.getImplicitHydrogenCount=function(){if("H"===this.label||!a[this.label]||!a[this.label].addH)return 0;var b=a[this.label].valency,c=b-this.coordinationNumber;return 0<this.numRadical&&(c=e.max(0,c-this.numRadical)),0<this.charge?(b=4-b,c=this.charge<=b?c+this.charge:4-this.coordinationNumber-this.charge+b):c+=this.charge,0>c?0:e.floor(c)},d.getBounds=function(){var a=new c.Bounds;if(a.expand(this.x,this.y),this.textBounds)for(var b=0,d=this.textBounds.length;d>b;b++){var e=this.textBounds[b];a.expand(e.x,e.y,e.x+e.w,e.y+e.h)}return a},d.getBounds3D=function(){var a=new c.Bounds;return a.expand3D(this.x,this.y,this.z),a},d.getElementColor=function(b,c,d,e){return 2==e&&this.any||-1!==this.rgroup?d:(b?d=a[this.label].jmolColor:c&&(d=a[this.label].pymolColor),d)}}(ChemDoodle.ELEMENT,ChemDoodle.extensions,ChemDoodle.math,ChemDoodle.structures,Math,ChemDoodle.lib.mat4),function(a,b,c,d,e,f,g){c.Bond=function(a,b,c){this.a1=a,this.a2=b,this.bondOrder=void 0!==c?c:1},c.Bond.STEREO_NONE="none",c.Bond.STEREO_PROTRUDING="protruding",c.Bond.STEREO_RECESSED="recessed",c.Bond.STEREO_AMBIGUOUS="ambiguous",a=c.Bond.prototype,a.stereo=c.Bond.STEREO_NONE,a.isHover=!1,a.ring=void 0,a.getCenter=function(){return new c.Point((this.a1.x+this.a2.x)/2,(this.a1.y+this.a2.y)/2)},a.getLength=function(){return this.a1.distance(this.a2)},a.getLength3D=function(){return this.a1.distance3D(this.a2)},a.contains=function(a){return a===this.a1||a===this.a2},a.getNeighbor=function(a){return a===this.a1?this.a2:a===this.a2?this.a1:void 0},a.draw=function(a,f){if(this.a1.x!==this.a2.x||this.a1.y!==this.a2.y){this.specs&&(f=this.specs);var g=this.a1.x,h=this.a2.x,i=this.a1.y,j=this.a2.y,k=this.a1.distance(this.a2),l=h-g,m=j-i;if(this.a1.isLassoed&&this.a2.isLassoed){var n=a.createLinearGradient(g,i,h,j);n.addColorStop(0,"rgba(212, 99, 0, 0)"),n.addColorStop(.5,"rgba(212, 99, 0, 0.8)"),n.addColorStop(1,"rgba(212, 99, 0, 0)");var o=2.5,p=this.a1.angle(this.a2)+e.PI/2,q=e.cos(p),p=e.sin(p),r=g-q*o,s=i+p*o,t=g+q*o,u=i-p*o,v=h+q*o,w=j-p*o,q=h-q*o,p=j+p*o;a.fillStyle=n,a.beginPath(),a.moveTo(r,s),a.lineTo(t,u),a.lineTo(v,w),a.lineTo(q,p),a.closePath(),a.fill()}if(f.atoms_display&&!f.atoms_circles_2D&&this.a1.isLabelVisible(f)&&this.a1.textBounds){for(o=q=0,r=this.a1.textBounds.length;r>o;o++)q=Math.max(q,d.calculateDistanceInterior(this.a1,this.a2,this.a1.textBounds[o]));q+=f.bonds_atomLabelBuffer_2D,q/=k,g+=l*q,i+=m*q}if(f.atoms_display&&!f.atoms_circles_2D&&this.a2.isLabelVisible(f)&&this.a2.textBounds){for(o=q=0,r=this.a2.textBounds.length;r>o;o++)q=Math.max(q,d.calculateDistanceInterior(this.a2,this.a1,this.a2.textBounds[o]));q+=f.bonds_atomLabelBuffer_2D,q/=k,h-=l*q,j-=m*q}if(f.bonds_clearOverlaps_2D&&(q=g+.15*l,p=i+.15*m,o=h-.15*l,k=j-.15*m,a.strokeStyle=f.backgroundColor,a.lineWidth=f.bonds_width_2D+2*f.bonds_overlapClearWidth_2D,a.lineCap="round",a.beginPath(),a.moveTo(q,p),a.lineTo(o,k),a.closePath(),a.stroke()),a.strokeStyle=f.bonds_color,a.fillStyle=f.bonds_color,a.lineWidth=f.bonds_width_2D,a.lineCap=f.bonds_ends_2D,(f.bonds_useJMOLColors||f.bonds_usePYMOLColors)&&(q=a.createLinearGradient(g,i,h,j),p=this.a1.getElementColor(f.bonds_useJMOLColors,f.bonds_usePYMOLColors,f.atoms_color,2),o=this.a2.getElementColor(f.bonds_useJMOLColors,f.bonds_usePYMOLColors,f.atoms_color,2),q.addColorStop(0,p),f.bonds_colorGradient||(q.addColorStop(.5,p),q.addColorStop(.51,o)),q.addColorStop(1,o),a.strokeStyle=q,a.fillStyle=q),f.bonds_lewisStyle_2D&&0===this.bondOrder%1)this.drawLewisStyle(a,f,g,i,h,j);else switch(this.bondOrder){case 0:for(h-=g,j-=i,h=e.sqrt(h*h+j*j),j=e.floor(h/f.bonds_dotSize_2D),h=(h-(j-1)*f.bonds_dotSize_2D)/2,1===j%2?h+=f.bonds_dotSize_2D/4:(h-=f.bonds_dotSize_2D/4,j+=2),j/=2,m=this.a1.angle(this.a2),q=g+h*Math.cos(m),p=i-h*Math.sin(m),a.beginPath(),o=0;j>o;o++)a.arc(q,p,f.bonds_dotSize_2D/2,0,2*e.PI,!1),q+=2*f.bonds_dotSize_2D*Math.cos(m),p-=2*f.bonds_dotSize_2D*Math.sin(m);a.fill();break;case.5:a.beginPath(),a.moveTo(g,i),b.contextHashTo(a,g,i,h,j,f.bonds_hashSpacing_2D,f.bonds_hashSpacing_2D),a.stroke();break;case 1:if(this.stereo===c.Bond.STEREO_PROTRUDING||this.stereo===c.Bond.STEREO_RECESSED)m=f.bonds_width_2D/2,o=this.a1.distance(this.a2)*f.bonds_wedgeThickness_2D/2,p=this.a1.angle(this.a2)+e.PI/2,q=e.cos(p),p=e.sin(p),r=g-q*m,s=i+p*m,t=g+q*m,u=i-p*m,v=h+q*o,w=j-p*o,q=h-q*o,p=j+p*o,a.beginPath(),a.moveTo(r,s),a.lineTo(t,u),a.lineTo(v,w),a.lineTo(q,p),a.closePath(),this.stereo===c.Bond.STEREO_PROTRUDING?a.fill():(a.save(),a.clip(),a.lineWidth=2*o,a.lineCap="butt",a.beginPath(),a.moveTo(g,i),b.contextHashTo(a,g,i,h,j,f.bonds_hashWidth_2D,f.bonds_hashSpacing_2D),a.stroke(),a.restore());else{if(this.stereo===c.Bond.STEREO_AMBIGUOUS){for(a.beginPath(),a.moveTo(g,i),h=e.floor(e.sqrt(l*l+m*m)/f.bonds_wavyLength_2D),p=this.a1.angle(this.a2)+e.PI/2,q=e.cos(p),p=e.sin(p),j=l/h,m/=h,o=0,r=h;r>o;o++)g+=j,i+=m,h=f.bonds_wavyLength_2D*q+g-.5*j,k=f.bonds_wavyLength_2D*-p+i-.5*m,l=f.bonds_wavyLength_2D*-q+g-.5*j,s=f.bonds_wavyLength_2D*p+i-.5*m,0===o%2?a.quadraticCurveTo(h,k,g,i):a.quadraticCurveTo(l,s,g,i);a.stroke();break}a.beginPath(),a.moveTo(g,i),a.lineTo(h,j),a.stroke()}break;case 1.5:case 2:this.stereo===c.Bond.STEREO_AMBIGUOUS?(o=this.a1.distance(this.a2)*f.bonds_saturationWidth_2D/2,p=this.a1.angle(this.a2)+e.PI/2,q=e.cos(p),p=e.sin(p),r=g-q*o,s=i+p*o,t=g+q*o,u=i-p*o,v=h+q*o,w=j-p*o,q=h-q*o,p=j+p*o,a.beginPath(),a.moveTo(r,s),a.lineTo(v,w),a.moveTo(t,u),a.lineTo(q,p),a.stroke()):!f.bonds_symmetrical_2D&&(this.ring||"C"===this.a1.label&&"C"===this.a2.label)?(a.beginPath(),a.moveTo(g,i),a.lineTo(h,j),q=0,k=this.a1.distance(this.a2),m=this.a1.angle(this.a2),p=m+e.PI/2,o=k*f.bonds_saturationWidth_2D,l=f.bonds_saturationAngle_2D,l<e.PI/2&&(q=-(o/e.tan(l))),e.abs(q)<k/2&&(l=g-e.cos(m)*q,g=h+e.cos(m)*q,h=i+e.sin(m)*q,i=j-e.sin(m)*q,q=e.cos(p),p=e.sin(p),r=l-q*o,s=h+p*o,t=l+q*o,u=h-p*o,v=g-q*o,w=i+p*o,q=g+q*o,p=i-p*o,!this.ring||this.ring.center.angle(this.a1)>this.ring.center.angle(this.a2)&&!(this.ring.center.angle(this.a1)-this.ring.center.angle(this.a2)>e.PI)||this.ring.center.angle(this.a1)-this.ring.center.angle(this.a2)<-e.PI?(a.moveTo(r,s),2===this.bondOrder?a.lineTo(v,w):b.contextHashTo(a,r,s,v,w,f.bonds_hashSpacing_2D,f.bonds_hashSpacing_2D)):(a.moveTo(t,u),2===this.bondOrder?a.lineTo(q,p):b.contextHashTo(a,t,u,q,p,f.bonds_hashSpacing_2D,f.bonds_hashSpacing_2D)),a.stroke())):(o=this.a1.distance(this.a2)*f.bonds_saturationWidth_2D/2,p=this.a1.angle(this.a2)+e.PI/2,q=e.cos(p),p=e.sin(p),r=g-q*o,s=i+p*o,t=g+q*o,u=i-p*o,v=h+q*o,w=j-p*o,q=h-q*o,p=j+p*o,a.beginPath(),a.moveTo(r,s),a.lineTo(q,p),a.moveTo(t,u),2===this.bondOrder?a.lineTo(v,w):b.contextHashTo(a,t,u,v,w,f.bonds_hashSpacing_2D,f.bonds_hashSpacing_2D),a.stroke());break;case 3:o=this.a1.distance(this.a2)*f.bonds_saturationWidth_2D,p=this.a1.angle(this.a2)+e.PI/2,q=e.cos(p),p=e.sin(p),r=g-q*o,s=i+p*o,t=g+q*o,u=i-p*o,v=h+q*o,w=j-p*o,q=h-q*o,p=j+p*o,a.beginPath(),a.moveTo(r,s),a.lineTo(q,p),a.moveTo(t,u),a.lineTo(v,w),a.moveTo(g,i),a.lineTo(h,j),a.stroke()}}},a.drawDecorations=function(a){if(this.isHover||this.isSelected){var b=2*e.PI,c=(this.a1.angleForStupidCanvasArcs(this.a2)+e.PI/2)%b;a.strokeStyle=this.isHover?"#885110":"#0060B2",a.lineWidth=1.2,a.beginPath();var d=(c+e.PI)%b,d=d%(2*e.PI);a.arc(this.a1.x,this.a1.y,7,c,d,!1),a.stroke(),a.beginPath(),c+=e.PI,d=(c+e.PI)%b,a.arc(this.a2.x,this.a2.y,7,c,d,!1),a.stroke()}},a.drawLewisStyle=function(a,b,c,d,f,g){var h=this.a1.angle(this.a2),i=h+e.PI/2;for(f-=c,g-=d,f=e.sqrt(f*f+g*g)/(this.bondOrder+1),g=f*e.cos(h),h=-f*e.sin(h),c+=g,d+=h,f=0;f<this.bondOrder;f++){var j=b.atoms_lonePairSpread_2D/2,k=c-e.cos(i)*j,l=d+e.sin(i)*j,m=c+e.cos(i)*j,j=d-e.sin(i)*j;a.beginPath(),a.arc(k-b.atoms_lonePairDiameter_2D/2,l-b.atoms_lonePairDiameter_2D/2,b.atoms_lonePairDiameter_2D,0,2*e.PI,!1),a.fill(),a.beginPath(),a.arc(m-b.atoms_lonePairDiameter_2D/2,j-b.atoms_lonePairDiameter_2D/2,b.atoms_lonePairDiameter_2D,0,2*e.PI,!1),a.fill(),c+=g,d+=h}},a.render=function(a,c,d){this.specs&&(c=this.specs);var h=this.a1.distance3D(this.a2);if(0!==h){var i,j,k=c.bonds_cylinderDiameter_3D/2,l=c.bonds_color,m=f.translate(a.modelViewMatrix,[this.a1.x,this.a1.y,this.a1.z],[]),n=[this.a2.x-this.a1.x,this.a2.y-this.a1.y,this.a2.z-this.a1.z],o=[0,1,0],p=0;this.a1.x===this.a2.x&&this.a1.z===this.a2.z?(o=[0,0,1],this.a2.y<this.a1.y&&(p=e.PI)):(p=b.vec3AngleFrom(o,n),o=g.cross(o,n,[]));var q=c.bonds_useJMOLColors,r=c.bonds_usePYMOLColors;(q||r)&&(l=this.a1.getElementColor(q,r,l),i=this.a2.getElementColor(q,r,c.bonds_color),l!=i&&(j=f.translate(a.modelViewMatrix,[this.a2.x,this.a2.y,this.a2.z],[])));var s,q=[0];if(d){c.bonds_showBondOrders_3D&&1<this.bondOrder&&(q=[c.bonds_cylinderDiameter_3D],s=[0,0,1],d=f.inverse(a.rotationMatrix,[]),f.multiplyVec3(d,s),s=g.cross(n,s,[]),g.normalize(s));var k=1,t=c.bonds_pillSpacing_3D,n=c.bonds_pillHeight_3D;0==this.bondOrder&&(c.bonds_renderAsLines_3D?n=t:(n=c.bonds_pillDiameter_3D,n<c.bonds_cylinderDiameter_3D&&(n/=2),k=n/2,h/=k,t/=k/2)),d=n+t;var r=e.floor(h/d),u=(t+c.bonds_pillDiameter_3D+(h-d*r))/2,v=r;for(j&&(v=e.floor(r/2)),h=0,t=q.length;t>h;h++){var w=f.set(m,[]);0!==q[h]&&f.translate(w,g.scale(s,q[h],[])),0!==p&&f.rotate(w,p,o),1!=k&&f.scale(w,[k,k,k]),l&&a.material.setDiffuseColor(l),f.translate(w,[0,u,0]);for(var x=0;v>x;x++)c.bonds_renderAsLines_3D?0==this.bondOrder?(a.setMatrixUniforms(w),a.drawArrays(a.POINTS,0,1)):(f.scale(w,[1,n,1]),a.setMatrixUniforms(w),a.drawArrays(a.LINES,0,a.lineBuffer.vertexPositionBuffer.numItems),f.scale(w,[1,1/n,1])):(a.setMatrixUniforms(w),0==this.bondOrder?a.drawElements(a.TRIANGLES,a.sphereBuffer.vertexIndexBuffer.numItems,a.UNSIGNED_SHORT,0):a.drawElements(a.TRIANGLES,a.pillBuffer.vertexIndexBuffer.numItems,a.UNSIGNED_SHORT,0)),f.translate(w,[0,d,0]);if(j){var y,z;for(c.bonds_renderAsLines_3D?(y=n,y/=2,z=0):(y=2/3,z=(1-y)/2),0!=r%2&&(f.scale(w,[1,y,1]),a.setMatrixUniforms(w),c.bonds_renderAsLines_3D?0==this.bondOrder?a.drawArrays(a.POINTS,0,1):a.drawArrays(a.LINES,0,a.lineBuffer.vertexPositionBuffer.numItems):0==this.bondOrder?a.drawElements(a.TRIANGLES,a.sphereBuffer.vertexIndexBuffer.numItems,a.UNSIGNED_SHORT,0):a.drawElements(a.TRIANGLES,a.pillBuffer.vertexIndexBuffer.numItems,a.UNSIGNED_SHORT,0),f.translate(w,[0,d*(1+z),0]),f.scale(w,[1,1/y,1])),f.set(j,w),0!==q[h]&&f.translate(w,g.scale(s,q[h],[])),f.rotate(w,p+e.PI,o),1!=k&&f.scale(w,[k,k,k]),i&&a.material.setDiffuseColor(i),f.translate(w,[0,u,0]),x=0;v>x;x++)c.bonds_renderAsLines_3D?0==this.bondOrder?(a.setMatrixUniforms(w),a.drawArrays(a.POINTS,0,1)):(f.scale(w,[1,n,1]),a.setMatrixUniforms(w),a.drawArrays(a.LINES,0,a.lineBuffer.vertexPositionBuffer.numItems),f.scale(w,[1,1/n,1])):(a.setMatrixUniforms(w),0==this.bondOrder?a.drawElements(a.TRIANGLES,a.sphereBuffer.vertexIndexBuffer.numItems,a.UNSIGNED_SHORT,0):a.drawElements(a.TRIANGLES,a.pillBuffer.vertexIndexBuffer.numItems,a.UNSIGNED_SHORT,0)),f.translate(w,[0,d,0]);0!=r%2&&(f.scale(w,[1,y,1]),a.setMatrixUniforms(w),c.bonds_renderAsLines_3D?0==this.bondOrder?a.drawArrays(a.POINTS,0,1):a.drawArrays(a.LINES,0,a.lineBuffer.vertexPositionBuffer.numItems):0==this.bondOrder?a.drawElements(a.TRIANGLES,a.sphereBuffer.vertexIndexBuffer.numItems,a.UNSIGNED_SHORT,0):a.drawElements(a.TRIANGLES,a.pillBuffer.vertexIndexBuffer.numItems,a.UNSIGNED_SHORT,0),f.translate(w,[0,d*(1+z),0]),f.scale(w,[1,1/y,1]))}}}else{if(c.bonds_showBondOrders_3D){switch(this.bondOrder){case 1.5:q=[-c.bonds_cylinderDiameter_3D];break;case 2:q=[-c.bonds_cylinderDiameter_3D,c.bonds_cylinderDiameter_3D];break;case 3:q=[-1.2*c.bonds_cylinderDiameter_3D,0,1.2*c.bonds_cylinderDiameter_3D]}1<this.bondOrder&&(s=[0,0,1],d=f.inverse(a.rotationMatrix,[]),f.multiplyVec3(d,s),s=g.cross(n,s,[]),g.normalize(s))}else switch(this.bondOrder){case 0:k*=.25;break;case.5:case 1.5:k*=.5}for(j&&(h/=2),k=[k,h,k],h=0,t=q.length;t>h;h++)w=f.set(m,[]),0!==q[h]&&f.translate(w,g.scale(s,q[h],[])),0!==p&&f.rotate(w,p,o),f.scale(w,k),l&&a.material.setDiffuseColor(l),a.setMatrixUniforms(w),c.bonds_renderAsLines_3D?a.drawArrays(a.LINES,0,a.lineBuffer.vertexPositionBuffer.numItems):a.drawArrays(a.TRIANGLE_STRIP,0,a.cylinderBuffer.vertexPositionBuffer.numItems),j&&(f.set(j,w),0!==q[h]&&f.translate(w,g.scale(s,q[h],[])),f.rotate(w,p+e.PI,o),f.scale(w,k),i&&a.material.setDiffuseColor(i),a.setMatrixUniforms(w),c.bonds_renderAsLines_3D?a.drawArrays(a.LINES,0,a.lineBuffer.vertexPositionBuffer.numItems):a.drawArrays(a.TRIANGLE_STRIP,0,a.cylinderBuffer.vertexPositionBuffer.numItems))}}},a.renderHighlight=function(a,c){if(this.isSelected||this.isHover){this.specs&&(c=this.specs),this.specs&&(c=this.specs);var d=this.a1.distance3D(this.a2);if(0!==d){var h=c.bonds_cylinderDiameter_3D/1.2,i=f.translate(a.modelViewMatrix,[this.a1.x,this.a1.y,this.a1.z],[]),j=[this.a2.x-this.a1.x,this.a2.y-this.a1.y,this.a2.z-this.a1.z],k=[0,1,0],l=0;this.a1.x===this.a2.x&&this.a1.z===this.a2.z?(j=[0,0,1],this.a2.y<this.a1.y&&(l=e.PI)):(l=b.vec3AngleFrom(k,j),j=g.cross(k,j,[])),d=[h,d,h],0!==l&&f.rotate(i,l,j),f.scale(i,d),a.setMatrixUniforms(i),a.material.setDiffuseColor(this.isHover?"#885110":"#0060B2"),a.drawArrays(a.TRIANGLE_STRIP,0,a.cylinderBuffer.vertexPositionBuffer.numItems)}}},a.renderPicker=function(a,c){this.specs&&(c=this.specs);var d=this.a1.distance3D(this.a2);if(0!==d){var h=c.bonds_cylinderDiameter_3D/2,i=f.translate(a.modelViewMatrix,[this.a1.x,this.a1.y,this.a1.z],[]),j=[this.a2.x-this.a1.x,this.a2.y-this.a1.y,this.a2.z-this.a1.z],k=[0,1,0],l=0;this.a1.x===this.a2.x&&this.a1.z===this.a2.z?(k=[0,0,1],this.a2.y<this.a1.y&&(l=e.PI)):(l=b.vec3AngleFrom(k,j),k=g.cross(k,j,[]));var m,n=[0];if(c.bonds_showBondOrders_3D)if(c.bonds_renderAsLines_3D){switch(this.bondOrder){case 1.5:case 2:n=[-c.bonds_cylinderDiameter_3D,c.bonds_cylinderDiameter_3D];break;case 3:n=[-1.2*c.bonds_cylinderDiameter_3D,0,1.2*c.bonds_cylinderDiameter_3D]}if(1<this.bondOrder){m=[0,0,1];var o=f.inverse(a.rotationMatrix,[]);f.multiplyVec3(o,m),m=g.cross(j,m,[]),g.normalize(m)}}else switch(this.bondOrder){case 1.5:case 2:h*=3;break;case 3:h*=3.4}else switch(this.bondOrder){case 0:h*=.25;break;case.5:case 1.5:h*=.5}for(d=[h,d,h],h=0,j=n.length;j>h;h++)o=f.set(i,[]),0!==n[h]&&f.translate(o,g.scale(m,n[h],[])),0!==l&&f.rotate(o,l,k),f.scale(o,d),a.setMatrixUniforms(o),c.bonds_renderAsLines_3D?a.drawArrays(a.LINES,0,a.lineBuffer.vertexPositionBuffer.numItems):a.drawArrays(a.TRIANGLE_STRIP,0,a.cylinderBuffer.vertexPositionBuffer.numItems)}}}(ChemDoodle.ELEMENT,ChemDoodle.extensions,ChemDoodle.structures,ChemDoodle.math,Math,ChemDoodle.lib.mat4,ChemDoodle.lib.vec3),function(a,b){a.Ring=function(){this.atoms=[],this.bonds=[]};var c=a.Ring.prototype;c.center=void 0,c.setupBonds=function(){for(var a=0,b=this.bonds.length;b>a;a++)this.bonds[a].ring=this;this.center=this.getCenter()},c.getCenter=function(){for(var c=1/0,d=1/0,e=-1/0,f=-1/0,g=0,h=this.atoms.length;h>g;g++)c=b.min(this.atoms[g].x,c),d=b.min(this.atoms[g].y,d),e=b.max(this.atoms[g].x,e),f=b.max(this.atoms[g].y,f);return new a.Point((e+c)/2,(f+d)/2)}}(ChemDoodle.structures,Math),function(a,b,c,d,e){c.Molecule=function(){this.atoms=[],this.bonds=[],this.rings=[]};var f=c.Molecule.prototype;f.findRings=!0,f.draw=function(a,b){if(this.specs&&(b=this.specs),b.atoms_display&&!b.atoms_circles_2D)for(var c=0,d=this.atoms.length;d>c;c++)this.atoms[c].draw(a,b);if(b.bonds_display)for(c=0,d=this.bonds.length;d>c;c++)this.bonds[c].draw(a,b);if(b.atoms_display&&b.atoms_circles_2D)for(c=0,d=this.atoms.length;d>c;c++)this.atoms[c].draw(a,b)},f.render=function(a,e){this.specs&&(e=this.specs);var f=0<this.atoms.length&&void 0!==this.atoms[0].hetatm;if(f){if(e.macro_displayBonds){0<this.bonds.length&&(e.bonds_renderAsLines_3D&&!this.residueSpecs||this.residueSpecs&&this.residueSpecs.bonds_renderAsLines_3D?(a.lineWidth(this.residueSpecs?this.residueSpecs.bonds_width_2D:e.bonds_width_2D),a.lineBuffer.bindBuffers(a)):a.cylinderBuffer.bindBuffers(a),a.material.setTempColors(e.bonds_materialAmbientColor_3D,void 0,e.bonds_materialSpecularColor_3D,e.bonds_materialShininess_3D));for(var g=0,h=this.bonds.length;h>g;g++){var i=this.bonds[g];!i.a1.hetatm&&(-1===e.macro_atomToLigandDistance||void 0!==i.a1.closestDistance&&e.macro_atomToLigandDistance>=i.a1.closestDistance&&e.macro_atomToLigandDistance>=i.a2.closestDistance)&&i.render(a,this.residueSpecs?this.residueSpecs:e)}}if(e.macro_displayAtoms)for(0<this.atoms.length&&(a.sphereBuffer.bindBuffers(a),a.material.setTempColors(e.atoms_materialAmbientColor_3D,void 0,e.atoms_materialSpecularColor_3D,e.atoms_materialShininess_3D)),g=0,h=this.atoms.length;h>g;g++)i=this.atoms[g],!i.hetatm&&(-1===e.macro_atomToLigandDistance||void 0!==i.closestDistance&&e.macro_atomToLigandDistance>=i.closestDistance)&&i.render(a,this.residueSpecs?this.residueSpecs:e)}if(e.bonds_display){var j=[],k=[];for(0<this.bonds.length&&(e.bonds_renderAsLines_3D?(a.lineWidth(e.bonds_width_2D),a.lineBuffer.bindBuffers(a)):a.cylinderBuffer.bindBuffers(a),a.material.setTempColors(e.bonds_materialAmbientColor_3D,void 0,e.bonds_materialSpecularColor_3D,e.bonds_materialShininess_3D)),g=0,h=this.bonds.length;h>g;g++)i=this.bonds[g],(!f||i.a1.hetatm)&&(e.bonds_showBondOrders_3D?0==i.bondOrder?k.push(i):.5==i.bondOrder?j.push(i):(1.5==i.bondOrder&&j.push(i),i.render(a,e)):i.render(a,e));if(0<j.length)for(e.bonds_renderAsLines_3D||a.pillBuffer.bindBuffers(a),g=0,h=j.length;h>g;g++)j[g].render(a,e,!0);if(0<k.length)for(e.bonds_renderAsLines_3D||a.sphereBuffer.bindBuffers(a),g=0,h=k.length;h>g;g++)k[g].render(a,e,!0)}if(e.atoms_display){for(g=0,h=this.atoms.length;h>g;g++)i=this.atoms[g],i.bondNumber=0,i.renderAsStar=!1;for(g=0,h=this.bonds.length;h>g;g++)i=this.bonds[g],i.a1.bondNumber++,i.a2.bondNumber++;for(0<this.atoms.length&&(a.sphereBuffer.bindBuffers(a),a.material.setTempColors(e.atoms_materialAmbientColor_3D,void 0,e.atoms_materialSpecularColor_3D,e.atoms_materialShininess_3D)),j=[],g=0,h=this.atoms.length;h>g;g++)i=this.atoms[g],(!f||i.hetatm&&(e.macro_showWater||!i.isWater))&&(e.atoms_nonBondedAsStars_3D&&0===i.bondNumber?(i.renderAsStar=!0,j.push(i)):i.render(a,e));if(0<j.length)for(a.starBuffer.bindBuffers(a),g=0,h=j.length;h>g;g++)j[g].render(a,e)}if(this.chains){if(a.setMatrixUniforms(a.modelViewMatrix),e.proteins_displayRibbon)for(a.material.setTempColors(e.proteins_materialAmbientColor_3D,void 0,e.proteins_materialSpecularColor_3D,e.proteins_materialShininess_3D),f=0,j=this.ribbons.length;j>f;f++)if(i=e.proteins_ribbonCartoonize?this.cartoons[f]:this.ribbons[f],"none"!==e.proteins_residueColor){for(i.front.bindBuffers(a),k="rainbow"===e.proteins_residueColor,g=0,h=i.front.segments.length;h>g;g++)k&&a.material.setDiffuseColor(b.rainbowAt(g,h,e.macro_rainbowColors)),i.front.segments[g].render(a,e);for(i.back.bindBuffers(a),g=0,h=i.back.segments.length;h>g;g++)k&&a.material.setDiffuseColor(b.rainbowAt(g,h,e.macro_rainbowColors)),i.back.segments[g].render(a,e)}else if(e.proteins_ribbonCartoonize){for(i.front.bindBuffers(a),g=0,h=i.front.cartoonSegments.length;h>g;g++)i.front.cartoonSegments[g].render(a,e);for(i.back.bindBuffers(a),g=0,h=i.back.cartoonSegments.length;h>g;g++)i.back.cartoonSegments[g].render(a,e)}else i.front.render(a,e),i.back.render(a,e);if(e.proteins_displayBackbone){if(!this.alphaCarbonTrace)for(this.alphaCarbonTrace={nodes:[],edges:[]},f=0,j=this.chains.length;j>f;f++)if(k=this.chains[f],!(2<k.length&&d[k[2].name]&&"#BEA06E"===d[k[2].name].aminoColor)&&0<k.length)for(g=1,h=k.length-2;h>g;g++)i=k[g].cp1,i.chainColor=k.chainColor,this.alphaCarbonTrace.nodes.push(i),i=new c.Bond(k[g].cp1,k[g+1].cp1),i.residueName=k[g].name,i.chainColor=k.chainColor,this.alphaCarbonTrace.edges.push(i),g===k.length-3&&(i=k[g+1].cp1,i.chainColor=k.chainColor,this.alphaCarbonTrace.nodes.push(i));if(0<this.alphaCarbonTrace.nodes.length){for(f=new c.VisualSpecifications,f.atoms_display=!0,f.bonds_display=!0,f.atoms_sphereDiameter_3D=e.proteins_backboneThickness,f.bonds_cylinderDiameter_3D=e.proteins_backboneThickness,f.bonds_useJMOLColors=!1,f.atoms_color=e.proteins_backboneColor,f.bonds_color=e.proteins_backboneColor,f.atoms_useVDWDiameters_3D=!1,a.material.setTempColors(e.proteins_materialAmbientColor_3D,void 0,e.proteins_materialSpecularColor_3D,e.proteins_materialShininess_3D),a.material.setDiffuseColor(e.proteins_backboneColor),g=0,h=this.alphaCarbonTrace.nodes.length;h>g;g++)i=this.alphaCarbonTrace.nodes[g],e.macro_colorByChain&&(f.atoms_color=i.chainColor),a.sphereBuffer.bindBuffers(a),i.render(a,f);for(g=0,h=this.alphaCarbonTrace.edges.length;h>g;g++){var l,i=this.alphaCarbonTrace.edges[g],j=d[i.residueName]?d[i.residueName]:d["*"];e.macro_colorByChain?l=i.chainColor:"shapely"===e.proteins_residueColor?l=j.shapelyColor:"amino"===e.proteins_residueColor?l=j.aminoColor:"polarity"===e.proteins_residueColor?l=j.polar?"#C10000":"#FFFFFF":"acidity"===e.proteins_residueColor?l=1===j.acidity?"#0000FF":-1===j.acidity?"#FF0000":j.polar?"#FFFFFF":"#773300":"rainbow"===e.proteins_residueColor&&(l=b.rainbowAt(g,h,e.macro_rainbowColors)),l&&(f.bonds_color=l),a.cylinderBuffer.bindBuffers(a),i.render(a,f)}}}if(e.nucleics_display)for(a.material.setTempColors(e.nucleics_materialAmbientColor_3D,void 0,e.nucleics_materialSpecularColor_3D,e.nucleics_materialShininess_3D),f=0,j=this.tubes.length;j>f;f++)a.setMatrixUniforms(a.modelViewMatrix),i=this.tubes[f],i.render(a,e)}if(e.crystals_displayUnitCell&&this.unitCell&&(a.setMatrixUniforms(a.modelViewMatrix),this.unitCell.bindBuffers(a),a.material.setDiffuseColor(e.crystals_unitCellColor),a.lineWidth(e.crystals_unitCellLineWidth),a.drawElements(a.LINES,this.unitCell.vertexIndexBuffer.numItems,a.UNSIGNED_SHORT,0)),e.atoms_display){for(l=!1,g=0,h=this.atoms.length;h>g;g++)if(i=this.atoms[g],i.isHover||i.isSelected){l=!0;break}if(!l)for(g=0,h=this.bonds.length;h>g;g++)if(i=this.bonds[g],i.isHover||i.isSelected){l=!0;break}if(l){for(a.sphereBuffer.bindBuffers(a),a.blendFunc(a.SRC_ALPHA,a.ONE),a.material.setTempColors(e.atoms_materialAmbientColor_3D,void 0,"#000000",0),a.enable(a.BLEND),a.depthMask(!1),a.material.setAlpha(.4),a.sphereBuffer.bindBuffers(a),g=0,h=this.atoms.length;h>g;g++)i=this.atoms[g],(i.isHover||i.isSelected)&&i.renderHighlight(a,e);for(a.cylinderBuffer.bindBuffers(a),g=0,h=this.bonds.length;h>g;g++)i=this.bonds[g],(i.isHover||i.isSelected)&&i.renderHighlight(a,e);a.depthMask(!0),a.disable(a.BLEND),a.blendFuncSeparate(a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA,a.ONE,a.ONE_MINUS_SRC_ALPHA)}}this.surface&&e.surfaces_display&&(a.setMatrixUniforms(a.modelViewMatrix),this.surface.bindBuffers(a),a.material.setTempColors(e.surfaces_materialAmbientColor_3D,e.surfaces_color,e.surfaces_materialSpecularColor_3D,e.surfaces_materialShininess_3D),"Dot"===e.surfaces_style?a.drawArrays(a.POINTS,0,this.surface.vertexPositionBuffer.numItems):a.drawElements(a.TRIANGLES,this.surface.vertexIndexBuffer.numItems,a.UNSIGNED_SHORT,0))},f.renderPickFrame=function(a,c,d,e,f){this.specs&&(c=this.specs);var g=0<this.atoms.length&&void 0!==this.atoms[0].hetatm;if(f&&c.bonds_display){0<this.bonds.length&&(c.bonds_renderAsLines_3D?(a.lineWidth(c.bonds_width_2D),a.lineBuffer.bindBuffers(a)):a.cylinderBuffer.bindBuffers(a)),f=0;for(var h=this.bonds.length;h>f;f++){var i=this.bonds[f];(!g||i.a1.hetatm)&&(a.material.setDiffuseColor(b.idx2color(d.length)),i.renderPicker(a,c),d.push(i))}}if(e&&c.atoms_display){for(f=0,h=this.atoms.length;h>f;f++)e=this.atoms[f],e.bondNumber=0,e.renderAsStar=!1;for(f=0,h=this.bonds.length;h>f;f++)i=this.bonds[f],i.a1.bondNumber++,i.a2.bondNumber++;for(0<this.atoms.length&&a.sphereBuffer.bindBuffers(a),i=[],f=0,h=this.atoms.length;h>f;f++)e=this.atoms[f],(!g||e.hetatm&&(c.macro_showWater||!e.isWater))&&(c.atoms_nonBondedAsStars_3D&&0===e.bondNumber?(e.renderAsStar=!0,i.push(e)):(a.material.setDiffuseColor(b.idx2color(d.length)),e.render(a,c,!0),d.push(e)));if(0<i.length)for(a.starBuffer.bindBuffers(a),f=0,h=i.length;h>f;f++)e=i[f],a.material.setDiffuseColor(b.idx2color(d.length)),e.render(a,c,!0),d.push(e)}},f.getCenter3D=function(){if(1===this.atoms.length)return new c.Atom("C",this.atoms[0].x,this.atoms[0].y,this.atoms[0].z);var a=1/0,b=1/0,d=1/0,f=-1/0,g=-1/0,h=-1/0;if(this.chains)for(var i=0,j=this.chains.length;j>i;i++)for(var k=this.chains[i],l=0,m=k.length;m>l;l++)var n=k[l],a=e.min(n.cp1.x,n.cp2.x,a),b=e.min(n.cp1.y,n.cp2.y,b),d=e.min(n.cp1.z,n.cp2.z,d),f=e.max(n.cp1.x,n.cp2.x,f),g=e.max(n.cp1.y,n.cp2.y,g),h=e.max(n.cp1.z,n.cp2.z,h);for(i=0,j=this.atoms.length;j>i;i++)a=e.min(this.atoms[i].x,a),b=e.min(this.atoms[i].y,b),d=e.min(this.atoms[i].z,d),f=e.max(this.atoms[i].x,f),g=e.max(this.atoms[i].y,g),h=e.max(this.atoms[i].z,h);return new c.Atom("C",(f+a)/2,(g+b)/2,(h+d)/2)},f.getCenter=function(){if(1===this.atoms.length)return new c.Point(this.atoms[0].x,this.atoms[0].y);for(var a=1/0,b=1/0,d=-1/0,f=-1/0,g=0,h=this.atoms.length;h>g;g++)a=e.min(this.atoms[g].x,a),b=e.min(this.atoms[g].y,b),d=e.max(this.atoms[g].x,d),f=e.max(this.atoms[g].y,f);return new c.Point((d+a)/2,(f+b)/2)},f.getDimension=function(){if(1===this.atoms.length)return new c.Point(0,0);var a=1/0,b=1/0,d=-1/0,f=-1/0;if(this.chains){for(var g=0,h=this.chains.length;h>g;g++)for(var i=this.chains[g],j=0,k=i.length;k>j;j++)var l=i[j],a=e.min(l.cp1.x,l.cp2.x,a),b=e.min(l.cp1.y,l.cp2.y,b),d=e.max(l.cp1.x,l.cp2.x,d),f=e.max(l.cp1.y,l.cp2.y,f);a-=30,b-=30,d+=30,f+=30}for(g=0,h=this.atoms.length;h>g;g++)a=e.min(this.atoms[g].x,a),b=e.min(this.atoms[g].y,b),d=e.max(this.atoms[g].x,d),f=e.max(this.atoms[g].y,f);return new c.Point(d-a,f-b)},f.check=function(b){if(b&&this.doChecks){if(this.findRings)if(this.bonds.length-this.atoms.length!==this.fjNumCache){this.rings=new a.informatics.SSSRFinder(this).rings;for(var c=0,d=this.bonds.length;d>c;c++)this.bonds[c].ring=void 0;for(c=0,d=this.rings.length;d>c;c++)this.rings[c].setupBonds()}else for(c=0,d=this.rings.length;d>c;c++){var e=this.rings[c];
e.center=e.getCenter()}for(c=0,d=this.atoms.length;d>c;c++)if(this.atoms[c].isLone=!1,"C"===this.atoms[c].label){for(var f=e=0,g=this.bonds.length;g>f;f++)(this.bonds[f].a1===this.atoms[c]||this.bonds[f].a2===this.atoms[c])&&e++;0===e&&(this.atoms[c].isLone=!0)}for(e=!1,c=0,d=this.atoms.length;d>c;c++)0!==this.atoms[c].z&&(e=!0);e&&(this.sortAtomsByZ(),this.sortBondsByZ()),this.setupMetaData(),this.atomNumCache=this.atoms.length,this.bondNumCache=this.bonds.length,this.fjNumCache=this.bonds.length-this.atoms.length}this.doChecks=!b},f.getAngles=function(a){for(var b=[],c=0,d=this.bonds.length;d>c;c++)this.bonds[c].contains(a)&&b.push(a.angle(this.bonds[c].getNeighbor(a)));return b.sort(),b},f.getCoordinationNumber=function(a){for(var b=0,c=0,d=a.length;d>c;c++)b+=a[c].bondOrder;return b},f.getBonds=function(a){for(var b=[],c=0,d=this.bonds.length;d>c;c++)this.bonds[c].contains(a)&&b.push(this.bonds[c]);return b},f.sortAtomsByZ=function(){for(var a=1,b=this.atoms.length;b>a;a++)for(var c=a;c>0&&this.atoms[c].z<this.atoms[c-1].z;){var d=this.atoms[c];this.atoms[c]=this.atoms[c-1],this.atoms[c-1]=d,c--}},f.sortBondsByZ=function(){for(var a=1,b=this.bonds.length;b>a;a++)for(var c=a;c>0&&this.bonds[c].a1.z+this.bonds[c].a2.z<this.bonds[c-1].a1.z+this.bonds[c-1].a2.z;){var d=this.bonds[c];this.bonds[c]=this.bonds[c-1],this.bonds[c-1]=d,c--}},f.setupMetaData=function(){for(var a=this.getCenter(),c=0,d=this.atoms.length;d>c;c++){var f=this.atoms[c];f.bonds=this.getBonds(f),f.angles=this.getAngles(f),f.isHidden=2===f.bonds.length&&e.abs(e.abs(f.angles[1]-f.angles[0])-e.PI)<e.PI/30&&f.bonds[0].bondOrder===f.bonds[1].bondOrder;var g=b.angleBetweenLargest(f.angles);f.angleOfLeastInterference=g.angle%(2*e.PI),f.largestAngle=g.largest,f.coordinationNumber=this.getCoordinationNumber(f.bonds),f.bondNumber=f.bonds.length,f.molCenter=a}for(c=0,d=this.bonds.length;d>c;c++)this.bonds[c].molCenter=a},f.scaleToAverageBondLength=function(a){var b=this.getAverageBondLength();if(0!==b){a/=b;for(var b=0,c=this.atoms.length;c>b;b++)this.atoms[b].x*=a,this.atoms[b].y*=a}},f.getAverageBondLength=function(){if(0===this.bonds.length)return 0;for(var a=0,b=0,c=this.bonds.length;c>b;b++)a+=this.bonds[b].getLength();return a/=this.bonds.length},f.getBounds=function(){for(var a=new b.Bounds,c=0,d=this.atoms.length;d>c;c++)a.expand(this.atoms[c].getBounds());if(this.chains){for(c=0,d=this.chains.length;d>c;c++)for(var e=this.chains[c],f=0,g=e.length;g>f;f++){var h=e[f];a.expand(h.cp1.x,h.cp1.y),a.expand(h.cp2.x,h.cp2.y)}a.minX-=30,a.minY-=30,a.maxX+=30,a.maxY+=30}return a},f.getBounds3D=function(){for(var a=new b.Bounds,c=0,d=this.atoms.length;d>c;c++)a.expand(this.atoms[c].getBounds3D());if(this.chains)for(c=0,d=this.chains.length;d>c;c++)for(var e=this.chains[c],f=0,g=e.length;g>f;f++){var h=e[f];a.expand3D(h.cp1.x,h.cp1.y,h.cp1.z),a.expand3D(h.cp2.x,h.cp2.y,h.cp2.z)}return a}}(ChemDoodle,ChemDoodle.math,ChemDoodle.structures,ChemDoodle.RESIDUE,Math),function(a,b,c,d){var e,f=-1;a.Residue=function(a){this.resSeq=a};var g=a.Residue.prototype;g.setup=function(b,c){this.horizontalResolution=c;var e=[b.x-this.cp1.x,b.y-this.cp1.y,b.z-this.cp1.z],f=d.cross(e,[this.cp2.x-this.cp1.x,this.cp2.y-this.cp1.y,this.cp2.z-this.cp1.z],[]);for(this.D=d.cross(f,e,[]),d.normalize(f),d.normalize(this.D),this.guidePointsSmall=[],this.guidePointsLarge=[],e=[(b.x+this.cp1.x)/2,(b.y+this.cp1.y)/2,(b.z+this.cp1.z)/2],this.helix&&(d.scale(f,1.5),d.add(e,f)),this.guidePointsSmall[0]=new a.Atom("",e[0]-this.D[0]/2,e[1]-this.D[1]/2,e[2]-this.D[2]/2),f=1;c>f;f++)this.guidePointsSmall[f]=new a.Atom("",this.guidePointsSmall[0].x+this.D[0]*f/c,this.guidePointsSmall[0].y+this.D[1]*f/c,this.guidePointsSmall[0].z+this.D[2]*f/c);for(d.scale(this.D,4),this.guidePointsLarge[0]=new a.Atom("",e[0]-this.D[0]/2,e[1]-this.D[1]/2,e[2]-this.D[2]/2),f=1;c>f;f++)this.guidePointsLarge[f]=new a.Atom("",this.guidePointsLarge[0].x+this.D[0]*f/c,this.guidePointsLarge[0].y+this.D[1]*f/c,this.guidePointsLarge[0].z+this.D[2]*f/c)},g.getGuidePointSet=function(a){return 0===a?this.helix||this.sheet?this.guidePointsLarge:this.guidePointsSmall:1===a?this.guidePointsSmall:2===a?this.guidePointsLarge:void 0},g.computeLineSegments=function(a,b,d,g,h){if(h!==f){var i=h*h,j=h*h*h;e=c.multiply([-1/6,.5,-.5,1/6,.5,-1,.5,0,-.5,0,.5,0,1/6,2/3,1/6,0],[6/j,0,0,0,6/j,2/i,0,0,1/j,1/i,1/h,0,0,0,0,1],[]),f=h}this.split=b.helix!==this.helix||b.sheet!==this.sheet,this.lineSegments=this.innerCompute(0,a,b,d,!1,h),g&&(this.lineSegmentsCartoon=this.innerCompute(b.helix||b.sheet?2:1,a,b,d,!0,h))},g.innerCompute=function(f,g,h,i,j,k){var l=[],m=this.getGuidePointSet(f);g=g.getGuidePointSet(f),h=h.getGuidePointSet(f);for(var n=i.getGuidePointSet(f),o=0,p=this.guidePointsLarge.length;p>o;o++){for(var q=c.multiply([g[o].x,g[o].y,g[o].z,1,m[o].x,m[o].y,m[o].z,1,h[o].x,h[o].y,h[o].z,1,n[o].x,n[o].y,n[o].z,1],e,[]),r=[],s=0;k>s;s++){for(f=3;f>0;f--)for(i=0;4>i;i++)q[4*f+i]+=q[4*(f-1)+i];r[s]=new a.Atom("",q[12]/q[15],q[13]/q[15],q[14]/q[15])}l[o]=r}if(j&&this.arrow)for(f=0;k>f;f++)for(j=1.5-1.3*f/k,m=b.floor(this.horizontalResolution/2),g=l[m],i=0,h=l.length;h>i;i++)i!==m&&(n=g[f],o=l[i][f],p=[o.x-n.x,o.y-n.y,o.z-n.z],d.scale(p,j),o.x=n.x+p[0],o.y=n.y+p[1],o.z=n.z+p[2]);return l}}(ChemDoodle.structures,Math,ChemDoodle.lib.mat4,ChemDoodle.lib.vec3),function(a,b,c,d,e){b.Spectrum=function(){this.data=[],this.metadata=[],this.dataDisplay=[],this.memory={offsetTop:0,offsetLeft:0,offsetBottom:0,flipXAxis:!1,scale:1,width:0,height:0}},d=b.Spectrum.prototype,d.title=void 0,d.xUnit=void 0,d.yUnit=void 0,d.continuous=!0,d.integrationSensitivity=.01,d.draw=function(b,c,d,f){this.specs&&(c=this.specs);var g=5,h=0,i=0;b.fillStyle=c.text_color,b.textAlign="center",b.textBaseline="alphabetic",b.font=a.getFontString(c.text_font_size,c.text_font_families),this.xUnit&&(i+=c.text_font_size,b.fillText(this.xUnit,d/2,f-2)),this.yUnit&&c.plots_showYAxis&&(h+=c.text_font_size,b.save(),b.translate(c.text_font_size,f/2),b.rotate(-e.PI/2),b.fillText(this.yUnit,0,0),b.restore()),this.title&&(g+=c.text_font_size,b.fillText(this.title,d/2,c.text_font_size)),i+=5+c.text_font_size,c.plots_showYAxis&&(h+=5+b.measureText("1000").width),c.plots_showGrid&&(b.strokeStyle=c.plots_gridColor,b.lineWidth=c.plots_gridLineWidth,b.strokeRect(h,g,d-h,f-i-g)),b.textAlign="center",b.textBaseline="top";for(var j=this.maxX-this.minX,k=j/100,l=.001;k>l||j/l>25;)l*=10;for(var m=0,n=c.plots_flipXAxis?d:0,j=e.round(this.minX/l)*l;j<=this.maxX;j+=l/2){var o=this.getTransformedX(j,c,d,h);if(o>h)if(b.strokeStyle="black",b.lineWidth=1,0===m%2){for(b.beginPath(),b.moveTo(o,f-i),b.lineTo(o,f-i+2),b.stroke(),k=j.toFixed(5);"0"===k.charAt(k.length-1);)k=k.substring(0,k.length-1);"."===k.charAt(k.length-1)&&(k=k.substring(0,k.length-1));var p=b.measureText(k).width;c.plots_flipXAxis&&(p*=-1);var q=o-p/2;(c.plots_flipXAxis?n>q:q>n)&&(b.fillText(k,o,f-i+2),n=o+p/2),c.plots_showGrid&&(b.strokeStyle=c.plots_gridColor,b.lineWidth=c.plots_gridLineWidth,b.beginPath(),b.moveTo(o,f-i),b.lineTo(o,g),b.stroke())}else b.beginPath(),b.moveTo(o,f-i),b.lineTo(o,f-i+2),b.stroke();m++}if(c.plots_showYAxis||c.plots_showGrid)for(l=1/c.scale,b.textAlign="right",b.textBaseline="middle",j=0;10>=j;j++)if(k=l/10*j,m=g+(f-i-g)*(1-k*c.scale),c.plots_showGrid&&(b.strokeStyle=c.plots_gridColor,b.lineWidth=c.plots_gridLineWidth,b.beginPath(),b.moveTo(h,m),b.lineTo(d,m),b.stroke()),c.plots_showYAxis){if(b.strokeStyle="black",b.lineWidth=1,b.beginPath(),b.moveTo(h,m),b.lineTo(h-3,m),b.stroke(),k*=100,n=e.max(0,3-e.floor(k).toString().length),k=k.toFixed(n),n>0)for(;"0"===k.charAt(k.length-1);)k=k.substring(0,k.length-1);"."===k.charAt(k.length-1)&&(k=k.substring(0,k.length-1)),b.fillText(k,h-3,m)}if(b.strokeStyle="black",b.lineWidth=1,b.beginPath(),b.moveTo(d,f-i),b.lineTo(h,f-i),c.plots_showYAxis&&b.lineTo(h,g),b.stroke(),0<this.dataDisplay.length)for(b.textAlign="left",b.textBaseline="top",j=k=0,l=this.dataDisplay.length;l>j;j++)if(this.dataDisplay[j].value)b.fillText([this.dataDisplay[j].display,": ",this.dataDisplay[j].value].join(""),h+10,g+10+k*(c.text_font_size+5)),k++;else if(this.dataDisplay[j].tag)for(m=0,n=this.metadata.length;n>m;m++)if(a.stringStartsWith(this.metadata[m],this.dataDisplay[j].tag)){n=this.metadata[m],this.dataDisplay[j].display&&(n=this.metadata[m].indexOf("="),n=[this.dataDisplay[j].display,": ",n>-1?this.metadata[m].substring(n+2):this.metadata[m]].join("")),b.fillText(n,h+10,g+10+k*(c.text_font_size+5)),k++;break}this.drawPlot(b,c,d,f,g,h,i),this.memory.offsetTop=g,this.memory.offsetLeft=h,this.memory.offsetBottom=i,this.memory.flipXAxis=c.plots_flipXAxis,this.memory.scale=c.scale,this.memory.width=d,this.memory.height=f},d.drawPlot=function(a,c,d,f,g,h,i){this.specs&&(c=this.specs),a.strokeStyle=c.plots_color,a.lineWidth=c.plots_width;var j=[];if(a.beginPath(),this.continuous)for(var k=!1,l=0,m=!1,n=0,o=this.data.length;o>n;n++){var p,q=this.getTransformedX(this.data[n].x,c,d,h);if(o>n&&!k&&(p=this.getTransformedX(this.data[n+1].x,c,d,h)),q>=h&&d>q||void 0!==p&&p>=h&&d>p){var r=this.getTransformedY(this.data[n].y,c,f,i,g);if(c.plots_showIntegration&&e.abs(this.data[n].y)>this.integrationSensitivity&&j.push(new b.Point(this.data[n].x,this.data[n].y)),k||(a.moveTo(q,r),k=!0),a.lineTo(q,r),l++,0===l%1e3&&(a.stroke(),a.beginPath(),a.moveTo(q,r)),m)break}else k&&(m=!0)}else for(n=0,o=this.data.length;o>n;n++)q=this.getTransformedX(this.data[n].x,c,d,h),q>=h&&d>q&&(a.moveTo(q,f-i),a.lineTo(q,this.getTransformedY(this.data[n].y,c,f,i,g)));if(a.stroke(),c.plots_showIntegration&&1<j.length){if(a.strokeStyle=c.plots_integrationColor,a.lineWidth=c.plots_integrationLineWidth,a.beginPath(),n=j[1].x>j[0].x,this.flipXAxis&&!n||!this.flipXAxis&&n){for(n=j.length-2;n>=0;n--)j[n].y+=j[n+1].y;k=j[0].y}else{for(n=1,o=j.length;o>n;n++)j[n].y+=j[n-1].y;k=j[j.length-1].y}for(n=0,o=j.length;o>n;n++)q=this.getTransformedX(j[n].x,c,d,h),r=this.getTransformedY(j[n].y/c.scale/k,c,f,i,g),0===n?a.moveTo(q,r):a.lineTo(q,r);a.stroke()}},d.getTransformedY=function(a,b,c,d,e){return e+(c-d-e)*(1-a*b.scale)},d.getInverseTransformedY=function(a){return 100*((1-(a-this.memory.offsetTop)/(this.memory.height-this.memory.offsetBottom-this.memory.offsetTop))/this.memory.scale)},d.getTransformedX=function(a,b,c,d){return a=d+(a-this.minX)/(this.maxX-this.minX)*(c-d),b.plots_flipXAxis&&(a=c+d-a),a},d.getInverseTransformedX=function(a){return this.memory.flipXAxis&&(a=this.memory.width+this.memory.offsetLeft-a),(a-this.memory.offsetLeft)*(this.maxX-this.minX)/(this.memory.width-this.memory.offsetLeft)+this.minX},d.setup=function(){for(var a=Number.MAX_VALUE,b=Number.MIN_VALUE,c=Number.MIN_VALUE,d=0,f=this.data.length;f>d;d++)a=e.min(a,this.data[d].x),b=e.max(b,this.data[d].x),c=e.max(c,this.data[d].y);for(this.continuous?(this.minX=a,this.maxX=b):(this.minX=a-1,this.maxX=b+1),d=0,f=this.data.length;f>d;d++)this.data[d].y/=c},d.zoom=function(a,b,d,f){if(a=this.getInverseTransformedX(a),b=this.getInverseTransformedX(b),this.minX=e.min(a,b),this.maxX=e.max(a,b),f){for(f=Number.MIN_VALUE,b=0,a=this.data.length;a>b;b++)c.isBetween(this.data[b].x,this.minX,this.maxX)&&(f=e.max(f,this.data[b].y));return 1/f}},d.translate=function(a,b){var c=a/(b-this.memory.offsetLeft)*(this.maxX-this.minX)*(this.memory.flipXAxis?1:-1);this.minX+=c,this.maxX+=c},d.alertMetadata=function(){alert(this.metadata.join("\n"))},d.getInternalCoordinates=function(a,b){return new ChemDoodle.structures.Point(this.getInverseTransformedX(a),this.getInverseTransformedY(b))},d.getClosestPlotInternalCoordinates=function(a){var b=this.getInverseTransformedX(a-1);if(a=this.getInverseTransformedX(a+1),b>a){var d=b,b=a;a=d}for(var d=-1,e=-1/0,f=!1,g=0,h=this.data.length;h>g;g++){var i=this.data[g];if(c.isBetween(i.x,b,a))i.y>e&&(f=!0,e=i.y,d=g);else if(f)break}return-1!==d?(i=this.data[d],new ChemDoodle.structures.Point(i.x,100*i.y)):void 0},d.getClosestPeakInternalCoordinates=function(a){var b=this.getInverseTransformedX(a);a=0;for(var c=1/0,d=0,f=this.data.length;f>d;d++){var g=e.abs(this.data[d].x-b);if(!(c>=g))break;c=g,a=d}for(b=highestRight=a,c=maxRight=this.data[a].y,d=a+1,f=this.data.length;f>d&&this.data[d].y+.05>maxRight;d++)maxRight=this.data[d].y,highestRight=d;for(d=a-1;d>=0&&this.data[d].y+.05>c;d--)c=this.data[d].y,b=d;return a=this.data[b-a>highestRight-a?highestRight:b],new ChemDoodle.structures.Point(a.x,100*a.y)}}(ChemDoodle.extensions,ChemDoodle.structures,ChemDoodle.math,ChemDoodle.lib.jQuery,Math),function(a,b,c){b._Shape=function(){},b=b._Shape.prototype,b.drawDecorations=function(a,b){if(this.isHover)for(var c=this.getPoints(),d=0,e=c.length;e>d;d++){var f=c[d];this.drawAnchor(a,b,f,f===this.hoverPoint)}},b.getBounds=function(){for(var b=new a.Bounds,c=this.getPoints(),d=0,e=c.length;e>d;d++){var f=c[d];b.expand(f.x,f.y)}return b},b.drawAnchor=function(a,b,d,e){a.save(),a.translate(d.x,d.y),a.rotate(c.PI/4),a.scale(1/b.scale,1/b.scale),a.beginPath(),a.moveTo(-4,-4),a.lineTo(4,-4),a.lineTo(4,4),a.lineTo(-4,4),a.closePath(),a.fillStyle=e?"#885110":"white",a.fill(),a.beginPath(),a.moveTo(-4,-2),a.lineTo(-4,-4),a.lineTo(-2,-4),a.moveTo(2,-4),a.lineTo(4,-4),a.lineTo(4,-2),a.moveTo(4,2),a.lineTo(4,4),a.lineTo(2,4),a.moveTo(-2,4),a.lineTo(-4,4),a.lineTo(-4,2),a.moveTo(-4,-2),a.strokeStyle="rgba(0,0,0,.2)",a.lineWidth=5,a.stroke(),a.strokeStyle="blue",a.lineWidth=1,a.stroke(),a.restore()}}(ChemDoodle.math,ChemDoodle.structures.d2,Math),function(a,b,c,d,e){d.Bracket=function(a,b){this.p1=a?a:new c.Point,this.p2=b?b:new c.Point},d=d.Bracket.prototype=new d._Shape,d.charge=0,d.mult=0,d.repeat=0,d.draw=function(b,c){var d=e.min(this.p1.x,this.p2.x),f=e.max(this.p1.x,this.p2.x),g=e.min(this.p1.y,this.p2.y),h=e.max(this.p1.y,this.p2.y),i=h-g,j=i/10;b.beginPath(),b.moveTo(d+j,g),b.lineTo(d,g),b.lineTo(d,h),b.lineTo(d+j,h),b.moveTo(f-j,h),b.lineTo(f,h),b.lineTo(f,g),b.lineTo(f-j,g),this.isLassoed&&(j=b.createLinearGradient(this.p1.x,this.p1.y,this.p2.x,this.p2.y),j.addColorStop(0,"rgba(212, 99, 0, 0)"),j.addColorStop(.5,"rgba(212, 99, 0, 0.8)"),j.addColorStop(1,"rgba(212, 99, 0, 0)"),b.lineWidth=c.shapes_lineWidth_2D+5,b.strokeStyle=j,b.lineJoin="miter",b.lineCap="square",b.stroke()),b.strokeStyle=c.shapes_color,b.lineWidth=c.shapes_lineWidth_2D,b.lineJoin="miter",b.lineCap="butt",b.stroke(),0!==this.charge&&(b.fillStyle=c.text_color,b.textAlign="left",b.textBaseline="alphabetic",b.font=a.getFontString(c.text_font_size,c.text_font_families),j=this.charge.toFixed(0),j="1"===j?"+":"-1"===j?"–":a.stringStartsWith(j,"-")?j.substring(1)+"–":j+"+",b.fillText(j,f+5,g+5)),0!==this.mult&&(b.fillStyle=c.text_color,b.textAlign="right",b.textBaseline="middle",b.font=a.getFontString(c.text_font_size,c.text_font_families),b.fillText(this.mult.toFixed(0),d-5,g+i/2)),0!==this.repeat&&(b.fillStyle=c.text_color,b.textAlign="left",b.textBaseline="top",b.font=a.getFontString(c.text_font_size,c.text_font_families),j=this.repeat.toFixed(0),b.fillText(j,f+5,h-5))},d.getPoints=function(){return[this.p1,this.p2]},d.isOver=function(a){return b.isBetween(a.x,this.p1.x,this.p2.x)&&b.isBetween(a.y,this.p1.y,this.p2.y)}}(ChemDoodle.extensions,ChemDoodle.math,ChemDoodle.structures,ChemDoodle.structures.d2,Math),function(a,b,c,d){c.Line=function(a,c){this.p1=a?a:new b.Point,this.p2=c?c:new b.Point},c.Line.ARROW_SYNTHETIC="synthetic",c.Line.ARROW_RETROSYNTHETIC="retrosynthetic",c.Line.ARROW_RESONANCE="resonance",c.Line.ARROW_EQUILIBRIUM="equilibrium";var e=c.Line.prototype=new c._Shape;e.arrowType=void 0,e.topText=void 0,e.bottomText=void 0,e.draw=function(a,b){if(this.isLassoed){var e=a.createLinearGradient(this.p1.x,this.p1.y,this.p2.x,this.p2.y);e.addColorStop(0,"rgba(212, 99, 0, 0)"),e.addColorStop(.5,"rgba(212, 99, 0, 0.8)"),e.addColorStop(1,"rgba(212, 99, 0, 0)");var f=2.5,g=this.p1.angle(this.p2)+d.PI/2,h=d.cos(g),g=d.sin(g),i=this.p1.x-h*f,j=this.p1.y+g*f,k=this.p1.x+h*f,l=this.p1.y-g*f,m=this.p2.x+h*f,n=this.p2.y-g*f,o=this.p2.x-h*f,p=this.p2.y+g*f;a.fillStyle=e,a.beginPath(),a.moveTo(i,j),a.lineTo(k,l),a.lineTo(m,n),a.lineTo(o,p),a.closePath(),a.fill()}if(a.strokeStyle=b.shapes_color,a.fillStyle=b.shapes_color,a.lineWidth=b.shapes_lineWidth_2D,a.lineJoin="miter",a.lineCap="butt",this.p1.x!==this.p2.x||this.p1.y!==this.p2.y){if(this.arrowType===c.Line.ARROW_RETROSYNTHETIC){var e=2*d.sqrt(2),f=b.shapes_arrowLength_2D/e,h=this.p1.angle(this.p2),g=h+d.PI/2,e=b.shapes_arrowLength_2D/e,q=d.cos(h),r=d.sin(h),h=d.cos(g),g=d.sin(g),i=this.p1.x-h*f,j=this.p1.y+g*f,k=this.p1.x+h*f,l=this.p1.y-g*f,m=this.p2.x+h*f-q*e,n=this.p2.y-g*f+r*e,o=this.p2.x-h*f-q*e,p=this.p2.y+g*f+r*e,s=this.p2.x+2*h*f-2*q*e,t=this.p2.y-2*g*f+2*r*e,u=this.p2.x-2*h*f-2*q*e,f=this.p2.y+2*g*f+2*r*e;a.beginPath(),a.moveTo(k,l),a.lineTo(m,n),a.moveTo(s,t),a.lineTo(this.p2.x,this.p2.y),a.lineTo(u,f),a.moveTo(o,p),a.lineTo(i,j)}else this.arrowType===c.Line.ARROW_EQUILIBRIUM?(e=2*d.sqrt(2),f=b.shapes_arrowLength_2D/e/2,h=this.p1.angle(this.p2),g=h+d.PI/2,e=2*b.shapes_arrowLength_2D/d.sqrt(3),q=d.cos(h),r=d.sin(h),h=d.cos(g),g=d.sin(g),i=this.p1.x-h*f,j=this.p1.y+g*f,k=this.p1.x+h*f,l=this.p1.y-g*f,m=this.p2.x+h*f,n=this.p2.y-g*f,o=this.p2.x-h*f,p=this.p2.y+g*f,a.beginPath(),a.moveTo(k,l),a.lineTo(m,n),a.moveTo(o,p),a.lineTo(i,j),a.stroke(),k=m-.8*q*e,l=n+.8*r*e,s=m+h*b.shapes_arrowLength_2D/3-q*e,t=n-g*b.shapes_arrowLength_2D/3+r*e,a.beginPath(),a.moveTo(m,n),a.lineTo(s,t),a.lineTo(k,l),a.closePath(),a.fill(),a.stroke(),k=i+.8*q*e,l=j-.8*r*e,s=i-h*b.shapes_arrowLength_2D/3+q*e,t=j+g*b.shapes_arrowLength_2D/3-r*e,a.beginPath(),a.moveTo(i,j),a.lineTo(s,t),a.lineTo(k,l),a.closePath(),a.fill()):this.arrowType===c.Line.ARROW_SYNTHETIC?(h=this.p1.angle(this.p2),g=h+d.PI/2,e=2*b.shapes_arrowLength_2D/d.sqrt(3),q=d.cos(h),r=d.sin(h),h=d.cos(g),g=d.sin(g),a.beginPath(),a.moveTo(this.p1.x,this.p1.y),a.lineTo(this.p2.x-q*e/2,this.p2.y+r*e/2),a.stroke(),k=this.p2.x-.8*q*e,l=this.p2.y+.8*r*e,s=this.p2.x+h*b.shapes_arrowLength_2D/3-q*e,t=this.p2.y-g*b.shapes_arrowLength_2D/3+r*e,u=this.p2.x-h*b.shapes_arrowLength_2D/3-q*e,f=this.p2.y+g*b.shapes_arrowLength_2D/3+r*e,a.beginPath(),a.moveTo(this.p2.x,this.p2.y),a.lineTo(u,f),a.lineTo(k,l),a.lineTo(s,t),a.closePath(),a.fill()):this.arrowType===c.Line.ARROW_RESONANCE?(h=this.p1.angle(this.p2),g=h+d.PI/2,e=2*b.shapes_arrowLength_2D/d.sqrt(3),q=d.cos(h),r=d.sin(h),h=d.cos(g),g=d.sin(g),a.beginPath(),a.moveTo(this.p1.x+q*e/2,this.p1.y-r*e/2),a.lineTo(this.p2.x-q*e/2,this.p2.y+r*e/2),a.stroke(),k=this.p2.x-.8*q*e,l=this.p2.y+.8*r*e,s=this.p2.x+h*b.shapes_arrowLength_2D/3-q*e,t=this.p2.y-g*b.shapes_arrowLength_2D/3+r*e,u=this.p2.x-h*b.shapes_arrowLength_2D/3-q*e,f=this.p2.y+g*b.shapes_arrowLength_2D/3+r*e,a.beginPath(),a.moveTo(this.p2.x,this.p2.y),a.lineTo(u,f),a.lineTo(k,l),a.lineTo(s,t),a.closePath(),a.fill(),a.stroke(),k=this.p1.x+.8*q*e,l=this.p1.y-.8*r*e,s=this.p1.x-h*b.shapes_arrowLength_2D/3+q*e,t=this.p1.y+g*b.shapes_arrowLength_2D/3-r*e,u=this.p1.x+h*b.shapes_arrowLength_2D/3+q*e,f=this.p1.y-g*b.shapes_arrowLength_2D/3-r*e,a.beginPath(),a.moveTo(this.p1.x,this.p1.y),a.lineTo(u,f),a.lineTo(k,l),a.lineTo(s,t),a.closePath(),a.fill()):(a.beginPath(),a.moveTo(this.p1.x,this.p1.y),a.lineTo(this.p2.x,this.p2.y));a.stroke(),this.topText&&(a.textAlign="center",a.textBaseline="bottom",a.fillText(this.topText,(this.p1.x+this.p2.x)/2,this.p1.y-5)),this.bottomText&&(a.textAlign="center",a.textBaseline="top",a.fillText(this.bottomText,(this.p1.x+this.p2.x)/2,this.p1.y+5))}},e.getPoints=function(){return[this.p1,this.p2]},e.isOver=function(b,c){var d=a.distanceFromPointToLineInclusive(b,this.p1,this.p2);return-1!==d&&c>d}}(ChemDoodle.math,ChemDoodle.structures,ChemDoodle.structures.d2,Math),function(a,b,c,d,e){var f=function(a){var b=[];if(a instanceof c.Atom){if(0===a.bondNumber)b.push(e.PI);else if(a.angles){if(1===a.angles.length)b.push(a.angles[0]+e.PI);else{for(var d=1,f=a.angles.length;f>d;d++)b.push(a.angles[d-1]+(a.angles[d]-a.angles[d-1])/2);d=a.angles[a.angles.length-1],b.push(d+(a.angles[0]+2*e.PI-d)/2)}if(a.largestAngle>e.PI&&(b=[a.angleOfLeastInterference]),a.bonds)for(d=0,f=a.bonds.length;f>d;d++){var g=a.bonds[d];if(2===g.bondOrder&&(g=g.getNeighbor(a),"O"===g.label)){b=[g.angle(a)];break}}}}else a=a.a1.angle(a.a2),b.push(a+e.PI/2),b.push(a+3*e.PI/2);for(d=0,f=b.length;f>d;d++){for(;b[d]>2*e.PI;)b[d]-=2*e.PI;for(;0>b[d];)b[d]+=2*e.PI}return b},g=function(a,b){var d=3;return a instanceof c.Atom?(a.isLabelVisible(b)&&(d=8),(0!==a.charge||0!==a.numRadical||0!==a.numLonePair)&&(d=13)):a instanceof c.Point?d=0:1<a.bondOrder&&(d=5),d},h=function(a,b,d,f,h,i,j,k,l,m){var n=i.angle(h),o=j.angle(k),p=e.cos(n),n=e.sin(n),q=g(d,b);h.x-=p*q,h.y+=n*q,q=o+e.PI/2,d=2*b.shapes_arrowLength_2D/e.sqrt(3);var p=e.cos(o),n=e.sin(o),r=e.cos(q),s=e.sin(q);k.x-=5*p,k.y+=5*n,o=new c.Point(k.x,k.y),q=g(f,b)/3,o.x-=p*q,o.y+=n*q,k.x-=p*(.8*d+q),k.y+=n*(.8*d+q),f=o.x-.8*p*d;var q=o.y+.8*n*d,t=new c.Point(o.x+r*b.shapes_arrowLength_2D/3-p*d,o.y-s*b.shapes_arrowLength_2D/3+n*d);b=new c.Point(o.x-r*b.shapes_arrowLength_2D/3-p*d,o.y+s*b.shapes_arrowLength_2D/3+n*d),n=p=!0,1===l&&(t.distance(i)>b.distance(i)?n=!1:p=!1),a.beginPath(),a.moveTo(o.x,o.y),n&&a.lineTo(b.x,b.y),a.lineTo(f,q),p&&a.lineTo(t.x,t.y),a.closePath(),a.fill(),a.stroke(),a.beginPath(),a.moveTo(h.x,h.y),a.bezierCurveTo(i.x,i.y,j.x,j.y,k.x,k.y),a.stroke(),m.push([h,i,j,k])};d.Pusher=function(a,b,c){this.o1=a,this.o2=b,this.numElectron=c?c:1},d=d.Pusher.prototype=new d._Shape,d.drawDecorations=function(a,b){if(this.isHover)for(var d=this.o1 instanceof c.Atom?new c.Point(this.o1.x,this.o1.y):this.o1.getCenter(),e=this.o2 instanceof c.Atom?new c.Point(this.o2.x,this.o2.y):this.o2.getCenter(),d=[d,e],e=0,f=d.length;f>e;e++){var g=d[e];this.drawAnchor(a,b,g,g===this.hoverPoint)}},d.draw=function(b,d){if(this.o1&&this.o2){b.strokeStyle=d.shapes_color,b.fillStyle=d.shapes_color,b.lineWidth=d.shapes_lineWidth_2D,b.lineJoin="miter",b.lineCap="butt";for(var g,i,j=this.o1 instanceof c.Atom?new c.Point(this.o1.x,this.o1.y):this.o1.getCenter(),k=this.o2 instanceof c.Atom?new c.Point(this.o2.x,this.o2.y):this.o2.getCenter(),l=f(this.o1),m=f(this.o2),n=1/0,o=0,p=l.length;p>o;o++)for(var q=0,r=m.length;r>q;q++){var s=new c.Point(j.x+35*e.cos(l[o]),j.y-35*e.sin(l[o])),t=new c.Point(k.x+35*e.cos(m[q]),k.y-35*e.sin(m[q])),u=s.distance(t);n>u&&(n=u,g=s,i=t)}this.caches=[],-1===this.numElectron?(o=j.distance(k)/2,m=j.angle(k),l=m+e.PI/2,p=e.cos(m),q=e.sin(m),m=new c.Point(j.x+(o-1)*p,j.y-(o-1)*q),n=new c.Point(m.x+35*e.cos(l+e.PI/6),m.y-35*e.sin(l+e.PI/6)),o=new c.Point(j.x+(o+1)*p,j.y-(o+1)*q),l=new c.Point(o.x+35*e.cos(l-e.PI/6),o.y-35*e.sin(l-e.PI/6)),h(b,d,this.o1,m,j,g,n,m,1,this.caches),h(b,d,this.o2,o,k,i,l,o,1,this.caches)):(a.intersectLines(j.x,j.y,g.x,g.y,k.x,k.y,i.x,i.y)&&(l=g,g=i,i=l),l=g.angle(j),m=i.angle(k),n=e.max(l,m)-e.min(l,m),.001>e.abs(n-e.PI)&&this.o1.molCenter===this.o2.molCenter&&(l+=e.PI/2,m-=e.PI/2,g.x=j.x+35*e.cos(l+e.PI),g.y=j.y-35*e.sin(l+e.PI),i.x=k.x+35*e.cos(m+e.PI),i.y=k.y-35*e.sin(m+e.PI)),h(b,d,this.o1,this.o2,j,g,i,k,this.numElectron,this.caches))}},d.getPoints=function(){return[]},d.isOver=function(a,c){for(var d=0,e=this.caches.length;e>d;d++)if(b.distanceFromCurve(a,this.caches[d]).distance<c)return!0;return!1}}(ChemDoodle.math,ChemDoodle.math.jsBezier,ChemDoodle.structures,ChemDoodle.structures.d2,Math),function(a){a._Mesh=function(){},a=a._Mesh.prototype,a.storeData=function(a,b,c){this.positionData=a,this.normalData=b,this.indexData=c},a.setupBuffers=function(a){if(this.vertexPositionBuffer=a.createBuffer(),a.bindBuffer(a.ARRAY_BUFFER,this.vertexPositionBuffer),a.bufferData(a.ARRAY_BUFFER,new Float32Array(this.positionData),a.STATIC_DRAW),this.vertexPositionBuffer.itemSize=3,this.vertexPositionBuffer.numItems=this.positionData.length/3,this.vertexNormalBuffer=a.createBuffer(),a.bindBuffer(a.ARRAY_BUFFER,this.vertexNormalBuffer),a.bufferData(a.ARRAY_BUFFER,new Float32Array(this.normalData),a.STATIC_DRAW),this.vertexNormalBuffer.itemSize=3,this.vertexNormalBuffer.numItems=this.normalData.length/3,this.indexData&&(this.vertexIndexBuffer=a.createBuffer(),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this.vertexIndexBuffer),a.bufferData(a.ELEMENT_ARRAY_BUFFER,new Uint16Array(this.indexData),a.STATIC_DRAW),this.vertexIndexBuffer.itemSize=1,this.vertexIndexBuffer.numItems=this.indexData.length),this.partitions)for(var b=0,c=this.partitions.length;c>b;b++){var d=this.partitions[b],e=this.generateBuffers(a,d.positionData,d.normalData,d.indexData);d.vertexPositionBuffer=e[0],d.vertexNormalBuffer=e[1],d.vertexIndexBuffer=e[2]}},a.generateBuffers=function(a,b,c,d){var e=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,e),a.bufferData(a.ARRAY_BUFFER,new Float32Array(b),a.STATIC_DRAW),e.itemSize=3,e.numItems=b.length/3,b=a.createBuffer(),a.bindBuffer(a.ARRAY_BUFFER,b),a.bufferData(a.ARRAY_BUFFER,new Float32Array(c),a.STATIC_DRAW),b.itemSize=3,b.numItems=c.length/3;var f;return d&&(f=a.createBuffer(),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,f),a.bufferData(a.ELEMENT_ARRAY_BUFFER,new Uint16Array(d),a.STATIC_DRAW),f.itemSize=1,f.numItems=d.length),[e,b,f]},a.bindBuffers=function(a){this.vertexPositionBuffer||this.setupBuffers(a),a.bindBuffer(a.ARRAY_BUFFER,this.vertexPositionBuffer),a.vertexAttribPointer(a.shader.vertexPositionAttribute,this.vertexPositionBuffer.itemSize,a.FLOAT,!1,0,0),a.bindBuffer(a.ARRAY_BUFFER,this.vertexNormalBuffer),a.vertexAttribPointer(a.shader.vertexNormalAttribute,this.vertexNormalBuffer.itemSize,a.FLOAT,!1,0,0),this.vertexIndexBuffer&&a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this.vertexIndexBuffer)}}(ChemDoodle.structures.d3,Math),function(a){a._Measurement=function(){},(a._Measurement.prototype=new a._Mesh).render=function(a,b){if(a.setMatrixUniforms(a.modelViewMatrix),b.measurement_update_3D&&(this.text=this.vertexPositionBuffer=void 0),this.vertexPositionBuffer||this.calculateData(b),this.bindBuffers(a),a.material.setDiffuseColor(b.shapes_color),a.lineWidth(1),a.drawElements(a.LINES,this.vertexIndexBuffer.numItems,a.UNSIGNED_SHORT,0),b.measurement_displayText_3D){this.text||(this.text=this.getText(b));var c={position:[],texCoord:[],translation:[]};a.textImage.pushVertexData(this.text.value,this.text.pos,1,c),a.textMesh.storeData(a,c.position,c.texCoord,c.translation),a.enable(a.BLEND),a.depthMask(!1),a.enableVertexAttribArray(a.shader.vertexTexCoordAttribute),a.textImage.useTexture(a),a.textMesh.render(a),a.disableVertexAttribArray(a.shader.vertexTexCoordAttribute),a.disable(a.BLEND),a.depthMask(!0)}}}(ChemDoodle.structures.d3),function(a,b,c,d,e,f,g){c.Angle=function(a,b,c){this.a1=a,this.a2=b,this.a3=c},a=c.Angle.prototype=new c._Measurement,a.calculateData=function(a){var c=[],d=[],f=[],h=this.a2.distance3D(this.a1),i=this.a2.distance3D(this.a3);for(this.distUse=e.min(h,i)/2,this.vec1=g.normalize([this.a1.x-this.a2.x,this.a1.y-this.a2.y,this.a1.z-this.a2.z]),this.vec2=g.normalize([this.a3.x-this.a2.x,this.a3.y-this.a2.y,this.a3.z-this.a2.z]),this.angle=b.vec3AngleFrom(this.vec1,this.vec2),h=g.normalize(g.cross(this.vec1,this.vec2,[])),h=g.normalize(g.cross(h,this.vec1,[])),a=a.measurement_angleBands_3D,i=0;a>=i;++i){var j=this.angle*i/a,k=g.scale(this.vec1,e.cos(j),[]),j=g.scale(h,e.sin(j),[]),k=g.scale(g.normalize(g.add(k,j,[])),this.distUse);c.push(this.a2.x+k[0],this.a2.y+k[1],this.a2.z+k[2]),d.push(0,0,0),a>i&&f.push(i,i+1)}this.storeData(c,d,f)},a.getText=function(){var a=g.scale(g.normalize(g.add(this.vec1,this.vec2,[])),this.distUse+.3);return{pos:[this.a2.x+a[0],this.a2.y+a[1],this.a2.z+a[2]],value:[d.angleBounds(this.angle,!0).toFixed(2)," °"].join("")}}}(ChemDoodle.ELEMENT,ChemDoodle.extensions,ChemDoodle.structures.d3,ChemDoodle.math,Math,ChemDoodle.lib.mat4,ChemDoodle.lib.vec3),function(a,b){a.Arrow=function(a,c){for(var d=[],e=[],f=0;c>=f;f++){var g=2*f*b.PI/c,h=b.sin(g),g=b.cos(g);e.push(0,0,-1,0,0,-1,g,h,0,g,h,0,0,0,-1,0,0,-1,g,h,1,g,h,1),d.push(0,0,0,a*g,a*h,0,a*g,a*h,0,a*g,a*h,2,a*g,a*h,2,2*a*g,2*a*h,2,2*a*g,2*a*h,2,0,0,3)}for(f=[],h=0;c>h;h++)for(var g=8*h,i=0;7>i;i++){var j=i+g,k=j+7+2;f.push(j,k,j+1,k,j,k-1)}this.storeData(d,e,f)},a.Arrow.prototype=new a._Mesh}(ChemDoodle.structures.d3,Math),function(a,b,c){a.LineArrow=function(){this.storeData([0,0,-3,.1,0,-2.8,0,0,-3,-.1,0,-2.8,0,0,-3,0,0,3,0,0,3,.1,0,2.8,0,0,3,-.1,0,2.8],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0])},a.LineArrow.prototype=new a._Mesh,a.Compass=function(d,e){this.textImage=new a.TextImage,this.textImage.init(d),this.textImage.updateFont(d,e.text_font_size,e.text_font_families,e.text_font_bold,e.text_font_italic,e.text_font_stroke_3D),this.textMesh=new a.TextMesh,this.textMesh.init(d);var f,g,h=3/(e.compass_size_3D/d.canvas.clientHeight),i=b.tan(e.projectionPerspectiveVerticalFieldOfView_3D/360*b.PI),j=h/i,k=b.max(j-h,.1),l=d.canvas.clientWidth/d.canvas.clientHeight;e.projectionPerspective_3D?(g=k,f=c.frustum):(g=j,f=c.ortho);var m=2*(g/d.canvas.clientHeight)*i,i=i*g;g=-i;var n=l*g,l=l*i;if(0===e.compass_type_3D){var o=(-(d.canvas.clientWidth-e.compass_size_3D)/2+this.textImage.charHeight)*m,m=(-(d.canvas.clientHeight-e.compass_size_3D)/2+this.textImage.charHeight)*m,n=n-o,l=l-o;g-=m,i-=m}this.projectionMatrix=f(n,l,g,i,k,j+h),this.translationMatrix=c.translate(c.identity([]),[0,0,-j]),h={position:[],texCoord:[],translation:[]},this.textImage.pushVertexData("X",[3.5,0,0],0,h),this.textImage.pushVertexData("Y",[0,3.5,0],0,h),this.textImage.pushVertexData("Z",[0,0,3.5],0,h),this.textMesh.storeData(d,h.position,h.texCoord,h.translation)};var d=a.Compass.prototype;d.renderArrow=function(a,b,c,d){a.material.setDiffuseColor(c),a.setMatrixUniforms(d),1===b?a.drawArrays(a.LINES,0,a.lineArrowBuffer.vertexPositionBuffer.numItems):a.drawElements(a.TRIANGLES,a.arrowBuffer.vertexIndexBuffer.numItems,a.UNSIGNED_SHORT,0)},d.render=function(a,d){1===d.compass_type_3D?a.lineArrowBuffer.bindBuffers(a):a.arrowBuffer.bindBuffers(a),a.material.setTempColors(d.bonds_materialAmbientColor_3D,void 0,d.bonds_materialSpecularColor_3D,d.bonds_materialShininess_3D);var e=c.multiply(this.translationMatrix,a.rotationMatrix,[]),f=b.PI/2;a.fogging.setMode(0),this.renderArrow(a,d.compass_type_3D,d.compass_axisXColor_3D,c.rotateY(e,f,[])),this.renderArrow(a,d.compass_type_3D,d.compass_axisYColor_3D,c.rotateX(e,-f,[])),this.renderArrow(a,d.compass_type_3D,d.compass_axisZColor_3D,e)},d.renderAxis=function(a){var b=c.multiply(this.translationMatrix,a.rotationMatrix,[]);a.setMatrixUniforms(b),this.textImage.useTexture(a),this.textMesh.render(a)}}(ChemDoodle.structures.d3,Math,ChemDoodle.lib.mat4),function(a,b){a.Cylinder=function(a,c,d){for(var e=[],f=[],g=0;d>g;g++){var h=2*g*b.PI/d,i=b.cos(h),h=b.sin(h);f.push(i,0,h),e.push(a*i,0,a*h),f.push(i,0,h),e.push(a*i,c,a*h)}f.push(1,0,0),e.push(a,0,0),f.push(1,0,0),e.push(a,c,0),this.storeData(e,f)},a.Cylinder.prototype=new a._Mesh}(ChemDoodle.structures.d3,Math),function(a,b,c,d){b.Distance=function(a,b,c,d){this.a1=a,this.a2=b,this.node=c,this.offset=d?d:0},b=b.Distance.prototype=new b._Measurement,b.calculateData=function(b){var e=[this.a1.x,this.a1.y,this.a1.z,this.a2.x,this.a2.y,this.a2.z];this.node&&(this.move=this.offset+c.max(b.atoms_useVDWDiameters_3D?a[this.a1.label].vdWRadius*b.atoms_vdwMultiplier_3D:b.atoms_sphereDiameter_3D/2,b.atoms_useVDWDiameters_3D?a[this.a2.label].vdWRadius*b.atoms_vdwMultiplier_3D:b.atoms_sphereDiameter_3D/2),this.displacement=[(this.a1.x+this.a2.x)/2-this.node.x,(this.a1.y+this.a2.y)/2-this.node.y,(this.a1.z+this.a2.z)/2-this.node.z],d.normalize(this.displacement),b=d.scale(this.displacement,this.move,[]),e[0]+=b[0],e[1]+=b[1],e[2]+=b[2],e[3]+=b[0],e[4]+=b[1],e[5]+=b[2]),this.storeData(e,[0,0,0,0,0,0],[0,1])},b.getText=function(){var a=this.a1.distance3D(this.a2),b=[(this.a1.x+this.a2.x)/2,(this.a1.y+this.a2.y)/2,(this.a1.z+this.a2.z)/2];if(this.node){var c=d.scale(this.displacement,this.move+.1,[]);b[0]+=c[0],b[1]+=c[1],b[2]+=c[2]}return{pos:b,value:[a.toFixed(2)," Å"].join("")}}}(ChemDoodle.ELEMENT,ChemDoodle.structures.d3,Math,ChemDoodle.lib.vec3),function(a,b){b.Fog=function(a){this.gl=a,this.mUL=a.getUniformLocation(a.program,"u_fog_mode"),this.cUL=a.getUniformLocation(a.program,"u_fog_color"),this.sUL=a.getUniformLocation(a.program,"u_fog_start"),this.eUL=a.getUniformLocation(a.program,"u_fog_end"),this.dUL=a.getUniformLocation(a.program,"u_fog_density")
};var c=b.Fog.prototype;c.setTempParameter=function(b,c,d,e){this.cCache&&this.cCache===b||(this.cCache=b,b=a.getRGB(b,1),this.gl.uniform3f(this.cUL,b[0],b[1],b[2])),this.sCache&&this.sCache===c||(this.sCache=c,this.gl.uniform1f(this.sUL,c)),this.eCache&&this.eCache===d||(this.eCache=d,this.gl.uniform1f(this.eUL,d)),this.dCache&&this.dCache===e||(this.dCache=e,this.gl.uniform1f(this.dUL,e))},c.setMode=function(a){this.mCache&&this.mCache===a||(this.mCache=a,this.gl.uniform1i(this.mUL,a))}}(ChemDoodle.math,ChemDoodle.structures.d3,ChemDoodle.lib.vec3),function(a,b){b.Label=function(){this.textImage=new b.TextImage};var c=b.Label.prototype;c.init=function(a,b){this.textImage.init(a),this.textImage.updateFont(a,b.atoms_font_size_2D,b.atoms_font_families_2D,b.atoms_font_bold_2D,b.atoms_font_italic_2D,b.text_font_stroke_3D)},c.updateVerticesBuffer=function(b,c,d){for(var e=0,f=c.length;f>e;e++){for(var g=c[e],h=g.labelMesh,i=g.atoms,j=this.textImage,k={position:[],texCoord:[],translation:[]},l=0<i.length&&void 0!=i[0].hetatm,m=0,n=i.length;n>m;m++){var o=i[m],p=o.label,q=.05;if(d.atoms_useVDWDiameters_3D){var r=a[p].vdWRadius*d.atoms_vdwMultiplier_3D;0===r&&(r=1),q+=r}else d.atoms_sphereDiameter_3D&&(q+=1.5*(d.atoms_sphereDiameter_3D/2));if(l)if(o.hetatm){if(o.isWater&&!d.macro_showWaters)continue}else if(!d.macro_displayAtoms)continue;j.pushVertexData(p,[o.x,o.y,o.z],q,k)}if((g=g.chains)&&(d.proteins_displayRibbon||d.proteins_displayBackbone))for(m=0,n=g.length;n>m;m++)for(i=g[m],l=0,p=i.length;p>l;l++)q=i[l],q.name&&(o=q.cp1,j.pushVertexData(q.name,[o.x,o.y,o.z],2,k));h.storeData(b,k.position,k.texCoord,k.translation,k.zDepth)}},c.render=function(a,b,c){a.setMatrixUniforms(a.modelViewMatrix),this.textImage.useTexture(a),b=0;for(var d=c.length;d>b;b++)c[b].labelMesh&&c[b].labelMesh.render(a)}}(ChemDoodle.ELEMENT,ChemDoodle.structures.d3),function(a,b){a.Sphere=function(a,c,d){for(var e=[],f=[],g=0;c>=g;g++)for(var h=g*b.PI/c,i=b.sin(h),j=b.cos(h),h=0;d>=h;h++){var k=2*h*b.PI/d,l=b.sin(k),k=b.cos(k)*i,m=j,l=l*i;f.push(k,m,l),e.push(a*k,a*m,a*l)}for(a=[],d+=1,g=0;c>g;g++)for(h=0;d>h;h++)i=g*d+h%d,j=i+d,a.push(i,i+1,j),d-1>h&&a.push(j,i+1,j+1);this.storeData(e,f,a)},a.Sphere.prototype=new a._Mesh}(ChemDoodle.structures.d3,Math),function(a,b,c,d){function e(a,b,c,d){this.entire=a,this.name=b,this.indexes=c,this.pi=d}var f=function(a,b){a.bindBuffer(a.ARRAY_BUFFER,b.vertexPositionBuffer),a.vertexAttribPointer(a.shader.vertexPositionAttribute,b.vertexPositionBuffer.itemSize,a.FLOAT,!1,0,0),a.bindBuffer(a.ARRAY_BUFFER,b.vertexNormalBuffer),a.vertexAttribPointer(a.shader.vertexNormalAttribute,b.vertexNormalBuffer.itemSize,a.FLOAT,!1,0,0),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,b.vertexIndexBuffer)},g=e.prototype;g.getColor=function(b){return b.macro_colorByChain?this.chainColor:this.name?this.getResidueColor(a[this.name]?this.name:"*",b):this.helix?this.entire.front?b.proteins_ribbonCartoonHelixPrimaryColor:b.proteins_ribbonCartoonHelixSecondaryColor:this.sheet?b.proteins_ribbonCartoonSheetColor:this.entire.front?b.proteins_primaryColor:b.proteins_secondaryColor},g.getResidueColor=function(b,c){var d=a[b];if("shapely"===c.proteins_residueColor)return d.shapelyColor;if("amino"===c.proteins_residueColor)return d.aminoColor;if("polarity"===c.proteins_residueColor){if(d.polar)return"#C10000"}else if("acidity"===c.proteins_residueColor){if(1===d.acidity)return"#0000FF";if(-1===d.acidity)return"#FF0000";if(!d.polar)return"#773300"}return"#FFFFFF"},g.render=function(a,b,c){this.entire.partitions&&this.pi!==this.entire.partitions.lastRender&&(f(a,this.entire.partitions[this.pi]),this.entire.partitions.lastRender=this.pi),this.vertexIndexBuffer||(this.vertexIndexBuffer=a.createBuffer(),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this.vertexIndexBuffer),a.bufferData(a.ELEMENT_ARRAY_BUFFER,new Uint16Array(this.indexes),a.STATIC_DRAW),this.vertexIndexBuffer.itemSize=1,this.vertexIndexBuffer.numItems=this.indexes.length),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this.vertexIndexBuffer),!c&&"rainbow"!==b.proteins_residueColor&&a.material.setDiffuseColor(this.getColor(b)),a.drawElements(a.TRIANGLES,this.vertexIndexBuffer.numItems,a.UNSIGNED_SHORT,0)},b.Ribbon=function(a,b,f){var g=a[0].lineSegments.length,h=a[0].lineSegments[0].length;this.partitions=[],this.partitions.lastRender=0;var i;this.front=b>0;for(var j=0,k=a.length-1;k>j;j++){(!i||65e3<i.positionData.length)&&(0<this.partitions.length&&j--,i={count:0,positionData:[],normalData:[],indexData:[]},this.partitions.push(i));var l=a[j];i.count++;for(var m=0;g>m;m++)for(var n=f?l.lineSegmentsCartoon[m]:l.lineSegments[m],o=0===m,p=!1,q=0;h>q;q++){var r=n[q],s=j,t=q+1;j===a.length-2&&q===h-1?t--:q===h-1&&(s++,t=0);var t=f?a[s].lineSegmentsCartoon[m][t]:a[s].lineSegments[m][t],s=!1,u=m+1;m===g-1&&(u-=2,s=!0);var u=f?l.lineSegmentsCartoon[u][q]:l.lineSegments[u][q],t=[t.x-r.x,t.y-r.y,t.z-r.z],u=[u.x-r.x,u.y-r.y,u.z-r.z],v=d.cross(t,u,[]);0===q&&(d.normalize(t),d.scale(t,-1),i.normalData.push(t[0],t[1],t[2]),i.positionData.push(r.x,r.y,r.z)),o||p?(d.normalize(u),d.scale(u,-1),i.normalData.push(u[0],u[1],u[2]),i.positionData.push(r.x,r.y,r.z),o&&q===h-1&&(o=!1,q=-1)):(d.normalize(v),(s&&!this.front||!s&&this.front)&&d.scale(v,-1),i.normalData.push(v[0],v[1],v[2]),d.scale(v,c.abs(b)),i.positionData.push(r.x+v[0],r.y+v[1],r.z+v[2]),m===g-1&&q===h-1&&(p=!0,q=-1)),(-1===q||q===h-1)&&(d.normalize(t),i.normalData.push(t[0],t[1],t[2]),i.positionData.push(r.x,r.y,r.z))}}for(g+=2,h+=2,f&&(this.cartoonSegments=[]),this.segments=[],b=0,l=this.partitions.length;l>b;b++){i=this.partitions[b];var w;for(f&&(w=[]),j=0,k=i.count-1;k>j;j++){for(n=j,m=0;b>m;m++)n+=this.partitions[m].count-1;for(m=a[n],j>0&&f&&m.split&&(q=new e(this,void 0,w,b),m.helix&&(q.helix=!0),m.sheet&&(q.sheet=!0),this.cartoonSegments.push(q),w=[]),o=j*g*h,p=[],m=0,r=g-1;r>m;m++)for(s=o+m*h,q=0;h>q;q++)t=1,j===i.count-1?t=0:q===h-1&&(t=g*h-q),t=[s+q,s+h+q,s+h+q+t,s+q,s+q+t,s+h+q+t],q!==h-1&&(this.front?p.push(t[0],t[1],t[2],t[3],t[5],t[4]):p.push(t[0],t[2],t[1],t[3],t[4],t[5])),q===h-2&&j<i.count-1&&(u=g*h-q,t[2]+=u,t[4]+=u,t[5]+=u),this.front?i.indexData.push(t[0],t[1],t[2],t[3],t[5],t[4]):i.indexData.push(t[0],t[2],t[1],t[3],t[4],t[5]),f&&(this.front?w.push(t[0],t[1],t[2],t[3],t[5],t[4]):w.push(t[0],t[2],t[1],t[3],t[4],t[5]));this.segments.push(new e(this,a[n+1].name,p,b))}if(f){for(q=new e(this,void 0,w,b),n=i.count-1,m=0;b>m;m++)n+=this.partitions[m].count-1;m=a[n],m.helix&&(q.helix=!0),m.sheet&&(q.sheet=!0),this.cartoonSegments.push(q)}}this.storeData(this.partitions[0].positionData,this.partitions[0].normalData,this.partitions[0].indexData),1===this.partitions.length&&(this.partitions=void 0)},(b.Ribbon.prototype=new b._Mesh).render=function(a,b){this.bindBuffers(a);var c=b.macro_colorByChain?this.chainColor:void 0;if(c||(c=this.front?b.proteins_primaryColor:b.proteins_secondaryColor),a.material.setDiffuseColor(c),a.drawElements(a.TRIANGLES,this.vertexIndexBuffer.numItems,a.UNSIGNED_SHORT,0),this.partitions)for(var c=1,d=this.partitions.length;d>c;c++){var e=this.partitions[c];f(a,e),a.drawElements(a.TRIANGLES,e.vertexIndexBuffer.numItems,a.UNSIGNED_SHORT,0)}}}(ChemDoodle.RESIDUE,ChemDoodle.structures.d3,Math,ChemDoodle.lib.vec3),function(a,b,c){b.Light=function(b,c,d){this.diffuseRGB=a.getRGB(b,1),this.specularRGB=a.getRGB(c,1),this.direction=d},b.Light.prototype.lightScene=function(a){a.uniform3f(a.getUniformLocation(a.program,"u_light_diffuse_color"),this.diffuseRGB[0],this.diffuseRGB[1],this.diffuseRGB[2]),a.uniform3f(a.getUniformLocation(a.program,"u_light_specular_color"),this.specularRGB[0],this.specularRGB[1],this.specularRGB[2]);var b=c.create(this.direction);c.normalize(b),c.negate(b),a.uniform3f(a.getUniformLocation(a.program,"u_light_direction"),b[0],b[1],b[2]);var d=[0,0,0],b=[d[0]+b[0],d[1]+b[1],d[2]+b[2]],d=c.length(b);0===d?b=[0,0,1]:c.scale(1/d),a.uniform3f(a.getUniformLocation(a.program,"u_light_half_vector"),b[0],b[1],b[2])}}(ChemDoodle.math,ChemDoodle.structures.d3,ChemDoodle.lib.vec3),function(a){a.Line=function(){this.storeData([0,0,0,0,1,0],[0,0,0,0,0,0])},a.Line.prototype=new a._Mesh}(ChemDoodle.structures.d3),function(a,b){b.Material=function(a){this.gl=a,this.aUL=a.getUniformLocation(a.program,"u_material_ambient_color"),this.dUL=a.getUniformLocation(a.program,"u_material_diffuse_color"),this.sUL=a.getUniformLocation(a.program,"u_material_specular_color"),this.snUL=a.getUniformLocation(a.program,"u_material_shininess"),this.alUL=a.getUniformLocation(a.program,"u_material_alpha")};var c=b.Material.prototype;c.setTempColors=function(b,c,d,e){this.aCache&&this.aCache===b||(this.aCache=b,b=a.getRGB(b,1),this.gl.uniform3f(this.aUL,b[0],b[1],b[2])),!c||this.dCache&&this.dCache===c||(this.dCache=c,b=a.getRGB(c,1),this.gl.uniform3f(this.dUL,b[0],b[1],b[2])),this.sCache&&this.sCache===d||(this.sCache=d,b=a.getRGB(d,1),this.gl.uniform3f(this.sUL,b[0],b[1],b[2])),this.snCache&&this.snCache===e||(this.snCache=e,this.gl.uniform1f(this.snUL,e)),this.alCache=1,this.gl.uniform1f(this.alUL,1)},c.setDiffuseColor=function(b){this.dCache&&this.dCache===b||(this.dCache=b,b=a.getRGB(b,1),this.gl.uniform3f(this.dUL,b[0],b[1],b[2]))},c.setAlpha=function(a){this.alCache&&this.alCache===a||(this.alCache=a,this.gl.uniform1f(this.alUL,a))}}(ChemDoodle.math,ChemDoodle.structures.d3),function(a,b,c,d){b.MolecularSurface=function(b,e,f,g,h){function i(a,b,c,d){var e=a.index;if(a.contained)for(var e=-1,f=1/0,g=0,h=b.length;h>g;g++)for(var i=b[g],j=0,k=i.length;k>j;j++){var l=i[j];if(!l.contained&&l.index!==c&&l.index!==d){var m=l.distance3D(a);f>m&&(e=l.index,f=m)}}return e}for(var j=[],k=[],l=[],m=[],n=0;e>=n;n++)for(var o=n*d.PI/e,p=d.sin(o),q=d.cos(o),o=0;f>=o;o++){var r=2*o*d.PI/f;m.push(d.cos(r)*p,q,d.sin(r)*p)}for(p=[],n=0,o=b.atoms.length;o>n;n++){for(var q=[],s=b.atoms[n],t=c[s.label][h]+g,u=[],r=0,v=b.atoms.length;v>r;r++)if(r!==n){var w=b.atoms[r];w.index=r,s.distance3D(w)<t+c[w.label][h]+g&&u.push(w)}for(r=0,v=m.length;v>r;r+=3){for(var x=new a.Atom("C",s.x+t*m[r],s.y+t*m[r+1],s.z+t*m[r+2]),y=0,z=u.length;z>y;y++)if(w=u[y],x.distance3D(w)<c[w.label][h]+g){x.contained=!0;break}q.push(x)}p.push(q)}for(b=[],f++,n=0;e>n;n++)for(o=0;f>o;o++)h=n*f+o%f,g=h+f,b.push(h),b.push(g),b.push(h+1),f-1>o&&(b.push(g),b.push(g+1),b.push(h+1));for(n=y=0,o=p.length;o>n;n++){for(q=p[n],r=0,v=q.length;v>r;r++)x=q[r],x.contained||(x.index=y,y++,j.push(x.x,x.y,x.z),k.push(m[3*r],m[3*r+1],m[3*r+2]));for(r=0,v=b.length;v>r;r+=3)h=q[b[r]],g=q[b[r+1]],x=q[b[r+2]],!h.contained&&!g.contained&&!x.contained&&l.push(h.index,g.index,x.index)}for(m=[],n=0,o=p.length;o>n;n++)for(q=p[n],r=0,v=b.length;v>r;r+=3){for(h=q[b[r]],g=q[b[r+1]],x=q[b[r+2]],u=[],y=0,z=p.length;z>y;y++)y!==n&&u.push(p[y]);if(!(h.contained&&g.contained&&x.contained||!(h.contained||g.contained||x.contained))&&(e=i(h,u,-1,-1),f=i(g,u,e,-1),u=i(x,u,e,f),-1!==e&&-1!==f&&-1!==u)){for(g=!1,y=0,z=m.length;z>y;y+=3)if(h=m[y],x=m[y+1],s=m[y+2],t=f===h||f===x||f===s,w=u===h||u===x||u===s,(e===h||e===x||e===s)&&t&&w){g=!0;break}g||m.push(e,f,u)}}l=l.concat(m),this.storeData(j,k,l)},b.MolecularSurface.prototype=new b._Mesh}(ChemDoodle.structures,ChemDoodle.structures.d3,ChemDoodle.ELEMENT,Math),function(a){a.Picker=function(){},a=a.Picker.prototype,a.init=function(a){this.framebuffer=a.createFramebuffer();var b=a.createTexture(),c=a.createRenderbuffer();a.bindTexture(a.TEXTURE_2D,b),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.NEAREST),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.NEAREST),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),a.bindRenderbuffer(a.RENDERBUFFER,c),a.bindFramebuffer(a.FRAMEBUFFER,this.framebuffer),a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,b,0),a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_ATTACHMENT,a.RENDERBUFFER,c),a.bindTexture(a.TEXTURE_2D,null),a.bindRenderbuffer(a.RENDERBUFFER,null),a.bindFramebuffer(a.FRAMEBUFFER,null)},a.setDimension=function(a,b,c){a.bindFramebuffer(a.FRAMEBUFFER,this.framebuffer);var d=a.getFramebufferAttachmentParameter(a.FRAMEBUFFER,a.DEPTH_ATTACHMENT,a.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME);a.isRenderbuffer(d)&&(a.bindRenderbuffer(a.RENDERBUFFER,d),a.renderbufferStorage(a.RENDERBUFFER,a.DEPTH_COMPONENT16,b,c),a.bindRenderbuffer(a.RENDERBUFFER,null)),d=a.getFramebufferAttachmentParameter(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME),a.isTexture(d)&&(a.bindTexture(a.TEXTURE_2D,d),a.texImage2D(a.TEXTURE_2D,0,a.RGBA,b,c,0,a.RGBA,a.UNSIGNED_BYTE,null),a.bindTexture(a.TEXTURE_2D,null)),a.bindFramebuffer(a.FRAMEBUFFER,null)},a.pick=function(a,b,c,d,e,f,g){var h=void 0,i=a.getParameter(a.COLOR_CLEAR_VALUE);a.bindFramebuffer(a.FRAMEBUFFER,this.framebuffer),a.clearColor(1,1,1,0),a.clear(a.COLOR_BUFFER_BIT|a.DEPTH_BUFFER_BIT),a.fogging.setMode(0),a.disableVertexAttribArray(a.shader.vertexNormalAttribute);var j=[];a.material.setAlpha(255);for(var k=0,l=b.length;l>k;k++)b[k].renderPickFrame(a,c,j,f,g);return a.flush(),b=new Uint8Array(4),a.readPixels(d-2,e+2,1,1,a.RGBA,a.UNSIGNED_BYTE,b),0<b[3]&&(h=j[b[2]|b[1]<<8|b[0]<<16]),a.enableVertexAttribArray(a.shader.vertexNormalAttribute),a.fogging.setMode(c.fog_mode_3D),a.bindFramebuffer(a.FRAMEBUFFER,null),a.clearColor(i[0],i[1],i[2],i[3]),h}}(ChemDoodle.structures.d3,ChemDoodle.math,document),function(a,b){a.Pill=function(a,c,d,e){var f=1,g=2*a;c-=g,0>c?(f=0,c+=g):g>c&&(f=c/g,c=g);for(var g=[],h=[],i=0;d>=i;i++)for(var j=i*b.PI/d,k=b.sin(j),l=b.cos(j)*f,j=0;e>=j;j++){var m=2*j*b.PI/e,n=b.sin(m),m=b.cos(m)*k,o=l,n=n*k;h.push(m,o,n),g.push(a*m,a*o+(d/2>i?c:0),a*n)}for(a=[],e+=1,i=0;d>i;i++)for(j=0;e>j;j++)c=i*e+j%e,f=c+e,a.push(c,c+1,f),e-1>j&&a.push(f,c+1,f+1);this.storeData(g,h,a)},a.Pill.prototype=new a._Mesh}(ChemDoodle.structures.d3,Math),function(a,b){a.Shader=function(){};var c=a.Shader.prototype;c.init=function(a){var b=this.getShader(a,"vertex-shader");b||(b=this.loadDefaultVertexShader(a));var c=this.getShader(a,"fragment-shader");c||(c=this.loadDefaultFragmentShader(a)),a.attachShader(a.program,b),a.attachShader(a.program,c),this.vertexPositionAttribute=0,a.bindAttribLocation(a.program,this.vertexPositionAttribute,"a_vertex_position"),a.linkProgram(a.program),a.getProgramParameter(a.program,a.LINK_STATUS)||alert("Could not initialize shaders: "+a.getProgramInfoLog(a.program)),a.useProgram(a.program),a.enableVertexAttribArray(this.vertexPositionAttribute),this.vertexTexCoordAttribute=a.getAttribLocation(a.program,"a_vertex_texcoord"),this.vertexNormalAttribute=a.getAttribLocation(a.program,"a_vertex_normal"),a.enableVertexAttribArray(this.vertexNormalAttribute),this.dimensionUniform=a.getUniformLocation(a.program,"u_dimension")},c.getShader=function(a,c){var d=b.getElementById(c);if(d){for(var e=[],f=d.firstChild;f;)3===f.nodeType&&e.push(f.textContent),f=f.nextSibling;if("x-shader/x-fragment"===d.type)f=a.createShader(a.FRAGMENT_SHADER);else{if("x-shader/x-vertex"!==d.type)return;f=a.createShader(a.VERTEX_SHADER)}if(a.shaderSource(f,e.join("")),a.compileShader(f),a.getShaderParameter(f,a.COMPILE_STATUS))return f;alert(d.type+" "+a.getShaderInfoLog(f))}},c.loadDefaultVertexShader=function(a){var b=a.createShader(a.VERTEX_SHADER);return a.shaderSource(b,"precision mediump float;attribute vec3 a_vertex_position;attribute vec3 a_vertex_normal;attribute vec2 a_vertex_texcoord;uniform vec3 u_light_diffuse_color;uniform vec3 u_material_ambient_color;uniform vec3 u_material_diffuse_color;uniform mat4 u_model_view_matrix;uniform mat4 u_projection_matrix;uniform mat3 u_normal_matrix;uniform vec2 u_dimension;varying vec2 v_texcoord;varying vec3 v_diffuse;varying vec4 v_ambient;varying vec3 v_normal;void main() {v_texcoord = a_vertex_texcoord;if(length(a_vertex_texcoord) != 0.) {gl_Position = u_model_view_matrix * vec4(a_vertex_position, 1.);vec4 depth_pos = vec4(gl_Position);depth_pos.z += a_vertex_normal.z;gl_Position = u_projection_matrix * gl_Position;depth_pos = u_projection_matrix * depth_pos;gl_Position /= gl_Position.w;gl_Position.xy += a_vertex_normal.xy / u_dimension * 2.;gl_Position.z = depth_pos.z / depth_pos.w;} else {v_normal = length(a_vertex_normal)==0. ? a_vertex_normal : normalize(u_normal_matrix * a_vertex_normal);v_ambient = vec4(u_material_ambient_color, 1.);v_diffuse = u_material_diffuse_color * u_light_diffuse_color;gl_Position = u_projection_matrix * u_model_view_matrix * vec4(a_vertex_position, 1.);gl_Position /= gl_Position.w;gl_PointSize = 2.;}}"),a.compileShader(b),a.getShaderParameter(b,a.COMPILE_STATUS)?b:void alert("Vertex shader failed to compile: "+a.getShaderInfoLog(b))},c.loadDefaultFragmentShader=function(a){var b=a.createShader(a.FRAGMENT_SHADER);return a.shaderSource(b,"precision mediump float;\nuniform vec3 u_light_specular_color;uniform vec3 u_light_direction;uniform vec3 u_light_half_vector;uniform vec3 u_material_specular_color;uniform float u_material_shininess;uniform float u_material_alpha;uniform int u_fog_mode;uniform vec3 u_fog_color;uniform float u_fog_density;uniform float u_fog_start;uniform float u_fog_end;uniform sampler2D u_image;varying vec2 v_texcoord;varying vec3 v_diffuse;varying vec4 v_ambient;varying vec3 v_normal;void main(void){if(length(v_texcoord)!=0.) {gl_FragColor = texture2D(u_image, v_texcoord);}else if(length(v_normal)==0.){gl_FragColor = vec4(v_diffuse, u_material_alpha);}else{float nDotL = max(dot(v_normal, u_light_direction), 0.);vec4 color = vec4(v_diffuse*nDotL, 1.);float nDotHV = max(dot(v_normal, u_light_half_vector), 0.);vec3 specular = u_material_specular_color * u_light_specular_color;color+=vec4(specular * pow(nDotHV, u_material_shininess), 1.);gl_FragColor = color+v_ambient;gl_FragColor.a*=u_material_alpha;float fogCoord = gl_FragCoord.z/gl_FragCoord.w;float fogFactor = 1.;if(u_fog_mode == 1){if(fogCoord < u_fog_start){fogFactor = 1.;}else if(fogCoord > u_fog_end){fogFactor = 0.;}else{fogFactor = clamp((u_fog_end - fogCoord) / (u_fog_end - u_fog_start), 0., 1.);}}else if(u_fog_mode == 2) {fogFactor = clamp(exp(-u_fog_density*fogCoord), 0., 1.);}else if(u_fog_mode == 3) {fogFactor = clamp(exp(-pow(u_fog_density*fogCoord, 2.)), 0., 1.);}gl_FragColor = mix(vec4(u_fog_color, 1.), gl_FragColor, fogFactor);}}"),a.compileShader(b),a.getShaderParameter(b,a.COMPILE_STATUS)?b:void alert("Fragment shader failed to compile: "+a.getShaderInfoLog(b))}}(ChemDoodle.structures.d3,document),function(a,b,c){b.Shape=function(b,d){for(var e=b.length,f=[],g=[],h=new a.Point,i=0,j=e;j>i;i++){var k=i+1;i===j-1&&(k=0);for(var l=b[i],k=b[k],m=c.cross([0,0,1],[k.x-l.x,k.y-l.y,0]),n=0;2>n;n++)f.push(l.x,l.y,d/2),f.push(l.x,l.y,-d/2),f.push(k.x,k.y,d/2),f.push(k.x,k.y,-d/2);for(n=0;4>n;n++)g.push(m[0],m[1],m[2]);g.push(0,0,1),g.push(0,0,-1),g.push(0,0,1),g.push(0,0,-1),h.add(l)}for(h.x/=e,h.y/=e,g.push(0,0,1),f.push(h.x,h.y,d/2),g.push(0,0,-1),f.push(h.x,h.y,-d/2),h=[],l=8*e,i=0,j=e;j>i;i++)e=8*i,h.push(e),h.push(e+3),h.push(e+1),h.push(e),h.push(e+2),h.push(e+3),h.push(e+4),h.push(l),h.push(e+6),h.push(e+5),h.push(e+7),h.push(l+1);this.storeData(f,g,h)},b.Shape.prototype=new b._Mesh}(ChemDoodle.structures,ChemDoodle.structures.d3,ChemDoodle.lib.vec3),function(a,b,c){a.Star=function(){for(var a=[.8944,.4472,0,.2764,.4472,.8506,.2764,.4472,-.8506,-.7236,.4472,.5257,-.7236,.4472,-.5257,-.3416,.4472,0,-.1056,.4472,.3249,-.1056,.4472,-.3249,.2764,.4472,.2008,.2764,.4472,-.2008,-.8944,-.4472,0,-.2764,-.4472,.8506,-.2764,-.4472,-.8506,.7236,-.4472,.5257,.7236,-.4472,-.5257,.3416,-.4472,0,.1056,-.4472,.3249,.1056,-.4472,-.3249,-.2764,-.4472,.2008,-.2764,-.4472,-.2008,-.5527,.1058,0,-.1708,.1058,.5527,-.1708,.1058,-.5527,.4471,.1058,.3249,.4471,.1058,-.3249,.5527,-.1058,0,.1708,-.1058,.5527,.1708,-.1058,-.5527,-.4471,-.1058,.3249,-.4471,-.1058,-.3249,0,1,0,0,-1,0],b=[0,9,8,2,7,9,4,5,7,3,6,5,1,8,6,0,8,23,30,6,8,3,21,6,11,26,21,13,23,26,2,9,24,30,8,9,1,23,8,13,25,23,14,24,25,4,7,22,30,9,7,0,24,9,14,27,24,12,22,27,3,5,20,30,7,5,2,22,7,12,29,22,10,20,29,1,6,21,30,5,6,4,20,5,10,28,20,11,21,28,10,19,18,12,17,19,14,15,17,13,16,15,11,18,16,31,19,17,14,17,27,2,27,22,4,22,29,10,29,19,31,18,19,12,19,29,4,29,20,3,20,28,11,28,18,31,16,18,10,18,28,3,28,21,1,21,26,13,26,16,31,15,16,11,16,26,1,26,23,0,23,25,14,25,15,31,17,15,13,15,25,0,25,24,2,24,27,12,27,17],d=[],e=[],f=[],g=0,h=b.length;h>g;g+=3){var i=3*b[g],j=3*b[g+1],k=3*b[g+2],i=[a[i],a[i+1],a[i+2]],j=[a[j],a[j+1],a[j+2]],k=[a[k],a[k+1],a[k+2]],l=c.cross([k[0]-j[0],k[1]-j[1],k[2]-j[2]],[i[0]-j[0],i[1]-j[1],i[2]-j[2]],[]);c.normalize(l),d.push(i[0],i[1],i[2],j[0],j[1],j[2],k[0],k[1],k[2]),e.push(l[0],l[1],l[2],l[0],l[1],l[2],l[0],l[1],l[2]),f.push(g,g+1,g+2)}this.storeData(d,e,f)},a.Star.prototype=new a._Mesh}(ChemDoodle.structures.d3,Math,ChemDoodle.lib.vec3),function(a,b,c){a.TextImage=function(){this.ctx=c.createElement("canvas").getContext("2d"),this.data=[],this.text="",this.charHeight=0},a=a.TextImage.prototype,a.init=function(a){this.textureImage=a.createTexture(),a.bindTexture(a.TEXTURE_2D,this.textureImage),a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,!1),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.NEAREST),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.NEAREST),a.bindTexture(a.TEXTURE_2D,null),this.updateFont(a,12,["Sans-serif"],!1,!1,!1)},a.charData=function(a){return a=this.text.indexOf(a),a>=0?this.data[a]:null},a.updateFont=function(a,c,d,e,f,g){var h=this.ctx,i=this.ctx.canvas,j=[],k="";f=b.getFontString(c,d,e,f),h.font=f,h.save();var l=0;for(c*=1.5,d=32,e=127;e>d;d++){var m=String.fromCharCode(d),n=h.measureText(m).width;j.push({text:m,width:n,height:c}),l+=2*n}var o=["°","Å","®"];for(d=0,e=o.length;e>d;d++)m=o[d],n=h.measureText(m).width,j.push({text:m,width:n,height:c}),l+=2*n;for(d=Math.sqrt(l*c),d=Math.ceil(d/c),l=Math.ceil(l/(d-1)),i.width=l,i.height=d*c,h.font=f,h.textAlign="left",h.textBaseline="middle",h.strokeStyle="#000",h.lineWidth=1.4,h.fillStyle="#fff",d=m=f=0,e=j.length;e>d;d++){n=j[d],o=2*n.width,c=n.height;var p=n.text;m+o>l&&(f++,m=0);var q=f*c;g&&h.strokeText(p,m,q+c/2),h.fillText(p,m,q+c/2),n.x=m,n.y=q,k+=p,m+=o}this.text=k,this.data=j,this.charHeight=c,a.bindTexture(a.TEXTURE_2D,this.textureImage),a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,i),a.bindTexture(a.TEXTURE_2D,null)},a.pushVertexData=function(a,b,c,d){var e=a.toString().split(""),f=this.getHeight(),g=this.getWidth();a=-this.textWidth(a)/2;for(var h=-this.charHeight/2,i=0,j=e.length;j>i;i++){var k=this.charData(e[i]),l=k.width,m=k.x/g,n=m+1.8*k.width/g,o=k.y/f,k=o+k.height/f,p=a+1.8*l,q=this.charHeight/2;d.position.push(b[0],b[1],b[2],b[0],b[1],b[2],b[0],b[1],b[2],b[0],b[1],b[2],b[0],b[1],b[2],b[0],b[1],b[2]),d.texCoord.push(m,o,n,k,n,o,m,o,m,k,n,k),d.translation.push(a,q,c,p,h,c,p,q,c,a,q,c,a,h,c,p,h,c),a=p+l-1.8*l}},a.getCanvas=function(){return this.ctx.canvas},a.getHeight=function(){return this.getCanvas().height},a.getWidth=function(){return this.getCanvas().width},a.textWidth=function(a){return this.ctx.measureText(a).width},a.test=function(){c.body.appendChild(this.getCanvas())},a.useTexture=function(a){a.bindTexture(a.TEXTURE_2D,this.textureImage)}}(ChemDoodle.structures.d3,ChemDoodle.extensions,document),function(a){a.TextMesh=function(){},a=a.TextMesh.prototype,a.init=function(a){this.vertexPositionBuffer=a.createBuffer(),this.vertexTexCoordBuffer=a.createBuffer(),this.vertexTranslationBuffer=a.createBuffer()},a.setVertexData=function(a,b,c,d){a.bindBuffer(a.ARRAY_BUFFER,b),a.bufferData(a.ARRAY_BUFFER,new Float32Array(c),a.STATIC_DRAW),b.itemSize=d,b.numItems=c.length/d},a.storeData=function(a,b,c,d){this.setVertexData(a,this.vertexPositionBuffer,b,3),this.setVertexData(a,this.vertexTexCoordBuffer,c,2),this.setVertexData(a,this.vertexTranslationBuffer,d,3)},a.bindBuffers=function(a){a.bindBuffer(a.ARRAY_BUFFER,this.vertexPositionBuffer),a.vertexAttribPointer(a.shader.vertexPositionAttribute,this.vertexPositionBuffer.itemSize,a.FLOAT,!1,0,0),a.bindBuffer(a.ARRAY_BUFFER,this.vertexTexCoordBuffer),a.vertexAttribPointer(a.shader.vertexTexCoordAttribute,this.vertexTexCoordBuffer.itemSize,a.FLOAT,!1,0,0),a.bindBuffer(a.ARRAY_BUFFER,this.vertexTranslationBuffer),a.vertexAttribPointer(a.shader.vertexNormalAttribute,this.vertexTranslationBuffer.itemSize,a.FLOAT,!1,0,0)},a.render=function(a){var b=this.vertexPositionBuffer.numItems;b&&(this.bindBuffers(a),a.drawArrays(a.TRIANGLES,0,b))}}(ChemDoodle.structures.d3,Math),function(a,b,c,d,e,f,g){d.Torsion=function(a,b,c,d){this.a1=a,this.a2=b,this.a3=c,this.a4=d},a=d.Torsion.prototype=new d._Measurement,a.calculateData=function(a){var b=[],c=[],d=[],f=this.a2.distance3D(this.a1),h=this.a2.distance3D(this.a3);this.distUse=e.min(f,h)/2;var h=[this.a2.x-this.a1.x,this.a2.y-this.a1.y,this.a2.z-this.a1.z],f=[this.a3.x-this.a2.x,this.a3.y-this.a2.y,this.a3.z-this.a2.z],i=[this.a4.x-this.a3.x,this.a4.y-this.a3.y,this.a4.z-this.a3.z],j=g.cross(h,f,[]),i=g.cross(f,i,[]);g.scale(h,g.length(f)),this.torsion=e.atan2(g.dot(h,i),g.dot(j,i)),h=g.normalize(g.cross(j,f,[])),j=g.normalize(g.cross(f,h,[])),this.pos=g.add([this.a2.x,this.a2.y,this.a2.z],g.scale(g.normalize(f,[]),this.distUse));var i=[],k=a.measurement_angleBands_3D;for(a=0;k>=a;++a){var l=this.torsion*a/k,m=g.scale(h,e.cos(l),[]),l=g.scale(j,e.sin(l),[]),m=g.scale(g.normalize(g.add(m,l,[])),this.distUse);0==a&&(i=m),b.push(this.pos[0]+m[0],this.pos[1]+m[1],this.pos[2]+m[2]),c.push(0,0,0),k>a&&d.push(a,a+1)}this.vecText=g.normalize(g.add(i,m,[])),f=g.normalize(f,[]),g.scale(f,.0625),l=this.torsion-2*e.asin(.125)*this.torsion/e.abs(this.torsion),m=g.scale(h,e.cos(l),[]),l=g.scale(j,e.sin(l),[]),m=g.scale(g.normalize(g.add(m,l,[])),this.distUse),b.push(this.pos[0]+f[0]+m[0],this.pos[1]+f[1]+m[1],this.pos[2]+f[2]+m[2]),c.push(0,0,0),b.push(this.pos[0]-f[0]+m[0],this.pos[1]-f[1]+m[1],this.pos[2]-f[2]+m[2]),c.push(0,0,0),d.push(--a,a+1,a,a+2),this.storeData(b,c,d)},a.getText=function(){return g.add(this.pos,g.scale(this.vecText,this.distUse+.3,[])),{pos:this.pos,value:[b.angleBounds(this.torsion,!0,!0).toFixed(2)," °"].join("")}}}(ChemDoodle.ELEMENT,ChemDoodle.math,ChemDoodle.extensions,ChemDoodle.structures.d3,Math,ChemDoodle.lib.mat4,ChemDoodle.lib.vec3),function(a,b,c,d,e,f,g,h){var i=function(a,b,c){var d=e.sqrt(b[1]*b[1]+b[2]*b[2]),g=[1,0,0,0,0,b[2]/d,-b[1]/d,0,0,b[1]/d,b[2]/d,0,0,0,0,1],h=[1,0,0,0,0,b[2]/d,b[1]/d,0,0,-b[1]/d,b[2]/d,0,0,0,0,1],i=[d,0,-b[0],0,0,1,0,0,b[0],0,d,0,0,0,0,1];b=[d,0,b[0],0,0,1,0,0,-b[0],0,d,0,0,0,0,1],c=[e.cos(c),-e.sin(c),0,0,e.sin(c),e.cos(c),0,0,0,0,1,0,0,0,0,1];var j=f.multiply(g,f.multiply(i,f.multiply(c,f.multiply(b,h,[]))));this.rotate=function(){return f.multiplyVec3(j,a)}};d.Tube=function(d,j,k){var l=d[0].lineSegments[0].length;this.partitions=[];var m;this.ends=[],this.ends.push(d[0].lineSegments[0][0]),this.ends.push(d[d.length-2].lineSegments[0][0]);for(var n=[1,0,0],o=0,p=d.length-1;p>o;o++){(!m||65e3<m.positionData.length)&&(0<this.partitions.length&&o--,m={count:0,positionData:[],normalData:[],indexData:[]},this.partitions.push(m));var q=d[o];m.count++;for(var r=1/0,s=new c.Atom("",d[o+1].cp1.x,d[o+1].cp1.y,d[o+1].cp1.z),t=0;l>t;t++){var u,v=q.lineSegments[0][t];u=t===l-1?o===d.length-2?q.lineSegments[0][t-1]:d[o+1].lineSegments[0][0]:q.lineSegments[0][t+1],u=[u.x-v.x,u.y-v.y,u.z-v.z],g.normalize(u),o===d.length-2&&t===l-1&&g.scale(u,-1);var w=g.cross(u,n,[]);g.normalize(w),g.scale(w,j/2),w=new i(w,u,2*Math.PI/k),u=0;for(var x=k;x>u;u++){var y=w.rotate();u===e.floor(k/4)&&(n=[y[0],y[1],y[2]]),m.normalData.push(y[0],y[1],y[2]),m.positionData.push(v.x+y[0],v.y+y[1],v.z+y[2])}s&&(u=v.distance3D(s),r>u&&(r=u,d[o+1].pPoint=v))}}for(n=0,q=this.partitions.length;q>n;n++)for(m=this.partitions[n],o=0,p=m.count-1;p>o;o++)for(r=o*l*k,t=0,s=l;s>t;t++)for(v=r+t*k,u=0;k>u;u++)w=v+u,m.indexData.push(w),m.indexData.push(w+k),m.indexData.push(w+k+1),m.indexData.push(w),m.indexData.push(w+k+1),m.indexData.push(w+1);for(this.storeData(this.partitions[0].positionData,this.partitions[0].normalData,this.partitions[0].indexData),k=[new c.Point(2,0)],o=0;60>o;o++)l=o/60*e.PI,k.push(new c.Point(2*e.cos(l),-2*e.sin(l)));k.push(new c.Point(-2,0),new c.Point(-2,4),new c.Point(2,4));var z=new c.d3.Shape(k,1);this.render=function(i,k){if(this.bindBuffers(i),i.material.setDiffuseColor(k.macro_colorByChain?this.chainColor:k.nucleics_tubeColor),i.drawElements(i.TRIANGLES,this.vertexIndexBuffer.numItems,i.UNSIGNED_SHORT,0),this.partitions)for(var l=1,m=this.partitions.length;m>l;l++){var n=this.partitions[l],o=i,p=n;o.bindBuffer(o.ARRAY_BUFFER,p.vertexPositionBuffer),o.vertexAttribPointer(o.shader.vertexPositionAttribute,p.vertexPositionBuffer.itemSize,o.FLOAT,!1,0,0),o.bindBuffer(o.ARRAY_BUFFER,p.vertexNormalBuffer),o.vertexAttribPointer(o.shader.vertexNormalAttribute,p.vertexNormalBuffer.itemSize,o.FLOAT,!1,0,0),o.bindBuffer(o.ELEMENT_ARRAY_BUFFER,p.vertexIndexBuffer),i.drawElements(i.TRIANGLES,n.vertexIndexBuffer.numItems,i.UNSIGNED_SHORT,0)}for(i.sphereBuffer.bindBuffers(i),l=0;2>l;l++)n=this.ends[l],n=f.translate(i.modelViewMatrix,[n.x,n.y,n.z],[]),m=j/2,f.scale(n,[m,m,m]),i.setMatrixUniforms(n),i.drawElements(i.TRIANGLES,i.sphereBuffer.vertexIndexBuffer.numItems,i.UNSIGNED_SHORT,0);for(i.cylinderBuffer.bindBuffers(i),l=1,m=d.length-1;m>l;l++){var p=d[l],q=p.pPoint,r=new c.Atom("",p.cp2.x,p.cp2.y,p.cp2.z),n=1.001*q.distance3D(r),p=[j/4,n,j/4],n=f.translate(i.modelViewMatrix,[q.x,q.y,q.z],[]),s=[0,1,0],t=0,o=[r.x-q.x,r.y-q.y,r.z-q.z];q.x===r.x&&q.z===r.z?(s=[0,0,1],q.y<q.y&&(t=e.PI)):(t=a.vec3AngleFrom(s,o),s=g.cross(s,o,[])),0!==t&&f.rotate(n,t,s),f.scale(n,p),i.setMatrixUniforms(n),i.drawArrays(i.TRIANGLE_STRIP,0,i.cylinderBuffer.vertexPositionBuffer.numItems)}for(z.bindBuffers(i),"none"===k.nucleics_residueColor&&!k.macro_colorByChain&&i.material.setDiffuseColor(k.nucleics_baseColor),l=1,m=d.length-1;m>l;l++)p=d[l],r=p.cp2,n=f.translate(i.modelViewMatrix,[r.x,r.y,r.z],[]),s=[0,1,0],t=0,q=p.cp3,o=[q.x-r.x,q.y-r.y,q.z-r.z],r.x===q.x&&r.z===q.z?(s=[0,0,1],r.y<r.y&&(t=e.PI)):(t=a.vec3AngleFrom(s,o),s=g.cross(s,o,[])),0!==t&&f.rotate(n,t,s),r=[1,0,0],t=f.rotate(f.identity([]),t,s),f.multiplyVec3(t,r),t=p.cp4,q=p.cp5,t.y===q.y&&t.z===q.z||(t=[q.x-t.x,q.y-t.y,q.z-t.z],q=a.vec3AngleFrom(r,t),0>g.dot(o,g.cross(r,t))&&(q*=-1),f.rotateY(n,q)),k.macro_colorByChain||("shapely"===k.nucleics_residueColor?i.material.setDiffuseColor(b[p.name]?b[p.name].shapelyColor:b["*"].shapelyColor):"rainbow"===k.nucleics_residueColor&&i.material.setDiffuseColor(h.rainbowAt(l,m,k.macro_rainbowColors))),i.setMatrixUniforms(n),i.drawElements(i.TRIANGLES,z.vertexIndexBuffer.numItems,i.UNSIGNED_SHORT,0)}},d.Tube.prototype=new d._Mesh}(ChemDoodle.extensions,ChemDoodle.RESIDUE,ChemDoodle.structures,ChemDoodle.structures.d3,Math,ChemDoodle.lib.mat4,ChemDoodle.lib.vec3,ChemDoodle.math),function(a){a.UnitCell=function(a){var b=[],c=[],d=function(a,d,e,f){for(b.push(a[0],a[1],a[2]),b.push(d[0],d[1],d[2]),b.push(e[0],e[1],e[2]),b.push(f[0],f[1],f[2]),a=0;4>a;a++)c.push(0,0,0)};for(d(a.o,a.x,a.xy,a.y),d(a.o,a.y,a.yz,a.z),d(a.o,a.z,a.xz,a.x),d(a.yz,a.y,a.xy,a.xyz),d(a.xyz,a.xz,a.z,a.yz),d(a.xy,a.x,a.xz,a.xyz),a=[],d=0;6>d;d++){var e=4*d;a.push(e,e+1,e+1,e+2,e+2,e+3,e+3,e)}this.storeData(b,c,a)},a.UnitCell.prototype=new a._Mesh}(ChemDoodle.structures.d3,ChemDoodle.lib.vec3),function(a,b,c){a.Plate=function(a){for(this.lanes=Array(a),i=0,ii=a;ii>i;i++)this.lanes[i]=[]};var d=a.Plate.prototype;d.sort=function(){for(i=0,ii=this.lanes.length;ii>i;i++)this.lanes[i].sort(function(a,b){return a-b})},d.draw=function(a){var d=a.canvas.width,e=a.canvas.height;for(this.origin=9*e/10,this.front=e/10,this.laneLength=this.origin-this.front,a.strokeStyle="#000000",a.beginPath(),a.moveTo(0,this.front),b.contextHashTo(a,0,this.front,d,this.front,3,3),a.closePath(),a.stroke(),a.beginPath(),a.moveTo(0,this.origin),a.lineTo(d,this.origin),a.closePath(),a.stroke(),i=0,ii=this.lanes.length;ii>i;i++)for(e=(i+1)*d/(ii+1),a.beginPath(),a.moveTo(e,this.origin),a.lineTo(e,this.origin+3),a.closePath(),a.stroke(),s=0,ss=this.lanes[i].length;ss>s;s++){var f=this.origin-this.laneLength*this.lanes[i][s].rf;
switch(this.lanes[i][s].type){case"compact":a.beginPath(),a.arc(e,f,3,0,2*c.PI,!1),a.closePath();break;case"expanded":a.beginPath(),a.arc(e,f,7,0,2*c.PI,!1),a.closePath();break;case"widened":b.contextOval(a,e-18,f-10,36,10);break;case"cresent":a.beginPath(),a.arc(e,f,9,0,c.PI,!0),a.closePath()}switch(this.lanes[i][s].style){case"solid":a.fillStyle="#000000",a.fill();break;case"transparent":a.stroke()}}},a.Plate.Spot=function(a,b,c){this.type=a,this.rf=b,this.style=c?c:"solid"}}(ChemDoodle.structures,ChemDoodle.extensions,Math),function(a,b,c){a.default_backgroundColor="#FFFFFF",a.default_scale=1,a.default_rotateAngle=0,a.default_bondLength_2D=20,a.default_angstromsPerBondLength=1.25,a.default_lightDirection_3D=[-.1,-.1,-1],a.default_lightDiffuseColor_3D="#FFFFFF",a.default_lightSpecularColor_3D="#FFFFFF",a.default_projectionPerspective_3D=!0,a.default_projectionPerspectiveVerticalFieldOfView_3D=45,a.default_projectionOrthoWidth_3D=40,a.default_projectionWidthHeightRatio_3D=void 0,a.default_projectionFrontCulling_3D=.1,a.default_projectionBackCulling_3D=1e4,a.default_cullBackFace_3D=!0,a.default_fog_mode_3D=0,a.default_fog_color_3D="#000000",a.default_fog_start_3D=0,a.default_fog_end_3D=1,a.default_fog_density_3D=1,a.default_atoms_display=!0,a.default_atoms_color="#000000",a.default_atoms_font_size_2D=12,a.default_atoms_font_families_2D=["Helvetica","Arial","Dialog"],a.default_atoms_font_bold_2D=!1,a.default_atoms_font_italic_2D=!1,a.default_atoms_circles_2D=!1,a.default_atoms_circleDiameter_2D=10,a.default_atoms_circleBorderWidth_2D=1,a.default_atoms_lonePairDistance_2D=8,a.default_atoms_lonePairSpread_2D=4,a.default_atoms_lonePairDiameter_2D=1,a.default_atoms_useJMOLColors=!1,a.default_atoms_usePYMOLColors=!1,a.default_atoms_resolution_3D=60,a.default_atoms_sphereDiameter_3D=.8,a.default_atoms_useVDWDiameters_3D=!1,a.default_atoms_vdwMultiplier_3D=1,a.default_atoms_materialAmbientColor_3D="#000000",a.default_atoms_materialSpecularColor_3D="#555555",a.default_atoms_materialShininess_3D=32,a.default_atoms_implicitHydrogens_2D=!0,a.default_atoms_displayTerminalCarbonLabels_2D=!1,a.default_atoms_showHiddenCarbons_2D=!0,a.default_atoms_showAttributedCarbons_2D=!0,a.default_atoms_displayAllCarbonLabels_2D=!1,a.default_atoms_nonBondedAsStars_3D=!1,a.default_atoms_displayLabels_3D=!1,a.default_atoms_HBlack_2D=!0,a.default_bonds_display=!0,a.default_bonds_color="#000000",a.default_bonds_width_2D=1,a.default_bonds_saturationWidth_2D=.2,a.default_bonds_ends_2D="round",a.default_bonds_useJMOLColors=!1,a.default_bonds_usePYMOLColors=!1,a.default_bonds_colorGradient=!1,a.default_bonds_saturationAngle_2D=c.PI/3,a.default_bonds_symmetrical_2D=!1,a.default_bonds_clearOverlaps_2D=!1,a.default_bonds_overlapClearWidth_2D=.5,a.default_bonds_atomLabelBuffer_2D=1,a.default_bonds_wedgeThickness_2D=.22,a.default_bonds_hashWidth_2D=1,a.default_bonds_hashSpacing_2D=2.5,a.default_bonds_dotSize_2D=2,a.default_bonds_lewisStyle_2D=!1,a.default_bonds_showBondOrders_3D=!1,a.default_bonds_resolution_3D=60,a.default_bonds_renderAsLines_3D=!1,a.default_bonds_cylinderDiameter_3D=.3,a.default_bonds_pillLatitudeResolution_3D=10,a.default_bonds_pillLongitudeResolution_3D=20,a.default_bonds_pillHeight_3D=.3,a.default_bonds_pillSpacing_3D=.1,a.default_bonds_pillDiameter_3D=.3,a.default_bonds_materialAmbientColor_3D="#222222",a.default_bonds_materialSpecularColor_3D="#555555",a.default_bonds_materialShininess_3D=32,a.default_proteins_displayRibbon=!0,a.default_proteins_displayBackbone=!1,a.default_proteins_backboneThickness=1.5,a.default_proteins_backboneColor="#CCCCCC",a.default_proteins_ribbonCartoonize=!1,a.default_proteins_residueColor="none",a.default_proteins_primaryColor="#FF0D0D",a.default_proteins_secondaryColor="#FFFF30",a.default_proteins_ribbonCartoonHelixPrimaryColor="#00E740",a.default_proteins_ribbonCartoonHelixSecondaryColor="#9905FF",a.default_proteins_ribbonCartoonSheetColor="#E8BB99",a.default_proteins_ribbonThickness=.2,a.default_proteins_verticalResolution=10,a.default_proteins_horizontalResolution=9,a.default_proteins_materialAmbientColor_3D="#222222",a.default_proteins_materialSpecularColor_3D="#555555",a.default_proteins_materialShininess_3D=32,a.default_nucleics_display=!0,a.default_nucleics_tubeColor="#CCCCCC",a.default_nucleics_baseColor="#C10000",a.default_nucleics_residueColor="none",a.default_nucleics_tubeThickness=1.5,a.default_nucleics_tubeResolution_3D=60,a.default_nucleics_verticalResolution=10,a.default_nucleics_materialAmbientColor_3D="#222222",a.default_nucleics_materialSpecularColor_3D="#555555",a.default_nucleics_materialShininess_3D=32,a.default_macro_displayAtoms=!1,a.default_macro_displayBonds=!1,a.default_macro_atomToLigandDistance=-1,a.default_macro_showWater=!1,a.default_macro_colorByChain=!1,a.default_macro_rainbowColors=["#0000FF","#00FFFF","#00FF00","#FFFF00","#FF0000"],a.default_surfaces_display=!0,a.default_surfaces_style="Dot",a.default_surfaces_color="#E9B862",a.default_surfaces_materialAmbientColor_3D="#000000",a.default_surfaces_materialSpecularColor_3D="#000000",a.default_surfaces_materialShininess_3D=32,a.default_crystals_displayUnitCell=!0,a.default_crystals_unitCellColor="green",a.default_crystals_unitCellLineWidth=1,a.default_plots_color="#000000",a.default_plots_width=1,a.default_plots_showIntegration=!1,a.default_plots_integrationColor="#c10000",a.default_plots_integrationLineWidth=1,a.default_plots_showGrid=!1,a.default_plots_gridColor="gray",a.default_plots_gridLineWidth=.5,a.default_plots_showYAxis=!0,a.default_plots_flipXAxis=!1,a.default_text_font_size=12,a.default_text_font_families=["Helvetica","Arial","Dialog"],a.default_text_font_bold=!0,a.default_text_font_italic=!1,a.default_text_font_stroke_3D=!0,a.default_text_color="#000000",a.default_shapes_color="#000000",a.default_shapes_lineWidth_2D=1,a.default_shapes_arrowLength_2D=8,a.default_compass_display=!1,a.default_compass_axisXColor_3D="#FF0000",a.default_compass_axisYColor_3D="#00FF00",a.default_compass_axisZColor_3D="#0000FF",a.default_compass_size_3D=50,a.default_compass_resolution_3D=10,a.default_compass_displayText_3D=!0,a.default_compass_type_3D=0,a.default_measurement_update_3D=!1,a.default_measurement_angleBands_3D=10,a.default_measurement_displayText_3D=!0,b.VisualSpecifications=function(){this.backgroundColor=a.default_backgroundColor,this.scale=a.default_scale,this.rotateAngle=a.default_rotateAngle,this.bondLength=a.default_bondLength_2D,this.angstromsPerBondLength=a.default_angstromsPerBondLength,this.lightDirection_3D=a.default_lightDirection_3D.slice(0),this.lightDiffuseColor_3D=a.default_lightDiffuseColor_3D,this.lightSpecularColor_3D=a.default_lightSpecularColor_3D,this.projectionPerspective_3D=a.default_projectionPerspective_3D,this.projectionPerspectiveVerticalFieldOfView_3D=a.default_projectionPerspectiveVerticalFieldOfView_3D,this.projectionOrthoWidth_3D=a.default_projectionOrthoWidth_3D,this.projectionWidthHeightRatio_3D=a.default_projectionWidthHeightRatio_3D,this.projectionFrontCulling_3D=a.default_projectionFrontCulling_3D,this.projectionBackCulling_3D=a.default_projectionBackCulling_3D,this.cullBackFace_3D=a.default_cullBackFace_3D,this.fog_mode_3D=a.default_fog_mode_3D,this.fog_color_3D=a.default_fog_color_3D,this.fog_start_3D=a.default_fog_start_3D,this.fog_end_3D=a.default_fog_end_3D,this.fog_density_3D=a.default_fog_density_3D,this.atoms_display=a.default_atoms_display,this.atoms_color=a.default_atoms_color,this.atoms_font_size_2D=a.default_atoms_font_size_2D,this.atoms_font_families_2D=a.default_atoms_font_families_2D.slice(0),this.atoms_font_bold_2D=a.default_atoms_font_bold_2D,this.atoms_font_italic_2D=a.default_atoms_font_italic_2D,this.atoms_circles_2D=a.default_atoms_circles_2D,this.atoms_circleDiameter_2D=a.default_atoms_circleDiameter_2D,this.atoms_circleBorderWidth_2D=a.default_atoms_circleBorderWidth_2D,this.atoms_lonePairDistance_2D=a.default_atoms_lonePairDistance_2D,this.atoms_lonePairSpread_2D=a.default_atoms_lonePairSpread_2D,this.atoms_lonePairDiameter_2D=a.default_atoms_lonePairDiameter_2D,this.atoms_useJMOLColors=a.default_atoms_useJMOLColors,this.atoms_usePYMOLColors=a.default_atoms_usePYMOLColors,this.atoms_resolution_3D=a.default_atoms_resolution_3D,this.atoms_sphereDiameter_3D=a.default_atoms_sphereDiameter_3D,this.atoms_useVDWDiameters_3D=a.default_atoms_useVDWDiameters_3D,this.atoms_vdwMultiplier_3D=a.default_atoms_vdwMultiplier_3D,this.atoms_materialAmbientColor_3D=a.default_atoms_materialAmbientColor_3D,this.atoms_materialSpecularColor_3D=a.default_atoms_materialSpecularColor_3D,this.atoms_materialShininess_3D=a.default_atoms_materialShininess_3D,this.atoms_implicitHydrogens_2D=a.default_atoms_implicitHydrogens_2D,this.atoms_displayTerminalCarbonLabels_2D=a.default_atoms_displayTerminalCarbonLabels_2D,this.atoms_showHiddenCarbons_2D=a.default_atoms_showHiddenCarbons_2D,this.atoms_showAttributedCarbons_2D=a.default_atoms_showAttributedCarbons_2D,this.atoms_displayAllCarbonLabels_2D=a.default_atoms_displayAllCarbonLabels_2D,this.atoms_nonBondedAsStars_3D=a.default_atoms_nonBondedAsStars_3D,this.atoms_displayLabels_3D=a.default_atoms_displayLabels_3D,this.atoms_HBlack_2D=a.default_atoms_HBlack_2D,this.bonds_display=a.default_bonds_display,this.bonds_color=a.default_bonds_color,this.bonds_width_2D=a.default_bonds_width_2D,this.bonds_saturationWidth_2D=a.default_bonds_saturationWidth_2D,this.bonds_ends_2D=a.default_bonds_ends_2D,this.bonds_useJMOLColors=a.default_bonds_useJMOLColors,this.bonds_usePYMOLColors=a.default_bonds_usePYMOLColors,this.bonds_colorGradient=a.default_bonds_colorGradient,this.bonds_saturationAngle_2D=a.default_bonds_saturationAngle_2D,this.bonds_symmetrical_2D=a.default_bonds_symmetrical_2D,this.bonds_clearOverlaps_2D=a.default_bonds_clearOverlaps_2D,this.bonds_overlapClearWidth_2D=a.default_bonds_overlapClearWidth_2D,this.bonds_atomLabelBuffer_2D=a.default_bonds_atomLabelBuffer_2D,this.bonds_wedgeThickness_2D=a.default_bonds_wedgeThickness_2D,this.bonds_hashWidth_2D=a.default_bonds_hashWidth_2D,this.bonds_hashSpacing_2D=a.default_bonds_hashSpacing_2D,this.bonds_dotSize_2D=a.default_bonds_dotSize_2D,this.bonds_lewisStyle_2D=a.default_bonds_lewisStyle_2D,this.bonds_showBondOrders_3D=a.default_bonds_showBondOrders_3D,this.bonds_resolution_3D=a.default_bonds_resolution_3D,this.bonds_renderAsLines_3D=a.default_bonds_renderAsLines_3D,this.bonds_cylinderDiameter_3D=a.default_bonds_cylinderDiameter_3D,this.bonds_pillHeight_3D=a.default_bonds_pillHeight_3D,this.bonds_pillLatitudeResolution_3D=a.default_bonds_pillLatitudeResolution_3D,this.bonds_pillLongitudeResolution_3D=a.default_bonds_pillLongitudeResolution_3D,this.bonds_pillSpacing_3D=a.default_bonds_pillSpacing_3D,this.bonds_pillDiameter_3D=a.default_bonds_pillDiameter_3D,this.bonds_materialAmbientColor_3D=a.default_bonds_materialAmbientColor_3D,this.bonds_materialSpecularColor_3D=a.default_bonds_materialSpecularColor_3D,this.bonds_materialShininess_3D=a.default_bonds_materialShininess_3D,this.proteins_displayRibbon=a.default_proteins_displayRibbon,this.proteins_displayBackbone=a.default_proteins_displayBackbone,this.proteins_backboneThickness=a.default_proteins_backboneThickness,this.proteins_backboneColor=a.default_proteins_backboneColor,this.proteins_ribbonCartoonize=a.default_proteins_ribbonCartoonize,this.proteins_residueColor=a.default_proteins_residueColor,this.proteins_primaryColor=a.default_proteins_primaryColor,this.proteins_secondaryColor=a.default_proteins_secondaryColor,this.proteins_ribbonCartoonHelixPrimaryColor=a.default_proteins_ribbonCartoonHelixPrimaryColor,this.proteins_ribbonCartoonHelixSecondaryColor=a.default_proteins_ribbonCartoonHelixSecondaryColor,this.proteins_ribbonCartoonSheetColor=a.default_proteins_ribbonCartoonSheetColor,this.proteins_ribbonThickness=a.default_proteins_ribbonThickness,this.proteins_verticalResolution=a.default_proteins_verticalResolution,this.proteins_horizontalResolution=a.default_proteins_horizontalResolution,this.proteins_materialAmbientColor_3D=a.default_proteins_materialAmbientColor_3D,this.proteins_materialSpecularColor_3D=a.default_proteins_materialSpecularColor_3D,this.proteins_materialShininess_3D=a.default_proteins_materialShininess_3D,this.macro_displayAtoms=a.default_macro_displayAtoms,this.macro_displayBonds=a.default_macro_displayBonds,this.macro_atomToLigandDistance=a.default_macro_atomToLigandDistance,this.nucleics_display=a.default_nucleics_display,this.nucleics_tubeColor=a.default_nucleics_tubeColor,this.nucleics_baseColor=a.default_nucleics_baseColor,this.nucleics_residueColor=a.default_nucleics_residueColor,this.nucleics_tubeThickness=a.default_nucleics_tubeThickness,this.nucleics_tubeResolution_3D=a.default_nucleics_tubeResolution_3D,this.nucleics_verticalResolution=a.default_nucleics_verticalResolution,this.nucleics_materialAmbientColor_3D=a.default_nucleics_materialAmbientColor_3D,this.nucleics_materialSpecularColor_3D=a.default_nucleics_materialSpecularColor_3D,this.nucleics_materialShininess_3D=a.default_nucleics_materialShininess_3D,this.macro_showWater=a.default_macro_showWater,this.macro_colorByChain=a.default_macro_colorByChain,this.macro_rainbowColors=a.default_macro_rainbowColors.slice(0),this.surfaces_display=a.default_surfaces_display,this.surfaces_style=a.default_surfaces_style,this.surfaces_color=a.default_surfaces_color,this.surfaces_materialAmbientColor_3D=a.default_surfaces_materialAmbientColor_3D,this.surfaces_materialSpecularColor_3D=a.default_surfaces_materialSpecularColor_3D,this.surfaces_materialShininess_3D=a.default_surfaces_materialShininess_3D,this.crystals_displayUnitCell=a.default_crystals_displayUnitCell,this.crystals_unitCellColor=a.default_crystals_unitCellColor,this.crystals_unitCellLineWidth=a.default_crystals_unitCellLineWidth,this.plots_color=a.default_plots_color,this.plots_width=a.default_plots_width,this.plots_showIntegration=a.default_plots_showIntegration,this.plots_integrationColor=a.default_plots_integrationColor,this.plots_integrationLineWidth=a.default_plots_integrationLineWidth,this.plots_showGrid=a.default_plots_showGrid,this.plots_gridColor=a.default_plots_gridColor,this.plots_gridLineWidth=a.default_plots_gridLineWidth,this.plots_showYAxis=a.default_plots_showYAxis,this.plots_flipXAxis=a.default_plots_flipXAxis,this.text_font_size=a.default_text_font_size,this.text_font_families=a.default_text_font_families.slice(0),this.text_font_bold=a.default_text_font_bold,this.text_font_italic=a.default_text_font_italic,this.text_font_stroke_3D=a.default_text_font_stroke_3D,this.text_color=a.default_text_color,this.shapes_color=a.default_shapes_color,this.shapes_lineWidth_2D=a.default_shapes_lineWidth_2D,this.shapes_arrowLength_2D=a.default_shapes_arrowLength_2D,this.compass_display=a.default_compass_display,this.compass_axisXColor_3D=a.default_compass_axisXColor_3D,this.compass_axisYColor_3D=a.default_compass_axisYColor_3D,this.compass_axisZColor_3D=a.default_compass_axisZColor_3D,this.compass_size_3D=a.default_compass_size_3D,this.compass_resolution_3D=a.default_compass_resolution_3D,this.compass_displayText_3D=a.default_compass_displayText_3D,this.compass_type_3D=a.default_compass_type_3D,this.measurement_update_3D=a.default_measurement_update_3D,this.measurement_angleBands_3D=a.default_measurement_angleBands_3D,this.measurement_displayText_3D=a.default_measurement_displayText_3D},b.VisualSpecifications.prototype.set3DRepresentation=function(b){this.bonds_display=this.atoms_display=!0,this.bonds_color="#777777",this.bonds_showBondOrders_3D=this.bonds_useJMOLColors=this.atoms_useJMOLColors=this.atoms_useVDWDiameters_3D=!0,this.bonds_renderAsLines_3D=!1,"Ball and Stick"===b?(this.atoms_vdwMultiplier_3D=.3,this.bonds_useJMOLColors=!1,this.bonds_cylinderDiameter_3D=.3,this.bonds_materialAmbientColor_3D=a.default_atoms_materialAmbientColor_3D,this.bonds_pillDiameter_3D=.15):"van der Waals Spheres"===b?(this.bonds_display=!1,this.atoms_vdwMultiplier_3D=1):"Stick"===b?(this.bonds_showBondOrders_3D=this.atoms_useVDWDiameters_3D=!1,this.bonds_cylinderDiameter_3D=this.atoms_sphereDiameter_3D=.8,this.bonds_materialAmbientColor_3D=this.atoms_materialAmbientColor_3D):"Wireframe"===b?(this.atoms_useVDWDiameters_3D=!1,this.bonds_cylinderDiameter_3D=this.bonds_pillDiameter_3D=.05,this.atoms_sphereDiameter_3D=.15,this.bonds_materialAmbientColor_3D=a.default_atoms_materialAmbientColor_3D):"Line"===b?(this.atoms_display=!1,this.bonds_renderAsLines_3D=!0,this.bonds_width_2D=1,this.bonds_cylinderDiameter_3D=.05):alert('"'+b+'" is not recognized. Use one of the following strings:\n\n1. Ball and Stick\n2. van der Waals Spheres\n3. Stick\n4. Wireframe\n5. Line\n')}}(ChemDoodle,ChemDoodle.structures,Math),function(a,b,c,d){c.getPointsPerAngstrom=function(){return a.default_bondLength_2D/a.default_angstromsPerBondLength},c.BondDeducer=function(){};var e=c.BondDeducer.prototype;e.margin=1.1,e.deduceCovalentBonds=function(a,e){var f=c.getPointsPerAngstrom();e&&(f=e);for(var g=0,h=a.atoms.length;h>g;g++)for(var i=g+1;h>i;i++){var j=a.atoms[g],k=a.atoms[i];j.distance3D(k)<(b[j.label].covalentRadius+b[k.label].covalentRadius)*f*this.margin&&a.bonds.push(new d.Bond(j,k,1))}}}(ChemDoodle,ChemDoodle.ELEMENT,ChemDoodle.informatics,ChemDoodle.structures),function(a){a.HydrogenDeducer=function(){},a.HydrogenDeducer.prototype.removeHydrogens=function(a){for(var b=[],c=[],d=0,e=a.bonds.length;e>d;d++)"H"!==a.bonds[d].a1.label&&"H"!==a.bonds[d].a2.label&&c.push(a.bonds[d]);for(d=0,e=a.atoms.length;e>d;d++)"H"!==a.atoms[d].label&&b.push(a.atoms[d]);a.atoms=b,a.bonds=c}}(ChemDoodle.informatics),function(a,b,c){b.MolecularSurfaceGenerator=function(){},b.MolecularSurfaceGenerator.prototype.generateSurface=function(a,b,d,e,f){return new c.MolecularSurface(a,b,d,e,f)}}(ChemDoodle,ChemDoodle.informatics,ChemDoodle.structures.d3),function(a,b){a.Splitter=function(){},a.Splitter.prototype.split=function(a){for(var c=[],d=0,e=a.atoms.length;e>d;d++)a.atoms[d].visited=!1;for(d=0,e=a.bonds.length;e>d;d++)a.bonds[d].visited=!1;for(d=0,e=a.atoms.length;e>d;d++){var f=a.atoms[d];if(!f.visited){var g=new b.Molecule;g.atoms.push(f),f.visited=!0;var h=new b.Queue;for(h.enqueue(f);!h.isEmpty();)for(var f=h.dequeue(),i=0,j=a.bonds.length;j>i;i++){var k=a.bonds[i];k.contains(f)&&!k.visited&&(k.visited=!0,g.bonds.push(k),k=k.getNeighbor(f),k.visited||(k.visited=!0,g.atoms.push(k),h.enqueue(k)))}c.push(g)}}return c}}(ChemDoodle.informatics,ChemDoodle.structures),function(a,b){a.StructureBuilder=function(){},a.StructureBuilder.prototype.copy=function(a){var c=new b.JSONInterpreter;return c.molFrom(c.molTo(a))}}(ChemDoodle.informatics,ChemDoodle.io,ChemDoodle.structures),function(a){a._Counter=function(){},a=a._Counter.prototype,a.value=0,a.molecule=void 0,a.setMolecule=function(a){this.value=0,this.molecule=a,this.innerCalculate&&this.innerCalculate()}}(ChemDoodle.informatics),function(a){a.FrerejacqueNumberCounter=function(a){this.setMolecule(a)},(a.FrerejacqueNumberCounter.prototype=new a._Counter).innerCalculate=function(){this.value=this.molecule.bonds.length-this.molecule.atoms.length+new a.NumberOfMoleculesCounter(this.molecule).value}}(ChemDoodle.informatics),function(a,b){b.NumberOfMoleculesCounter=function(a){this.setMolecule(a)},(b.NumberOfMoleculesCounter.prototype=new b._Counter).innerCalculate=function(){for(var b=0,c=this.molecule.atoms.length;c>b;b++)this.molecule.atoms[b].visited=!1;for(b=0,c=this.molecule.atoms.length;c>b;b++)if(!this.molecule.atoms[b].visited){this.value++;var d=new a.Queue;for(this.molecule.atoms[b].visited=!0,d.enqueue(this.molecule.atoms[b]);!d.isEmpty();)for(var e=d.dequeue(),f=0,g=this.molecule.bonds.length;g>f;f++){var h=this.molecule.bonds[f];h.contains(e)&&(h=h.getNeighbor(e),h.visited||(h.visited=!0,d.enqueue(h)))}}}}(ChemDoodle.structures,ChemDoodle.informatics),function(a){a._RingFinder=function(){},a=a._RingFinder.prototype,a.atoms=void 0,a.bonds=void 0,a.rings=void 0,a.reduce=function(a){for(var b=0,c=a.atoms.length;c>b;b++)a.atoms[b].visited=!1;for(b=0,c=a.bonds.length;c>b;b++)a.bonds[b].visited=!1;for(var d=!0;d;)for(d=!1,b=0,c=a.atoms.length;c>b;b++){for(var e,f=0,g=0,h=a.bonds.length;h>g;g++)if(a.bonds[g].contains(a.atoms[b])&&!a.bonds[g].visited){if(f++,2===f)break;e=a.bonds[g]}1===f&&(d=!0,e.visited=!0,a.atoms[b].visited=!0)}for(b=0,c=a.atoms.length;c>b;b++)a.atoms[b].visited||this.atoms.push(a.atoms[b]);for(b=0,c=a.bonds.length;c>b;b++)a.bonds[b].visited||this.bonds.push(a.bonds[b]);0===this.bonds.length&&0!==this.atoms.length&&(this.atoms=[])},a.setMolecule=function(a){this.atoms=[],this.bonds=[],this.rings=[],this.reduce(a),2<this.atoms.length&&this.innerGetRings&&this.innerGetRings()},a.fuse=function(){for(var a=0,b=this.rings.length;b>a;a++)for(var c=0,d=this.bonds.length;d>c;c++)-1!==this.rings[a].atoms.indexOf(this.bonds[c].a1)&&-1!==this.rings[a].atoms.indexOf(this.bonds[c].a2)&&this.rings[a].bonds.push(this.bonds[c])}}(ChemDoodle.informatics),function(a,b){function c(a,b){if(this.atoms=[],b)for(var c=0,d=b.atoms.length;d>c;c++)this.atoms[c]=b.atoms[c];this.atoms.push(a)}var d=c.prototype;d.grow=function(a,b){for(var d=this.atoms[this.atoms.length-1],e=[],f=0,g=a.length;g>f;f++)if(a[f].contains(d)){var h=a[f].getNeighbor(d);-1===b.indexOf(h)&&e.push(h)}for(d=[],f=0,g=e.length;g>f;f++)d.push(new c(e[f],this));return d},d.check=function(a,c,d){for(var e=0,f=c.atoms.length-1;f>e;e++)if(-1!==this.atoms.indexOf(c.atoms[e]))return;var g;if(c.atoms[c.atoms.length-1]===this.atoms[this.atoms.length-1]){for(g=new b.Ring,g.atoms[0]=d,e=0,f=this.atoms.length;f>e;e++)g.atoms.push(this.atoms[e]);for(e=c.atoms.length-2;e>=0;e--)g.atoms.push(c.atoms[e])}else{for(var h=[],e=0,f=a.length;f>e;e++)a[e].contains(c.atoms[c.atoms.length-1])&&h.push(a[e]);for(e=0,f=h.length;f>e;e++)if((1===c.atoms.length||!h[e].contains(c.atoms[c.atoms.length-2]))&&h[e].contains(this.atoms[this.atoms.length-1])){for(g=new b.Ring,g.atoms[0]=d,a=0,d=this.atoms.length;d>a;a++)g.atoms.push(this.atoms[a]);for(a=c.atoms.length-1;a>=0;a--)g.atoms.push(c.atoms[a]);break}}return g},a.EulerFacetRingFinder=function(a){this.setMolecule(a)},d=a.EulerFacetRingFinder.prototype=new a._RingFinder,d.fingerBreak=5,d.innerGetRings=function(){for(var a=0,b=this.atoms.length;b>a;a++){for(var d=[],e=0,f=this.bonds.length;f>e;e++)this.bonds[e].contains(this.atoms[a])&&d.push(this.bonds[e].getNeighbor(this.atoms[a]));for(e=0,f=d.length;f>e;e++)for(var g=e+1;g<d.length;g++){var h=[];h[0]=new c(d[e]),h[1]=new c(d[g]);var i=[];i[0]=this.atoms[a];for(var j=0,k=d.length;k>j;j++)j!==e&&j!==g&&i.push(d[j]);var l=[];for((j=h[0].check(this.bonds,h[1],this.atoms[a]))&&(l[0]=j);0===l.length&&0<h.length&&h[0].atoms.length<this.fingerBreak;){for(var m=[],j=0,k=h.length;k>j;j++)for(var n=h[j].grow(this.bonds,i),o=0,p=n.length;p>o;o++)m.push(n[o]);for(h=m,j=0,k=h.length;k>j;j++)for(o=j+1;k>o;o++)(p=h[j].check(this.bonds,h[o],this.atoms[a]))&&l.push(p);if(0===l.length){for(m=[],j=0,k=i.length;k>j;j++)for(o=0,p=this.bonds.length;p>o;o++)this.bonds[o].contains(i[j])&&(d=this.bonds[o].getNeighbor(i[j]),-1===i.indexOf(d)&&-1===m.indexOf(d)&&m.push(d));for(j=0,k=m.length;k>j;j++)i.push(m[j])}}if(0<l.length){for(h=void 0,j=0,k=l.length;k>j;j++)(!h||h.atoms.length>l[j].atoms.length)&&(h=l[j]);for(l=!1,j=0,k=this.rings.length;k>j;j++){for(i=!0,o=0,p=h.atoms.length;p>o;o++)if(-1===this.rings[j].atoms.indexOf(h.atoms[o])){i=!1;break}if(i){l=!0;break}}l||this.rings.push(h)}}}this.fuse()}}(ChemDoodle.informatics,ChemDoodle.structures),function(a){a.SSSRFinder=function(b){if(this.rings=[],0<b.atoms.length){var c=new a.FrerejacqueNumberCounter(b).value,d=new a.EulerFacetRingFinder(b).rings;d.sort(function(a,b){return a.atoms.length-b.atoms.length});for(var e=0,f=b.bonds.length;f>e;e++)b.bonds[e].visited=!1;for(e=0,f=d.length;f>e;e++){b=!1;for(var g=0,h=d[e].bonds.length;h>g;g++)if(!d[e].bonds[g].visited){b=!0;break}if(b){for(g=0,h=d[e].bonds.length;h>g;g++)d[e].bonds[g].visited=!0;this.rings.push(d[e])}if(this.rings.length===c)break}}}}(ChemDoodle.informatics),function(a){a._Interpreter=function(){},a._Interpreter.prototype.fit=function(a,b,c){for(var d=a.length,e=[],f=0;b-d>f;f++)e.push(" ");return c?a+e.join(""):e.join("")+a}}(ChemDoodle.io),function(a,b,c,d,e,f){var g=/\s+/g,h=/\(|\)|\s+/g,i=/\'|\s+/g,j=/,|\'|\s+/g,k=/^\s+/,l=/[0-9]/g,m=/[0-9]|\+|\-/g,n=function(a){return 0!==a.length},o={P:[],A:[[0,.5,.5]],B:[[.5,0,.5]],C:[[.5,.5,0]],I:[[.5,.5,.5]],R:[[2/3,1/3,1/3],[1/3,2/3,2/3]],S:[[1/3,1/3,2/3],[2/3,2/3,1/3]],T:[[1/3,2/3,1/3],[2/3,1/3,2/3]],F:[[0,.5,.5],[.5,0,.5],[.5,.5,0]]},p=function(a){var b=0,c=0,d=0,e=0,f=a.indexOf("x"),g=a.indexOf("y"),h=a.indexOf("z");if(-1!==f&&(c++,f>0&&"+"!==a.charAt(f-1)&&(c*=-1)),-1!==g&&(d++,g>0&&"+"!==a.charAt(g-1)&&(d*=-1)),-1!==h&&(e++,h>0&&"+"!==a.charAt(h-1)&&(e*=-1)),2<a.length)for(f="+",g=0,h=a.length;h>g;g++){var i=a.charAt(g);"-"!==i&&"/"!==i||g!==a.length-1&&!a.charAt(g+1).match(l)||(f=i),i.match(l)&&("+"===f?b+=parseInt(i):"-"===f?b-=parseInt(i):"/"===f&&(b/=parseInt(i)))}return[b,c,d,e]};c.CIFInterpreter=function(){},(c.CIFInterpreter.prototype=new c._Interpreter).read=function(c,l,q,r){l=l?l:1,q=q?q:1,r=r?r:1;var s=new d.Molecule;if(!c)return s;for(var t,u,v,w,x=c.split("\n"),y=0,z=0,A=0,B=c=0,C=0,D="P",E=!0;0<x.length;)if(E?w=x.shift():E=!0,0<w.length)if(b.stringStartsWith(w,"_cell_length_a"))y=parseFloat(w.split(h)[1]);else if(b.stringStartsWith(w,"_cell_length_b"))z=parseFloat(w.split(h)[1]);else if(b.stringStartsWith(w,"_cell_length_c"))A=parseFloat(w.split(h)[1]);else if(b.stringStartsWith(w,"_cell_angle_alpha"))c=e.PI*parseFloat(w.split(h)[1])/180;else if(b.stringStartsWith(w,"_cell_angle_beta"))B=e.PI*parseFloat(w.split(h)[1])/180;else if(b.stringStartsWith(w,"_cell_angle_gamma"))C=e.PI*parseFloat(w.split(h)[1])/180;else if(b.stringStartsWith(w,"_symmetry_space_group_name_H-M"))D=w.split(i)[1];else if(b.stringStartsWith(w,"loop_")){for(var F={fields:[],lines:[]},G=!1;void 0!==(w=x.shift())&&!b.stringStartsWith(w=w.replace(k,""),"loop_")&&0<w.length;)if(b.stringStartsWith(w,"_")){if(G)break;F.fields=F.fields.concat(w.split(g).filter(n))}else G=!0,F.lines.push(w);0!==x.length&&(b.stringStartsWith(w,"loop_")||b.stringStartsWith(w,"_"))&&(E=!1),-1!==F.fields.indexOf("_symmetry_equiv_pos_as_xyz")||-1!==F.fields.indexOf("_space_group_symop_operation_xyz")?t=F:-1!==F.fields.indexOf("_atom_site_label")?u=F:-1!==F.fields.indexOf("_geom_bond_atom_site_label_1")&&(v=F)}if(w=y,c=(e.cos(c)-e.cos(C)*e.cos(B))/e.sin(C),c=[w,0,0,0,z*e.cos(C),z*e.sin(C),0,0,A*e.cos(B),A*c,A*e.sqrt(1-e.pow(e.cos(B),2)-c*c),0,0,0,0,1],u){for(F=E=y=x=A=-1,C=0,B=u.fields.length;B>C;C++)w=u.fields[C],"_atom_site_type_symbol"===w?A=C:"_atom_site_label"===w?x=C:"_atom_site_fract_x"===w?y=C:"_atom_site_fract_y"===w?E=C:"_atom_site_fract_z"===w&&(F=C);for(C=0,B=u.lines.length;B>C;C++)w=u.lines[C],z=w.split(g).filter(n),w=new d.Atom(z[-1===A?x:A].split(m)[0],parseFloat(z[y]),parseFloat(z[E]),parseFloat(z[F])),s.atoms.push(w),-1!==x&&(w.cifId=z[x],w.cifPart=0)}if(t&&!v){for(C=z=0,B=t.fields.length;B>C;C++)w=t.fields[C],("_symmetry_equiv_pos_as_xyz"===w||"_space_group_symop_operation_xyz"===w)&&(z=C);for(E=o[D],x=[],C=0,B=t.lines.length;B>C;C++){w=t.lines[C].split(j).filter(n);for(var F=p(w[z]),G=p(w[z+1]),H=p(w[z+2]),D=0,y=s.atoms.length;y>D;D++){w=s.atoms[D];var I=w.x*F[1]+w.y*F[2]+w.z*F[3]+F[0],J=w.x*G[1]+w.y*G[2]+w.z*G[3]+G[0],K=w.x*H[1]+w.y*H[2]+w.z*H[3]+H[0];if(u=new d.Atom(w.label,I,J,K),x.push(u),void 0!==w.cifId&&(u.cifId=w.cifId,u.cifPart=C+1),E)for(u=0,A=E.length;A>u;u++){var L=E[u],L=new d.Atom(w.label,I+L[0],J+L[1],K+L[2]);x.push(L),void 0!==w.cifId&&(L.cifId=w.cifId,L.cifPart=C+1)}}}for(C=0,B=x.length;B>C;C++){for(w=x[C];1<=w.x;)w.x--;for(;0>w.x;)w.x++;for(;1<=w.y;)w.y--;for(;0>w.y;)w.y++;for(;1<=w.z;)w.z--;for(;0>w.z;)w.z++}for(u=[],C=0,B=x.length;B>C;C++){for(A=!1,w=x[C],D=0,y=s.atoms.length;y>D;D++)if(1e-4>s.atoms[D].distance3D(w)){A=!0;break}if(!A){for(D=0,y=u.length;y>D;D++)if(1e-4>u[D].distance3D(w)){A=!0;break}A||u.push(w)}}s.atoms=s.atoms.concat(u)}for(B=[],C=0;l>C;C++)for(D=0;q>D;D++)for(u=0;r>u;u++)if(0!==C||0!==D||0!==u)for(A=0,z=s.atoms.length;z>A;A++)w=s.atoms[A],x=new d.Atom(w.label,w.x+C,w.y+D,w.z+u),B.push(x),void 0!==w.cifId&&(x.cifId=w.cifId,x.cifPart=w.cifPart+(t?t.lines.length:0)+C+10*D+100*u);for(s.atoms=s.atoms.concat(B),C=0,B=s.atoms.length;B>C;C++)w=s.atoms[C],t=f.multiplyVec3(c,[w.x,w.y,w.z]),w.x=t[0],w.y=t[1],w.z=t[2];if(v){for(x=t=-1,C=0,B=v.fields.length;B>C;C++)w=v.fields[C],"_geom_bond_atom_site_label_1"===w?t=C:"_geom_bond_atom_site_label_2"===w&&(x=C);for(u=0,A=v.lines.length;A>u;u++)for(z=v.lines[u].split(g).filter(n),w=z[t],z=z[x],C=0,B=s.atoms.length;B>C;C++)for(D=C+1;B>D&&(y=s.atoms[C],E=s.atoms[D],y.cifPart===E.cifPart);D++)(y.cifId===w&&E.cifId===z||y.cifId===z&&E.cifId===w)&&s.bonds.push(new d.Bond(y,E))}else(new a.informatics.BondDeducer).deduceCovalentBonds(s,1);return l=[-l/2,-q/2,-r/2],s.unitCellVectors={o:f.multiplyVec3(c,l,[]),x:f.multiplyVec3(c,[l[0]+1,l[1],l[2]]),y:f.multiplyVec3(c,[l[0],l[1]+1,l[2]]),z:f.multiplyVec3(c,[l[0],l[1],l[2]+1]),xy:f.multiplyVec3(c,[l[0]+1,l[1]+1,l[2]]),xz:f.multiplyVec3(c,[l[0]+1,l[1],l[2]+1]),yz:f.multiplyVec3(c,[l[0],l[1]+1,l[2]+1]),xyz:f.multiplyVec3(c,[l[0]+1,l[1]+1,l[2]+1])},s};var q=new c.CIFInterpreter;a.readCIF=function(a,b,c,d){return q.read(a,b,c,d)}}(ChemDoodle,ChemDoodle.extensions,ChemDoodle.io,ChemDoodle.structures,Math,ChemDoodle.lib.mat4,ChemDoodle.lib.vec3),function(a,b,c,d){b.CMLInterpreter=function(){};var e=b.CMLInterpreter.prototype=new b._Interpreter;e.read=function(a){var b=[];a=d.parseXML(a),a=d(a).find("cml");for(var e=0,f=a.length;f>e;e++)for(var g=d(a[e]).find("molecule"),h=0,i=g.length;i>h;h++){for(var j=b[h]=new c.Molecule,k=[],l=d(g[h]).find("atom"),m=0,n=l.length;n>m;m++){var o,p,q,r=d(l[m]),s=r.attr("elementType");void 0==r.attr("x2")?(o=r.attr("x3"),p=r.attr("y3"),q=r.attr("z3")):(o=r.attr("x2"),p=r.attr("y2"),q=0),s=b[h].atoms[m]=new c.Atom(s,o,p,q),k[m]=r.attr("id"),void 0!=r.attr("formalCharge")&&(s.charge=r.attr("formalCharge"))}for(l=d(g[h]).find("bond"),m=0,n=l.length;n>m;m++){switch(r=d(l[m]),o=r.attr("atomRefs2").split(" "),s=j.atoms[d.inArray(o[0],k)],o=j.atoms[d.inArray(o[1],k)],r.attr("order")){case"2":case"D":p=2;break;case"3":case"T":p=3;break;case"A":p=1.5;break;default:p=1}switch(s=b[h].bonds[m]=new c.Bond(s,o,p),r.find("bondStereo").text()){case"W":s.stereo=c.Bond.STEREO_PROTRUDING;break;case"H":s.stereo=c.Bond.STEREO_RECESSED}}}return b},e.write=function(a){var b=[];b.push('<?xml version="1.0" encoding="UTF-8"?>\n'),b.push('<cml convention="conventions:molecular" xmlns="http://www.xml-cml.org/schema" xmlns:conventions="http://www.xml-cml.org/convention/" xmlns:dc="http://purl.org/dc/elements/1.1/">\n');for(var c=0,d=a.length;d>c;c++){b.push('<molecule id="m'),b.push(c),b.push('">'),b.push("<atomArray>");for(var e=0,f=a[c].atoms.length;f>e;e++){var g=a[c].atoms[e];b.push('<atom elementType="'),b.push(g.label),b.push('" id="a'),b.push(e),b.push('" '),b.push('x3="'),b.push(g.x),b.push('" y3="'),b.push(g.y),b.push('" z3="'),b.push(g.z),b.push('" '),0!=g.charge&&(b.push('formalCharge="'),b.push(g.charge),b.push('" ')),b.push("/>")}for(b.push("</atomArray>"),b.push("<bondArray>"),e=0,f=a[c].bonds.length;f>e;e++){switch(g=a[c].bonds[e],b.push('<bond atomRefs2="a'),b.push(a[c].atoms.indexOf(g.a1)),b.push(" a"),b.push(a[c].atoms.indexOf(g.a2)),b.push('" order="'),g.bondOrder){case 1.5:b.push("A");break;case 1:case 2:case 3:b.push(g.bondOrder);break;default:b.push("S")}b.push('"/>')}b.push("</bondArray>"),b.push("</molecule>")}return b.push("</cml>"),b.join("")};var f=new b.CMLInterpreter;a.readCML=function(a){return f.read(a)},a.writeCML=function(a){return f.write(a)}}(ChemDoodle,ChemDoodle.io,ChemDoodle.structures,ChemDoodle.lib.jQuery),function(a,b,c,d){c.MOLInterpreter=function(){};var e=c.MOLInterpreter.prototype=new c._Interpreter;e.read=function(c,e){e||(e=a.default_bondLength_2D);var f=new d.Molecule;if(!c)return f;for(var g=c.split("\n"),h=g[3],i=parseInt(h.substring(0,3)),h=parseInt(h.substring(3,6)),j=0;i>j;j++){var k=g[4+j];
f.atoms[j]=new d.Atom(k.substring(31,34),parseFloat(k.substring(0,10))*e,(1===e?1:-1)*parseFloat(k.substring(10,20))*e,parseFloat(k.substring(20,30))*e);var l=parseInt(k.substring(34,36));switch(0!==l&&b[f.atoms[j].label]&&(f.atoms[j].mass=b[f.atoms[j].label].mass+l),parseInt(k.substring(36,39))){case 1:f.atoms[j].charge=3;break;case 2:f.atoms[j].charge=2;break;case 3:f.atoms[j].charge=1;break;case 5:f.atoms[j].charge=-1;break;case 6:f.atoms[j].charge=-2;break;case 7:f.atoms[j].charge=-3}}for(j=0;h>j;j++){var k=g[4+i+j],m=parseInt(k.substring(6,9)),l=parseInt(k.substring(9,12));if(m>3)switch(m){case 4:m=1.5;break;default:m=1}switch(k=new d.Bond(f.atoms[parseInt(k.substring(0,3))-1],f.atoms[parseInt(k.substring(3,6))-1],m),l){case 3:k.stereo=d.Bond.STEREO_AMBIGUOUS;break;case 1:k.stereo=d.Bond.STEREO_PROTRUDING;break;case 6:k.stereo=d.Bond.STEREO_RECESSED}f.bonds[j]=k}return f},e.write=function(c){var e=[];e.push("Molecule from ChemDoodle Web Components\n\nhttp://www.ichemlabs.com\n"),e.push(this.fit(c.atoms.length.toString(),3)),e.push(this.fit(c.bonds.length.toString(),3)),e.push("  0  0  0  0            999 V2000\n");for(var f=c.getCenter(),g=0,h=c.atoms.length;h>g;g++){var i=c.atoms[g],j=" 0";if(-1!==i.mass&&b[i.label]){var k=i.mass-b[i.label].mass;5>k&&k>-4&&(j=(k>-1?" ":"")+k)}if(k="  0",0!==i.charge)switch(i.charge){case 3:k="  1";break;case 2:k="  2";break;case 1:k="  3";break;case-1:k="  5";break;case-2:k="  6";break;case-3:k="  7"}e.push(this.fit(((i.x-f.x)/a.default_bondLength_2D).toFixed(4),10)),e.push(this.fit((-(i.y-f.y)/a.default_bondLength_2D).toFixed(4),10)),e.push(this.fit((i.z/a.default_bondLength_2D).toFixed(4),10)),e.push(" "),e.push(this.fit(i.label,3,!0)),e.push(j),e.push(k),e.push("  0  0  0  0\n")}for(g=0,h=c.bonds.length;h>g;g++)i=c.bonds[g],f=0,i.stereo===d.Bond.STEREO_AMBIGUOUS?f=3:i.stereo===d.Bond.STEREO_PROTRUDING?f=1:i.stereo===d.Bond.STEREO_RECESSED&&(f=6),e.push(this.fit((c.atoms.indexOf(i.a1)+1).toString(),3)),e.push(this.fit((c.atoms.indexOf(i.a2)+1).toString(),3)),i=i.bondOrder,1.5==i?i=4:(i>3||0!=i%1)&&(i=1),e.push(this.fit(i,3)),e.push("  "),e.push(f),e.push("     0  0\n");return e.push("M  END"),e.join("")};var f=new c.MOLInterpreter;a.readMOL=function(a,b){return f.read(a,b)},a.writeMOL=function(a){return f.write(a)}}(ChemDoodle,ChemDoodle.ELEMENT,ChemDoodle.io,ChemDoodle.structures),function(a,b,c,d,e,f,g){function h(a,b,c,d,e){for(var f=0,g=b.length;g>f;f++){var h=b[f];if(h.id===c&&d>=h.start&&d<=h.end){e?a.helix=!0:a.sheet=!0,d+1===h.end&&(a.arrow=!0);break}}}c.PDBInterpreter=function(){};var i=c.PDBInterpreter.prototype=new c._Interpreter;i.calculateRibbonDistances=!1,i.deduceResidueBonds=!1,i.read=function(c,i){var j=new d.Molecule;if(j.chains=[],!c)return j;var k=c.split("\n");i||(i=1);for(var l,m=[],n=[],o=[],p=[],q=[],r=0,s=k.length;s>r;r++){var t=k[r];if(b.stringStartsWith(t,"HELIX"))m.push({id:t.substring(19,20),start:parseInt(t.substring(21,25)),end:parseInt(t.substring(33,37))});else if(b.stringStartsWith(t,"SHEET"))n.push({id:t.substring(21,22),start:parseInt(t.substring(22,26)),end:parseInt(t.substring(33,37))});else if(b.stringStartsWith(t,"ATOM")){var u=t.substring(16,17);if(" "===u||"A"===u){if(u=f(t.substring(76,78)),0===u.length){var v=f(t.substring(12,14));"HD"===v?u="H":0<v.length&&(u=1<v.length?v.charAt(0)+v.substring(1).toLowerCase():v)}v=new d.Atom(u,parseFloat(t.substring(30,38))*i,parseFloat(t.substring(38,46))*i,parseFloat(t.substring(46,54))*i),v.hetatm=!1,p.push(v);var w=parseInt(t.substring(22,26));if(0===o.length)for(u=0;2>u;u++){var x=new d.Residue(-1);x.cp1=v,x.cp2=v,o.push(x)}w!==Number.NaN&&o[o.length-1].resSeq!==w&&(u=new d.Residue(w),u.name=f(t.substring(17,20)),3===u.name.length?u.name=u.name.substring(0,1)+u.name.substring(1).toLowerCase():2===u.name.length&&"D"===u.name.charAt(0)&&(u.name=u.name.substring(1)),o.push(u),x=t.substring(21,22),h(u,m,x,w,!0),h(u,n,x,w,!1)),t=f(t.substring(12,16)),u=o[o.length-1],"CA"===t||"P"===t||"O5'"===t?u.cp1||(u.cp1=v):"N3"===t&&("C"===u.name||"U"===u.name||"T"===u.name)||"N1"===t&&("A"===u.name||"G"===u.name)?u.cp3=v:"C2"===t?u.cp4=v:"C4"===t&&("C"===u.name||"U"===u.name||"T"===u.name)||"C6"===t&&("A"===u.name||"G"===u.name)?u.cp5=v:"O"===t||"C6"===t&&("C"===u.name||"U"===u.name||"T"===u.name)||"N9"===t?o[o.length-1].cp2||(("C6"===t||"N9"===t)&&(l=v),u.cp2=v):"C"===t&&(l=v)}}else if(b.stringStartsWith(t,"HETATM"))u=f(t.substring(76,78)),0===u.length&&(u=f(t.substring(12,16))),1<u.length&&(u=u.substring(0,1)+u.substring(1).toLowerCase()),u=new d.Atom(u,parseFloat(t.substring(30,38))*i,parseFloat(t.substring(38,46))*i,parseFloat(t.substring(46,54))*i),u.hetatm=!0,"HOH"===f(t.substring(17,20))&&(u.isWater=!0),j.atoms.push(u),q[parseInt(f(t.substring(6,11)))]=u;else if(b.stringStartsWith(t,"CONECT")){if(u=parseInt(f(t.substring(6,11))),q[u])for(v=q[u],w=0;4>w;w++)if(u=f(t.substring(11+5*w,16+5*w)),0!==u.length&&(u=parseInt(u),q[u])){for(var x=q[u],y=!1,u=0,z=j.bonds.length;z>u;u++){var A=j.bonds[u];if(A.a1===v&&A.a2===x||A.a1===x&&A.a2===v){y=!0;break}}y||j.bonds.push(new d.Bond(v,x))}}else if(b.stringStartsWith(t,"TER"))this.endChain(j,o,l,p),o=[];else if(b.stringStartsWith(t,"ENDMDL"))break}if(this.endChain(j,o,l,p),0===j.bonds.size&&(new a.informatics.BondDeducer).deduceCovalentBonds(j,i),this.deduceResidueBonds)for(r=0,s=p.length;s>r;r++)for(k=g.min(s,r+20),u=r+1;k>u;u++)m=p[r],n=p[u],m.distance3D(n)<1.1*(e[m.label].covalentRadius+e[n.label].covalentRadius)&&j.bonds.push(new d.Bond(m,n,1));return j.atoms=j.atoms.concat(p),this.calculateRibbonDistances&&this.calculateDistances(j,p),j},i.endChain=function(a,b,c,e){if(0<b.length){var f=b[b.length-1];for(f.cp1||(f.cp1=e[e.length-2]),f.cp2||(f.cp2=e[e.length-1]),e=0;4>e;e++)f=new d.Residue(-1),f.cp1=c,f.cp2=b[b.length-1].cp2,b.push(f);a.chains.push(b)}},i.calculateDistances=function(a,b){for(var c=[],d=0,e=a.atoms.length;e>d;d++){var f=a.atoms[d];f.hetatm&&(f.isWater||c.push(f))}for(d=0,e=b.length;e>d;d++)if(f=b[d],f.closestDistance=Number.POSITIVE_INFINITY,0===c.length)f.closestDistance=0;else for(var g=0,h=c.length;h>g;g++)f.closestDistance=Math.min(f.closestDistance,f.distance3D(c[g]))};var j=new c.PDBInterpreter;a.readPDB=function(a,b){return j.read(a,b)}}(ChemDoodle,ChemDoodle.extensions,ChemDoodle.io,ChemDoodle.structures,ChemDoodle.ELEMENT,ChemDoodle.lib.jQuery.trim,Math),function(a,b,c,d,e,f){var g={"@":0,A:1,B:2,C:3,D:4,E:5,F:6,G:7,H:8,I:9,a:-1,b:-2,c:-3,d:-4,e:-5,f:-6,g:-7,h:-8,i:-9},h={"%":0,J:1,K:2,L:3,M:4,N:5,O:6,P:7,Q:8,R:9,j:-1,k:-2,l:-3,m:-4,n:-5,o:-6,p:-7,q:-8,r:-9},i={S:1,T:2,U:3,V:4,W:5,X:6,Y:7,Z:8,s:9};c.JCAMPInterpreter=function(){},e=c.JCAMPInterpreter.prototype=new c._Interpreter,e.convertHZ2PPM=!1,e.read=function(a){this.isBreak=function(a){return void 0!==g[a]||void 0!==h[a]||void 0!==i[a]||" "===a||"-"===a||"+"===a},this.getValue=function(a,b){var c=a.charAt(0),d=a.substring(1);return void 0!==g[c]?parseFloat(g[c]+d):void 0!==h[c]?parseFloat(h[c]+d)+b:parseFloat(d)};var c=new d.Spectrum;if(void 0===a||0===a.length)return c;a=a.split("\n");for(var e,j,k,l,m=[],n=1,o=1,p=1,q=-1,r=-1,s=-1,t=!0,u=!1,v=0,w=a.length;w>v;v++){var x=f(a[v]),y=x.indexOf("$$");if(-1!==y&&(x=x.substring(0,y)),0!==m.length&&b.stringStartsWith(a[v],"##")){if(y=m.join(""),t&&100>y.length&&c.metadata.push(y),m=[x],b.stringStartsWith(y,"##TITLE="))c.title=f(y.substring(8));else if(b.stringStartsWith(y,"##XUNITS="))c.xUnit=f(y.substring(9)),this.convertHZ2PPM&&"HZ"===c.xUnit.toUpperCase()&&(c.xUnit="PPM",u=!0);else if(b.stringStartsWith(y,"##YUNITS="))c.yUnit=f(y.substring(9));else if(!b.stringStartsWith(y,"##XYPAIRS="))if(b.stringStartsWith(y,"##FIRSTX="))j=parseFloat(f(y.substring(9)));else if(b.stringStartsWith(y,"##LASTX="))e=parseFloat(f(y.substring(8)));else if(b.stringStartsWith(y,"##FIRSTY="))k=parseFloat(f(y.substring(9)));else if(b.stringStartsWith(y,"##NPOINTS="))l=parseFloat(f(y.substring(10)));else if(b.stringStartsWith(y,"##XFACTOR="))n=parseFloat(f(y.substring(10)));else if(b.stringStartsWith(y,"##YFACTOR="))o=parseFloat(f(y.substring(10)));else if(b.stringStartsWith(y,"##DELTAX="))q=parseFloat(f(y.substring(9)));else if(b.stringStartsWith(y,"##.OBSERVE FREQUENCY="))this.convertHZ2PPM&&(p=parseFloat(f(y.substring(21))));else if(b.stringStartsWith(y,"##.SHIFT REFERENCE="))this.convertHZ2PPM&&(s=y.substring(19).split(","),r=parseInt(f(s[2])),s=parseFloat(f(s[3])));else if(b.stringStartsWith(y,"##XYDATA=")){u||(p=1);var x=t=!1,y=y.split("\n"),z=(e-j)/(l-1);if(-1!==q)for(var A=1,B=y.length;B>A;A++)if("|"===y[A].charAt(0)){z=q;break}for(var C,D=j-z,E=k,F=0,A=1,B=y.length;B>A;A++){for(var G=[],D=f(y[A]),m=[],H=!1,I=0,J=D.length;J>I;I++)this.isBreak(D.charAt(I))?(0<m.length&&!(1===m.length&&" "===m[0])&&G.push(m.join("")),m=[D.charAt(I)]):"|"===D.charAt(I)?H=!0:m.push(D.charAt(I));for(G.push(m.join("")),D=parseFloat(G[0])*n-z,I=1,J=G.length;J>I;I++)if(E=G[I],void 0!==i[E.charAt(0)])for(var K=parseInt(i[E.charAt(0)]+E.substring(1))-1,L=0;K>L;L++)D+=z,F=this.getValue(C,F),E=F*o,M++,c.data[c.data.length-1]=new d.Point(D/p,E);else void 0!==g[E.charAt(0)]&&x?(E=this.getValue(E,F)*o,H&&(D+=z,c.data.push(new d.Point(D/p,E)))):(x=void 0!==h[E.charAt(0)],C=E,D+=z,F=this.getValue(E,F),E=F*o,M++,c.data.push(new d.Point(D/p,E)))}if(-1!==r)for(x=s-c.data[r-1].x,v=0,w=c.data.length;w>v;v++)c.data[v].x+=x}else if(b.stringStartsWith(y,"##PEAK TABLE=")){t=!1,c.continuous=!1;for(var y=y.split("\n"),M=0,A=1,B=y.length;B>A;A++)for(x=y[A].split(/[\s,]+/),M+=x.length/2,I=0,J=x.length;J>I+1;I+=2)c.data.push(new d.Point(parseFloat(f(x[I])),parseFloat(f(x[I+1]))))}}else 0!==m.length&&m.push("\n"),m.push(f(x))}return c.setup(),c};var j=new c.JCAMPInterpreter;j.convertHZ2PPM=!0,a.readJCAMP=function(a){return j.read(a)}}(ChemDoodle,ChemDoodle.extensions,ChemDoodle.io,ChemDoodle.structures,ChemDoodle.lib.jQuery,ChemDoodle.lib.jQuery.trim),function(a,b,c,d,e,f){b.JSONInterpreter=function(){};var g=b.JSONInterpreter.prototype;g.contentTo=function(a,b){for(var c=0,d=0,e=0,f=a.length;f>e;e++){for(var g=a[e],h=0,i=g.atoms.length;i>h;h++)g.atoms[h].tmpid="a"+c++;for(h=0,i=g.bonds.length;i>h;h++)g.bonds[h].tmpid="b"+d++}for(e=c=0,f=b.length;f>e;e++)b[e].tmpid="s"+c++;if(c={},a&&0<a.length)for(c.m=[],e=0,f=a.length;f>e;e++)c.m.push(this.molTo(a[e]));if(b&&0<b.length)for(c.s=[],e=0,f=b.length;f>e;e++)c.s.push(this.shapeTo(b[e]));for(e=0,f=a.length;f>e;e++){for(g=a[e],h=0,i=g.atoms.length;i>h;h++)g.atoms[h].tmpid=void 0;for(h=0,i=g.bonds.length;i>h;h++)g.bonds[h].tmpid=void 0}for(e=0,f=b.length;f>e;e++)b[e].tmpid=void 0;return c},g.contentFrom=function(a){var b={molecules:[],shapes:[]};if(a.m)for(var c=0,d=a.m.length;d>c;c++)b.molecules.push(this.molFrom(a.m[c]));if(a.s)for(c=0,d=a.s.length;d>c;c++)b.shapes.push(this.shapeFrom(a.s[c],b.molecules));for(c=0,d=b.molecules.length;d>c;c++){a=b.molecules[c];for(var e=0,f=a.atoms.length;f>e;e++)a.atoms[e].tmpid=void 0;for(e=0,f=a.bonds.length;f>e;e++)a.bonds[e].tmpid=void 0}for(c=0,d=b.shapes.length;d>c;c++)b.shapes[c].tmpid=void 0;return b},g.molTo=function(a){for(var b={a:[]},d=0,e=a.atoms.length;e>d;d++){var f=a.atoms[d],g={x:f.x,y:f.y};f.tmpid&&(g.i=f.tmpid),"C"!==f.label&&(g.l=f.label),0!==f.z&&(g.z=f.z),0!==f.charge&&(g.c=f.charge),-1!==f.mass&&(g.m=f.mass),0!==f.numRadical&&(g.r=f.numRadical),0!==f.numLonePair&&(g.p=f.numLonePair),f.any&&(g.q=!0),-1!==f.rgroup&&(g.rg=f.rgroup),b.a.push(g)}if(0<a.bonds.length)for(b.b=[],d=0,e=a.bonds.length;e>d;d++)f=a.bonds[d],g={b:a.atoms.indexOf(f.a1),e:a.atoms.indexOf(f.a2)},f.tmpid&&(g.i=f.tmpid),1!==f.bondOrder&&(g.o=f.bondOrder),f.stereo!==c.Bond.STEREO_NONE&&(g.s=f.stereo),b.b.push(g);return b},g.molFrom=function(a){for(var b=new c.Molecule,d=0,e=a.a.length;e>d;d++){var f=a.a[d],g=new c.Atom(f.l?f.l:"C",f.x,f.y);f.i&&(g.tmpid=f.i),f.z&&(g.z=f.z),f.c&&(g.charge=f.c),f.m&&(g.mass=f.m),f.r&&(g.numRadical=f.r),f.p&&(g.numLonePair=f.p),f.q&&(g.any=!0),f.rg&&(g.rgroup=f.rg),void 0!==f.p_h&&(g.hetatm=f.p_h),void 0!==f.p_w&&(g.isWater=f.p_w),void 0!==f.p_d&&(g.closestDistance=f.p_d),b.atoms.push(g)}if(a.b)for(d=0,e=a.b.length;e>d;d++)f=a.b[d],g=new c.Bond(b.atoms[f.b],b.atoms[f.e],void 0===f.o?1:f.o),f.i&&(g.tmpid=f.i),f.s&&(g.stereo=f.s),b.bonds.push(g);return b},g.shapeTo=function(a){var b={};return a.tmpid&&(b.i=a.tmpid),a instanceof d.Line?(b.t="Line",b.x1=a.p1.x,b.y1=a.p1.y,b.x2=a.p2.x,b.y2=a.p2.y,b.a=a.arrowType):a instanceof d.Pusher?(b.t="Pusher",b.o1=a.o1.tmpid,b.o2=a.o2.tmpid,1!==a.numElectron&&(b.e=a.numElectron)):a instanceof d.Bracket?(b.t="Bracket",b.x1=a.p1.x,b.y1=a.p1.y,b.x2=a.p2.x,b.y2=a.p2.y,0!==a.charge&&(b.c=a.charge),0!==a.mult&&(b.m=a.mult),0!==a.repeat&&(b.r=a.repeat)):a instanceof e.Distance?(b.t="Distance",b.a1=a.a1.tmpid,b.a2=a.a2.tmpid,a.node&&(b.n=a.node,b.o=a.offset)):a instanceof e.Angle?(b.t="Angle",b.a1=a.a1.tmpid,b.a2=a.a2.tmpid,b.a3=a.a3.tmpid):a instanceof e.Torsion&&(b.t="Torsion",b.a1=a.a1.tmpid,b.a2=a.a2.tmpid,b.a3=a.a3.tmpid,b.a4=a.a4.tmpid),b},g.shapeFrom=function(a,b){var f;if("Line"===a.t)f=new d.Line(new c.Point(a.x1,a.y1),new c.Point(a.x2,a.y2)),f.arrowType=a.a;else if("Pusher"===a.t){var g,h;f=0;for(var i=b.length;i>f;f++){for(var j=b[f],k=0,l=j.atoms.length;l>k;k++){var m=j.atoms[k];m.tmpid===a.o1?g=m:m.tmpid===a.o2&&(h=m)}for(k=0,l=j.bonds.length;l>k;k++){var n=j.bonds[k];n.tmpid===a.o1?g=n:n.tmpid===a.o2&&(h=n)}}f=new d.Pusher(g,h),a.e&&(f.numElectron=a.e)}else if("Bracket"===a.t)f=new d.Bracket(new c.Point(a.x1,a.y1),new c.Point(a.x2,a.y2)),void 0!==a.c&&(f.charge=a.c),void 0!==a.m&&(f.mult=a.m),void 0!==a.r&&(f.repeat=a.r);else if("Distance"===a.t){var o;for(f=0,i=b.length;i>f;f++)for(j=b[f],k=0,l=j.atoms.length;l>k;k++)m=j.atoms[k],m.tmpid===a.a1?n=m:m.tmpid===a.a2&&(o=m);f=new e.Distance(n,o,a.n,a.o)}else if("Angle"===a.t){var p;for(f=0,i=b.length;i>f;f++)for(j=b[f],k=0,l=j.atoms.length;l>k;k++)m=j.atoms[k],m.tmpid===a.a1?n=m:m.tmpid===a.a2?o=m:m.tmpid===a.a3&&(p=m);f=new e.Angle(n,o,p)}else if("Torsion"===a.t){var q;for(f=0,i=b.length;i>f;f++)for(j=b[f],k=0,l=j.atoms.length;l>k;k++)m=j.atoms[k],m.tmpid===a.a1?n=m:m.tmpid===a.a2?o=m:m.tmpid===a.a3?p=m:m.tmpid===a.a4&&(q=m);f=new e.Torsion(n,o,p,q)}return f},g.pdbFrom=function(a){var b=this.molFrom(a.mol);return b.findRings=!1,b.fromJSON=!0,b.chains=this.chainsFrom(a.ribbons),b},g.chainsFrom=function(a){for(var b=[],d=0,e=a.cs.length;e>d;d++){for(var f=a.cs[d],g=[],h=0,i=f.length;i>h;h++){var j=f[h],k=new c.Residue;k.name=j.n,k.cp1=new c.Atom("",j.x1,j.y1,j.z1),k.cp2=new c.Atom("",j.x2,j.y2,j.z2),j.x3&&(k.cp3=new c.Atom("",j.x3,j.y3,j.z3),k.cp4=new c.Atom("",j.x4,j.y4,j.z4),k.cp5=new c.Atom("",j.x5,j.y5,j.z5)),k.helix=j.h,k.sheet=j.s,k.arrow=j.a,g.push(k)}b.push(g)}return b};var h=new b.JSONInterpreter;a.readJSON=function(a){var b;try{b=f.parse(a)}catch(c){return}return b?b.m||b.s?h.contentFrom(b):b.a?{molecules:[h.molFrom(b)],shapes:[]}:{molecules:[],shapes:[]}:void 0},a.writeJSON=function(a,b){return f.stringify(h.contentTo(a,b))}}(ChemDoodle,ChemDoodle.io,ChemDoodle.structures,ChemDoodle.structures.d2,ChemDoodle.structures.d3,JSON),function(a,b,c){b.RXNInterpreter=function(){};var d=b.RXNInterpreter.prototype=new b._Interpreter;d.read=function(b,d){d||(d=a.default_bondLength_2D);var e,f=[];if(b){e=b.split("$MOL\n");for(var g=e[0].split("\n")[4],h=parseInt(g.substring(0,3)),g=parseInt(g.substring(3,6)),i=1,j=0,k=0,l=h+g;l>k;k++){f[k]=a.readMOL(e[i],d);var m=f[k].getBounds(),m=m.maxX-m.minX,j=j-(m+40);i++}for(k=0,l=h;l>k;k++){var m=f[k].getBounds(),m=m.maxX-m.minX,i=f[k].getCenter(),n=0;for(e=f[k].atoms.length;e>n;n++){var o=f[k].atoms[n];o.x+=j+m/2-i.x,o.y-=i.y}j+=m+40}for(e=new c.d2.Line(new c.Point(j,0),new c.Point(j+40,0)),j+=80,k=h,l=h+g;l>k;k++){for(m=f[k].getBounds(),m=m.maxX-m.minX,i=f[k].getCenter(),n=0;n<f[k].atoms.length;n++)o=f[k].atoms[n],o.x+=j+m/2-i.x,o.y-=i.y;j+=m+40}}else f.push(new c.Molecule),e=new c.d2.Line(new c.Point(-20,0),new c.Point(20,0));return e.arrowType=c.d2.Line.ARROW_SYNTHETIC,{molecules:f,shapes:[e]}},d.write=function(b,d){var e=[[],[]],f=void 0;if(b&&d){for(g=0,h=d.length;h>g;g++)if(d[g]instanceof c.d2.Line){f=d[g].getPoints();break}if(!f)return"";for(var g=0,h=b.length;h>g;g++)b[g].getCenter().x<f[1].x?e[0].push(b[g]):e[1].push(b[g]);for(f=[],f.push("$RXN\nReaction from ChemDoodle Web Components\n\nhttp://www.ichemlabs.com\n"),f.push(this.fit(e[0].length.toString(),3)),f.push(this.fit(e[1].length.toString(),3)),f.push("\n"),g=0;2>g;g++)for(var h=0,i=e[g].length;i>h;h++)f.push("$MOL\n"),f.push(a.writeMOL(e[g][h])),f.push("\n");return f.join("")}};var e=new b.RXNInterpreter;a.readRXN=function(a,b){return e.read(a,b)},a.writeRXN=function(a,b){return e.write(a,b)}}(ChemDoodle,ChemDoodle.io,ChemDoodle.structures),function(a,b,c,d,e,f){d.XYZInterpreter=function(){},b=d.XYZInterpreter.prototype=new d._Interpreter,b.deduceCovalentBonds=!0,b.read=function(b){var d=new e.Molecule;if(!b)return d;b=b.split("\n");for(var g=parseInt(f(b[0])),h=0;g>h;h++){var i=b[h+2].split(/\s+/g);d.atoms[h]=new e.Atom(isNaN(i[0])?i[0]:c[parseInt(i[0])-1],parseFloat(i[1]),parseFloat(i[2]),parseFloat(i[3]))}return this.deduceCovalentBonds&&(new a.informatics.BondDeducer).deduceCovalentBonds(d,1),d};var g=new d.XYZInterpreter;a.readXYZ=function(a){return g.read(a)}}(ChemDoodle,ChemDoodle.ELEMENT,ChemDoodle.SYMBOLS,ChemDoodle.io,ChemDoodle.structures,ChemDoodle.lib.jQuery.trim),ChemDoodle.monitor=function(a,b,c){var d={CANVAS_DRAGGING:void 0,CANVAS_OVER:void 0,ALT:!1,SHIFT:!1,META:!1};return a.supports_touch()||b(c).ready(function(){b(c).mousemove(function(a){d.CANVAS_DRAGGING&&d.CANVAS_DRAGGING.drag&&(d.CANVAS_DRAGGING.prehandleEvent(a),d.CANVAS_DRAGGING.drag(a))}),b(c).mouseup(function(a){d.CANVAS_DRAGGING&&d.CANVAS_DRAGGING!==d.CANVAS_OVER&&d.CANVAS_DRAGGING.mouseup&&(d.CANVAS_DRAGGING.prehandleEvent(a),d.CANVAS_DRAGGING.mouseup(a)),d.CANVAS_DRAGGING=void 0}),b(c).keydown(function(a){d.SHIFT=a.shiftKey,d.ALT=a.altKey,d.META=a.metaKey||a.ctrlKey;var b=d.CANVAS_OVER;d.CANVAS_DRAGGING&&(b=d.CANVAS_DRAGGING),b&&b.keydown&&(b.prehandleEvent(a),b.keydown(a))}),b(c).keypress(function(a){var b=d.CANVAS_OVER;d.CANVAS_DRAGGING&&(b=d.CANVAS_DRAGGING),b&&b.keypress&&(b.prehandleEvent(a),b.keypress(a))}),b(c).keyup(function(a){d.SHIFT=a.shiftKey,d.ALT=a.altKey,d.META=a.metaKey||a.ctrlKey;var b=d.CANVAS_OVER;d.CANVAS_DRAGGING&&(b=d.CANVAS_DRAGGING),b&&b.keyup&&(b.prehandleEvent(a),b.keyup(a))})}),d}(ChemDoodle.featureDetection,ChemDoodle.lib.jQuery,document),function(a,b,c,d,e,f,g,h,i,j){a._Canvas=function(){};var k=a._Canvas.prototype;k.molecules=void 0,k.shapes=void 0,k.emptyMessage=void 0,k.image=void 0,k.repaint=function(){if(!this.test){var a=h.getElementById(this.id);if(a.getContext){var b=a.getContext("2d");if(1!==this.pixelRatio&&a.width===this.width&&(a.width=this.width*this.pixelRatio,a.height=this.height*this.pixelRatio,b.scale(this.pixelRatio,this.pixelRatio)),this.image?b.drawImage(this.image,0,0):(this.specs.backgroundColor&&this.bgCache!==a.style.backgroundColor&&(a.style.backgroundColor=this.specs.backgroundColor,this.bgCache=a.style.backgroundColor),b.fillStyle=this.specs.backgroundColor,b.fillRect(0,0,this.width,this.height)),this.innerRepaint)this.innerRepaint(b);else if(0!==this.molecules.length||0!==this.shapes.length){b.save(),b.translate(this.width/2,this.height/2),b.rotate(this.specs.rotateAngle),b.scale(this.specs.scale,this.specs.scale),b.translate(-this.width/2,-this.height/2);for(var a=0,c=this.molecules.length;c>a;a++)this.molecules[a].check(!0),this.molecules[a].draw(b,this.specs);for(a=0,c=this.shapes.length;c>a;a++)this.shapes[a].draw(b,this.specs);b.restore()}else this.emptyMessage&&(b.fillStyle="#737683",b.textAlign="center",b.textBaseline="middle",b.font="18px Helvetica, Verdana, Arial, Sans-serif",b.fillText(this.emptyMessage,this.width/2,this.height/2));this.drawChildExtras&&this.drawChildExtras(b)}}},k.resize=function(b,c){var d=f("#"+this.id);if(d.attr({width:b,height:c}),d.css("width",b),d.css("height",c),this.width=b,this.height=c,a._Canvas3D&&this instanceof a._Canvas3D)this.gl.viewport(0,0,b,c),this.setupScene();else if(0<this.molecules.length){this.center();for(var d=0,e=this.molecules.length;e>d;d++)this.molecules[d].check()}this.repaint()},k.setBackgroundImage=function(a){this.image=new Image;var b=this;this.image.onload=function(){b.repaint()},this.image.src=a},k.loadMolecule=function(b){this.clear(),this.molecules.push(b),this.center(),a._Canvas3D&&this instanceof a._Canvas3D||b.check(),this.afterLoadContent&&this.afterLoadContent(),this.repaint()},k.loadContent=function(b,c){if(this.molecules=b?b:[],this.shapes=c?c:[],this.center(),!(a._Canvas3D&&this instanceof a._Canvas3D))for(var d=0,e=this.molecules.length;e>d;d++)this.molecules[d].check();this.afterLoadContent&&this.afterLoadContent(),this.repaint()},k.addMolecule=function(b){this.molecules.push(b),a._Canvas3D&&this instanceof a._Canvas3D||b.check(),this.repaint()},k.removeMolecule=function(a){this.molecules=f.grep(this.molecules,function(b){return b!==a}),this.repaint()},k.getMolecule=function(){return 0<this.molecules.length?this.molecules[0]:void 0},k.getMolecules=function(){return this.molecules},k.addShape=function(a){this.shapes.push(a),this.repaint()},k.removeShape=function(a){this.shapes=f.grep(this.shapes,function(b){return b!==a}),this.repaint()},k.getShapes=function(){return this.shapes},k.clear=function(){this.molecules=[],this.shapes=[],this.specs.scale=1,this.repaint()},k.center=function(){for(var a=this.getContentBounds(),b=new e.Point((this.width-a.minX-a.maxX)/2,(this.height-a.minY-a.maxY)/2),c=0,d=this.molecules.length;d>c;c++)for(var f=this.molecules[c],h=0,i=f.atoms.length;i>h;h++)f.atoms[h].add(b);for(c=0,d=this.shapes.length;d>c;c++)for(f=this.shapes[c].getPoints(),h=0,i=f.length;i>h;h++)f[h].add(b);this.specs.scale=1,b=a.maxX-a.minX,a=a.maxY-a.minY,(b>this.width||a>this.height)&&(this.specs.scale=.85*g.min(this.width/b,this.height/a))},k.bondExists=function(a,b){for(var c=0,d=this.molecules.length;d>c;c++)for(var e=this.molecules[c],f=0,g=e.bonds.length;g>f;f++){var h=e.bonds[f];if(h.contains(a)&&h.contains(b))return!0}return!1},k.getBond=function(a,b){for(var c=0,d=this.molecules.length;d>c;c++)for(var e=this.molecules[c],f=0,g=e.bonds.length;g>f;f++){var h=e.bonds[f];if(h.contains(a)&&h.contains(b))return h}},k.getMoleculeByAtom=function(a){for(var b=0,c=this.molecules.length;c>b;b++){var d=this.molecules[b];if(-1!==d.atoms.indexOf(a))return d}},k.getAllAtoms=function(){for(var a=[],b=0,c=this.molecules.length;c>b;b++)a=a.concat(this.molecules[b].atoms);return a},k.getAllPoints=function(){for(var a=[],b=0,c=this.molecules.length;c>b;b++)a=a.concat(this.molecules[b].atoms);for(b=0,c=this.shapes.length;c>b;b++)a=a.concat(this.shapes[b].getPoints());return a},k.getContentBounds=function(){for(var a=new c.Bounds,b=0,d=this.molecules.length;d>b;b++)a.expand(this.molecules[b].getBounds());for(b=0,d=this.shapes.length;d>b;b++)a.expand(this.shapes[b].getBounds());return a},k.create=function(c,k,l){if(this.id=c,this.width=k,this.height=l,this.molecules=[],this.shapes=[],h.getElementById(c)){var m=f("#"+c);k?m.attr("width",k):this.width=m.attr("width"),l?m.attr("height",l):this.height=m.attr("height"),m.attr("class","ChemDoodleWebComponent")}else{if(!a.featureDetection.supports_canvas_text()&&-1!=j.indexOf("MSIE"))return void h.writeln('<div style="border: 1px solid black;" width="'+k+'" height="'+l+'">Please install <a href="http://code.google.com/chrome/chromeframe/">Google Chrome Frame</a>, then restart Internet Explorer.</div>');h.writeln('<canvas class="ChemDoodleWebComponent" id="'+c+'" width="'+k+'" height="'+l+'" alt="ChemDoodle Web Component">This browser does not support HTML5/Canvas.</canvas>')}c=f("#"+c),c.css("width",this.width),c.css("height",this.height),this.pixelRatio=i.devicePixelRatio?i.devicePixelRatio:1,this.specs=new e.VisualSpecifications;var n=this;b.supports_touch()?(c.bind("touchstart",function(a){var c=(new Date).getTime();if(!b.supports_gesture()&&2===a.originalEvent.touches.length){var d=a.originalEvent.touches,f=new e.Point(d[0].pageX,d[0].pageY),d=new e.Point(d[1].pageX,d[1].pageY);n.implementedGestureDist=f.distance(d),n.implementedGestureAngle=f.angle(d),n.gesturestart&&(n.prehandleEvent(a),n.gesturestart(a))}n.lastTouch&&1===a.originalEvent.touches.length&&500>c-n.lastTouch?n.dbltap?(n.prehandleEvent(a),n.dbltap(a)):n.dblclick?(n.prehandleEvent(a),n.dblclick(a)):n.touchstart?(n.prehandleEvent(a),n.touchstart(a)):n.mousedown&&(n.prehandleEvent(a),n.mousedown(a)):n.touchstart?(n.prehandleEvent(a),n.touchstart(a),this.hold&&clearTimeout(this.hold),this.touchhold&&(this.hold=setTimeout(function(){n.touchhold(a)},1e3))):n.mousedown&&(n.prehandleEvent(a),n.mousedown(a)),n.lastTouch=c}),c.bind("touchmove",function(a){if(this.hold&&(clearTimeout(this.hold),this.hold=void 0),!b.supports_gesture()&&2===a.originalEvent.touches.length&&n.gesturechange){var c=a.originalEvent.touches,d=new e.Point(c[0].pageX,c[0].pageY),f=new e.Point(c[1].pageX,c[1].pageY),c=d.distance(f),d=d.angle(f);a.originalEvent.scale=c/n.implementedGestureDist,a.originalEvent.rotation=180*(n.implementedGestureAngle-d)/g.PI,n.prehandleEvent(a),n.gesturechange(a)}if(1<a.originalEvent.touches.length&&n.multitouchmove){for(d=a.originalEvent.touches.length,n.prehandleEvent(a),c=new e.Point(-a.offset.left*d,-a.offset.top*d),f=0;d>f;f++)c.x+=a.originalEvent.changedTouches[f].pageX,c.y+=a.originalEvent.changedTouches[f].pageY;c.x/=d,c.y/=d,a.p=c,n.multitouchmove(a,d)}else n.touchmove?(n.prehandleEvent(a),n.touchmove(a)):n.drag&&(n.prehandleEvent(a),n.drag(a))}),c.bind("touchend",function(a){this.hold&&(clearTimeout(this.hold),this.hold=void 0),!b.supports_gesture()&&n.implementedGestureDist&&(n.implementedGestureDist=void 0,n.implementedGestureAngle=void 0,n.gestureend&&(n.prehandleEvent(a),n.gestureend(a))),n.touchend?(n.prehandleEvent(a),n.touchend(a)):n.mouseup&&(n.prehandleEvent(a),n.mouseup(a)),250>(new Date).getTime()-n.lastTouch&&(n.tap?(n.prehandleEvent(a),n.tap(a)):n.click&&(n.prehandleEvent(a),n.click(a)))}),c.bind("gesturestart",function(a){n.gesturestart&&(n.prehandleEvent(a),n.gesturestart(a))}),c.bind("gesturechange",function(a){n.gesturechange&&(n.prehandleEvent(a),n.gesturechange(a))}),c.bind("gestureend",function(a){n.gestureend&&(n.prehandleEvent(a),n.gestureend(a))})):(c.click(function(a){switch(a.which){case 1:n.click&&(n.prehandleEvent(a),n.click(a));break;case 2:n.middleclick&&(n.prehandleEvent(a),n.middleclick(a));break;case 3:n.rightclick&&(n.prehandleEvent(a),n.rightclick(a))}}),c.dblclick(function(a){n.dblclick&&(n.prehandleEvent(a),n.dblclick(a))}),c.mousedown(function(a){switch(a.which){case 1:d.CANVAS_DRAGGING=n,n.mousedown&&(n.prehandleEvent(a),n.mousedown(a));break;case 2:n.middlemousedown&&(n.prehandleEvent(a),n.middlemousedown(a));break;case 3:n.rightmousedown&&(n.prehandleEvent(a),n.rightmousedown(a))}}),c.mousemove(function(a){!d.CANVAS_DRAGGING&&n.mousemove&&(n.prehandleEvent(a),n.mousemove(a))}),c.mouseout(function(a){d.CANVAS_OVER=void 0,n.mouseout&&(n.prehandleEvent(a),n.mouseout(a))}),c.mouseover(function(a){d.CANVAS_OVER=n,n.mouseover&&(n.prehandleEvent(a),n.mouseover(a))}),c.mouseup(function(a){switch(a.which){case 1:n.mouseup&&(n.prehandleEvent(a),n.mouseup(a));break;case 2:n.middlemouseup&&(n.prehandleEvent(a),n.middlemouseup(a));break;case 3:n.rightmouseup&&(n.prehandleEvent(a),n.rightmouseup(a))}}),c.mousewheel(function(a,b){n.mousewheel&&(n.prehandleEvent(a),n.mousewheel(a,b))})),this.subCreate&&this.subCreate()},k.prehandleEvent=function(a){a.originalEvent.changedTouches&&(a.pageX=a.originalEvent.changedTouches[0].pageX,a.pageY=a.originalEvent.changedTouches[0].pageY),a.preventDefault(),a.offset=f("#"+this.id).offset(),a.p=new e.Point(a.pageX-a.offset.left,a.pageY-a.offset.top)}}(ChemDoodle,ChemDoodle.featureDetection,ChemDoodle.math,ChemDoodle.monitor,ChemDoodle.structures,ChemDoodle.lib.jQuery,Math,document,window,navigator.userAgent),function(a,b){a._AnimatorCanvas=function(a,b,c){a&&this.create(a,b,c)};var c=a._AnimatorCanvas.prototype=new a._Canvas;c.timeout=33,c.startAnimation=function(){this.stopAnimation(),this.lastTime=(new Date).getTime();var a=this;this.nextFrame&&(this.handle=b.requestInterval(function(){var b=(new Date).getTime();a.nextFrame(b-a.lastTime),a.repaint(),a.lastTime=b},this.timeout))},c.stopAnimation=function(){this.handle&&(b.clearRequestInterval(this.handle),this.handle=void 0)},c.isRunning=function(){return void 0!==this.handle}}(ChemDoodle,ChemDoodle.animations),function(a,b){a.FileCanvas=function(a,c,d,e){a&&this.create(a,c,d),b.writeln('<br><form name="FileForm" enctype="multipart/form-data" method="POST" action="'+e+'" target="HiddenFileFrame"><input type="file" name="f" /><input type="submit" name="submitbutton" value="Show File" /></form><iframe id="HFF-'+a+'" name="HiddenFileFrame" height="0" width="0" style="display:none;" onLoad="GetMolFromFrame(\'HFF-'+a+"', "+a+')"></iframe>'),this.emptyMessage="Click below to load file",this.repaint()},a.FileCanvas.prototype=new a._Canvas}(ChemDoodle,document),function(a){a.HyperlinkCanvas=function(a,b,c,d,e,f){a&&this.create(a,b,c),this.urlOrFunction=d,this.color=e?e:"blue",this.size=f?f:2},a=a.HyperlinkCanvas.prototype=new a._Canvas,a.openInNewWindow=!0,a.hoverImage=void 0,a.drawChildExtras=function(a){this.e&&(this.hoverImage?a.drawImage(this.hoverImage,0,0):(a.strokeStyle=this.color,a.lineWidth=2*this.size,a.strokeRect(0,0,this.width,this.height)))},a.setHoverImage=function(a){this.hoverImage=new Image,this.hoverImage.src=a},a.click=function(){this.e=void 0,this.repaint(),this.urlOrFunction instanceof Function?this.urlOrFunction():this.openInNewWindow?window.open(this.urlOrFunction):location.href=this.urlOrFunction},a.mouseout=function(){this.e=void 0,this.repaint()},a.mouseover=function(a){this.e=a,this.repaint()}}(ChemDoodle),function(a,b,c,d){a.MolGrabberCanvas=function(a,b,e){a&&this.create(a,b,e),b=[],b.push('<br><input type="text" id="'),b.push(a),b.push('_query" size="32" value="" />'),b.push("<br><nobr>"),b.push('<select id="'),b.push(a),b.push('_select">'),b.push('<option value="chemexper">ChemExper'),b.push('<option value="chemspider">ChemSpider'),b.push('<option value="pubchem" selected>PubChem'),b.push("</select>"),b.push('<button id="'),b.push(a),b.push('_submit">Show Molecule</button>'),b.push("</nobr>"),d.getElementById(a),c("#"+a).after(b.join(""));var f=this;c("#"+a+"_submit").click(function(){f.search()}),c("#"+a+"_query").keypress(function(a){13===a.which&&f.search()}),this.emptyMessage="Enter search term below",this.repaint()},a=a.MolGrabberCanvas.prototype=new a._Canvas,a.setSearchTerm=function(a){c("#"+this.id+"_query").val(a),this.search()},a.search=function(){this.emptyMessage="Searching...",this.clear();var a=this;b.getMoleculeFromDatabase(c("#"+this.id+"_query").val(),{database:c("#"+this.id+"_select").val()},function(b){a.loadMolecule(b)})}}(ChemDoodle,ChemDoodle.iChemLabs,ChemDoodle.lib.jQuery,document),function(a,b,c){var d=[],e=[1,0,0],f=[0,1,0],g=[0,0,1];a.RotatorCanvas=function(a,b,c,d){a&&this.create(a,b,c),this.rotate3D=d},a=a.RotatorCanvas.prototype=new a._AnimatorCanvas,b=b.PI/15,a.xIncrement=b,a.yIncrement=b,a.zIncrement=b,a.nextFrame=function(a){if(0===this.molecules.length&&0===this.shapes.length)this.stopAnimation();else if(a/=1e3,this.rotate3D){c.identity(d),c.rotate(d,this.xIncrement*a,e),c.rotate(d,this.yIncrement*a,f),c.rotate(d,this.zIncrement*a,g),a=0;for(var b=this.molecules.length;b>a;a++){for(var h=this.molecules[a],i=0,j=h.atoms.length;j>i;i++){var k=h.atoms[i],l=[k.x-this.width/2,k.y-this.height/2,k.z];c.multiplyVec3(d,l),k.x=l[0]+this.width/2,k.y=l[1]+this.height/2,k.z=l[2]}for(i=0,j=h.rings.length;j>i;i++)h.rings[i].center=h.rings[i].getCenter();this.specs.atoms_display&&this.specs.atoms_circles_2D&&h.sortAtomsByZ(),this.specs.bonds_display&&this.specs.bonds_clearOverlaps_2D&&h.sortBondsByZ()}for(a=0,b=this.shapes.length;b>a;a++)for(h=this.shapes[a].getPoints(),i=0,j=h.length;j>i;i++)k=h[i],l=[k.x-this.width/2,k.y-this.height/2,0],c.multiplyVec3(d,l),k.x=l[0]+this.width/2,k.y=l[1]+this.height/2
}else this.specs.rotateAngle+=this.zIncrement*a},a.dblclick=function(){this.isRunning()?this.stopAnimation():this.startAnimation()}}(ChemDoodle,Math,ChemDoodle.lib.mat4),function(a,b,c){a.SlideshowCanvas=function(a,b,c){a&&this.create(a,b,c)},a=a.SlideshowCanvas.prototype=new a._AnimatorCanvas,a.frames=[],a.curIndex=0,a.timeout=5e3,a.alpha=0,a.innerHandle=void 0,a.phase=0,a.drawChildExtras=function(a){var b=c.getRGB(this.specs.backgroundColor,255);a.fillStyle="rgba("+b[0]+", "+b[1]+", "+b[2]+", "+this.alpha+")",a.fillRect(0,0,this.width,this.height)},a.nextFrame=function(){if(0===this.frames.length)this.stopAnimation();else{this.phase=0;var a=this,b=1;this.innerHandle=setInterval(function(){a.alpha=b/15,a.repaint(),15===b&&a.breakInnerHandle(),b++},33)}},a.breakInnerHandle=function(){if(this.innerHandle&&(clearInterval(this.innerHandle),this.innerHandle=void 0),0===this.phase){this.curIndex++,this.curIndex>this.frames.length-1&&(this.curIndex=0),this.alpha=1;var a=this.frames[this.curIndex];this.loadContent(a.mols,a.shapes),this.phase=1;var b=this,c=1;this.innerHandle=setInterval(function(){b.alpha=(15-c)/15,b.repaint(),15===c&&b.breakInnerHandle(),c++},33)}else 1===this.phase&&(this.alpha=0,this.repaint())},a.addFrame=function(a,b){0===this.frames.length&&this.loadContent(a,b),this.frames.push({mols:a,shapes:b})}}(ChemDoodle,ChemDoodle.animations,ChemDoodle.math),function(a,b,c,d,e){a.TransformCanvas=function(a,b,c,d){a&&this.create(a,b,c),this.rotate3D=d},a=a.TransformCanvas.prototype=new a._Canvas,a.lastPoint=void 0,a.rotationMultMod=1.3,a.lastPinchScale=1,a.lastGestureRotate=0,a.mousedown=function(a){this.lastPoint=a.p},a.dblclick=function(){this.center(),this.repaint()},a.drag=function(a){if(!this.lastPoint.multi){if(b.ALT){var f=new c.Point(a.p.x,a.p.y);f.sub(this.lastPoint);for(var g=0,h=this.molecules.length;h>g;g++){for(var i=this.molecules[g],j=0,k=i.atoms.length;k>j;j++)i.atoms[j].add(f);i.check()}for(g=0,h=this.shapes.length;h>g;g++)for(i=this.shapes[g].getPoints(),j=0,k=i.length;k>j;j++)i[j].add(f);this.lastPoint=a.p}else if(!0===this.rotate3D)for(k=d.max(this.width/4,this.height/4),j=(a.p.x-this.lastPoint.x)/k*this.rotationMultMod,k=-(a.p.y-this.lastPoint.y)/k*this.rotationMultMod,f=[],e.identity(f),e.rotate(f,k,[1,0,0]),e.rotate(f,j,[0,1,0]),g=0,h=this.molecules.length;h>g;g++){for(i=this.molecules[g],j=0,k=i.atoms.length;k>j;j++)g=i.atoms[j],h=[g.x-this.width/2,g.y-this.height/2,g.z],e.multiplyVec3(f,h),g.x=h[0]+this.width/2,g.y=h[1]+this.height/2,g.z=h[2];for(g=0,h=i.rings.length;h>g;g++)i.rings[g].center=i.rings[g].getCenter();this.lastPoint=a.p,this.specs.atoms_display&&this.specs.atoms_circles_2D&&i.sortAtomsByZ(),this.specs.bonds_display&&this.specs.bonds_clearOverlaps_2D&&i.sortBondsByZ()}else k=new c.Point(this.width/2,this.height/2),j=k.angle(this.lastPoint),k=k.angle(a.p),this.specs.rotateAngle-=k-j,this.lastPoint=a.p;this.repaint()}},a.mousewheel=function(a,b){this.specs.scale+=b/50,.01>this.specs.scale&&(this.specs.scale=.01),this.repaint()},a.multitouchmove=function(a,b){if(2===b)if(this.lastPoint.multi){var d=new c.Point(a.p.x,a.p.y);d.sub(this.lastPoint);for(var e=0,f=this.molecules.length;f>e;e++){for(var g=this.molecules[e],h=0,i=g.atoms.length;i>h;h++)g.atoms[h].add(d);g.check()}for(e=0,f=this.shapes.length;f>e;e++)for(g=this.shapes[e].getPoints(),h=0,i=g.length;i>h;h++)g[h].add(d);this.lastPoint=a.p,this.lastPoint.multi=!0,this.repaint()}else this.lastPoint=a.p,this.lastPoint.multi=!0},a.gesturechange=function(a){if(0!==a.originalEvent.scale-this.lastPinchScale&&(this.specs.scale*=a.originalEvent.scale/this.lastPinchScale,.01>this.specs.scale&&(this.specs.scale=.01),this.lastPinchScale=a.originalEvent.scale),0!==this.lastGestureRotate-a.originalEvent.rotation){for(var b=(this.lastGestureRotate-a.originalEvent.rotation)/180*g.PI,d=new c.Point(this.width/2,this.height/2),e=0,f=this.molecules.length;f>e;e++){for(var g=this.molecules[e],h=0,i=g.atoms.length;i>h;h++){var j=g.atoms[h],k=d.distance(j),l=d.angle(j)+b;j.x=d.x+k*g.cos(l),j.y=d.y-k*g.sin(l)}g.check()}this.lastGestureRotate=a.originalEvent.rotation}this.repaint()},a.gestureend=function(){this.lastPinchScale=1,this.lastGestureRotate=0}}(ChemDoodle,ChemDoodle.monitor,ChemDoodle.structures,Math,ChemDoodle.lib.mat4),function(a){a.ViewerCanvas=function(a,b,c){a&&this.create(a,b,c)},a.ViewerCanvas.prototype=new a._Canvas}(ChemDoodle),function(a){a._SpectrumCanvas=function(a,b,c){a&&this.create(a,b,c)},a=a._SpectrumCanvas.prototype=new a._Canvas,a.spectrum=void 0,a.emptyMessage="No Spectrum Loaded or Recognized",a.loadMolecule=void 0,a.getMolecule=void 0,a.innerRepaint=function(a){this.spectrum&&0<this.spectrum.data.length?this.spectrum.draw(a,this.specs,this.width,this.height):this.emptyMessage&&(a.fillStyle="#737683",a.textAlign="center",a.textBaseline="middle",a.font="18px Helvetica, Verdana, Arial, Sans-serif",a.fillText(this.emptyMessage,this.width/2,this.height/2))},a.loadSpectrum=function(a){this.spectrum=a,this.repaint()},a.getSpectrum=function(){return this.spectrum},a.getSpectrumCoordinates=function(a,b){return spectrum.getInternalCoordinates(a,b,this.width,this.height)}}(ChemDoodle,document),function(a){a.ObserverCanvas=function(a,b,c){a&&this.create(a,b,c)},a.ObserverCanvas.prototype=new a._SpectrumCanvas}(ChemDoodle),function(a){a.OverlayCanvas=function(a,b,c){a&&this.create(a,b,c)},a=a.OverlayCanvas.prototype=new a._SpectrumCanvas,a.overlaySpectra=[],a.superRepaint=a.innerRepaint,a.innerRepaint=function(a){if(this.superRepaint(a),this.spectrum&&0<this.spectrum.data.length)for(var b=0,c=this.overlaySpectra.length;c>b;b++){var d=this.overlaySpectra[b];d&&0<d.data.length&&(d.minX=this.spectrum.minX,d.maxX=this.spectrum.maxX,d.drawPlot(a,this.specs,this.width,this.height,this.spectrum.memory.offsetTop,this.spectrum.memory.offsetLeft,this.spectrum.memory.offsetBottom))}},a.addSpectrum=function(a){this.spectrum?this.overlaySpectra.push(a):this.spectrum=a}}(ChemDoodle),function(a,b,c){a.PerspectiveCanvas=function(a,b,c){a&&this.create(a,b,c)};var d=a.PerspectiveCanvas.prototype=new a._SpectrumCanvas;d.dragRange=void 0,d.rescaleYAxisOnZoom=!0,d.lastPinchScale=1,d.mousedown=function(b){this.dragRange=new a.structures.Point(b.p.x,b.p.x)},d.mouseup=function(a){this.dragRange&&this.dragRange.x!==this.dragRange.y&&(this.dragRange.multi||(a=this.spectrum.zoom(this.dragRange.x,a.p.x,this.width,this.rescaleYAxisOnZoom),this.rescaleYAxisOnZoom&&(this.specs.scale=a)),this.dragRange=void 0,this.repaint())},d.drag=function(a){this.dragRange&&(this.dragRange.multi?this.dragRange=void 0:(b.SHIFT&&(this.spectrum.translate(a.p.x-this.dragRange.x,this.width),this.dragRange.x=a.p.x),this.dragRange.y=a.p.x),this.repaint())},d.drawChildExtras=function(a){if(this.dragRange){var b=c.min(this.dragRange.x,this.dragRange.y),d=c.max(this.dragRange.x,this.dragRange.y);for(a.strokeStyle="gray",a.lineStyle=1,a.beginPath(),a.moveTo(b,this.height/2);d>=b;b++)5>b%10?a.lineTo(b,c.round(this.height/2)):a.moveTo(b,c.round(this.height/2));a.stroke()}},d.mousewheel=function(a,b){this.specs.scale+=b/10,.01>this.specs.scale&&(this.specs.scale=.01),this.repaint()},d.dblclick=function(){this.spectrum.setup(),this.specs.scale=1,this.repaint()},d.multitouchmove=function(b,c){2===c&&(this.dragRange&&this.dragRange.multi?(this.spectrum.translate(b.p.x-this.dragRange.x,this.width),this.dragRange.x=b.p.x,this.dragRange.y=b.p.x,this.repaint()):(this.dragRange=new a.structures.Point(b.p.x,b.p.x),this.dragRange.multi=!0))},d.gesturechange=function(a){this.specs.scale*=a.originalEvent.scale/this.lastPinchScale,.01>this.specs.scale&&(this.specs.scale=.01),this.lastPinchScale=a.originalEvent.scale,this.repaint()},d.gestureend=function(){this.lastPinchScale=1}}(ChemDoodle,ChemDoodle.monitor,Math),function(a,b,c){a.SeekerCanvas=function(a,b,c,d){a&&this.create(a,b,c),this.seekType=d};var d=a.SeekerCanvas.prototype=new a._SpectrumCanvas;d.superRepaint=d.innerRepaint,d.innerRepaint=function(d){if(this.superRepaint(d),this.spectrum&&0<this.spectrum.data.length&&this.p){var e,f;if(this.seekType===a.SeekerCanvas.SEEK_POINTER)e=this.p,f=this.spectrum.getInternalCoordinates(e.x,e.y);else if(this.seekType===a.SeekerCanvas.SEEK_PLOT||this.seekType===a.SeekerCanvas.SEEK_PEAK){if(f=this.seekType===a.SeekerCanvas.SEEK_PLOT?this.spectrum.getClosestPlotInternalCoordinates(this.p.x):this.spectrum.getClosestPeakInternalCoordinates(this.p.x),!f)return;e={x:this.spectrum.getTransformedX(f.x,this.specs,this.width,this.spectrum.memory.offsetLeft),y:this.spectrum.getTransformedY(f.y/100,this.specs,this.height,this.spectrum.memory.offsetBottom,this.spectrum.memory.offsetTop)}}d.fillStyle="white",d.strokeStyle=this.specs.plots_color,d.lineWidth=this.specs.plots_width,d.beginPath(),d.arc(e.x,e.y,3,0,2*c.PI,!1),d.fill(),d.stroke(),d.font=b.getFontString(this.specs.text_font_size,this.specs.text_font_families),d.textAlign="left",d.textBaseline="bottom",f="x:"+f.x.toFixed(3)+", y:"+f.y.toFixed(3);var g=e.x+3,h=d.measureText(f).width;g+h>this.width-2&&(g-=6+h),e=e.y,0>e-this.specs.text_font_size-2&&(e+=this.specs.text_font_size),d.fillRect(g,e-this.specs.text_font_size,h,this.specs.text_font_size),d.fillStyle="black",d.fillText(f,g,e)}},d.mouseout=function(){this.p=void 0,this.repaint()},d.mousemove=function(a){this.p={x:a.p.x-2,y:a.p.y-3},this.repaint()},d.touchstart=function(a){this.mousemove(a)},d.touchmove=function(a){this.mousemove(a)},d.touchend=function(a){this.mouseout(a)},a.SeekerCanvas.SEEK_POINTER="pointer",a.SeekerCanvas.SEEK_PLOT="plot",a.SeekerCanvas.SEEK_PEAK="peak"}(ChemDoodle,ChemDoodle.extensions,Math),function(a,b,c,d,e,f,g,h,i,j,k,l){a._Canvas3D=function(a,b,c){a&&this.create(a,b,c)};var m=a._Canvas3D.prototype=new a._Canvas;m.rotationMatrix=void 0,m.translationMatrix=void 0,m.lastPoint=void 0,m.emptyMessage="WebGL is Unavailable!",m.lastPinchScale=1,m.lastGestureRotate=0,m.afterLoadContent=function(){for(var a=new c.Bounds,b=0,d=this.molecules.length;d>b;b++)a.expand(this.molecules[b].getBounds3D());var e=k.dist([a.maxX,a.maxY,a.maxZ],[a.minX,a.minY,a.minZ])/2+1.5,b=45,d=Math.tan(b/360*Math.PI)/.8;this.depth=e/d;var d=g.max(this.depth-e,.1),e=this.depth+e,f=this.gl.canvas.clientWidth/this.gl.canvas.clientHeight;1>f&&(b/=f),this.specs.projectionOrthoWidth_3D=2*Math.tan(b/360*Math.PI)*this.depth*f,this.specs.projectionPerspectiveVerticalFieldOfView_3D=b,this.specs.projectionFrontCulling_3D=d,this.specs.projectionBackCulling_3D=e,this.specs.projectionWidthHeightRatio_3D=f,this.translationMatrix=i.translate(i.identity([]),[0,0,-this.depth]),this.maxDimension=g.max(a.maxX-a.minX,a.maxY-a.minY),this.setupScene()},m.setViewDistance=function(a){this.specs.projectionPerspectiveVerticalFieldOfView_3D=c.clamp(this.specs.projectionPerspectiveVerticalFieldOfView_3D/a,.1,179.9),this.specs.projectionOrthoWidth_3D=2*g.tan(this.specs.projectionPerspectiveVerticalFieldOfView_3D/360*Math.PI)*this.depth*this.specs.projectionWidthHeightRatio_3D,this.updateScene()},m.repaint=function(){if(this.gl){this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT),this.gl.modelViewMatrix=i.multiply(this.translationMatrix,this.rotationMatrix,[]),this.gl.rotationMatrix=this.rotationMatrix;var a=this.gl.getUniformLocation(this.gl.program,"u_projection_matrix");this.gl.uniformMatrix4fv(a,!1,this.gl.projectionMatrix),this.gl.fogging.setMode(this.specs.fog_mode_3D);for(var b=0,c=this.molecules.length;c>b;b++)this.molecules[b].render(this.gl,this.specs);for(b=0,c=this.shapes.length;c>b;b++)this.shapes[b].render(this.gl,this.specs);this.specs.compass_display&&(this.gl.uniformMatrix4fv(a,!1,this.compass.projectionMatrix),this.compass.render(this.gl,this.specs),this.gl.setMatrixUniforms(this.gl.modelViewMatrix),this.gl.uniformMatrix4fv(a,!1,this.gl.projectionMatrix)),this.gl.enable(this.gl.BLEND),this.gl.depthMask(!1),this.gl.enableVertexAttribArray(this.gl.shader.vertexTexCoordAttribute),this.specs.atoms_displayLabels_3D&&this.label3D.render(this.gl,this.specs,this.getMolecules()),this.specs.compass_display&&this.specs.compass_displayText_3D&&(this.gl.uniformMatrix4fv(a,!1,this.compass.projectionMatrix),this.compass.renderAxis(this.gl),this.gl.setMatrixUniforms(this.gl.modelViewMatrix),this.gl.uniformMatrix4fv(a,!1,this.gl.projectionMatrix)),this.gl.disableVertexAttribArray(this.gl.shader.vertexTexCoordAttribute),this.gl.disable(this.gl.BLEND),this.gl.depthMask(!0),this.gl.disable(this.gl.DEPTH_TEST),this.drawChildExtras&&this.drawChildExtras(this.gl),this.gl.enable(this.gl.DEPTH_TEST),this.gl.flush()}},m.pick=function(a,b,c,d){if(this.gl){i.multiply(this.translationMatrix,this.rotationMatrix,this.gl.modelViewMatrix),this.gl.rotationMatrix=this.rotationMatrix;var e=this.gl.getUniformLocation(this.gl.program,"u_projection_matrix");return this.gl.uniformMatrix4fv(e,!1,this.gl.projectionMatrix),this.picker.pick(this.gl,this.molecules,this.specs,a,this.height-b,c,d)}},m.center=function(){for(var a=new d.Atom,b=0,c=this.molecules.length;c>b;b++){var e=this.molecules[b];a.add3D(e.getCenter3D())}for(a.x/=this.molecules.length,a.y/=this.molecules.length,b=0,c=this.molecules.length;c>b;b++){for(var e=this.molecules[b],f=0,g=e.atoms.length;g>f;f++)e.atoms[f].sub3D(a);if(e.chains&&e.fromJSON)for(f=0,g=e.chains.length;g>f;f++)for(var h=e.chains[f],i=0,j=h.length;j>i;i++){var k=h[i];k.cp1.sub3D(a),k.cp2.sub3D(a),k.cp3&&(k.cp3.sub3D(a),k.cp4.sub3D(a),k.cp5.sub3D(a))}}},m.subCreate=function(){try{var a=h.getElementById(this.id);this.gl=a.getContext("webgl"),this.gl||(this.gl=a.getContext("experimental-webgl"))}catch(b){}this.gl?(this.rotationMatrix=i.identity([]),this.translationMatrix=i.identity([]),this.gl.viewport(0,0,this.width,this.height),this.gl.program=this.gl.createProgram(),this.gl.shader=new e.Shader,this.gl.shader.init(this.gl),this.gl.programLabel=this.gl.createProgram(),this.setupScene()):this.displayMessage()},a._Canvas.prototype.displayMessage=function(){var a=h.getElementById(this.id);a.getContext&&(a=a.getContext("2d"),this.specs.backgroundColor&&(a.fillStyle=this.specs.backgroundColor,a.fillRect(0,0,this.width,this.height)),this.emptyMessage&&(a.fillStyle="#737683",a.textAlign="center",a.textBaseline="middle",a.font="18px Helvetica, Verdana, Arial, Sans-serif",a.fillText(this.emptyMessage,this.width/2,this.height/2)))},m.renderText=function(a,b){if(this.gl){var c={position:[],texCoord:[],translation:[]};this.gl.textImage.pushVertexData(a,b,0,c),this.gl.textMesh.storeData(this.gl,c.position,c.texCoord,c.translation),this.gl.enable(this.gl.BLEND),this.gl.depthMask(!1),this.gl.enableVertexAttribArray(this.gl.shader.vertexTexCoordAttribute),this.gl.textImage.useTexture(this.gl),this.gl.textMesh.render(this.gl),this.gl.disableVertexAttribArray(this.gl.shader.vertexTexCoordAttribute),this.gl.disable(this.gl.BLEND),this.gl.depthMask(!0)}},m.setupScene=function(){if(this.gl){l("#"+this.id).css("background-color",this.specs.backgroundColor);var h=c.getRGB(this.specs.backgroundColor,1);this.gl.clearColor(h[0],h[1],h[2],1),this.gl.clearDepth(1),this.gl.enable(this.gl.DEPTH_TEST),this.gl.depthFunc(this.gl.LEQUAL),this.gl.blendFuncSeparate(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA,this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA),this.specs.cullBackFace_3D&&this.gl.enable(this.gl.CULL_FACE),this.gl.sphereBuffer=new e.Sphere(1,this.specs.atoms_resolution_3D,this.specs.atoms_resolution_3D),this.gl.starBuffer=new e.Star,this.gl.cylinderBuffer=new e.Cylinder(1,1,this.specs.bonds_resolution_3D),this.gl.pillBuffer=new e.Pill(this.specs.bonds_pillDiameter_3D/2,this.specs.bonds_pillHeight_3D,this.specs.bonds_pillLatitudeResolution_3D,this.specs.bonds_pillLongitudeResolution_3D),this.gl.lineBuffer=new e.Line,this.gl.lineArrowBuffer=new e.LineArrow,this.gl.arrowBuffer=new e.Arrow(.3,this.specs.compass_resolution_3D),this.gl.textMesh=new e.TextMesh,this.gl.textMesh.init(this.gl),this.gl.textImage=new e.TextImage,this.gl.textImage.init(this.gl),this.gl.textImage.updateFont(this.gl,this.specs.text_font_size,this.specs.text_font_families,this.specs.text_font_bold,this.specs.text_font_italic,this.specs.text_font_stroke_3D),this.label3D=new e.Label,this.label3D.init(this.gl,this.specs);for(var m=0,n=this.molecules.length;n>m;m++)if(h=this.molecules[m],h.labelMesh instanceof e.TextMesh||(h.labelMesh=new e.TextMesh,h.labelMesh.init(this.gl)),h.unitCellVectors&&(h.unitCell=new e.UnitCell(h.unitCellVectors)),h.chains){h.ribbons=[],h.cartoons=[],h.tubes=[];for(var o=0,p=h.chains.length;p>o;o++){var q=h.chains[o],r=2<q.length&&f[q[2].name]&&"#BEA06E"===f[q[2].name].aminoColor;if(0<q.length&&!q[0].lineSegments){for(var s=0,t=q.length-1;t>s;s++)q[s].setup(q[s+1].cp1,r?1:this.specs.proteins_horizontalResolution);if(!r)for(s=1,t=q.length-1;t>s;s++)b.vec3AngleFrom(q[s-1].D,q[s].D)>g.PI/2&&(q[s].guidePointsSmall.reverse(),q[s].guidePointsLarge.reverse(),k.scale(q[s].D,-1));for(s=1,t=q.length-3;t>s;s++)q[s].computeLineSegments(q[s-1],q[s+1],q[s+2],!r,r?this.specs.nucleics_verticalResolution:this.specs.proteins_verticalResolution);q.pop(),q.pop(),q.pop(),q.shift()}var s=c.hsl2rgb(1===p?.5:o/p,1,.5),u="rgb("+s[0]+","+s[1]+","+s[2]+")";if(q.chainColor=u,r)s=new e.Tube(q,this.specs.nucleics_tubeThickness,this.specs.nucleics_tubeResolution_3D),s.chainColor=u,h.tubes.push(s);else{for(r={front:new e.Ribbon(q,this.specs.proteins_ribbonThickness,!1),back:new e.Ribbon(q,-this.specs.proteins_ribbonThickness,!1)},r.front.chainColor=u,r.back.chainColor=u,s=0,t=r.front.segments.length;t>s;s++)r.front.segments[s].chainColor=u;for(s=0,t=r.back.segments.length;t>s;s++)r.back.segments[s].chainColor=u;for(h.ribbons.push(r),q={front:new e.Ribbon(q,this.specs.proteins_ribbonThickness,!0),back:new e.Ribbon(q,-this.specs.proteins_ribbonThickness,!0)},q.front.chainColor=u,q.back.chainColor=u,s=0,t=q.front.segments.length;t>s;s++)q.front.segments[s].chainColor=u;for(s=0,t=q.back.segments.length;t>s;s++)q.back.segments[s].chainColor=u;for(s=0,t=q.front.cartoonSegments.length;t>s;s++)q.front.cartoonSegments[s].chainColor=u;for(s=0,t=q.back.cartoonSegments.length;t>s;s++)q.back.cartoonSegments[s].chainColor=u;h.cartoons.push(q)}}}if(this.label3D.updateVerticesBuffer(this.gl,this.getMolecules(),this.specs),this instanceof a.MovieCanvas3D&&this.frames)for(s=0,t=this.frames.length;t>s;s++){for(m=this.frames[s],o=0,p=m.mols.length;p>o;o++)h=m.mols[o],h.labelMesh instanceof d.d3.TextMesh||(h.labelMesh=new d.d3.TextMesh,h.labelMesh.init(this.gl));this.label3D.updateVerticesBuffer(this.gl,m.mols,this.specs)}this.gl.lighting=new e.Light(this.specs.lightDiffuseColor_3D,this.specs.lightSpecularColor_3D,this.specs.lightDirection_3D),this.gl.lighting.lightScene(this.gl),this.gl.material=new e.Material(this.gl),this.gl.fogging=new e.Fog(this.gl),this.gl.fogging.setTempParameter(this.specs.fog_color_3D||this.specs.backgroundColor,this.specs.fog_start_3D,this.specs.fog_end_3D,this.specs.fog_density_3D),this.compass=new e.Compass(this.gl,this.specs),h=this.width/this.height,this.specs.projectionWidthHeightRatio_3D&&(h=this.specs.projectionWidthHeightRatio_3D),this.gl.projectionMatrix=this.specs.projectionPerspective_3D?i.perspective(this.specs.projectionPerspectiveVerticalFieldOfView_3D,h,this.specs.projectionFrontCulling_3D,this.specs.projectionBackCulling_3D):i.ortho(-this.specs.projectionOrthoWidth_3D/2,this.specs.projectionOrthoWidth_3D/2,-this.specs.projectionOrthoWidth_3D/2/h,this.specs.projectionOrthoWidth_3D/2/h,this.specs.projectionFrontCulling_3D,this.specs.projectionBackCulling_3D),h=this.gl.getUniformLocation(this.gl.program,"u_projection_matrix"),this.gl.uniformMatrix4fv(h,!1,this.gl.projectionMatrix);var v=this.gl.getUniformLocation(this.gl.program,"u_model_view_matrix"),w=this.gl.getUniformLocation(this.gl.program,"u_normal_matrix");this.gl.setMatrixUniforms=function(a){this.uniformMatrix4fv(v,!1,a),a=j.transpose(i.toInverseMat3(a,[])),this.uniformMatrix3fv(w,!1,a)},o=this.gl.getUniformLocation(this.gl.program,"u_dimension"),this.gl.uniformMatrix4fv(h,!1,this.gl.projectionMatrix),this.gl.uniform2f(o,this.gl.canvas.clientWidth,this.gl.canvas.clientHeight),this.picker=new e.Picker,this.picker.init(this.gl),this.picker.setDimension(this.gl,this.width,this.height)}},m.updateScene=function(){this.gl.fogging.setTempParameter(this.specs.fog_color_3D||this.specs.backgroundColor,this.specs.fog_start_3D,this.specs.fog_end_3D,this.specs.fog_density_3D);var a=this.width/this.height;this.specs.projectionWidthHeightRatio_3D&&(a=this.specs.projectionWidthHeightRatio_3D),this.gl.projectionMatrix=this.specs.projectionPerspective_3D?i.perspective(this.specs.projectionPerspectiveVerticalFieldOfView_3D,a,this.specs.projectionFrontCulling_3D,this.specs.projectionBackCulling_3D):i.ortho(-this.specs.projectionOrthoWidth_3D/2,this.specs.projectionOrthoWidth_3D/2,-this.specs.projectionOrthoWidth_3D/2/a,this.specs.projectionOrthoWidth_3D/2/a,this.specs.projectionFrontCulling_3D,this.specs.projectionBackCulling_3D),this.repaint()},m.mousedown=function(a){this.lastPoint=a.p},m.mouseup=function(){this.lastPoint=void 0},m.rightmousedown=function(a){this.lastPoint=a.p},m.drag=function(b){if(this.lastPoint){if(a.monitor.ALT){var c=new d.Point(b.p.x,b.p.y);c.sub(this.lastPoint);var e=g.tan(this.specs.projectionPerspectiveVerticalFieldOfView_3D/360*g.PI),e=this.depth/(this.height/2/e);i.translate(this.translationMatrix,[c.x*e,-c.y*e,0])}else e=b.p.x-this.lastPoint.x,c=b.p.y-this.lastPoint.y,e=i.rotate(i.identity([]),e*g.PI/180,[0,1,0]),i.rotate(e,c*g.PI/180,[1,0,0]),this.rotationMatrix=i.multiply(e,this.rotationMatrix);this.lastPoint=b.p,this.repaint()}},m.mousewheel=function(a,b){var c=this.specs.projectionPerspectiveVerticalFieldOfView_3D+b;this.specs.projectionPerspectiveVerticalFieldOfView_3D=.1>c?.1:c>179.9?179.9:c,this.specs.projectionOrthoWidth_3D=2*Math.tan(this.specs.projectionPerspectiveVerticalFieldOfView_3D/360*Math.PI)*this.depth*this.specs.projectionWidthHeightRatio_3D,this.updateScene()},m.multitouchmove=function(a,b){if(2===b)if(this.lastPoint.multi){var c=new d.Point(a.p.x,a.p.y);c.sub(this.lastPoint);var e=g.tan(this.specs.projectionPerspectiveVerticalFieldOfView_3D/360*g.PI),e=this.depth/(this.height/2/e);i.translate(this.translationMatrix,[c.x*e,-c.y*e,0]),this.lastPoint=a.p,this.repaint()}else this.lastPoint=a.p,this.lastPoint.multi=!0},m.gesturechange=function(a){if(0!==a.originalEvent.scale-this.lastPinchScale){var b=this.specs.projectionPerspectiveVerticalFieldOfView_3D+30*-(a.originalEvent.scale/this.lastPinchScale-1);this.specs.projectionPerspectiveVerticalFieldOfView_3D=.1>b?.1:b>179.9?179.9:b,this.specs.projectionOrthoWidth_3D=2*Math.tan(this.specs.projectionPerspectiveVerticalFieldOfView_3D/360*Math.PI)*this.depth*this.specs.projectionWidthHeightRatio_3D,this.updateScene(),this.lastPinchScale=a.originalEvent.scale}this.repaint()},m.gestureend=function(){this.lastPinchScale=1,this.lastGestureRotate=0}}(ChemDoodle,ChemDoodle.extensions,ChemDoodle.math,ChemDoodle.structures,ChemDoodle.structures.d3,ChemDoodle.RESIDUE,Math,document,ChemDoodle.lib.mat4,ChemDoodle.lib.mat3,ChemDoodle.lib.vec3,ChemDoodle.lib.jQuery,window),function(a,b,c,d){a.MolGrabberCanvas3D=function(a,b,e){a&&this.create(a,b,e),b=[],b.push('<br><input type="text" id="'),b.push(a),b.push('_query" size="32" value="" />'),b.push("<br><nobr>"),b.push('<select id="'),b.push(a),b.push('_select">'),b.push('<option value="pubchem" selected>PubChem'),b.push("</select>"),b.push('<button id="'),b.push(a),b.push('_submit">Show Molecule</button>'),b.push("</nobr>"),d.writeln(b.join(""));var f=this;c("#"+a+"_submit").click(function(){f.search()}),c("#"+a+"_query").keypress(function(a){13===a.which&&f.search()})},a=a.MolGrabberCanvas3D.prototype=new a._Canvas3D,a.setSearchTerm=function(a){c("#"+this.id+"_query").val(a),this.search()},a.search=function(){var a=this;b.getMoleculeFromDatabase(c("#"+this.id+"_query").val(),{database:c("#"+this.id+"_select").val(),dimension:3},function(b){a.loadMolecule(b)})}}(ChemDoodle,ChemDoodle.iChemLabs,ChemDoodle.lib.jQuery,document),function(a,b){a.MovieCanvas3D=function(a,b,c){a&&this.create(a,b,c),this.frames=[]},a.MovieCanvas3D.PLAY_ONCE=0,a.MovieCanvas3D.PLAY_LOOP=1,a.MovieCanvas3D.PLAY_SPRING=2;var c=a.MovieCanvas3D.prototype=new a._Canvas3D;c.timeout=50,c.frameNumber=0,c.playMode=2,c.reverse=!1,c.startAnimation=a._AnimatorCanvas.prototype.startAnimation,c.stopAnimation=a._AnimatorCanvas.prototype.stopAnimation,c.isRunning=a._AnimatorCanvas.prototype.isRunning,c.dblclick=a.RotatorCanvas.prototype.dblclick,c.nextFrame=function(){var a=this.frames[this.frameNumber];this.molecules=a.mols,this.shapes=a.shapes,2===this.playMode&&this.reverse?(this.frameNumber--,0>this.frameNumber&&(this.frameNumber=1,this.reverse=!1)):(this.frameNumber++,this.frameNumber>=this.frames.length&&(2===this.playMode?(this.frameNumber-=2,this.reverse=!0):(this.frameNumber=0,0===this.playMode&&this.stopAnimation())))},c.center=function(){for(var a=new b.Atom,c=this.frames[0],d=0,e=c.mols.length;e>d;d++)a.add3D(c.mols[d].getCenter3D());a.x/=c.mols.length,a.y/=c.mols.length,c=new b.Atom,c.sub3D(a);for(var a=0,f=this.frames.length;f>a;a++)for(var g=this.frames[a],d=0,e=g.mols.length;e>d;d++)for(var h=g.mols[d],i=0,j=h.atoms.length;j>i;i++)h.atoms[i].add3D(c)},c.addFrame=function(a,b){this.frames.push({mols:a,shapes:b})}}(ChemDoodle,ChemDoodle.structures),function(a,b,c){var d=[],e=[1,0,0],f=[0,1,0],g=[0,0,1];a.RotatorCanvas3D=function(a,b,c){a&&this.create(a,b,c)};var h=a.RotatorCanvas3D.prototype=new a._Canvas3D;h.timeout=33,b=b.PI/15,h.xIncrement=b,h.yIncrement=b,h.zIncrement=b,h.startAnimation=a._AnimatorCanvas.prototype.startAnimation,h.stopAnimation=a._AnimatorCanvas.prototype.stopAnimation,h.isRunning=a._AnimatorCanvas.prototype.isRunning,h.dblclick=a.RotatorCanvas.prototype.dblclick,h.mousedown=void 0,h.rightmousedown=void 0,h.drag=void 0,h.mousewheel=void 0,h.nextFrame=function(a){0===this.molecules.length&&0===this.shapes.length?this.stopAnimation():(c.identity(d),a/=1e3,c.rotate(d,this.xIncrement*a,e),c.rotate(d,this.yIncrement*a,f),c.rotate(d,this.zIncrement*a,g),c.multiply(this.rotationMatrix,d))}}(ChemDoodle,Math,ChemDoodle.lib.mat4),function(a){a.TransformCanvas3D=function(a,b,c){a&&this.create(a,b,c)},a.TransformCanvas3D.prototype=new a._Canvas3D}(ChemDoodle),function(a){a.ViewerCanvas3D=function(a,b,c){a&&this.create(a,b,c)},a=a.ViewerCanvas3D.prototype=new a._Canvas3D,a.mousedown=void 0,a.rightmousedown=void 0,a.drag=void 0,a.mousewheel=void 0}(ChemDoodle),function(a,b,c){function d(a,b,c,d){this.element=a,this.x=b,this.y=c,this.dimension=d}a.PeriodicTableCanvas=function(a,b){this.padding=5,a&&this.create(a,18*b+2*this.padding,10*b+2*this.padding),this.cellDimension=b?b:20,this.setupTable(),this.repaint()};var e=a.PeriodicTableCanvas.prototype=new a._Canvas;e.loadMolecule=void 0,e.getMolecule=void 0,e.getHoveredElement=function(){return this.hovered?this.hovered.element:void 0},e.innerRepaint=function(a){for(var b=0,c=this.cells.length;c>b;b++)this.drawCell(a,this.specs,this.cells[b]);this.hovered&&this.drawCell(a,this.specs,this.hovered),this.selected&&this.drawCell(a,this.specs,this.selected)},e.setupTable=function(){this.cells=[];for(var b=this.padding,c=this.padding,e=0,f=0,g=a.SYMBOLS.length;g>f;f++){18===e&&(e=0,c+=this.cellDimension,b=this.padding);var h=a.ELEMENT[a.SYMBOLS[f]];2===h.atomicNumber?(b+=16*this.cellDimension,e+=16):(5===h.atomicNumber||13===h.atomicNumber)&&(b+=10*this.cellDimension,e+=10),(58>h.atomicNumber||71<h.atomicNumber&&90>h.atomicNumber||103<h.atomicNumber)&&113>h.atomicNumber&&(this.cells.push(new d(h,b,c,this.cellDimension)),b+=this.cellDimension,e++)}for(c+=2*this.cellDimension,b=3*this.cellDimension+this.padding,f=57;104>f;f++)h=a.ELEMENT[a.SYMBOLS[f]],90===h.atomicNumber&&(c+=this.cellDimension,b=3*this.cellDimension+this.padding),(58<=h.atomicNumber&&71>=h.atomicNumber||90<=h.atomicNumber&&103>=h.atomicNumber)&&(this.cells.push(new d(h,b,c,this.cellDimension)),b+=this.cellDimension)},e.drawCell=function(a,c,d){var e=a.createRadialGradient(d.x+d.dimension/3,d.y+d.dimension/3,1.5*d.dimension,d.x+d.dimension/3,d.y+d.dimension/3,d.dimension/10);e.addColorStop(0,"#000000"),e.addColorStop(.7,d.element.jmolColor),e.addColorStop(1,"#FFFFFF"),a.fillStyle=e,b.contextRoundRect(a,d.x,d.y,d.dimension,d.dimension,d.dimension/8),(d===this.hovered||d===this.selected)&&(a.lineWidth=2,a.strokeStyle="#c10000",a.stroke(),a.fillStyle="white"),a.fill(),a.font=b.getFontString(c.text_font_size,c.text_font_families),a.fillStyle=c.text_color,a.textAlign="center",a.textBaseline="middle",a.fillText(d.element.symbol,d.x+d.dimension/2,d.y+d.dimension/2)},e.click=function(){this.hovered&&(this.selected=this.hovered,this.repaint())},e.touchstart=function(a){this.mousemove(a)},e.mousemove=function(a){var b=a.p.x;a=a.p.y,this.hovered=void 0;for(var d=0,e=this.cells.length;e>d;d++){var f=this.cells[d];if(c.isBetween(b,f.x,f.x+f.dimension)&&c.isBetween(a,f.y,f.y+f.dimension)){this.hovered=f;break}}this.repaint()},e.mouseout=function(){this.hovered=void 0,this.repaint()}}(ChemDoodle,ChemDoodle.extensions,ChemDoodle.math,document),function(a,b,c){a.png={},a.png.create=function(a){c.open(b.getElementById(a.id).toDataURL("image/png"))}}(ChemDoodle.io,document,window),function(a,b){a.file={},a.file.content=function(a,c){b.get(a,"",c)}}(ChemDoodle.io,ChemDoodle.lib.jQuery),function(a,b,c,d,e,f){b.SERVER_URL="http://ichemlabs.cloud.chemdoodle.com/icl_cdc_v060001/WebHQ",b.inRelay=!1,b.asynchronous=!0,b.INFO={userAgent:navigator.userAgent,v_cwc:a.getVersion(),v_jQuery:e.version,v_jQuery_ui:e.ui?e.ui.version:"N/A"};var g=new c.JSONInterpreter,h=new d.Queue;b.useHTTPS=function(){b.SERVER_URL="https"+b.SERVER_URL.substr(4)},b._contactServer=function(a,c,d,f,g){this.inRelay?h.enqueue({call:a,content:c,options:d,callback:f,errorback:g}):(b.inRelay=!0,e.ajax({dataType:"text",type:"POST",data:JSON.stringify({call:a,content:c,options:d,info:b.INFO}),url:this.SERVER_URL,success:function(a){a=JSON.parse(a),a.message&&alert(a.message),b.inRelay=!1,f&&a.content&&!a.stop&&f(a.content),a.stop&&g&&g(),h.isEmpty()||(a=h.dequeue(),b.contactServer(a.call,a.content,a.options,a.callback,a.errorback))},error:function(){if("checkForUpdates"!=a&&alert("Call failed. Please try again. If you continue to see this message, please contact iChemLabs customer support."),b.inRelay=!1,g&&g(),!h.isEmpty()){var c=h.dequeue();b.contactServer(c.call,c.content,c.options,c.callback,c.errorback)}},xhrFields:{withCredentials:!0},async:b.asynchronous}))},b.authenticate=function(a,b,c,d){this._contactServer("authenticate",{credential:a},b,function(a){c(a)},d)},b.calculate=function(a,b,c,d){this._contactServer("calculate",{mol:g.molTo(a)},b,function(a){c(a)},d)},b.createLewisDotStructure=function(a,b,c,d){this._contactServer("createLewisDot",{mol:g.molTo(a)},b,function(a){c(g.molFrom(a.mol))},d)},b.generateImage=function(a,b,c,d){this._contactServer("generateImage",{mol:g.molTo(a)},b,function(a){c(a.link)},d)},b.generateIUPACName=function(a,b,c,d){this._contactServer("generateIUPACName",{mol:g.molTo(a)},b,function(a){c(a.iupac)},d)},b.getAd=function(a,b){this._contactServer("getAd",{},{},function(b){a(b.image_url,b.target_url)},b)},b.getMoleculeFromContent=function(a,b,c,d){this._contactServer("getMoleculeFromContent",{content:a},b,function(a){for(var b=!1,d=0,e=a.mol.a.length;e>d;d++)if(0!==a.mol.a[d].z){b=!0;break}if(b)for(d=0,e=a.mol.a.length;e>d;d++)a.mol.a[d].x/=20,a.mol.a[d].y/=20,a.mol.a[d].z/=20;c(g.molFrom(a.mol))},d)},b.getMoleculeFromDatabase=function(a,b,c,d){this._contactServer("getMoleculeFromDatabase",{query:a},b,function(a){if(3===b.dimension)for(var d=0,e=a.mol.a.length;e>d;d++)a.mol.a[d].x/=20,a.mol.a[d].y/=-20,a.mol.a[d].z/=20;c(g.molFrom(a.mol))},d)},b.getOptimizedPDBStructure=function(a,b,c,e){this._contactServer("getOptimizedPDBStructure",{id:a},b,function(a){var b;b=a.mol?g.molFrom(a.mol):new d.Molecule,b.chains=g.chainsFrom(a.ribbons),b.fromJSON=!0,c(b)},e)},b.getZeoliteFromIZA=function(a,b,c,d){this._contactServer("getZeoliteFromIZA",{query:a},b,function(a){c(ChemDoodle.readCIF(a.cif,b.xSuper,b.ySuper,b.zSuper))
},d)},b.isGraphIsomorphism=function(a,b,c,d,e){this._contactServer("isGraphIsomorphism",{arrow:g.molTo(a),target:g.molTo(b)},c,function(a){d(a.value)},e)},b.isSubgraphIsomorphism=function(a,b,c,d,e){this._contactServer("isSubgraphIsomorphism",{arrow:g.molTo(a),target:g.molTo(b)},c,function(a){d(a.value)},e)},b.kekulize=function(a,b,c,d){this._contactServer("kekulize",{mol:g.molTo(a)},b,function(a){c(g.molFrom(a.mol))},d)},b.optimize=function(a,b,c,d){this._contactServer("optimize",{mol:g.molTo(a)},b,function(d){if(d=g.molFrom(d.mol),2===b.dimension){for(var e=0,f=d.atoms.length;f>e;e++)a.atoms[e].x=d.atoms[e].x,a.atoms[e].y=d.atoms[e].y;c()}else if(3===b.dimension){for(e=0,f=d.atoms.length;f>e;e++)d.atoms[e].x/=20,d.atoms[e].y/=-20,d.atoms[e].z/=20;c(d)}},d)},b.readIUPACName=function(a,b,c,d){this._contactServer("readIUPACName",{iupac:a},b,function(a){c(g.molFrom(a.mol))},d)},b.readSMILES=function(a,b,c,d){this._contactServer("readSMILES",{smiles:a},b,function(a){c(g.molFrom(a.mol))},d)},b.saveFile=function(a,b,c,d){this._contactServer("saveFile",{mol:g.molTo(a)},b,function(a){c(a.link)},d)},b.simulate13CNMR=function(b,c,d,e){c.nucleus="C",c.isotope=13,this._contactServer("simulateNMR",{mol:g.molTo(b)},c,function(b){d(a.readJCAMP(b.jcamp))},e)},b.simulate1HNMR=function(b,c,d,e){c.nucleus="H",c.isotope=1,this._contactServer("simulateNMR",{mol:g.molTo(b)},c,function(b){d(a.readJCAMP(b.jcamp))},e)},b.simulateMassParentPeak=function(b,c,d,e){this._contactServer("simulateMassParentPeak",{mol:g.molTo(b)},c,function(b){d(a.readJCAMP(b.jcamp))},e)},b.writeSMILES=function(a,b,c,d){this._contactServer("writeSMILES",{mol:g.molTo(a)},b,function(a){c(a.smiles)},d)},b.version=function(a,b,c){this._contactServer("version",{},a,function(a){b(a.value)},c)},b.checkForUpdates=function(a){this._contactServer("checkForUpdates",{value:f.href},a,function(){},function(){})}}(ChemDoodle,ChemDoodle.iChemLabs,ChemDoodle.io,ChemDoodle.structures,ChemDoodle.lib.jQuery,location),"function"!=typeof Blob&&"object"!=typeof Blob||"undefined"==typeof URL)if("function"!=typeof Blob&&"object"!=typeof Blob||"undefined"==typeof webkitURL)var Blob=function(a){var b=a.BlobBuilder||a.WebKitBlobBuilder||a.MozBlobBuilder||a.MSBlobBuilder||function(a){var b=function(a){return Object.prototype.toString.call(a).match(/^\[object\s(.*)\]$/)[1]},c=function(){this.data=[]},d=function(a,b,c){this.data=a,this.size=a.length,this.type=b,this.encoding=c},e=c.prototype,f=d.prototype,g=a.FileReaderSync,h=function(a){this.code=this[this.name=a]},i="NOT_FOUND_ERR SECURITY_ERR ABORT_ERR NOT_READABLE_ERR ENCODING_ERR NO_MODIFICATION_ALLOWED_ERR INVALID_STATE_ERR SYNTAX_ERR".split(" "),j=i.length,k=a.URL||a.webkitURL||a,l=k.createObjectURL,m=k.revokeObjectURL,n=k,o=a.btoa,p=a.atob,q=a.ArrayBuffer,r=a.Uint8Array;for(d.fake=f.fake=!0;j--;)h.prototype[i[j]]=j+1;return k.createObjectURL||(n=a.URL={}),n.createObjectURL=function(a){var b,c=a.type;return null===c&&(c="application/octet-stream"),a instanceof d?(b="data:"+c,"base64"===a.encoding?b+";base64,"+a.data:"URI"===a.encoding?b+","+decodeURIComponent(a.data):o?b+";base64,"+o(a.data):b+","+encodeURIComponent(a.data)):l?l.call(k,a):void 0},n.revokeObjectURL=function(a){"data:"!==a.substring(0,5)&&m&&m.call(k,a)},e.append=function(a){var c=this.data;if(r&&(a instanceof q||a instanceof r)){for(var e="",f=new r(a),i=0,j=f.length;j>i;i++)e+=String.fromCharCode(f[i]);c.push(e)}else if("Blob"===b(a)||"File"===b(a)){if(!g)throw new h("NOT_READABLE_ERR");var k=new g;c.push(k.readAsBinaryString(a))}else a instanceof d?"base64"===a.encoding&&p?c.push(p(a.data)):"URI"===a.encoding?c.push(decodeURIComponent(a.data)):"raw"===a.encoding&&c.push(a.data):("string"!=typeof a&&(a+=""),c.push(unescape(encodeURIComponent(a))))},e.getBlob=function(a){return arguments.length||(a=null),new d(this.data.join(""),a,"raw")},e.toString=function(){return"[object BlobBuilder]"},f.slice=function(a,b,c){var e=arguments.length;return 3>e&&(c=null),new d(this.data.slice(a,e>1?b:this.data.length),c,this.encoding)},f.toString=function(){return"[object Blob]"},c}(a);return function(a,c){var d=c?c.type||"":"",e=new b;if(a)for(var f=0,g=a.length;g>f;f++)e.append(a[f]);return e.getBlob(d)}}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||this.content||this);else self.URL=webkitURL;var saveAs=saveAs||"undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob.bind(navigator)||function(a){if("undefined"==typeof navigator||!/MSIE [1-9]\./.test(navigator.userAgent)){var b=a.document,c=function(){return a.URL||a.webkitURL||a},d=a.URL||a.webkitURL||a,e=b.createElementNS("http://www.w3.org/1999/xhtml","a"),f=!a.externalHost&&"download"in e,g=a.webkitRequestFileSystem,h=a.requestFileSystem||g||a.mozRequestFileSystem,i=function(b){(a.setImmediate||a.setTimeout)(function(){throw b},0)},j="application/octet-stream",k=0,l=[],m=function(){for(var a=l.length;a--;){var b=l[a];"string"==typeof b?d.revokeObjectURL(b):b.remove()}l.length=0},n=function(a,b,c){b=[].concat(b);for(var d=b.length;d--;){var e=a["on"+b[d]];if("function"==typeof e)try{e.call(a,c||a)}catch(f){i(f)}}},o=function(d,i){var m,o,p,q=this,r=d.type,s=!1,t=function(){var a=c().createObjectURL(d);return l.push(a),a},u=function(){n(q,"writestart progress write writeend".split(" "))},v=function(){(s||!m)&&(m=t(d)),o?o.location.href=m:window.open(m,"_blank"),q.readyState=q.DONE,u()},w=function(a){return function(){return q.readyState!==q.DONE?a.apply(this,arguments):void 0}},x={create:!0,exclusive:!1};if(q.readyState=q.INIT,i||(i="download"),f){m=t(d),b=a.document,e=b.createElementNS("http://www.w3.org/1999/xhtml","a"),e.href=m,e.download=i;var y=b.createEvent("MouseEvents");return y.initMouseEvent("click",!0,!1,a,0,0,0,0,0,!1,!1,!1,!1,0,null),e.dispatchEvent(y),q.readyState=q.DONE,void u()}return a.chrome&&r&&r!==j&&(p=d.slice||d.webkitSlice,d=p.call(d,0,d.size,j),s=!0),g&&"download"!==i&&(i+=".download"),(r===j||g)&&(o=a),h?(k+=d.size,void h(a.TEMPORARY,k,w(function(a){a.root.getDirectory("saved",x,w(function(a){var b=function(){a.getFile(i,x,w(function(a){a.createWriter(w(function(b){b.onwriteend=function(b){o.location.href=a.toURL(),l.push(a),q.readyState=q.DONE,n(q,"writeend",b)},b.onerror=function(){var a=b.error;a.code!==a.ABORT_ERR&&v()},"writestart progress write abort".split(" ").forEach(function(a){b["on"+a]=q["on"+a]}),b.write(d),q.abort=function(){b.abort(),q.readyState=q.DONE},q.readyState=q.WRITING}),v)}),v)};a.getFile(i,{create:!1},w(function(a){a.remove(),b()}),w(function(a){a.code===a.NOT_FOUND_ERR?b():v()}))}),v)}),v)):void v()},p=o.prototype,q=function(a,b){return new o(a,b)};return p.abort=function(){var a=this;a.readyState=a.DONE,n(a,"abort")},p.readyState=p.INIT=0,p.WRITING=1,p.DONE=2,p.error=p.onwritestart=p.onprogress=p.onwrite=p.onabort=p.onerror=p.onwriteend=null,a.addEventListener("unload",m,!1),q.unload=function(){m(),a.removeEventListener("unload",m,!1)},q}}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||this.content);"undefined"!=typeof module&&null!==module?module.exports=saveAs:"undefined"!=typeof define&&null!==define&&null!=define.amd&&define([],function(){return saveAs});var PeriodicTable={table:[{elements:[{group:"Element",position:0,number:1,name:"Hydrogen",molar:1.00794,small:"H",electrons:[1]},{group:"Element Noble p",position:17,number:2,name:"Helium",molar:4.002602,small:"He",electrons:[2]}]},{elements:[{group:"Element Alkali s",position:0,name:"Lithium",number:3,small:"Li",molar:6.941,electrons:[2,1]},{group:"Element Alkaline s",position:1,name:"Beryllium",number:4,small:"Be",molar:9.012182,electrons:[2,2]},{group:"Element Metalloid Boron p",position:12,name:"Boron",number:5,small:"B",molar:10.811,electrons:[2,3]},{group:"Element Nonmetal Carbon p",position:13,name:"Carbon",number:6,small:"C",molar:12.0107,electrons:[2,4]},{group:"Element Nonmetal Pnictogen p",position:14,name:"Nitrogen",number:7,small:"N",molar:14.0067,electrons:[2,5]},{group:"Element Nonmetal Chalcogen p",position:15,name:"Oxygen",number:8,small:"O",molar:15.9994,electrons:[2,6]},{group:"Element Halogen p",position:16,name:"Fluorine",number:9,small:"F",molar:18.998404,electrons:[2,7]},{group:"Element Noble p",position:17,name:"Neon",number:10,small:"Ne",molar:20.1797,electrons:[2,8]}]},{elements:[{group:"Element Alkali s",position:0,name:"Sodium",number:11,small:"Na",molar:22.989769,electrons:[2,8,1]},{group:"Element Alkaline s",position:1,name:"Magnesium",number:12,small:"Mg",molar:24.305,electrons:[2,8,2]},{group:"Element Poor Boron p",position:12,name:"Aluminium",number:13,small:"Al",molar:26.981539,electrons:[2,8,3]},{group:"Element Metalloid Carbon p",position:13,name:"Silicon",number:14,small:"Si",molar:28.0855,electrons:[2,8,4]},{group:"Element Nonmetal Pnictogen p",position:14,name:"Phosphorus",number:15,small:"P",molar:30.973763,electrons:[2,8,5]},{group:"Element Nonmetal Chalcogen p",position:15,name:"Sulfur",number:16,small:"S",molar:32.065,electrons:[2,8,6]},{group:"Element Halogen p",position:16,name:"Chlorine",number:17,small:"Cl",molar:35.453,electrons:[2,8,7]},{group:"Element Noble p",position:17,name:"Argon",number:18,small:"Ar",molar:39.948,electrons:[2,8,8]}]},{elements:[{group:"Element Alkali s",position:0,name:"Potassium",number:19,small:"K",molar:39.0983,electrons:[2,8,8,1]},{group:"Element Alkaline s",position:1,name:"Calcium",number:20,small:"Ca",molar:40.078,electrons:[2,8,8,2]},{group:"Element Transition d",position:2,name:"Scandium",number:21,small:"Sc",molar:44.955914,electrons:[2,8,9,2]},{group:"Element Transition d",position:3,name:"Titanium",number:22,small:"Ti",molar:47.867,electrons:[2,8,10,2]},{group:"Element Transition d",position:4,name:"Vanadium",number:23,small:"V",molar:50.9415,electrons:[2,8,11,2]},{group:"Element Transition d",position:5,name:"Chromium",number:24,small:"Cr",molar:51.9961,electrons:[2,8,13,1]},{group:"Element Transition d",position:6,name:"Manganese",number:25,small:"Mn",molar:54.938046,electrons:[2,8,13,2]},{group:"Element Transition d",position:7,name:"Iron",number:26,small:"Fe",molar:55.845,electrons:[2,8,14,2]},{group:"Element Transition d",position:8,name:"Cobalt",number:27,small:"Co",molar:58.933193,electrons:[2,8,15,2]},{group:"Element Transition d",position:9,name:"Nickel",number:28,small:"Ni",molar:58.6934,electrons:[2,8,16,2]},{group:"Element Transition d",position:10,name:"Copper",number:29,small:"Cu",molar:63.546,electrons:[2,8,18,1]},{group:"Element Transition d",position:11,name:"Zinc",number:30,small:"Zn",molar:65.38,electrons:[2,8,18,2]},{group:"Element Poor Boron p",position:12,name:"Gallium",number:31,small:"Ga",molar:69.723,electrons:[2,8,18,3]},{group:"Element Metalloid Carbon p",position:13,name:"Germanium",number:32,small:"Ge",molar:72.63,electrons:[2,8,18,4]},{group:"Element Metalloid Pnictogen p",position:14,name:"Arsenic",number:33,small:"As",molar:74.9216,electrons:[2,8,18,5]},{group:"Element Nonmetal Chalcogen p",position:15,name:"Selenium",number:34,small:"Se",molar:78.96,electrons:[2,8,18,6]},{group:"Element Halogen p",position:16,name:"Bromine",number:35,small:"Br",molar:79.904,electrons:[2,8,18,7]},{group:"Element Noble p",position:17,name:"Krypton",number:36,small:"Kr",molar:83.798,electrons:[2,8,18,8]}]},{elements:[{group:"Element Alkali s",position:0,name:"Rubidium",number:37,small:"Rb",molar:85.4678,electrons:[2,8,18,8,1]},{group:"Element Alkaline s",position:1,name:"Strontium",number:38,small:"Sr",molar:87.62,electrons:[2,8,18,8,2]},{group:"Element Transition d",position:2,name:"Yttrium",number:39,small:"Y",molar:88.90585,electrons:[2,8,18,9,2]},{group:"Element Transition d",position:3,name:"Zirconium",number:40,small:"Zr",molar:91.224,electrons:[2,8,18,10,2]},{group:"Element Transition d",position:4,name:"Niobium",number:41,small:"Nb",molar:92.90638,electrons:[2,8,18,12,1]},{group:"Element Transition d",position:5,name:"Molybdenum",number:42,small:"Mo",molar:95.96,electrons:[2,8,18,13,1]},{group:"Element Transition d",position:6,name:"Technetium",number:43,small:"Tc",molar:98,electrons:[2,8,18,13,2]},{group:"Element Transition d",position:7,name:"Ruthenium",number:44,small:"Ru",molar:101.07,electrons:[2,8,18,15,1]},{group:"Element Transition d",position:8,name:"Rhodium",number:45,small:"Rh",molar:102.9055,electrons:[2,8,18,16,1]},{group:"Element Transition d",position:9,name:"Palladium",number:46,small:"Pd",molar:106.42,electrons:[2,8,18,18]},{group:"Element Transition d",position:10,name:"Silver",number:47,small:"Ag",molar:107.8682,electrons:[2,8,18,18,1]},{group:"Element Transition d",position:11,name:"Cadmium",number:48,small:"Cd",molar:112.411,electrons:[2,8,18,18,2]},{group:"Element Poor Boron p",position:12,name:"Indium",number:49,small:"In",molar:114.818,electrons:[2,8,18,18,3]},{group:"Element Poor Carbon p",position:13,name:"Tin",number:50,small:"Sn",molar:118.71,electrons:[2,8,18,18,4]},{group:"Element Metalloid Pnictogen p",position:14,name:"Antimony",number:51,small:"Sb",molar:121.76,electrons:[2,8,18,18,5]},{group:"Element Metalloid Chalcogen p",position:15,name:"Tellurium",number:52,small:"Te",molar:127.6,electrons:[2,8,18,18,6]},{group:"Element Halogen p",position:16,name:"Iodine",number:53,small:"I",molar:126.90447,electrons:[2,8,18,18,7]},{group:"Element Noble p",position:17,name:"Xenon",number:54,small:"Xe",molar:131.293,electrons:[2,8,18,18,8]}]},{elements:[{group:"Element Alkali s",position:0,name:"Caesium",number:55,small:"Cs",molar:132.90546,electrons:[2,8,18,18,8,1]},{group:"Element Alkaline s",position:1,name:"Barium",number:56,small:"Ba",molar:137.327,electrons:[2,8,18,18,8,2]},{group:"Element Transition d",position:3,name:"Hafnium",number:72,small:"Hf",molar:178.49,electrons:[2,8,18,32,10,2]},{group:"Element Transition d",position:4,name:"Tantalum",number:73,small:"Ta",molar:180.94788,electrons:[2,8,18,32,11,2]},{group:"Element Transition d",position:5,name:"Tungsten",number:74,small:"W",molar:183.84,electrons:[2,8,18,32,12,2]},{group:"Element Transition d",position:6,name:"Rhenium",number:75,small:"Re",molar:186.207,electrons:[2,8,18,32,13,2]},{group:"Element Transition d",position:7,name:"Osmium",number:76,small:"Os",molar:190.23,electrons:[2,8,18,32,14,2]},{group:"Element Transition d",position:8,name:"Iridium",number:77,small:"Ir",molar:192.217,electrons:[2,8,18,32,15,2]},{group:"Element Transition d",position:9,name:"Platinum",number:78,small:"Pt",molar:195.084,electrons:[2,8,18,32,17,1]},{group:"Element Transition d",position:10,name:"Gold",number:79,small:"Au",molar:196.96657,electrons:[2,8,18,32,18,1]},{group:"Element Transition d",position:11,name:"Mercury",number:80,small:"Hg",molar:200.59,electrons:[2,8,18,32,18,2]},{group:"Element Poor Boron p",position:12,name:"Thallium",number:81,small:"Tl",molar:204.3833,electrons:[2,8,18,32,18,3]},{group:"Element Poor Carbon p",position:13,name:"Lead",number:82,small:"Pb",molar:207.2,electrons:[2,8,18,32,18,4]},{group:"Element Poor Pnictogen p",position:14,name:"Bismuth",number:83,small:"Bi",molar:208.9804,electrons:[2,8,18,32,18,5]},{group:"Element Metalloid Chalcogen p",position:15,name:"Polonium",number:84,small:"Po",molar:209,electrons:[2,8,18,32,18,6]},{group:"Element Halogen p",position:16,name:"Astatine",number:85,small:"At",molar:210,electrons:[2,8,18,32,18,7]},{group:"Element Noble p",position:17,name:"Radon",number:86,small:"Rn",molar:222,electrons:[2,8,18,32,18,8]}]},{elements:[{group:"Element Alkali s",position:0,name:"Francium",number:87,small:"Fr",molar:223,electrons:[2,8,18,32,18,8,1]},{group:"Element Alkaline s",position:1,name:"Radium",number:88,small:"Ra",molar:226,electrons:[2,8,18,32,18,8,2]},{group:"Element Transition d",position:3,name:"Rutherfordium",number:104,small:"Rf",molar:267,electrons:[2,8,18,32,32,10,2]},{group:"Element Transition d",position:4,name:"Dubnium",number:105,small:"Db",molar:268,electrons:[2,8,18,32,32,11,2]},{group:"Element Transition d",position:5,name:"Seaborgium",number:106,small:"Sg",molar:271,electrons:[2,8,18,32,32,12,2]},{group:"Element Transition d",position:6,name:"Bohrium",number:107,small:"Bh",molar:272,electrons:[2,8,18,32,32,13,2]},{group:"Element Transition d",position:7,name:"Hassium",number:108,small:"Hs",molar:270,electrons:[2,8,18,32,32,14,2]},{group:"Element Transition d",position:8,name:"Meitnerium",number:109,small:"Mt",molar:276,electrons:[2,8,18,32,32,15,2]},{group:"Element Transition d",position:9,name:"Darmstadtium",number:110,small:"Ds",molar:281,electrons:[2,8,18,32,32,17,1]},{group:"Element Transition d",position:10,name:"Roentgenium",number:111,small:"Rg",molar:280,electrons:[2,8,18,32,32,18,1]},{group:"Element Transition d",position:11,name:"Copernicium",number:112,small:"Cn",molar:285,electrons:[2,8,18,32,32,18,2]},{group:"Element Poor Boron p",position:12,name:"Ununtrium",number:113,small:"Uut",molar:284,electrons:[2,8,18,32,32,18,3]},{group:"Element Poor Carbon p",position:13,name:"Flerovium",number:114,small:"Fl",molar:289,electrons:[2,8,18,32,32,18,4]},{group:"Element Poor Pnictogen p",position:14,name:"Ununpentium",number:115,small:"Uup",molar:288,electrons:[2,8,18,32,32,18,5]},{group:"Element Poor Chalcogen p",position:15,name:"Livermorium",number:116,small:"Lv",molar:293,electrons:[2,8,18,32,32,18,6]},{group:"Element Halogen p",position:16,name:"Ununseptium",number:117,small:"Uus",molar:294,electrons:[2,8,18,32,32,18,7]},{group:"Element Noble p",position:17,name:"Ununoctium",number:118,small:"Uuo",molar:294,electrons:[2,8,18,32,32,18,8]}]}],lanthanoids:[{group:"Element Lanthanoid f",position:2,name:"Lanthanum",number:57,small:"La",molar:138.90547,electrons:[2,8,18,18,9,2]},{group:"Element Lanthanoid f",position:3,name:"Cerium",number:58,small:"Ce",molar:140.116,electrons:[2,8,18,19,9,2]},{group:"Element Lanthanoid f",position:4,name:"Praseodymium",number:59,small:"Pr",molar:140.90765,electrons:[2,8,18,21,8,2]},{group:"Element Lanthanoid f",position:5,name:"Neodymium",number:60,small:"Nd",molar:144.242,electrons:[2,8,18,22,8,2]},{group:"Element Lanthanoid f",position:6,name:"Promethium",number:61,small:"Pm",molar:145,electrons:[2,8,18,23,8,2]},{group:"Element Lanthanoid f",position:7,name:"Samarium",number:62,small:"Sm",molar:150.36,electrons:[2,8,18,24,8,2]},{group:"Element Lanthanoid f",position:8,name:"Europium",number:63,small:"Eu",molar:151.964,electrons:[2,8,18,25,8,2]},{group:"Element Lanthanoid f",position:9,name:"Gadolinium",number:64,small:"Gd",molar:157.25,electrons:[2,8,18,25,9,2]},{group:"Element Lanthanoid f",position:10,name:"Terbium",number:65,small:"Tb",molar:158.92535,electrons:[2,8,18,27,8,2]},{group:"Element Lanthanoid f",position:11,name:"Dysprosium",number:66,small:"Dy",molar:162.5,electrons:[2,8,18,28,8,2]},{group:"Element Lanthanoid f",position:12,name:"Holmium",number:67,small:"Ho",molar:164.93031,electrons:[2,8,18,29,8,2]},{group:"Element Lanthanoid f",position:13,name:"Erbium",number:68,small:"Er",molar:167.259,electrons:[2,8,18,30,8,2]},{group:"Element Lanthanoid f",position:14,name:"Thulium",number:69,small:"Tm",molar:168.9342,electrons:[2,8,18,31,8,2]},{group:"Element Lanthanoid f",position:15,name:"Ytterbium",number:70,small:"Yb",molar:173.054,electrons:[2,8,18,32,8,2]},{group:"Element Lanthanoid d",position:16,name:"Lutetium",number:71,small:"Lu",molar:174.9668,electrons:[2,8,18,32,9,2]}],actinoids:[{group:"Element Actinoid f",position:2,name:"Actinium",number:89,small:"Ac",molar:227,electrons:[2,8,18,32,18,9,2]},{group:"Element Actinoid f",position:3,name:"Thorium",number:90,small:"Th",molar:232.03806,electrons:[2,8,18,32,18,10,2]},{group:"Element Actinoid f",position:4,name:"Protactinium",number:91,small:"Pa",molar:231.03587,electrons:[2,8,18,32,20,9,2]},{group:"Element Actinoid f",position:5,name:"Uranium",number:92,small:"U",molar:238.02892,electrons:[2,8,18,32,21,9,2]},{group:"Element Actinoid f",position:6,name:"Neptunium",number:93,small:"Np",molar:237,electrons:[2,8,18,32,22,9,2]},{group:"Element Actinoid f",position:7,name:"Plutonium",number:94,small:"Pu",molar:244,electrons:[2,8,18,32,24,8,2]},{group:"Element Actinoid f",position:8,name:"Americium",number:95,small:"Am",molar:243,electrons:[2,8,18,32,25,8,2]},{group:"Element Actinoid f",position:9,name:"Curium",number:96,small:"Cm",molar:247,electrons:[2,8,18,32,25,9,2]},{group:"Element Actinoid f",position:10,name:"Berkelium",number:97,small:"Bk",molar:247,electrons:[2,8,18,32,27,8,2]},{group:"Element Actinoid f",position:11,name:"Californium",number:98,small:"Cf",molar:251,electrons:[2,8,18,32,28,8,2]},{group:"Element Actinoid f",position:12,name:"Einsteinium",number:99,small:"Es",molar:252,electrons:[2,8,18,32,29,8,2]},{group:"Element Actinoid f",position:13,name:"Fermium",number:100,small:"Fm",molar:257,electrons:[2,8,18,32,30,8,2]},{group:"Element Actinoid f",position:14,name:"Mendelevium",number:101,small:"Md",molar:258,electrons:[2,8,18,32,31,8,2]},{group:"Element Actinoid f",position:15,name:"Nobelium",number:102,small:"No",molar:259,electrons:[2,8,18,32,32,8,2]},{group:"Element Actinoid d",position:16,name:"Lawrencium",number:103,small:"Lr",molar:262,electrons:[2,8,18,32,32,8,3]}]},Latinize={};Latinize.latin_map={"Á":"A","Ă":"A","Ắ":"A","Ặ":"A","Ằ":"A","Ẳ":"A","Ẵ":"A","Ǎ":"A","Â":"A","Ấ":"A","Ậ":"A","Ầ":"A","Ẩ":"A","Ẫ":"A","Ä":"A","Ǟ":"A","Ȧ":"A","Ǡ":"A","Ạ":"A","Ȁ":"A","À":"A","Ả":"A","Ȃ":"A","Ā":"A","Ą":"A","Å":"A","Ǻ":"A","Ḁ":"A","Ⱥ":"A","Ã":"A","Ꜳ":"AA","Æ":"AE","Ǽ":"AE","Ǣ":"AE","Ꜵ":"AO","Ꜷ":"AU","Ꜹ":"AV","Ꜻ":"AV","Ꜽ":"AY","Ḃ":"B","Ḅ":"B","Ɓ":"B","Ḇ":"B","Ƀ":"B","Ƃ":"B","Ć":"C","Č":"C","Ç":"C","Ḉ":"C","Ĉ":"C","Ċ":"C","Ƈ":"C","Ȼ":"C","Ď":"D","Ḑ":"D","Ḓ":"D","Ḋ":"D","Ḍ":"D","Ɗ":"D","Ḏ":"D","ǲ":"D","ǅ":"D","Đ":"D","Ƌ":"D","Ǳ":"DZ","Ǆ":"DZ","É":"E","Ĕ":"E","Ě":"E","Ȩ":"E","Ḝ":"E","Ê":"E","Ế":"E","Ệ":"E","Ề":"E","Ể":"E","Ễ":"E","Ḙ":"E","Ë":"E","Ė":"E","Ẹ":"E","Ȅ":"E","È":"E","Ẻ":"E","Ȇ":"E","Ē":"E","Ḗ":"E","Ḕ":"E","Ę":"E","Ɇ":"E","Ẽ":"E","Ḛ":"E","Ꝫ":"ET","Ḟ":"F","Ƒ":"F","Ǵ":"G","Ğ":"G","Ǧ":"G","Ģ":"G","Ĝ":"G","Ġ":"G","Ɠ":"G","Ḡ":"G","Ǥ":"G","Ḫ":"H","Ȟ":"H","Ḩ":"H","Ĥ":"H","Ⱨ":"H","Ḧ":"H","Ḣ":"H","Ḥ":"H","Ħ":"H","Í":"I","Ĭ":"I","Ǐ":"I","Î":"I","Ï":"I","Ḯ":"I","İ":"I","Ị":"I","Ȉ":"I","Ì":"I","Ỉ":"I","Ȋ":"I","Ī":"I","Į":"I","Ɨ":"I","Ĩ":"I","Ḭ":"I","Ꝺ":"D","Ꝼ":"F","Ᵹ":"G","Ꞃ":"R","Ꞅ":"S","Ꞇ":"T","Ꝭ":"IS","Ĵ":"J","Ɉ":"J","Ḱ":"K","Ǩ":"K","Ķ":"K","Ⱪ":"K","Ꝃ":"K","Ḳ":"K","Ƙ":"K","Ḵ":"K","Ꝁ":"K","Ꝅ":"K","Ĺ":"L","Ƚ":"L","Ľ":"L","Ļ":"L","Ḽ":"L","Ḷ":"L","Ḹ":"L","Ⱡ":"L","Ꝉ":"L","Ḻ":"L","Ŀ":"L","Ɫ":"L","ǈ":"L","Ł":"L","Ǉ":"LJ","Ḿ":"M","Ṁ":"M","Ṃ":"M","Ɱ":"M","Ń":"N","Ň":"N","Ņ":"N","Ṋ":"N","Ṅ":"N","Ṇ":"N","Ǹ":"N","Ɲ":"N","Ṉ":"N","Ƞ":"N","ǋ":"N","Ñ":"N","Ǌ":"NJ","Ó":"O","Ŏ":"O","Ǒ":"O","Ô":"O","Ố":"O","Ộ":"O","Ồ":"O","Ổ":"O","Ỗ":"O","Ö":"O","Ȫ":"O","Ȯ":"O","Ȱ":"O","Ọ":"O","Ő":"O","Ȍ":"O","Ò":"O","Ỏ":"O","Ơ":"O","Ớ":"O","Ợ":"O","Ờ":"O","Ở":"O","Ỡ":"O","Ȏ":"O","Ꝋ":"O","Ꝍ":"O","Ō":"O","Ṓ":"O","Ṑ":"O","Ɵ":"O","Ǫ":"O","Ǭ":"O","Ø":"O","Ǿ":"O","Õ":"O","Ṍ":"O","Ṏ":"O","Ȭ":"O","Ƣ":"OI","Ꝏ":"OO","Ɛ":"E","Ɔ":"O","Ȣ":"OU","Ṕ":"P","Ṗ":"P","Ꝓ":"P","Ƥ":"P","Ꝕ":"P","Ᵽ":"P","Ꝑ":"P","Ꝙ":"Q","Ꝗ":"Q","Ŕ":"R","Ř":"R","Ŗ":"R","Ṙ":"R","Ṛ":"R","Ṝ":"R","Ȑ":"R","Ȓ":"R","Ṟ":"R","Ɍ":"R","Ɽ":"R","Ꜿ":"C","Ǝ":"E","Ś":"S","Ṥ":"S","Š":"S","Ṧ":"S","Ş":"S","Ŝ":"S","Ș":"S","Ṡ":"S","Ṣ":"S","Ṩ":"S","Ť":"T","Ţ":"T","Ṱ":"T","Ț":"T","Ⱦ":"T","Ṫ":"T","Ṭ":"T","Ƭ":"T","Ṯ":"T","Ʈ":"T","Ŧ":"T","Ɐ":"A","Ꞁ":"L","Ɯ":"M","Ʌ":"V","Ꜩ":"TZ","Ú":"U","Ŭ":"U","Ǔ":"U","Û":"U","Ṷ":"U","Ü":"U","Ǘ":"U","Ǚ":"U","Ǜ":"U","Ǖ":"U","Ṳ":"U","Ụ":"U","Ű":"U","Ȕ":"U","Ù":"U","Ủ":"U","Ư":"U","Ứ":"U","Ự":"U","Ừ":"U","Ử":"U","Ữ":"U","Ȗ":"U","Ū":"U","Ṻ":"U","Ų":"U","Ů":"U","Ũ":"U","Ṹ":"U","Ṵ":"U","Ꝟ":"V","Ṿ":"V","Ʋ":"V","Ṽ":"V","Ꝡ":"VY","Ẃ":"W","Ŵ":"W","Ẅ":"W","Ẇ":"W","Ẉ":"W","Ẁ":"W","Ⱳ":"W","Ẍ":"X","Ẋ":"X","Ý":"Y","Ŷ":"Y","Ÿ":"Y","Ẏ":"Y","Ỵ":"Y","Ỳ":"Y","Ƴ":"Y","Ỷ":"Y","Ỿ":"Y","Ȳ":"Y","Ɏ":"Y","Ỹ":"Y","Ź":"Z","Ž":"Z","Ẑ":"Z","Ⱬ":"Z","Ż":"Z","Ẓ":"Z","Ȥ":"Z","Ẕ":"Z","Ƶ":"Z","Ĳ":"IJ","Œ":"OE","ᴀ":"A","ᴁ":"AE","ʙ":"B","ᴃ":"B","ᴄ":"C","ᴅ":"D","ᴇ":"E","ꜰ":"F","ɢ":"G","ʛ":"G","ʜ":"H","ɪ":"I","ʁ":"R","ᴊ":"J","ᴋ":"K","ʟ":"L","ᴌ":"L","ᴍ":"M","ɴ":"N","ᴏ":"O","ɶ":"OE","ᴐ":"O","ᴕ":"OU","ᴘ":"P","ʀ":"R","ᴎ":"N","ᴙ":"R","ꜱ":"S","ᴛ":"T","ⱻ":"E","ᴚ":"R","ᴜ":"U","ᴠ":"V","ᴡ":"W","ʏ":"Y","ᴢ":"Z","á":"a","ă":"a","ắ":"a","ặ":"a","ằ":"a","ẳ":"a","ẵ":"a","ǎ":"a","â":"a","ấ":"a","ậ":"a","ầ":"a","ẩ":"a","ẫ":"a","ä":"a","ǟ":"a","ȧ":"a","ǡ":"a","ạ":"a","ȁ":"a","à":"a","ả":"a","ȃ":"a","ā":"a","ą":"a","ᶏ":"a","ẚ":"a","å":"a","ǻ":"a","ḁ":"a","ⱥ":"a","ã":"a","ꜳ":"aa","æ":"ae","ǽ":"ae","ǣ":"ae","ꜵ":"ao","ꜷ":"au","ꜹ":"av","ꜻ":"av","ꜽ":"ay","ḃ":"b","ḅ":"b","ɓ":"b","ḇ":"b","ᵬ":"b","ᶀ":"b","ƀ":"b","ƃ":"b","ɵ":"o","ć":"c","č":"c","ç":"c","ḉ":"c","ĉ":"c","ɕ":"c","ċ":"c","ƈ":"c","ȼ":"c","ď":"d","ḑ":"d","ḓ":"d","ȡ":"d","ḋ":"d","ḍ":"d","ɗ":"d","ᶑ":"d","ḏ":"d","ᵭ":"d","ᶁ":"d","đ":"d","ɖ":"d","ƌ":"d","ı":"i","ȷ":"j","ɟ":"j","ʄ":"j","ǳ":"dz","ǆ":"dz","é":"e","ĕ":"e","ě":"e","ȩ":"e","ḝ":"e","ê":"e","ế":"e","ệ":"e","ề":"e","ể":"e","ễ":"e","ḙ":"e","ë":"e","ė":"e","ẹ":"e","ȅ":"e","è":"e","ẻ":"e","ȇ":"e","ē":"e","ḗ":"e","ḕ":"e","ⱸ":"e","ę":"e","ᶒ":"e","ɇ":"e","ẽ":"e","ḛ":"e","ꝫ":"et","ḟ":"f","ƒ":"f","ᵮ":"f","ᶂ":"f","ǵ":"g","ğ":"g","ǧ":"g","ģ":"g","ĝ":"g","ġ":"g","ɠ":"g","ḡ":"g","ᶃ":"g","ǥ":"g","ḫ":"h","ȟ":"h","ḩ":"h","ĥ":"h","ⱨ":"h","ḧ":"h","ḣ":"h","ḥ":"h","ɦ":"h","ẖ":"h","ħ":"h","ƕ":"hv","í":"i","ĭ":"i","ǐ":"i","î":"i","ï":"i","ḯ":"i","ị":"i","ȉ":"i","ì":"i","ỉ":"i","ȋ":"i","ī":"i","į":"i","ᶖ":"i","ɨ":"i","ĩ":"i","ḭ":"i","ꝺ":"d","ꝼ":"f","ᵹ":"g","ꞃ":"r","ꞅ":"s","ꞇ":"t","ꝭ":"is","ǰ":"j","ĵ":"j","ʝ":"j","ɉ":"j","ḱ":"k","ǩ":"k","ķ":"k","ⱪ":"k","ꝃ":"k","ḳ":"k","ƙ":"k","ḵ":"k","ᶄ":"k","ꝁ":"k","ꝅ":"k","ĺ":"l","ƚ":"l","ɬ":"l","ľ":"l","ļ":"l","ḽ":"l","ȴ":"l","ḷ":"l","ḹ":"l","ⱡ":"l","ꝉ":"l","ḻ":"l","ŀ":"l","ɫ":"l","ᶅ":"l","ɭ":"l","ł":"l","ǉ":"lj","ſ":"s","ẜ":"s","ẛ":"s","ẝ":"s","ḿ":"m","ṁ":"m","ṃ":"m","ɱ":"m","ᵯ":"m","ᶆ":"m","ń":"n","ň":"n","ņ":"n","ṋ":"n","ȵ":"n","ṅ":"n","ṇ":"n","ǹ":"n","ɲ":"n","ṉ":"n","ƞ":"n","ᵰ":"n","ᶇ":"n","ɳ":"n","ñ":"n","ǌ":"nj","ó":"o","ŏ":"o","ǒ":"o","ô":"o","ố":"o","ộ":"o","ồ":"o","ổ":"o","ỗ":"o","ö":"o","ȫ":"o","ȯ":"o","ȱ":"o","ọ":"o","ő":"o","ȍ":"o","ò":"o","ỏ":"o","ơ":"o","ớ":"o","ợ":"o","ờ":"o","ở":"o","ỡ":"o","ȏ":"o","ꝋ":"o","ꝍ":"o","ⱺ":"o","ō":"o","ṓ":"o","ṑ":"o","ǫ":"o","ǭ":"o","ø":"o","ǿ":"o","õ":"o","ṍ":"o","ṏ":"o","ȭ":"o","ƣ":"oi","ꝏ":"oo","ɛ":"e","ᶓ":"e","ɔ":"o","ᶗ":"o","ȣ":"ou","ṕ":"p","ṗ":"p","ꝓ":"p","ƥ":"p","ᵱ":"p","ᶈ":"p","ꝕ":"p","ᵽ":"p","ꝑ":"p","ꝙ":"q","ʠ":"q","ɋ":"q","ꝗ":"q","ŕ":"r","ř":"r","ŗ":"r","ṙ":"r","ṛ":"r","ṝ":"r","ȑ":"r","ɾ":"r","ᵳ":"r","ȓ":"r","ṟ":"r","ɼ":"r","ᵲ":"r","ᶉ":"r","ɍ":"r","ɽ":"r","ↄ":"c","ꜿ":"c","ɘ":"e","ɿ":"r","ś":"s","ṥ":"s","š":"s","ṧ":"s","ş":"s","ŝ":"s","ș":"s","ṡ":"s","ṣ":"s","ṩ":"s","ʂ":"s","ᵴ":"s","ᶊ":"s","ȿ":"s","ɡ":"g","ᴑ":"o","ᴓ":"o","ᴝ":"u","ť":"t","ţ":"t","ṱ":"t","ț":"t","ȶ":"t","ẗ":"t","ⱦ":"t","ṫ":"t","ṭ":"t","ƭ":"t","ṯ":"t","ᵵ":"t","ƫ":"t","ʈ":"t","ŧ":"t","ᵺ":"th","ɐ":"a","ᴂ":"ae","ǝ":"e","ᵷ":"g","ɥ":"h","ʮ":"h","ʯ":"h","ᴉ":"i","ʞ":"k","ꞁ":"l","ɯ":"m","ɰ":"m","ᴔ":"oe","ɹ":"r","ɻ":"r","ɺ":"r","ⱹ":"r","ʇ":"t","ʌ":"v","ʍ":"w","ʎ":"y","ꜩ":"tz","ú":"u","ŭ":"u","ǔ":"u","û":"u","ṷ":"u","ü":"u","ǘ":"u","ǚ":"u","ǜ":"u","ǖ":"u","ṳ":"u","ụ":"u","ű":"u","ȕ":"u","ù":"u","ủ":"u","ư":"u","ứ":"u","ự":"u","ừ":"u","ử":"u","ữ":"u","ȗ":"u","ū":"u","ṻ":"u","ų":"u","ᶙ":"u","ů":"u","ũ":"u","ṹ":"u","ṵ":"u","ᵫ":"ue","ꝸ":"um","ⱴ":"v","ꝟ":"v","ṿ":"v","ʋ":"v","ᶌ":"v","ⱱ":"v","ṽ":"v","ꝡ":"vy","ẃ":"w","ŵ":"w","ẅ":"w","ẇ":"w","ẉ":"w","ẁ":"w","ⱳ":"w","ẘ":"w","ẍ":"x","ẋ":"x","ᶍ":"x","ý":"y","ŷ":"y","ÿ":"y","ẏ":"y","ỵ":"y","ỳ":"y","ƴ":"y","ỷ":"y","ỿ":"y","ȳ":"y","ẙ":"y","ɏ":"y","ỹ":"y","ź":"z","ž":"z","ẑ":"z","ʑ":"z","ⱬ":"z","ż":"z","ẓ":"z","ȥ":"z","ẕ":"z","ᵶ":"z","ᶎ":"z","ʐ":"z","ƶ":"z","ɀ":"z","ﬀ":"ff","ﬃ":"ffi","ﬄ":"ffl","ﬁ":"fi","ﬂ":"fl","ĳ":"ij","œ":"oe","ﬆ":"st","ₐ":"a","ₑ":"e","ᵢ":"i","ⱼ":"j","ₒ":"o","ᵣ":"r","ᵤ":"u","ᵥ":"v","ₓ":"x"},String.prototype.latinize=function(){return this.replace(/[^A-Za-z0-9\[\] ]/g,function(a){return Latinise.latin_map[a]||a})},function(a){a.fn.textfill=function(b){var c,d,e=b.maxFontPixels,f=a("span:visible:first",this),g=a(this).height(),h=a(this).width();do f.css("font-size",e),c=f.height(),d=f.width(),e-=1;while((c>g||d>h)&&e>3);return this}}(jQuery);var JmolAtomColors={H:16777215,He:14286847,Li:13402367,Be:12779264,B:16758197,C:9474192,N:3166456,O:16715021,F:9494608,Ne:11789301,Na:11230450,Mg:9109248,Al:12560038,Si:1578e4,P:16744448,S:16777008,Cl:2093087,Ar:8442339,K:9388244,Ca:4062976,Sc:15132390,Ti:12567239,V:10921643,Cr:9083335,Mn:10255047,Fe:14706227,Co:15765664,Ni:5296208,Cu:13140019,Zn:8224944,Ga:12750735,Ge:6721423,As:12419299,Se:16752896,Br:10889513,Kr:6076625,Rb:7351984,Sr:65280,Y:9764863,Zr:9756896,Nb:7586505,Mo:5551541,Tc:3907230,Ru:2396047,Rh:687500,Pd:27013,Ag:12632256,Cd:16767375,In:10909043,Sn:6717568,Sb:10380213,Te:13924864,I:9699476,Xe:4366e3,Cs:5707663,Ba:51456,La:7394559,Ce:16777159,Pr:14286791,Nd:13107143,Pm:10747847,Sm:9437127,Eu:6422471,Gd:4587463,Tb:3211207,Dy:2097095,Ho:65436,Er:58997,Tm:54354,Yb:48952,Lu:43812,Hf:5096191,Ta:5089023,W:2200790,Re:2522539,Os:2516630,Ir:1528967,Pt:13684960,Au:16765219,Hg:12105936,Tl:10900557,Pb:5724513,Bi:10375093,Po:11230208,At:7688005,Rn:4358806,Fr:4325478,Ra:32e3,Ac:7384058,Th:47871,Pa:41471,U:36863,Np:33023,Pu:27647,Am:5528818,Cm:7888099,Bk:9064419,Cf:10565332,Es:11739092,Fm:11739066,Md:11734438,No:12389767,Lr:13041766,Rf:13369433,Db:13697103,Sg:14221381,Bh:14680120,Hs:15073326,Mt:15400998},JmolAtomColorsCSS={H:"#000000",He:"#849b9b",Li:"#c87efa",Be:"#82ab00",B:"#c38a8a",C:"#000000",N:"#304ff7",O:"#ff0d0d",F:"#6dab3c",Ne:"#7b9ca8",Na:"#ab5cf2",Mg:"#61b400",Al:"#a79191",Si:"#b09276",P:"#ff8000",S:"#c39517",Cl:"#1dc51d",Ar:"#63a2b0",K:"#8f40d4",Ca:"#2fc300",Sc:"#969696",Ti:"#94969a",V:"#96969a",Cr:"#8796c3",Mn:"#9c7ac7",Fe:"#e06633",Co:"#db8293",Ni:"#45b645",Cu:"#c78033",Zn:"#7d80b0",Ga:"#bd8c8c",Ge:"#668f8f",As:"#bd80e3",Se:"#e28f00",Br:"#a62929",Kr:"#53a6bc",Rb:"#702eb0",Sr:"#00d000",Y:"#5fa4a4",Zr:"#6ba2a2",Nb:"#61a4a9",Mo:"#4ea9a9",Tc:"#3b9e9e",Ru:"#248f8f",Rh:"#0a7d8c",Pd:"#006985",Ag:"#969696",Cd:"#ae9462",In:"#a67573",Sn:"#668080",Sb:"#9e63b5",Te:"#d47a00",I:"#940094",Xe:"#429eb0",Cs:"#57178f",Ba:"#00c900",La:"#57a4c5",Ce:"#989877",Pr:"#869d7b",Nd:"#7da07d",Pm:"#69a581",Sm:"#5ea883",Eu:"#43b089",Gd:"#31b48d",Tb:"#23b890",Dy:"#17bb92",Ho:"#00c578",Er:"#00c765",Tm:"#00c94e",Yb:"#00bf38",Lu:"#00ab24",Hf:"#42a8dc",Ta:"#4ba2f9",W:"#2194d6",Re:"#267dab",Os:"#266696",Ir:"#175487",Pt:"#9595a0",Au:"#b9981a",Hg:"#9595a9",Tl:"#a6544d",Pb:"#575961",Bi:"#9e4fb5",Po:"#ab5c00",At:"#754f45",Rn:"#428296",Fr:"#420066",Ra:"#007d00",Ac:"#669ce4",Th:"#00b8fc",Pa:"#00a1ff",U:"#008fff",Np:"#0080ff",Pu:"#006bff",Am:"#545cf2",Cm:"#785ce3",Bk:"#8a4fe3",Cf:"#a136d4",Es:"#b31fd4",Fm:"#B31FBA",Md:"#B30DA6",No:"#BD0D87",Lr:"#C70066",Rf:"#CC0059",Db:"#D1004F",Sg:"#D90045",Bh:"#E00038",Hs:"#E6002E",Mt:"#EB0026",Ds:"#9595a0",Rg:"#b9981a",Cn:"#9595a9"},defaultMol2D=["C8H10N4O2","APtclcactv04181408232D 0   0.00000     0.00000"," "," 24 25  0  0  0  0  0  0  0  0999 V2000","    2.8660    0.5000    0.0000 N   0  0  0  0  0  0  0  0  0  0  0  0","    2.0000    1.0000    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0","    2.8660   -0.5000    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0","    2.0000   -1.0000    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0","    3.7321   -1.0000    0.0000 N   0  0  0  0  0  0  0  0  0  0  0  0","    3.7321   -2.0000    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0","    4.5981   -0.5000    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0","    5.5443   -0.8047    0.0000 N   0  0  0  0  0  0  0  0  0  0  0  0","    6.1279    0.0000    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0","    5.5443    0.8047    0.0000 N   0  0  0  0  0  0  0  0  0  0  0  0","    5.8550    1.7553    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0","    4.5981    0.5000    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0","    3.7321    1.0000    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0","    3.7321    2.0000    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0","    2.3100    1.5369    0.0000 H   0  0  0  0  0  0  0  0  0  0  0  0","    1.4631    1.3100    0.0000 H   0  0  0  0  0  0  0  0  0  0  0  0","    1.6900    0.4631    0.0000 H   0  0  0  0  0  0  0  0  0  0  0  0","    3.1121   -2.0000    0.0000 H   0  0  0  0  0  0  0  0  0  0  0  0","    3.7321   -2.6200    0.0000 H   0  0  0  0  0  0  0  0  0  0  0  0","    4.3521   -2.0000    0.0000 H   0  0  0  0  0  0  0  0  0  0  0  0","    6.7479   -0.0000    0.0000 H   0  0  0  0  0  0  0  0  0  0  0  0","    6.4443    1.5626    0.0000 H   0  0  0  0  0  0  0  0  0  0  0  0","    6.0476    2.3446    0.0000 H   0  0  0  0  0  0  0  0  0  0  0  0","    5.2656    1.9479    0.0000 H   0  0  0  0  0  0  0  0  0  0  0  0","  1  2  1  0  0  0  0","  1  3  1  0  0  0  0","  3  4  2  0  0  0  0","  3  5  1  0  0  0  0","  5  6  1  0  0  0  0","  5  7  1  0  0  0  0","  7  8  1  0  0  0  0","  8  9  2  0  0  0  0","  9 10  1  0  0  0  0"," 10 11  1  0  0  0  0"," 10 12  1  0  0  0  0","  7 12  2  0  0  0  0"," 12 13  1  0  0  0  0","  1 13  1  0  0  0  0"," 13 14  2  0  0  0  0","  2 15  1  0  0  0  0","  2 16  1  0  0  0  0","  2 17  1  0  0  0  0","  6 18  1  0  0  0  0","  6 19  1  0  0  0  0","  6 20  1  0  0  0  0","  9 21  1  0  0  0  0"," 11 22  1  0  0  0  0"," 11 23  1  0  0  0  0"," 11 24  1  0  0  0  0","M  END","$$$$"].join("\n"),defaultMol3D=["C8H10N4O2","APtclcactv04181408293D 0   0.00000     0.00000"," "," 24 25  0  0  0  0  0  0  0  0999 V2000","    1.3120   -1.0479    0.0025 N   0  0  0  0  0  0  0  0  0  0  0  0","    2.2465   -2.1762    0.0031 C   0  0  0  0  0  0  0  0  0  0  0  0","    1.7906    0.2081    0.0010 C   0  0  0  0  0  0  0  0  0  0  0  0","    2.9938    0.3838    0.0002 O   0  0  0  0  0  0  0  0  0  0  0  0","    0.9714    1.2767   -0.0001 N   0  0  0  0  0  0  0  0  0  0  0  0","    1.5339    2.6294   -0.0017 C   0  0  0  0  0  0  0  0  0  0  0  0","   -0.4026    1.0989   -0.0001 C   0  0  0  0  0  0  0  0  0  0  0  0","   -1.4446    1.9342   -0.0010 N   0  0  0  0  0  0  0  0  0  0  0  0","   -2.5608    1.2510   -0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0","   -2.2862   -0.0680    0.0015 N   0  0  0  0  0  0  0  0  0  0  0  0","   -3.2614   -1.1612    0.0029 C   0  0  0  0  0  0  0  0  0  0  0  0","   -0.9114   -0.1939    0.0014 C   0  0  0  0  0  0  0  0  0  0  0  0","   -0.0163   -1.2853   -0.0022 C   0  0  0  0  0  0  0  0  0  0  0  0","   -0.4380   -2.4279   -0.0068 O   0  0  0  0  0  0  0  0  0  0  0  0","    3.2697   -1.8004    0.0022 H   0  0  0  0  0  0  0  0  0  0  0  0","    2.0830   -2.7828    0.8938 H   0  0  0  0  0  0  0  0  0  0  0  0","    2.0821   -2.7846   -0.8862 H   0  0  0  0  0  0  0  0  0  0  0  0","    2.6223    2.5703   -0.0019 H   0  0  0  0  0  0  0  0  0  0  0  0","    1.1987    3.1611   -0.8923 H   0  0  0  0  0  0  0  0  0  0  0  0","    1.1990    3.1632    0.8877 H   0  0  0  0  0  0  0  0  0  0  0  0","   -3.5520    1.6797   -0.0001 H   0  0  0  0  0  0  0  0  0  0  0  0","   -3.5037   -1.4333   -1.0244 H   0  0  0  0  0  0  0  0  0  0  0  0","   -2.8389   -2.0244    0.5173 H   0  0  0  0  0  0  0  0  0  0  0  0","   -4.1672   -0.8395    0.5168 H   0  0  0  0  0  0  0  0  0  0  0  0","  1  2  1  0  0  0  0","  1  3  1  0  0  0  0","  3  4  2  0  0  0  0","  3  5  1  0  0  0  0","  5  6  1  0  0  0  0","  5  7  1  0  0  0  0","  7  8  1  0  0  0  0","  8  9  2  0  0  0  0","  9 10  1  0  0  0  0"," 10 11  1  0  0  0  0"," 10 12  1  0  0  0  0","  7 12  2  0  0  0  0"," 12 13  1  0  0  0  0","  1 13  1  0  0  0  0"," 13 14  2  0  0  0  0","  2 15  1  0  0  0  0","  2 16  1  0  0  0  0","  2 17  1  0  0  0  0","  6 18  1  0  0  0  0","  6 19  1  0  0  0  0","  6 20  1  0  0  0  0","  9 21  1  0  0  0  0"," 11 22  1  0  0  0  0"," 11 23  1  0  0  0  0"," 11 24  1  0  0  0  0","M  END","$$$$"].join("\n"),xhr,History={init:function(){window.addEventListener("popstate",function(){var a=getQuery();
JSON.stringify(a)!=JSON.stringify(MolView.query)&&(MolView.query=a,MolView.executeQuery())})},push:function(a,b){b=""+b;var c=a+"="+specialEncodeURIComponent(b.replace(/^ /,""));history&&history.pushState&&-1==location.search.indexOf(c)&&history.pushState(null,document.title,"?"+c)}},Progress={value:0,steps:0,bar:void 0,part:void 0,init:function(){this.bar=$("#progress"),this.part=$("#progress .part")},setValue:function(a){0!=this.steps&&(a>1&&(a=1),this.value=a,this.part.stop().animate({width:""+100*this.value+"%"},800,"swing"))},clear:function(){this.value=0,this.part.stop().css({width:0,opacity:1})},add:function(a){this.setValue(this.value+a)},setSteps:function(a){this.steps=a+1,this.increment(),document.title=document.title.replace(/ \[loading\]/g,""),document.title+=" [loading]"},increment:function(){this.add(1/this.steps)},hide:function(){Progress.part.animate({opacity:0},1e3,"swing",function(){Progress.part.css("width",0)})},alert:function(){document.title=document.title.replace(/ \[loading\]/g,"")},complete:function(){this.setValue(1),this.hide(),document.title=document.title.replace(/ \[loading\]/g,"")}},Messages={cir_down:"The Chemical Identifier Resolver is temporarily offline. Therefore, some functions are unavailable.",cir_func_down:"This function is unavailable because the Chemical Identifier Resolver is temporarily offline.",switch_engine:"",compound:"Loading compound...",protein:"Loading protein...",crystal:"Loading crystal...",crystal_structure:"Loading crystal structure...",search:"Searching...",clean:"Cleaning...",resolve:"Resolving...",no_glmol_crystals:"You cannot view crystals using GLmol",init_jmol:"",jmol_calculation:"",no_webgl_support:Detector.getWebGLErrorMessage(),no_canvas_support:"Your browser doesn't support this web application, try <a class='link' href='//google.com/chrome' title='A modern browser'>Google Chrome</a> instead.",sketcher_no_proteins:"Proteins cannot be displayed in the sketcher",mobile_old_no_proteins:"Proteins cannot be viewed on your device",smiles_load_error:"Failed to load structure from sketcher",smiles_load_error_force:"Failed to load structure from sketcher",load_fail:"Failed to load structure <small>The source database might be offline.</small>",search_fail:"Structure cannot be found",resolve_fail:"Structure cannot be resolved",clean_fail:"Structure cannot be cleaned",crystal_2d_fail:"Failed to load structural formula for this crystal structure",init:function(){$("#start-messages-close").on("click",function(){Messages.hide()}),$("#sketcher-messages .btn.ok").on("click",function(){Progress.complete(),Messages.hide()}),$("#model-messages .btn.ok").on("click",function(){Progress.complete(),Messages.hide()}),$("#content-messages .btn.ok").on("click",function(){Progress.complete(),Messages.hide()})},process:function(a,b){$("body").addClass("process"),$("#content").removeClass("start-messages sketcher-messages model-messages content-messages message-alert stay").addClass("message-process"),"clean"==b?($("#sketcher-messages .text").first().html(Messages[b]),$("#content").addClass("sketcher-messages")):"switch_engine"==b||"protein"==b||"resolve"==b||"init_jmol"==b||"jmol_calculation"==b||"crystal_structure"==b?($("#model-messages .text").first().html(Messages[b]),$("#content").addClass("model-messages")):"compound"==b||"crystal"==b||"search"==b?($("#content-messages .text").first().html(Messages[b]),$("#content").addClass("content-messages")):"misc"==b&&($("#content-messages .text").first().html(""),$("#content").addClass("content-messages")),window.setTimeout(a,300)},alert:function(a,b){$("body").removeClass("process"),$("#content").removeClass("start-messages content-messages message-process stay "+("smiles_load_error"==a||"clean_fail"==a||"resolve_fail"==a?"":"sketcher-messages model-messages")).addClass("message-alert"),"sketcher_no_proteins"==a||"crystal_2d_fail"==a?($("#sketcher-messages .text").first().html(Messages[a]),$("#content").addClass("sketcher-messages")):"no_webgl_support"==a||"no_glmol_crystals"==a?($("#model-messages .text").first().html(Messages[a]),$("#content").addClass("model-messages")):"cir_down"==a||"cir_func_down"==a||"no_canvas_support"==a||"search_fail"==a||"load_fail"==a||"mobile_old_no_proteins"==a?($("#content-messages .text").first().html(Messages[a]),$("#content").addClass("content-messages"),"no_canvas_support"==a&&$("#content").addClass("stay")):"smiles_load_error"==a||"clean_fail"==a||"resolve_fail"==a?$("#sketcher-messages .text, #model-messages .text, #content-messages .text").html(b?Messages[a]+" <small>"+(b.message||b.detailMessage||b)+"</small>":Messages[a]):"smiles_load_error_force"==a&&(b&&$("#content-messages .text").html(Messages[a]+" <small>"+(b.message||b.detailMessage||b)+"</small>"),$("#content").addClass("content-messages")),Progress.alert()},hide:function(){$("body").removeClass("process"),$("#content").removeClass("start-messages sketcher-messages model-messages content-messages message-process message-alert stay")}},Sketcher={moledit:void 0,title_lock:!1,CID:void 0,init:function(){this.initPeriodicTable(),Detector.canvas?(this.moledit=new ChemicalView(document.getElementById("moledit-area"),document.getElementById("moledit-canvas")),MolView.loadDefault&&this.loadMOL(defaultMol2D),this.moledit.onChanged=function(){Sketcher.CID=void 0,$("#resolve").removeClass("updated"),Sketcher.title_lock||(document.title="MolView")}):Messages.alert("no_canvas_support")},resize:function(){void 0!==this.moledit&&this.moledit.resize()},initPeriodicTable:function(){var a=PeriodicTable.table;a.push({elements:PeriodicTable.lanthanoids}),a.push({elements:PeriodicTable.actinoids});for(var b=0;b<a.length;b++){for(var c=-1,d=0;d<a[b].elements.length;d++){for(var e=a[b].elements[d],f=c;f<e.position-1;f++)$('<div class="space"></div>').appendTo("#periodictable");$('<div class="element"></div>').addClass(e.group.toLowerCase()).attr("title",e.name).append($("<h3></h3>").html(e.number)).append($("<h4></h4>").html(e.small).css("color",JmolAtomColorsCSS[e.small])).data("nr",e.small).on(MolView.trigger,function(){$("#moledit .button:not(.custom)").not(this).removeClass("selected"),$("#me-elements").addClass("selected"),Sketcher.moledit.setElement.call(Sketcher.moledit,$(this).data("nr")),window.setTimeout(MolView.hideWindows,0)}).appendTo("#periodictable"),c=e.position}$("<br/>").appendTo("#periodictable")}$("#me-elements").on(MolView.trigger,function(){$("#me-elements").removeClass("selected"),MolView.showDialog("elements")})},loadMOL:function(a){void 0!==this.moledit&&(this.title_lock=!0,this.moledit.loadMOL(a),this.moledit.removeImplicitHydrogen(),this.title_lock=!1)},getMOL:function(){return void 0!==this.moledit?this.moledit.getMOL():""},getSMILES:function(){if(void 0!==this.moledit){if(0==this.moledit.chem.atoms.length)throw new Error("No atoms found");var a=chem.Molfile.parseCTFile(this.getMOL().split("\n"));return(new chem.SmilesSaver).saveMolecule(a)}return""},markOutdated:function(){$("#resolve").removeClass("updated")},markUpdated:function(){$("#resolve").addClass("updated")},toDataURL:function(){return void 0!==this.moledit?document.getElementById("moledit-canvas").toDataURL("image/png"):void 0}},JmolScripts={Ball_and_Stick:"select *; wireframe 0.09; spacefill 28%;",Stick:"select *; wireframe 0.3; spacefill 0;",van_der_Waals_Spheres:"select *; spacefill 100%;",Wireframe:"select *; wireframe 0.03; spacefill 0.08;",Line:"select *; wireframe on; spacefill off;",Proteins:"select protein or nucleic; ribbon only; color ribbons structure",resetLabels:"hover off; color measures [xFFFF00]",clearChargeDisplay:'measure off; measure delete; mo off; isosurface off; echo ""; label ""; select formalCharge <> 0; label %C; select *; dipole bond delete; dipole molecular delete; color cpk;'},Model={data:{mol:"",pdb:"",cif:"",current:"MOL"},engine:null,representation:"balls",init:function(a,b){MolView.loadDefault&&(this.data.mol=defaultMol3D),this.setRenderEngine(b||"GLmol",a)},resize:function(){"GLmol"==this.engine?this.GLmol.resize():"JSmol"==this.engine?this.JSmol.resize():"CDW"==this.engine&&this.CDW.resize()},reset:function(){"GLmol"==this.engine?this.GLmol.reset():"JSmol"==this.engine?this.JSmol.reset():"CDW"==this.engine&&this.CDW.reset()},setRenderEngine:function(a,b){if(this.engine==a)return void(b&&b());if("GLmol"==a){if("CIF"==this.data.current)return void Messages.alert("no_glmol_crystals");if(this.GLmol.ready)this._setRenderEngine(a),b&&b();else if(!this.GLmol.init(b))return}else if("JSmol"==a){if(this.JSmol.ready)this._setRenderEngine(a),b&&b();else if(!this.JSmol.init(b))return}else if("CDW"==a)if(this.CDW.ready)this._setRenderEngine(a),b&&b();else if(!this.CDW.init(b))return;$("#engine-glmol").removeClass("checked"),$("#engine-jmol").removeClass("checked"),$("#engine-cdw").removeClass("checked"),$("#engine-"+("GLmol"==a?"glmol":"JSmol"==a?"jmol":"CDW"==a?"cdw":"")).addClass("checked")},_setRenderEngine:function(a){$("#glmol").css("display","GLmol"==a?"block":"none"),$("#jsmol").css("display","JSmol"==a?"block":"none"),$("#chemdoodle").css("display","CDW"==a?"block":"none"),this.engine=a,this.resize(),this.loadContent()||this.setRepresentation(this.representation)},setRepresentation:function(a){this.representation=a,$(".r-mode").removeClass("checked"),"balls"==a?$("#model-balls").addClass("checked"):"stick"==a?$("#model-stick").addClass("checked"):"vdw"==a?$("#model-vdw").addClass("checked"):"wireframe"==a?$("#model-wireframe").addClass("checked"):"line"==a&&$("#model-line").addClass("checked"),"GLmol"==this.engine?this.GLmol.setRepresentation():"JSmol"==this.engine?this.JSmol.setRepresentation(a):"CDW"==this.engine&&this.CDW.setRepresentation(a)},loadContent:function(){return"MOL"==this.data.current?this.loadMOL(this.data.mol):"PDB"==this.data.current?this.loadPDB(this.data.pdb):"CIF"==this.data.current?this.loadCIF(this.data.cif):!1},loadMOL:function(a){return this.data.current="MOL",this.data.mol=a,$("#save-local-3d").text("MOL file"),$(".jmol-script").removeClass("disabled"),"GLmol"==this.engine?this.GLmol.loadMOL(a):"JSmol"==this.engine?this.JSmol.loadMOL(a):"CDW"==this.engine?this.CDW.loadMOL(a):void 0},loadPDB:function(a,b){return this.data.current="PDB",this.data.pdb=a,$("#save-local-3d").text("PDB file"),b?void 0:($(".jmol-script").addClass("disabled"),"GLmol"==this.engine?this.GLmol.loadPDB(a):"JSmol"==this.engine?this.JSmol.loadPDB(a):"CDW"==this.engine?this.CDW.loadPDB(a):void 0)},loadCIF:function(a,b){if(this.data.current="CIF",this.data.cif=a,$("#save-local-3d").text("CIF file"),$(".jmol-script").removeClass("disabled"),b=b||[1,1,1],"GLmol"==this.engine)Detector.webgl?this.setRenderEngine("CDW",function(){Model.CDW.loadCIF(Model.data.cif,b)}):this.setRenderEngine("JSmol",function(){Model.JSmol.loadCIF(Model.data.cif,b)});else{if("JSmol"==this.engine)return this.JSmol.loadCIF(a,b);"CDW"==this.engine&&(Detector.webgl?this.CDW.loadCIF(a,b):this.setRenderEngine("JSmol",function(){return Model.JSmol.loadCIF(Model.data.cif,b)}))}},toDataURL:function(){var a="";return"CDW"==this.engine?a=this.CDW.toDataURL():"JSmol"==this.engine?a=this.JSmol.toDataURL():"GLmol"==this.engine&&(a=this.GLmol.toDataURL()),a},getDataBlob:function(){var a;return"MOL"==this.data.current?a=new Blob([this.data.mol],{type:"chemical/x-mdl-molfile"}):"PDB"==this.data.current?a=new Blob([this.data.pdb],{type:"chemical/x-pdb"}):"CIF"==this.data.current&&(a=new Blob([this.data.cif],{type:"chemical/x-cif"})),a},GLmol:{ready:!1,view:void 0,canvas:void 0,container:void 0,init:function(a){return Detector.canvas?(this.view=new GLmol("glmol",!0,!Detector.webgl,MolView.mobile?1.5:1),this.container=$("#glmol"),this.canvas=this.container.children("canvas").first(),this.canvas.css("width",this.container.width()),this.view.defineRepresentation=function(){var a=this.getAllAtoms(),b=this.removeSolvents(this.getHetatms(a));this.colorByAtom(a,{}),this.colorByStructure(a,13369548,52428);var c=this.modelGroup;this.canvas_vdw=!1,"balls"==Model.representation?(this.canvas_atom_radius=.4,this.canvas_bond_width=.3,this.drawBondsAsStick(c,b,this.cylinderRadius/2,5*this.cylinderRadius,!0,!0,.3)):"stick"==Model.representation?(this.canvas_atom_radius=.3,this.canvas_bond_width=.6,this.drawBondsAsStick(c,b,this.cylinderRadius,this.cylinderRadius,!0)):"vdw"==Model.representation?(this.canvas_vdw=!0,this.canvas_atom_radius=.5,this.canvas_bond_width=.3,this.drawAtomsAsSphere(c,b,this.sphereRadius)):"wireframe"==Model.representation?(this.canvas_atom_radius=.2,this.canvas_bond_width=.1,this.drawBondsAsStick(c,b,this.cylinderRadius/8,8*this.cylinderRadius,!0,!0,.05)):"line"==Model.representation&&(this.canvas_atom_radius=.05,this.canvas_bond_width=.1,this.drawBondsAsLine(c,b,1)),this.drawCartoon(c,a,!1),this.drawCartoonNucleicAcid(c,a)},Model._setRenderEngine("GLmol"),this.ready=!0,a&&a(),!0):(Messages.alert("no_canvas_support"),!1)},resize:function(){void 0!==this.view&&(void 0!==this.canvas&&void 0!==this.container&&this.canvas.css("width",this.container.width()),this.view.resize())},reset:function(){void 0!==this.view&&(this.view.zoom2D=30,this.view.zoomInto(this.view.getAllAtoms()),this.view.show())},setRepresentation:function(){void 0!==this.view&&(this.view.rebuildScene(),this.view.setBackground("#000000"),this.view.show())},loadMOL:function(a){void 0!==this.view&&this.view.loadMoleculeStr(!1,a)},loadPDB:function(a){void 0!==this.view&&this.view.loadMoleculeStr(!1,a)},toDataURL:function(){return void 0!==this.view?Detector.webgl?(this.view.show(),this.view.renderer.domElement.toDataURL("image/png")):document.getElementById("glmol").firstChild.toDataURL("image/png"):""}},JSmol:{ready:!1,readyCB:void 0,platformSpeed:4,picking:"OFF",init:function(a){return void 0!=Jmol?(delete Jmol._tracker,Detector.canvas?(this.readyCB=a,Messages.process(function(){Jmol.setDocument(0),Jmol.getApplet("JSmol",{width:$("#model").width(),height:$("#model").height(),debug:!1,showfrank:!1,disableJ2SLoadMonitor:!0,disableInitialConsole:!0,use:"HTML5",j2sPath:window.location.origin+window.location.pathname+"src/js/lib/jmol/j2s",script:'frank off; background black; set antialiasDisplay true; set disablePopupMenu true; set showunitcelldetails false; set hoverDelay 0.001; hover off; set MessageCallback "Model.JSmol.onMessage";',readyFunction:Model.JSmol.onReady.bind(Model.JSmol),console:"none"}),$("#jsmol").html(Jmol.getAppletHtml(JSmol))},"init_jmol"),!0):(Messages.alert("no_canvas_support"),!1)):void 0},onReady:function(){this.ready=!0,this.setPlatformSpeed(this.platformSpeed);var a=this;Model._setRenderEngine("JSmol"),Messages.hide(),a.readyCB&&a.readyCB()},onMessage:function(a,b){if(b.toLowerCase().indexOf("initial mmff e")>-1&&b.toLowerCase().indexOf("max steps = 0")>-1){var c=b.split(/ +/);Model.JSmol.print("Energy = "+c[5]+" kJ")}return null},script:function(a){this.ready&&Jmol.script(JSmol,a)},scriptWaitOutput:function(a){this.ready&&Jmol.scriptWaitOutput(JSmol,a)},print:function(a){this.ready&&Model.JSmol.script('set echo top left; background echo black; font echo 18 serif bold; color echo white; echo "'+a+'";')},resize:function(){this.ready&&Jmol.resizeApplet(JSmol,[$("#model").width(),$("#model").height()])},reset:function(){this.ready&&Model.JSmol.script("reset;")},setRepresentation:function(a){if(this.ready){var b="";"balls"==a?b+=JmolScripts.Ball_and_Stick:"stick"==a?b+=JmolScripts.Stick:"vdw"==a?b+=JmolScripts.van_der_Waals_Spheres:"wireframe"==a?b+=JmolScripts.Wireframe:"line"==a&&(b+=JmolScripts.Line),"PDB"==Model.data.current&&(b+=JmolScripts.Proteins),this.scriptWaitOutput(JmolScripts.resetLabels),this.scriptWaitOutput(b),this.scriptWaitOutput(JmolScripts.resetLabels)}},loadMOL:function(a){return this.ready?(JSmol._loadMolData(a),this.setRepresentation(Model.representation),this.setPicking(this.picking),!0):void 0},loadPDB:function(a){return this.ready?(this.script("set picking off;"),this._setPlatformSpeed(Model.JSmol.platformSpeed),JSmol.__loadModel(a),this.setRepresentation(Model.representation),!0):void 0},loadCIF:function(a,b){return this.ready?(b=b||[1,1,1],this.scriptWaitOutput("set defaultLattice {"+b.join(" ")+"};"),this.scriptWaitOutput("set showUnitcell "+(b.reduce(function(a,b){return a*b})>1?"false":"true")),JSmol.__loadModel(a),this.setRepresentation(Model.representation),this.setPicking(this.picking),!0):void 0},toDataURL:function(){return this.ready?document.getElementById("JSmol_canvas2d").toDataURL("image/png"):""},setPlatformSpeed:function(a){$(".jmol-rnd").removeClass("checked"),$("#jmol-render-"+(1==a?"minimal":4==a?"normal":"all")).addClass("checked"),this.platformSpeed=a,this._setPlatformSpeed(a)},_setPlatformSpeed:function(a){this.script("set antialiasDisplay "+(2>=a?"false":"true")+"; set platformSpeed "+a+";"),this.script(JmolScripts.resetLabels)},safeCallback:function(a,b,c){Model.setRenderEngine("JSmol",function(){c?Messages.process(function(){a(),Messages.hide()},b):window.setTimeout(a,100)})},clean:function(){this.script(JmolScripts.clearChargeDisplay),this.script(JmolScripts.resetLabels)},calculatePartialCharge:function(){if(this.ready){var a=Jmol.getPropertyAsArray(JSmol,"moleculeInfo.mf")[0];a.indexOf("H 1 F 1")>-1&&Jmol.script(JSmol,"{fluorine and connected(1,hydrogen)}.partialCharge = '-0.47';{hydrogen and connected(1,fluorine)}.partialCharge = '0.47';"),a.indexOf("H 1 Cl 1")>-1&&Jmol.script(JSmol,"{chlorine and connected(1,hydrogen)}.partialCharge = '-0.46';{hydrogen and connected(1,chlorine)}.partialCharge = '0.46';"),a.indexOf("H 1 Br 1")>-1&&Jmol.script(JSmol,"{bromine and connected(1,hydrogen)}.partialCharge = '-0.42';{hydrogen and connected(1,bromine)}.partialCharge = '0.42';"),a.indexOf("H 1 I 1")>-1&&Jmol.script(JSmol,"{iodine and connected(1,hydrogen)}.partialCharge = '-0.37';{hydrogen and connected(1,iodine)}.partialCharge = '0.37';"),Jmol.script(JSmol,"select *; calculate partialcharge;")}},loadMEPSurface:function(a){"PDB"!=Model.data.current&&(MolView.makeModelVisible(),Model.JSmol.safeCallback(function(){Model.JSmol.calculatePartialCharge(),Model.JSmol.script("isosurface vdw resolution 0 color range -.07 .07 map mep "+(a?"translucent":"opaque")+";"),Model.JSmol.script(JmolScripts.resetLabels)},"jmol_calculation",!0))},loadVDWSurface:function(){"PDB"!=Model.data.current&&(MolView.makeModelVisible(),Model.JSmol.safeCallback(function(){Model.JSmol.script("isosurface vdw translucent;"),Model.JSmol.script(JmolScripts.resetLabels)},"jmol_calculation",!0))},displayCharge:function(){if("PDB"!=Model.data.current){MolView.makeModelVisible();var a=Model.JSmol.ready?parseFloat(""+Jmol.evaluate(JSmol,"{*}.partialcharge.max"))>0:!1;Model.JSmol.safeCallback(function(){a||Model.JSmol.calculatePartialCharge(),Model.JSmol.script("color {*} partialCharge; color label yellow; label %-8.4[partialcharge]; hover off;")},"jmol_calculation",!a)}},displayDipoles:function(){if("PDB"!=Model.data.current){MolView.makeModelVisible();var a=Model.JSmol.ready?parseFloat(""+Jmol.evaluate(JSmol,"{*}.partialcharge.max"))>0:!1;Model.JSmol.safeCallback(function(){a||Model.JSmol.calculatePartialCharge(),Model.JSmol.script("dipole bonds on; dipole calculate bonds; hover off;")},"jmol_calculation",!a)}},displayNetDipole:function(){if("PDB"!=Model.data.current){MolView.makeModelVisible();var a=Model.JSmol.ready?parseFloat(""+Jmol.evaluate(JSmol,"{*}.partialcharge.max"))>0:!1;Model.JSmol.safeCallback(function(){a||Model.JSmol.calculatePartialCharge(),Model.JSmol.script("dipole molecular on; dipole calculate molecular; hover off;")},"jmol_calculation",!a)}},calculateEnergyMinimization:function(){"PDB"!=Model.data.current&&(MolView.makeModelVisible(),Model.JSmol.safeCallback(function(){Model.JSmol.script("minimize;")},"jmol_calculation",!1))},setPicking:function(a){this.picking=a,Model.JSmol.safeCallback(function(){"OFF"==a?(Model.JSmol.script("set picking off;"),Model.JSmol._setPlatformSpeed(Model.JSmol.platformSpeed)):(Model.JSmol._setPlatformSpeed(2),Model.JSmol.script("set picking off; set picking on; color measures yellow; set pickingstyle MEASURE; set picking MEASURE "+a+"; hover off;"))},"jmol_calculation",!1)}},CDW:{ready:!1,view:void 0,molecule:void 0,init:function(a){return void 0!=ChemDoodle?Detector.webgl?(this.view=new ChemDoodle.TransformCanvas3D("chemdoodle-canvas",$("#model").width(),$("#model").height()),this.view.specs.backgroundColor="#000000",this.view.specs.proteins_ribbonCartoonize=!0,this.view.specs.crystals_unitCellColor="#ffffff",Model._setRenderEngine("CDW"),this.ready=!0,a&&a(),!0):(Messages.alert("no_webgl_support"),!1):void 0},resize:function(){void 0!==this.view&&(this.view.resize($("#model").width(),$("#model").height()),void 0!==this.molecule&&this.view.loadMolecule(this.molecule))},reset:function(){void 0!==this.view&&(this.view.rotationMatrix=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],this.view.repaint())},setRepresentation:function(a){"balls"==a&&(a="Ball and Stick"),"stick"==a&&(a="Stick"),"vdw"==a&&(a="van der Waals Spheres"),"wireframe"==a&&(a="Wireframe"),"line"==a&&(a="Line"),this.view.specs.set3DRepresentation(a),this.view.repaint()},loadMOL:function(a){void 0!==this.view&&(this.molecule=ChemDoodle.readMOL(a,1),this.view.specs.projectionPerspective_3D=!0,this.view.specs.compass_display=!1,this.view.loadMolecule(this.molecule))},loadPDB:function(a){void 0!==this.view&&(this.molecule=ChemDoodle.readPDB(a),this.view.specs.projectionPerspective_3D=!0,this.view.specs.compass_display=!1,this.view.loadMolecule(this.molecule))},loadCIF:function(a,b){void 0!==this.view&&(b=b||[1,1,1],this.view.specs.crystals_displayUnitCell=1==b.reduce(function(a,b){return a*b}),this.view.specs.projectionPerspective_3D=!1,this.view.specs.compass_display=!0,this.molecule=ChemDoodle.readCIF(a,b[0],b[1],b[2]),this.view.loadMolecule(this.molecule))},toDataURL:function(){return void 0!==this.view?(this.view.repaint(),this.view.gl.canvas.toDataURL("image/png")):""}}},Request={HTTP_CLIENT_IP:"",HTTP_ACCEPT_LANGUAGE:"",alternativeLanguages:[],init:function(){for(var a=this.HTTP_ACCEPT_LANGUAGE.split(","),b=0;b<a.length;b++){var c=a[b].substr(0,2);"en"!=c&&Request.alternativeLanguages.push(c)}},translation:function(a,b){Request.alternativeLanguages.length>0&&a.length>0?(void 0!==xhr&&xhr.abort(),xhr=AJAX({dataType:"json",url:"http://mymemory.translated.net/api/get?q="+encodeURI(a)+"&langpair="+Request.alternativeLanguages[0]+"|en&de=hermanbergwerf@gmail.com&ip="+Request.HTTP_CLIENT_IP,success:function(a){b(a.responseData.translatedText)},error:function(){b(a)}})):b(a)},CIRsearch:function(a,b,c,d){return""===a?void d():void Request.ChemicalIdentifierResolver.search(a,!1,function(e){Progress.increment(),b?Request.ChemicalIdentifierResolver.search(a,!0,function(b){c(b,e,a)},d):c(e,a)},function(){Progress.increment(),Request.translation(a,function(e){Progress.increment(),a=e,Request.ChemicalIdentifierResolver.search(a,!1,function(e){Progress.increment(),b?Request.ChemicalIdentifierResolver.search(a,!0,function(b){c(b,e,a)},d):c(e,a)},d)})},d)},ChemicalIdentifierResolver:{search:function(a,b,c,d){return Request.ChemicalIdentifierResolver.available?(void 0!==xhr&&xhr.abort(),void(xhr=AJAX({dataType:"text",url:"http://cactus.nci.nih.gov/chemical/structure/"+a+"/file?format=sdf&get3d="+(b?"False":"True"),success:function(a){"<h1>Page not found (404)</h1>\n"==a||void 0===a?d():c(a)},error:function(a,b){"error"==b&&d&&d()}}))):void d()},resolve3d:function(a,b,c){return Request.ChemicalIdentifierResolver.available?(a=a.replace(/#/g,"%23"),void 0!==xhr&&xhr.abort(),void(xhr=AJAX({dataType:"text",url:"http://cactus.nci.nih.gov/chemical/structure/"+a+"/file?format=sdf&get3d=True",success:function(a){"<h1>Page not found (404)</h1>\n"===a||void 0===a?c&&c():b(a)},error:function(a,b){"error"==b&&c&&c()}}))):void c()},resolve2d:function(a,b,c){return Request.ChemicalIdentifierResolver.available?(a=a.replace(/#/g,"%23"),void 0!==xhr&&xhr.abort(),void(xhr=AJAX({dataType:"text",url:"http://cactus.nci.nih.gov/chemical/structure/"+a+"/file?format=sdf&get3d=False",success:function(a){"<h1>Page not found (404)</h1>\n"===a||void 0===a?c&&c():b(a)},error:function(a,b){"error"==b&&c&&c()}}))):void c()},getProperty:function(a,b,c,d,e){return Request.ChemicalIdentifierResolver.available?(a=a.replace(/#/g,"%23"),void AJAX({dataType:"text",url:"http://cactus.nci.nih.gov/chemical/structure/"+a+"/"+b,success:function(a){"<h1>Page not found (404)</h1>\n"===a||void 0===a?d&&d():c(a)},error:function(a,b){return 404==a.status?void(e&&e()):void("error"==b&&d&&d())}})):void d()}},PubChem:{data:[],maxRecords:50,MaxSeconds:10,search:function(a,b,c){return""===a?void(c&&c()):void Request.translation(a,function(d){Progress.increment(),a=d,void 0!==xhr&&xhr.abort(),xhr=AJAX({dataType:"json",url:"https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/name/"+encodeURIComponent(a)+"/cids/json?name_type=word",success:function(a){Progress.increment(),Request.PubChem.data=a.IdentifierList.CID.reverse(),b()},error:function(a,b){"error"==b&&c&&c()}})})},listkey:function(a,b,c,d,e){void 0!==xhr&&xhr.abort(),xhr=AJAX({dataType:"json",url:"smiles"==c?"https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/"+c+"/smiles/json?smiles="+b:"https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/"+c+"/"+a+"/"+b+"/json?MaxRecords="+Request.PubChem.maxRecords+"&MaxSeconds="+Request.PubChem.MaxSeconds,success:function(a){d(a.Waiting.ListKey)},error:function(a,b){"error"==b&&e&&e()}})},list:function(a,b,c,d){void 0!==xhr&&xhr.abort(),xhr=AJAX({dataType:"json",url:"https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/listkey/"+a+"/cids/json",success:function(a){a.IdentifierList?(Request.PubChem.data=a.IdentifierList.CID,b()):a.Waiting?c(a.Waiting.ListKey):a.Fault&&d&&d()},error:function(a,b){"error"==b&&d&&d()}})},description:function(a,b,c){AJAX({dataType:"json",url:"https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/"+a+"/description/json",success:b,error:function(a,b){"error"==b&&c&&c()}})},properties:function(a,b,c,d){AJAX({dataType:"json",url:"https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/"+a+"/property/"+b+"/json",success:c,error:function(a,b){"error"==b&&d&&d()}})},image:function(a){return"https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/"+a+"/png?record_type=2d"},mol:function(a,b,c,d){void 0!==xhr&&xhr.abort(),xhr=AJAX({dataType:"text",url:"https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/"+a+"/sdf?record_type="+(b?"2d":"3d"),success:c,error:function(a,b){"error"==b&&d&&d()}})},SMILES:{description:function(a,b,c){AJAX({dataType:"json",url:"https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/smiles/description/json?smiles="+encodeURIComponent(a),success:b,error:function(a,b){"error"==b&&c&&c()}})},properties:function(a,b,c,d){AJAX({dataType:"json",url:"https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/smiles/property/"+b+"/json?smiles="+encodeURIComponent(a),success:c,error:function(a,b){"error"==b&&d&&d()}})},image:function(a){return"https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/smiles/png?record_type=2d&smiles="+encodeURIComponent(a)}}},RCSB:{data:[],search:function(a,b,c){return""===a?void(c&&c()):void Request.translation(a,function(d){Progress.increment(),a=d,a=a.replace(/\s/g,"|"),void 0!==xhr&&xhr.abort(),xhr=AJAX({type:"POST",data:"<orgPdbQuery>						<queryType>org.pdb.query.simple.AdvancedKeywordQuery</queryType>						<description>Proteins search from MolView</description>						<keywords>"+a+"</keywords>						</orgPdbQuery>",contentType:"application/x-www-form-urlencoded",dataType:"text",url:"http://www.pdb.org/pdb/rest/search?sortfield=rank",success:function(a){Progress.increment(),Request.RCSB.data=a.split(/\n/),Request.RCSB.data=Request.RCSB.data.filter(function(a){return""!==a}),Request.RCSB.data.reverse(),Request.RCSB.data.length>0?b():c&&c()},error:function(a,b){"error"==b&&c&&c()}})})},information:function(a,b,c){void 0!==xhr&&xhr.abort(),xhr=AJAX({dataType:"text",url:"http://www.rcsb.org/pdb/rest/customReport?pdbids="+a.join()+"&customReportColumns=structureId,structureTitle",success:function(c){var d,e={dataset:[]},f=[],g=$(c).find("record");for(d=0;d<g.length;d++)f.push({structureId:$(g[d]).find("dimStructure\\.structureId").text(),structureTitle:$(g[d]).find("dimStructure\\.structureTitle").text()});for(d=0;d<a.length;d++)for(var h=0;h<f.length;h++)f[h].structureId!=a[d]||e.dataset.push(f[h]);b(e)},error:function(a,b){"error"==b&&c&&c()}})},image:function(a){return"http://www.rcsb.org/pdb/images/"+a+"_bio_r_500.jpg"},PDB:function(a,b,c){void 0!==xhr&&xhr.abort(),xhr=AJAX({dataType:"text",url:"http://www.rcsb.org/pdb/files/"+a+".pdb",success:b,error:function(a,b){"error"==b&&c&&c()}})}},NMRdb:{prediction:function(a,b,c){AJAX({dataType:"json",url:"http://www.nmrdb.org/service/prediction?smiles="+encodeURIComponent(a),success:function(a){b(a.jcamp.value)},error:function(a,b){"error"==b&&c&&c()}})}},NIST:{IRlookup:function(a,b,c){AJAX({dataType:"json",url:"nist.php?type=lookup&cas="+a,success:function(a){var c=[];c.mass=a.mass,c.uvvis=a.uvvis,c.ir=new Array,a.ir.sort(function(a,b){return a.i>b.i});for(var d=0;d<a.ir.length;d++)if(-1==a.ir[d].source.indexOf("NO SPECTRUM")){var e=humanize(a.ir[d].state);c.ir.push({i:a.ir[d].i,state:e})}b(c)},error:function(a,b){"error"==b&&c&&c()}})},spectrum:function(a,b,c,d){var e=0;-1!=b.indexOf("ir")&&(e=parseInt(b.substr(3)),b="ir"),AJAX({dataType:"text",url:"nist.php?type="+b+"&cas="+a+"&i="+e,success:c,error:function(a,b){"error"==b&&d&&d()}})}},COD:{data:[],search:function(a,b,c){return""===a?void(c&&c()):void Request.translation(a,function(d){Progress.increment(),a=d,void 0!==xhr&&xhr.abort(),xhr=AJAX({dataType:"json",url:"cod.php?type=search&q="+encodeURIComponent(a),success:function(a){Progress.increment(),a.records.length>0?(Request.COD.data=a.records,b()):c&&c()},error:function(a,b){"error"==b&&c&&c()}})})},information:function(a,b,c){void 0!==xhr&&xhr.abort(),xhr=AJAX({dataType:"json",url:"cod.php?type=information&codids="+a,success:b,error:function(a,b){"error"==b&&c&&c()}})},SMILES:function(a,b,c){void 0!==xhr&&xhr.abort(),xhr=AJAX({dataType:"json",url:"cod.php?type=smiles&codids="+a,success:b,error:function(a,b){"error"==b&&c&&c()}})},CIF:function(a,b,c){void 0!==xhr&&xhr.abort(),xhr=AJAX({dataType:"text",url:"cif.php?codid="+a,success:b,error:function(a,b){"error"==b&&c&&c()}})}}},Loader={lastQuery:{type:"",content:"",name:""},CIRsearch:function(){if(!Request.ChemicalIdentifierResolver.available)return void Messages.alert("cir_func_down");Progress.clear(),Progress.setSteps(3);var a=$("#search-input").val();Request.CIRsearch(a,!0,function(a,b,c){Sketcher.loadMOL(a),Sketcher.markUpdated(),Model.loadMOL(b),c=ucfirst(c),document.title=c,Progress.complete(),Messages.hide(),Loader.lastQuery.type="q",Loader.lastQuery.content=c,History.push("q",c)},function(){Messages.alert("search_fail")})},Compounds:{i:0,step:5,loading:!1,ssli:1e3,write:function(a){var b=$("<div class='result clickable'></div>");if($("<div class='img'></div>").css("background-image","url("+Request.PubChem.image(a.CID)+")").appendTo($("<div class='img-wrap'></div>").appendTo(b)),b.appendTo("#search-results .container"),a.Title){var c=$("<div class='title'><span>"+a.Title+"</span></div>");b.append(c),c.textfill({maxFontPixels:30})}b.data("cid",a.CID),b.data("title",a.Title),b.on("click",function(){"Range"!=window.getSelection().type&&(Actions.hide_search_results(),Loader.Compounds.loadCID($(this).data("cid"),$(this).data("title")))})},loadCIDS:function(a){0!==a.length&&Request.PubChem.description(a,function(a){for(var b=0;b<a.InformationList.Information.length;b++)Loader.Compounds.write(a.InformationList.Information[b]);Loader.Compounds.i>=Request.PubChem.data.length?$("#search-results .more").css("display","none"):$("#search-results .more").removeClass("loading"),Loader.Compounds.loading=!1,Progress.complete()},function(){Messages.alert("search_fail")})},loadNextSet:function(){if(!this.loading&&this.i<Request.PubChem.data.length){this.loading=!0;var a=this.i,b=this.i+this.step;b>Request.PubChem.data.length&&(b=Request.PubChem.data.length),this.loadCIDS(Request.PubChem.data.slice(a,b)),this.i=b,$("#search-results .more").addClass("loading")
}},search:function(){var a=$("#search-input").val();isNaN(a)?(Progress.clear(),Progress.setSteps(3),Request.PubChem.search(a,function(){Messages.hide(),$("#load-more-compounds").css("display","block"),$("#load-more-proteins").css("display","none"),$("#load-more-crystals").css("display","none"),$("#search-results .container").empty(),Actions.show_search_results(),Loader.Compounds.i=0,Loader.Compounds.loadNextSet()},function(){Messages.alert("search_fail")})):Messages.process(function(){Loader.Compounds.loadCID(a,document.title)},"compound")},structureSearch:function(a,b,c){Progress.clear(),Progress.setSteps(3),Request.PubChem.listkey(a,b,c,function(a){function b(){Request.PubChem.list(a,function(){Progress.increment(),Messages.hide(),$("#load-more-compounds").css("display","block"),$("#load-more-proteins").css("display","none"),$("#search-results .container").empty(),Actions.show_search_results(),Loader.Compounds.i=0,Loader.Compounds.loadNextSet()},function(c){a=c,window.setTimeout(b,Loader.Compounds.ssli)},function(){Messages.alert("search_fail")})}Progress.increment(),b()},function(){Messages.alert("search_fail")})},loadCID:function(a,b){Progress.clear(),Progress.setSteps(4),b=ucfirst(b),Messages.process(function(){Request.PubChem.mol(a,!0,function(c){Sketcher.loadMOL(c),Sketcher.markUpdated(),Progress.increment(),Request.PubChem.mol(a,!1,function(c){Model.loadMOL(c),Loader.lastQuery.type="cid",Loader.lastQuery.content=""+a,Sketcher.CID=a,document.title=b||"MolView",History.push("cid",a),Progress.complete(),Messages.hide()},function(){Progress.increment();var c;try{c=Sketcher.getSMILES()}catch(d){return Messages.alert("smiles_load_error",d),void(void 0===cb||success_cb||cb())}Progress.increment(),Request.ChemicalIdentifierResolver.resolve3d(c,function(c){Model.loadMOL(c),$("#resolve").addClass("updated"),Loader.lastQuery.type="cid",Loader.lastQuery.content=""+a,Sketcher.CID=a,document.title=b||"MolView",History.push("cid",a),Progress.complete(),Messages.hide()},function(){Messages.alert("load_fail")})})},function(){Messages.alert("load_fail")})},"compound")}},Proteins:{i:0,step:10,loading:!1,write:function(a){var b=$("<div class='result imgdesc title-select-only'></div>"),c=$("<div class='img'></div>").css("background-image","url("+Request.RCSB.image(a.structureId)+")");c.appendTo($("<div class='img-wrap'></div>").appendTo(b)),b.appendTo("#search-results .container");var d=$("<div class='title'><span>"+a.structureId+"</span></div>");b.append(d),d.textfill({maxFontPixels:30});var e=$("<div class='description light-scroll'>"+ucfirst(humanize(a.structureTitle))+"</div>");b.append(e);var f=d;f.data("pdbid",a.structureId),f.on("click",function(){"Range"!=window.getSelection().type&&(Actions.hide_search_results(),Loader.Proteins.loadPDBID($(this).data("pdbid")))})},loadPDBIDS:function(a){0!==a.length&&Request.RCSB.information(a,function(a){for(var b=0;b<a.dataset.length;b++)Loader.Proteins.write(a.dataset[b]);Loader.Proteins.i>=Request.RCSB.data.length?$("#search-results .more").css("display","none"):$("#search-results .more").removeClass("loading"),Loader.Proteins.loading=!1,Progress.complete(),Progress.hide()},function(){Messages.alert("search_fail")})},loadNextSet:function(){if(!this.loading&&this.i<Request.RCSB.data.length){this.loading=!0;var a=this.i,b=this.i+this.step;b>Request.RCSB.data.length&&(b=Request.RCSB.data.length),this.loadPDBIDS(Request.RCSB.data.slice(a,b)),this.i=b,$("#search-results .more").addClass("loading")}},search:function(){Progress.clear(),Progress.setSteps(3);var a=$("#search-input").val();Request.RCSB.search(a,function(){Messages.hide(),$("#load-more-compounds").css("display","none"),$("#load-more-proteins").css("display","block"),$("#load-more-crystals").css("display","none"),$("#search-results .container").empty(),Actions.show_search_results(),Loader.Proteins.i=0,Loader.Proteins.loadNextSet()},function(){Messages.alert("search_fail")})},loadPDBID:function(a,b){Progress.clear(),Progress.setSteps(2),MolView.setLayout("model"),Messages.process(function(){Progress.increment(),Request.RCSB.PDB(a,function(c){Detector.webgl?(Model.loadPDB(c),Sketcher.markOutdated(),document.title=b||a.toUpperCase(),Progress.complete(),Messages.hide(),Messages.alert("sketcher_no_proteins"),Loader.lastQuery.type="pdbid",Loader.lastQuery.content=""+a,History.push("pdbid",a)):MolView.mobile?Messages.alert("mobile_old_no_proteins"):Messages.process(function(){"JSmol"==Model.engine?(Model.loadPDB(c),Sketcher.markOutdated(),document.title=b||a.toUpperCase(),Progress.complete(),Messages.hide(),Messages.alert("sketcher_no_proteins"),Loader.lastQuery.type="pdbid",Loader.lastQuery.content=""+a,History.push("pdbid",a)):(Model.loadPDB(c,!0),Model.JSmol.setPlatformSpeed(1),Model.setRenderEngine("JSmol",function(){Sketcher.markOutdated(),document.title=b||a.toUpperCase(),Progress.complete(),Messages.hide(),Messages.alert("sketcher_no_proteins"),Loader.lastQuery.type="pdbid",Loader.lastQuery.content=""+a,History.push("pdbid",a)}))},"protein")},function(){Messages.alert("load_fail")})},"protein")}},Crystals:{i:0,step:10,loading:!1,write:function(a){var b=$("<div class='result title-select-only'></div>").appendTo("#search-results .container");a.formula=chemFormulaFormat(a.formula);var c=a.mineral||a.commonname||a.chemname||a.formula||"?",d=$("<div class='title'><span>"+c+"</span></div>");b.append(d),d.textfill({maxFontPixels:30});var e="";a.commonname&&a.commonname!=c&&(e+="<b>Common name:</b> "+a.commonname+"<br/>"),a.chemname&&a.chemname!=c&&(e+="<b>Chemical name:</b> "+a.chemname+"<br/>"),a.formula&&a.formula!=c&&(e+="<b>Formula:</b> "+a.formula+"<br/>"),""!=e&&(e+="<hr/>"),e+=a.title;var f=$("<div class='description light-scroll'>"+e+"</div>");b.append(f);var g=d;g.data("codid",a.codid),g.data("title",a.mineral||a.commonname||a.chemname||"COD: "+a.codid),g.on("click",function(){"Range"!=window.getSelection().type&&(Actions.hide_search_results(),Loader.Crystals.loadCODID($(this).data("codid"),$(this).data("title")))})},loadCODIDS:function(a){0!==a.length&&Request.COD.information(a,function(a){for(var b=0;b<a.records.length;b++)Loader.Crystals.write(a.records[b]);Loader.Crystals.i>=Request.COD.data.length?$("#search-results .more").css("display","none"):$("#search-results .more").removeClass("loading"),Loader.Crystals.loading=!1,Progress.complete()},function(){Messages.alert("search_fail")})},loadNextSet:function(){if(!this.loading&&this.i<Request.COD.data.length){this.loading=!0;var a=this.i,b=this.i+this.step;b>Request.COD.data.length&&(b=Request.COD.data.length),this.loadCODIDS(Request.COD.data.slice(a,b)),this.i=b,$("#search-results .more").addClass("loading")}},search:function(){Progress.clear(),Progress.setSteps(3);var a=$("#search-input").val();Request.COD.search(a,function(){Messages.hide(),$("#load-more-compounds").css("display","none"),$("#load-more-proteins").css("display","none"),$("#load-more-crystals").css("display","block"),$("#search-results .container").empty(),Actions.show_search_results(),Loader.Crystals.i=0,Loader.Crystals.loadNextSet()},function(){Messages.alert("search_fail")})},loadCODID:function(a,b){function c(){document.title=b||"COD: "+a,Progress.complete(),Messages.hide(),Loader.lastQuery.type="codid",Loader.lastQuery.content=""+a,History.push("codid",a)}Progress.clear(),Progress.setSteps(2),MolView.makeModelVisible(),Messages.process(function(){Progress.increment(),Request.COD.CIF(a,function(b){Model.loadCIF(b),Request.COD.SMILES(a,function(a){""==a.records[0].smiles?(c(),Messages.alert("crystal_2d_fail")):Request.ChemicalIdentifierResolver.resolve2d(a.records[0].smiles,function(a){Sketcher.loadMOL(a),Sketcher.markUpdated(),c()},function(){c(),Messages.alert("crystal_2d_fail")})},function(){c(),Messages.alert("crystal_2d_fail")})},function(){Messages.alert("load_fail")})},"crystal")}},clean:function(){if(!Request.ChemicalIdentifierResolver.available)return void Messages.alert("cir_func_down");Progress.clear(),Progress.setSteps(2);var a;try{a=Sketcher.getSMILES()}catch(b){return void Messages.alert("smiles_load_error",b)}Progress.increment(),Request.ChemicalIdentifierResolver.resolve2d(a,function(a){Sketcher.loadMOL(a),Progress.complete(),Messages.hide()},function(){Messages.alert("clean_fail")})},resolve:function(){if(!Request.ChemicalIdentifierResolver.available)return void Messages.alert("cir_func_down");Progress.clear(),Progress.setSteps(2);var a;try{a=Sketcher.getSMILES()}catch(b){return Messages.alert("smiles_load_error",b),void(void 0===cb||success_cb||cb())}Progress.increment(),Request.ChemicalIdentifierResolver.resolve3d(a,function(b){Model.loadMOL(b),$("#resolve").addClass("updated"),Progress.complete(),Messages.hide(),Loader.lastQuery.type="smiles",Loader.lastQuery.content=a,History.push("smiles",a)},function(){Messages.alert("resolve_fail")})},loadSMILES:function(a,b){return Request.ChemicalIdentifierResolver.available?(Progress.clear(),Progress.setSteps(2),document.title=b||"MolView",void Request.ChemicalIdentifierResolver.resolve3d(a,function(b){Progress.increment(),Model.loadMOL(b),Request.ChemicalIdentifierResolver.resolve2d(a,function(b){Sketcher.loadMOL(b),Sketcher.markUpdated(),Loader.lastQuery.type="smiles",Loader.lastQuery.content=a,History.push("smiles",a),Progress.complete(),Messages.hide()},function(){Messages.alert("load_fail")})},function(){Messages.alert("load_fail")})):void Messages.alert("cir_func_down")}},Actions={window_sketcher:function(){MolView.setLayout("sketcher")},window_model:function(){MolView.setLayout("model")},window_vsplit:function(){MolView.setLayout("vsplit")},window_hsplit:function(){MolView.setLayout("hsplit")},help:function(){MolView.showDialog("help")},about:function(){MolView.showDialog("about")},share:function(){Link.updateShareDialog(),MolView.showDialog("share")},embed:function(){Link.updateEmbedDialog(),MolView.showDialog("embed")},export_2D:function(){var a=Sketcher.toDataURL(),b=dataURItoBlob(a);null!==b&&saveAs(b,document.title+" (structural formula).png")},export_3D:function(){var a=Model.toDataURL(),b=dataURItoBlob(a);null!==b&&saveAs(b,document.title+" (model).png")},save_local_3D:function(a){var b=Model.getDataBlob();saveAs(b,(a||document.title)+"."+Model.data.current.toLowerCase())},data_properties:function(){if("pdbid"==Loader.lastQuery.type)window.open("http://www.rcsb.org/pdb/explore/explore.do?structureId="+Loader.lastQuery.content);else if("codid"==Loader.lastQuery.type)window.open("http://www.crystallography.net/"+Loader.lastQuery.content+".html");else{var a;try{a=Sketcher.getSMILES()}catch(b){return void Messages.alert("smiles_load_error_force",b)}MolView.showDialog("properties"),window.setTimeout(function(){ChemicalData.update(a),ChemicalData.updateProperties(),ChemicalData.updateMoleculeImage()},100)}},data_spectra:function(){var a;try{a=Sketcher.getSMILES()}catch(b){return void Messages.alert("smiles_load_error_force",b)}ChemicalData.smiles!=a&&ChemicalData.spectrumPrint("No spectrum selected"),MolView.showDialog("spectra"),window.setTimeout(function(){ChemicalData.update(a),ChemicalData.resizeSpectrum(),ChemicalData.updateSpectra()},100)},png_current_spectrum:function(){if(!ChemicalData.spectrum_data[$("#spectrum-select").val()])return void alert("No spectrum selected!");var a=document.getElementById("spectrum-canvas").toDataURL("image/png"),b=dataURItoBlob(a);null!==b&&saveAs(b,$("#spectrum-select").find("option:selected").text()+".png")},jcamp_current_spectrum:function(){if(!ChemicalData.spectrum_data[$("#spectrum-select").val()])return void alert("No spectrum selected!");var a=new Blob([ChemicalData.spectrum_data[$("#spectrum-select").val()]],{type:"chemical/x-jcamp-dx;charset=utf-8"});null!==a&&saveAs(a,$("#spectrum-select").find("option:selected").text()+".jdx")},search_substructure:function(){MolView.hideWindows(),Actions.hide_search_results(),Messages.process(function(){if(Sketcher.CID)Loader.Compounds.structureSearch("cid",Sketcher.CID,"substructure");else{var a;try{a=Sketcher.getSMILES()}catch(b){return void Messages.alert("smiles_load_error_force",b)}Loader.Compounds.structureSearch("smiles",a,"substructure")}},"search")},search_superstructure:function(){MolView.hideWindows(),Actions.hide_search_results(),Messages.process(function(){if(Sketcher.CID)Loader.Compounds.structureSearch("cid",Sketcher.CID,"superstructure");else{var a;try{a=Sketcher.getSMILES()}catch(b){return void Messages.alert("smiles_load_error_force",b)}Loader.Compounds.structureSearch("smiles",a,"superstructure")}},"search")},search_similarity:function(){MolView.hideWindows(),Actions.hide_search_results(),Messages.process(function(){if(Sketcher.CID)Loader.Compounds.structureSearch("cid",Sketcher.CID,"similarity");else{var a;try{a=Sketcher.getSMILES()}catch(b){return void Messages.alert("smiles_load_error_force",b)}Loader.Compounds.structureSearch("smiles",a,"similarity")}},"search")},model_reset:function(){Model.reset()},model_balls:function(){Model.setRepresentation("balls")},model_stick:function(){Model.setRepresentation("stick")},model_vdw:function(){Model.setRepresentation("vdw")},model_wireframe:function(){Model.setRepresentation("wireframe")},model_line:function(){Model.setRepresentation("line")},engine_glmol:function(){Messages.hide(),Messages.process(function(){Model.setRenderEngine("GLmol",Messages.hide)},"switch_engine")},engine_jmol:function(){Messages.hide(),Messages.process(function(){Model.setRenderEngine("JSmol",Messages.hide)},"switch_engine")},engine_cdw:function(){Messages.hide(),Messages.process(function(){Model.setRenderEngine("CDW",Messages.hide)},"switch_engine")},cif_unit_cell:function(){"CIF"==Model.data.current&&Messages.process(function(){Model.loadCIF(Model.data.cif,[1,1,1]),Messages.hide()},"crystal_structure")},cif_2x2x2_cell:function(){"CIF"==Model.data.current&&Messages.process(function(){Model.loadCIF(Model.data.cif,[2,2,2]),Messages.hide()},"crystal_structure")},cif_1x3x3_cell:function(){"CIF"==Model.data.current&&Messages.process(function(){Model.loadCIF(Model.data.cif,[1,3,3]),Messages.hide()},"crystal_structure")},jmol_clean:function(){Model.JSmol.clean()},mep_lucent:function(){Model.JSmol.loadMEPSurface(!0)},mep_opaque:function(){Model.JSmol.loadMEPSurface(!1)},vdw_surface:function(){Model.JSmol.loadVDWSurface()},jmol_charge:function(){Model.JSmol.displayCharge()},bond_dipoles:function(){Model.JSmol.displayDipoles()},net_dipole:function(){Model.JSmol.displayNetDipole()},jmol_minimize:function(){Model.JSmol.calculateEnergyMinimization()},measure_distance:function(){var a=$("#measure-distance").hasClass("checked");$(".jmol-picking").removeClass("checked"),a||$("#measure-distance").addClass("checked"),Model.JSmol.setPicking(a?"OFF":"DISTANCE")},measure_angle:function(){var a=$("#measure-angle").hasClass("checked");$(".jmol-picking").removeClass("checked"),a||$("#measure-angle").addClass("checked"),Model.JSmol.setPicking(a?"OFF":"ANGLE")},measure_torsion:function(){var a=$("#measure-torsion").hasClass("checked");$(".jmol-picking").removeClass("checked"),a||$("#measure-torsion").addClass("checked"),Model.JSmol.setPicking(a?"OFF":"TORSION")},jmol_render_all:function(){Model.JSmol.setPlatformSpeed(7)},jmol_render_normal:function(){Model.JSmol.setPlatformSpeed(4)},jmol_render_minimal:function(){Model.JSmol.setPlatformSpeed(1)},fast_search:function(){""===$("#search-input").val()?($("#search-input").focus(),MolView.alertEmptyInput()):($("#search-input").blur(),MolView.hideWindows(),Actions.hide_search_results(),Messages.process(Loader.CIRsearch,"search"))},pubchem_search:function(){""===$("#search-input").val()?($("#search-input").focus(),MolView.alertEmptyInput()):($("#search-input").blur(),MolView.hideWindows(),Actions.hide_search_results(),Messages.process(Loader.Compounds.search,"search"))},proteins_search:function(){""===$("#search-input").val()?($("#search-input").focus(),MolView.alertEmptyInput()):($("#search-input").blur(),MolView.hideWindows(),Actions.hide_search_results(),Messages.process(Loader.Proteins.search,"search"))},crystals_search:function(){""===$("#search-input").val()?($("#search-input").focus(),MolView.alertEmptyInput()):($("#search-input").blur(),MolView.hideWindows(),Actions.hide_search_results(),Messages.process(Loader.Crystals.search,"search"))},show_search_results:function(){$("#show-search-results").css("display","none"),$("#hide-search-results").css("display","block"),$("#search-results").css("display","block")},hide_search_results:function(){$("#hide-search-results").css("display","none"),$("#show-search-results").css("display","block"),$("#search-results").css("display","none")},load_more_compounds:function(){Loader.Compounds.loadNextSet()},load_more_proteins:function(){Loader.Proteins.loadNextSet()},load_more_crystals:function(){Loader.Crystals.loadNextSet()},clean:function(){Messages.process(Loader.clean,"clean")},resolve:function(){$("#search-results").css("display","none"),Messages.process(Loader.resolve,"resolve")},request_fullscreen:function(){launchFullscreen(document.documentElement)},exit_fullscreen:function(){exitFullscreen()}};$.fn.share=function(a,b,c){var d="View chemical structures using this free webapp!";this.children().each(function(){if($(this).hasClass("facebook")){var e=$(this);e.empty().unbind(),b?$.ajax({url:"https://api.facebook.com/method/fql.query?query="+encodeURIComponent("select total_count from link_stat where url='"+(a.fb||a.all)+"'")+"&format=json&callback=?",dataType:"jsonp",success:function(a){e.data("total_count",a[0].total_count),$("<span></span>").html(""+a[0].total_count+" Likes").appendTo(e)}}):$("<span></span>").html("Facebook").appendTo(e),e.on("click",function(){window.open("https://www.facebook.com/sharer/sharer.php?u="+encodeURIComponent(a.fb||a.all))})}else if($(this).hasClass("twitter")){var e=$(this);e.empty().unbind(),b?$.ajax({url:"http://cdn.api.twitter.com/1/urls/count.json?url="+encodeURIComponent(a.twitter||a.all)+"&callback=?",dataType:"jsonp",success:function(a){e.data("count",a.count),$("<span></span>").html(""+a.count+" Tweets").appendTo(e)}}):$("<span></span>").html("Twitter").appendTo(e),e.on("click",function(){window.open("https://twitter.com/intent/tweet?text="+encodeURIComponent(c||d)+"&url="+encodeURIComponent(a.twitter||a.all)+"&via=molview")})}else if($(this).hasClass("googleplus")){var e=$(this);e.empty().unbind(),b?$.ajax({url:"gplus.php?url="+encodeURIComponent(a.gplus||a.all),dataType:"json",success:function(a){e.data("count",a.count),$("<span></span>").html(""+a.count+" +1's").appendTo(e)}}):$("<span></span>").html("Google+").appendTo(e),e.on("click",function(){window.open("https://plus.google.com/share?hl=en-US&url="+encodeURIComponent(a.gplus||a.all))})}})};var Link={embedHTML:"",init:function(){$("#embed-width, #embed-height").on("keyup",this.updateEmbedDialog)},updateShareDialog:function(){$("#resolve").hasClass("updated")||"model"==MolView.layout?$("#share-2d-not-3d").hide():$("#share-2d-not-3d").show();var a=window.location.origin+window.location.pathname+"?mode="+Model.representation,b="";""!==Loader.lastQuery.type&&(b="Cool structure on MolView!",a+="&"+Loader.lastQuery.type+"="+specialEncodeURIComponent(Loader.lastQuery.content.replace(/^ /,""))),"sketcher"!=MolView.layout&&"model"!=MolView.layout||"PDB"==Model.data.current||(a+="&layout="+MolView.layout),$("#share-link").val(a),$("#share-dialog .social").share({all:a},!1,b)},updateEmbedDialog:function(){$("#resolve").hasClass("updated")||"model"==MolView.layout?$("#share-2d-not-3d").hide():$("#share-2d-not-3d").show();var a=window.location.origin+window.location.pathname+"embed/?mode="+Model.representation;""!==Loader.lastQuery.type&&(a+="&"+Loader.lastQuery.type+"="+specialEncodeURIComponent(Loader.lastQuery.content.replace(/^ /,""))),Link.embedHTML='<iframe style="width: '+$("#embed-width").val()+"; height: "+$("#embed-height").val()+';" frameborder="0" src="'+a+'"></iframe>',$("#embed-code").val(Link.embedHTML)}},ChemicalData={smiles:"",data:{},spectrum_data:{},spectrum:void 0,spectrum_ratio:1/.3,CIR_retry_interval:1e3,updated:{properties:!1,spectra:!1},init:function(){$(window).on("resize",function(){$("#properties-dialog").is(":visible")&&ChemicalData.updateMoleculeImage(),$("#spectra-dialog").is(":visible")&&ChemicalData.resizeSpectrum()}),$("#spectrum-select").on("change",function(){ChemicalData.loadSpectrum($("#spectrum-select").val())}),MolView.mobile?($("#spectrum-wrapper").on("touchmove",function(a){a.stopImmediatePropagation()}),this.spectrum_ratio=2,this.spectrum=new ChemDoodle.ObserverCanvas("spectrum-canvas",100,100)):this.spectrum=new ChemDoodle.SeekerCanvas("spectrum-canvas",100,100,ChemDoodle.SeekerCanvas.SEEK_PLOT),this.spectrum.specs.plots_showYAxis=!0,this.spectrum.specs.plots_flipXAxis=!0,this.spectrum.specs.plots_showGrid=!0,this.spectrum.specs.backgroundColor="#ffffff",this.spectrum.emptyMessage="No spectrum selected"},update:function(a){this.smiles!=a&&""!=a&&($(".chemprop").removeClass("unavailable").addClass("loading"),$(".chemprop:not(.chem-spectrum)").html("").val(""),$("#molecule-image").attr("src","src/img/empty.png").addClass("loading"),$("#molecule-title").text(""),$("#molecule-description").text(""),$("#chemspider-external-link").hide(),$("#pubchem-external-link").hide(),this.smiles=a,this.data={},this.spectrum_data={},this.updated.properties=!1,this.updated.spectra=!1)},updateProperties:function(){function a(){$("#pubchem-external-link").attr("href","https://pubchem.ncbi.nlm.nih.gov/summary/summary.cgi?cid="+ChemicalData.data.CID).show()}this.updated.properties||(this.updated.properties=!0,Request.ChemicalIdentifierResolver.getProperty(this.smiles,"formula",function(a){ChemicalData.data.formula=a,$("#prop-formula").html(chemFormulaFormat(a)).removeClass("loading")},function(){$("#prop-formula").addClass("unavailable")}),Request.ChemicalIdentifierResolver.getProperty(this.smiles,"mw",function(a){ChemicalData.data.mw=a,$("#prop-weight").text(a+" u").removeClass("loading")},function(){$("#prop-weight").addClass("unavailable")}),this.CIRproperty("prop-h-donors","h_bond_donor_count"),this.CIRproperty("prop-h-acceptors","h_bond_acceptor_count"),this.CIRproperty("prop-ro5-violations","rule_of_5_violation_count"),this.CIRproperty("prop-fr-bonds","rotor_count"),this.CIRproperty("prop-er-bonds","effective_rotor_count"),this.CIRproperty("prop-rings","ring_count"),this.CIRproperty("prop-ring-systems","ringsys_count"),this.CIRproperty("prop-stdinchikey","stdinchikey"),this.CIRproperty("prop-stdinchi","stdinchi"),this.CIRproperty("prop-cas","cas"),this.CIRproperty("prop-chemspider_id","chemspider_id",function(){$("#chemspider-external-link").attr("href","http://www.chemspider.com/Chemical-Structure."+ChemicalData.data.chemspider_id+".html").show()}),Sketcher.CID?(ChemicalData.data.CID=Sketcher.CID,$("#prop-cid").val(ChemicalData.data.CID).removeClass("loading"),a(),Request.PubChem.description(Sketcher.CID,function(a){a=a.InformationList.Information[0],$("#molecule-title").text(ucfirst(a.Title)),$("#molecule-description").text(a.Description),ChemicalData.PubChemProperty("prop-iupac","IUPACName"),ChemicalData.PubChemProperty("prop-smiles","CanonicalSMILES")},function(){$("#prop-smiles").val(ChemicalData.smiles).removeClass("loading"),$("#prop-iupac").removeClass("loading").addClass("unavailable")})):Request.PubChem.SMILES.description(this.smiles,function(b){b=b.InformationList.Information[0],ChemicalData.data.CID=b.CID,$("#prop-cid").val(b.CID).removeClass("loading"),a(),$("#molecule-title").text(ucfirst(b.Title)),$("#molecule-description").text(b.Description),ChemicalData.PubChemProperties(["prop-iupac","prop-smiles"],["IUPACName","CanonicalSMILES"])},function(){$("#prop-smiles").val(ChemicalData.smiles).removeClass("loading"),$("#prop-cid").removeClass("loading").addClass("unavailable"),$("#prop-iupac").removeClass("loading").addClass("unavailable")}))},updateSpectra:function(){function a(){$("#spectrum-select").append('<option value="default" disabled selected style="display:none;">Choose a spectrum</option>'),$("#spectrum-select").append('<option value="nmrdb">H1-NMR prediction</option>'),$("#spectrum").removeClass("loading")}this.updated.spectra||(this.updated.spectra=!0,$("#spectrum").addClass("loading"),$("#spectrum-select").html('<option value="loading" disabled selected style="display:none;">Loading...</option>').val("loading"),this.spectrumPrint("No spectrum selected"),this.CIRproperty("prop-cas","cas",function(){Request.NIST.IRlookup(ChemicalData.data.cas,function(a){if($("#spectrum-select").empty(),$("#spectrum-select").append('<option value="default" disabled selected style="display:none;">Choose a spectrum</option>'),$("#spectrum-select").append('<option value="nmrdb">H1-NMR prediction</option>'),a.mass&&$("#spectrum-select").append('<option value="nist-mass">Mass spectrum</option>'),void 0!==a.ir)for(var b=0;b<a.ir.length;b++)$("#spectrum-select").append('<option value="nist-ir-'+a.ir[b].i+'">IR spectrum ['+a.ir[b].state+"]</option>");$("#spectrum-select").val("default"),$("#spectrum").removeClass("loading")},a)},a))},loadSpectrum:function(a){function b(){var a=ChemDoodle.readJCAMP(ChemicalData.spectrum_data.nmrdb);a.title=ucfirst(humanize(a.title)),a.yUnit=ucfirst(humanize(a.yUnit)),ChemicalData.spectrum.specs.plots_flipXAxis=!0,ChemicalData.spectrum.loadSpectrum(a),$("#spectrum").removeClass("loading")}function c(){var b=ChemDoodle.readJCAMP(ChemicalData.spectrum_data[a]);b.title=ucfirst(humanize(b.title)),b.yUnit=ucfirst(humanize(b.yUnit)),ChemicalData.spectrum.specs.plots_flipXAxis="nist-mass"==a?!1:!0,ChemicalData.spectrum.loadSpectrum(b),$("#spectrum").removeClass("loading")}if(this.spectrumPrint("Loading..."),$("#spectrum").addClass("loading"),"nmrdb"==a)this.spectrum_data.nmrdb?b():Request.NMRdb.prediction(this.smiles,function(a){ChemicalData.spectrum_data.nmrdb=a,b()},function(){ChemicalData.spectrumPrint("Spectrum unavailable")});else if(a.indexOf(!0)){if(!this.data.cas)return;void 0===this.spectrum_data[a]?Request.NIST.spectrum(this.data.cas,a.substr(5),function(b){ChemicalData.spectrum_data[a]=b,c()},function(){ChemicalData.spectrumPrint("Spectrum unavailable")}):c()}},spectrumPrint:function(a){ChemicalData.spectrum.emptyMessage=a,ChemicalData.spectrum.loadSpectrum(null)},resizeSpectrum:function(){var a=$("#spectrum").width(),b=Math.round(a/ChemicalData.spectrum_ratio);$("#spectrum-wrapper").css({width:a,height:b}),ChemicalData.spectrum.resize(a*(MolView.mobile?2:1),b*(MolView.mobile?2:1))},updateMoleculeImage:function(){if(""!=ChemicalData.smiles){$("#molecule-image").addClass("loading");var a=$("#molecule-image").width()*(MolView.mobile?1.5:1),b=new Image;b.onload=function(){$("#molecule-image").attr("src",b.src).removeClass("loading")},b.onerror=function(){$("#molecule-image").attr("src","src/img/ask-black.svg").removeClass("loading")},b.src=Sketcher.CID?Request.PubChem.image(Sketcher.CID)+"&image_size="+a+"x"+a:Request.PubChem.SMILES.image(ChemicalData.smiles)+"&image_size="+a+"x"+a}},CIRproperty:function(a,b,c,d){function e(){Request.ChemicalIdentifierResolver.getProperty(f,b,function(d){var e=d.split("\n"),f=e[0];"cas"==b&&(e.sort(function(a,b){return a.length>b.length}),f=e[0]),ChemicalData.data[b]=f,$(a).removeClass("loading"),$(a).is("input")?$(a).val(f):$(a).text(f),c&&c()},function(){f==ChemicalData.smiles&&window.setTimeout(e,ChemicalData.CIR_retry_interval)},function(){$(a).removeClass("loading").addClass("unavailable"),d&&d()})}if(void 0!=ChemicalData.data[b])return void(c&&c());a="#"+a;var f=ChemicalData.smiles;e()},PubChemProperties:function(a,b){ChemicalData.data.CID&&a.length==b.length&&Request.PubChem.properties(ChemicalData.data.CID,""+b,function(c){c=c.PropertyTable.Properties[0];for(var d=0;d<a.length;d++){var e="#"+a[d];$(e).removeClass("loading"),c[b[d]]?(ChemicalData.data[b[d]]=c[b[d]],$(e).is("input")?$(e).val(c[b[d]]):$(e).text(c[b[d]])):$(e).addClass("unavailable")}},function(){$("#"+a.reduce(function(a,b){return a+",#"+b})).removeClass("loading").addClass("unavailable")})}},MolView={layout:"",touch:!1,mobile:!1,height:0,trigger:"click",query:{},loadDefault:!0,init:function(){(this.query.q||this.query.smiles||this.query.cid||this.query.pdbid||this.query.codid)&&(this.loadDefault=!1),this.touch=isTouchDevice(),this.touch&&$(document.body).addClass("touch"),this.mobile=isMobile(),this.height=window.innerHeight,this.mobile&&!Detector.webgl&&$("#proteins-search").hide(),Progress.init(),this.loadDefault&&(Progress.clear(),Progress.setSteps(2)),History.init(),Link.init(),ChemicalData.init(),$(window).on("resize",function(){"search-input"==document.activeElement.id&&MolView.touch?(window.innerHeight>MolView.height&&$("#search-input").blur(),MolView.height=window.innerHeight):(Sketcher.resize(),Model.resize())}),$(".dropdown-toggle").on(this.trigger,function(a){a.stopPropagation(),$(".dropdown-toggle").not(this).parent().removeClass("open");var b=this;$(this).parent().hasClass("open")?window.setTimeout(function(){$(b).parent().removeClass("open"),$("#menu").removeClass("open")},100):($(b).parent().addClass("open"),$("#menu").addClass("open"))}),$(".dropdown-menu a").on(this.trigger,function(a){if($(this).hasClass("disabled"))a.stopImmediatePropagation();else{var b=this;window.setTimeout(function(){$(".dropdown-toggle").not(b).parent().removeClass("open"),$("#menu").removeClass("open")},100)}}),$(window).on(this.trigger,function(a){var b=$(".dropdown.open .dropdown-menu"),c=$("#search");b.is(a.target)||0!==b.has(a.target).length||window.setTimeout(function(){b.parent().removeClass("open"),$("#menu").removeClass("open")},100),c.is(a.target)||0!==c.has(a.target).length||"search-input"!=document.activeElement.id||$("#search-input").blur()}),$("#window-layer").on("mousedown",function(a){var b=a.target||a.srcElement;"Range"==window.getSelection().type||$(document.activeElement).is("input")||$(b).is(this)&&(MolView.hideWindows(),window.getSelection().removeAllRanges())}),$("#window-layer .dialog .btn.close").on(this.trigger,function(){MolView.hideWindows()}),$(".expandable .title").on(this.trigger,function(){$(this).parent().toggleClass("open")}),$("#search-input-wrap").on(this.trigger,function(){$("#search-input").focus()}),Messages.init(),Request.init(),Sketcher.init(),this.loadDefault&&Progress.increment(),this.touch&&!Detector.webgl&&Actions.jmol_render_minimal(),Model.init(function(){$("#window-sketcher").on(this.trigger,Actions.window_sketcher),$("#window-model").on(this.trigger,Actions.window_model),$("#window-vsplit").on(this.trigger,Actions.window_vsplit),$("#window-hsplit").on(this.trigger,Actions.window_hsplit),$("#mv-help").on(this.trigger,Actions.help),$("#mv-about").on(this.trigger,Actions.about),$("#mv-share").on(this.trigger,Actions.share),$("#mv-embed").on(this.trigger,Actions.embed),$("#export-2d").on(this.trigger,Actions.export_2D),$("#export-3d").on(this.trigger,Actions.export_3D),$("#save-local-3d").on(this.trigger,function(){Actions.save_local_3D(Loader.lastQuery.name)}),$("#data-properties").on(this.trigger,Actions.data_properties),$("#data-spectra").on(this.trigger,Actions.data_spectra),$("#search-substructure").on(this.trigger,Actions.search_substructure),$("#search-superstructure").on(this.trigger,Actions.search_superstructure),$("#search-similarity").on(this.trigger,Actions.search_similarity),$("#model-reset").on(this.trigger,Actions.model_reset),$("#model-balls").on(this.trigger,Actions.model_balls),$("#model-stick").on(this.trigger,Actions.model_stick),$("#model-vdw").on(this.trigger,Actions.model_vdw),$("#model-wireframe").on(this.trigger,Actions.model_wireframe),$("#model-line").on(this.trigger,Actions.model_line),$("#cif-unit-cell").on(this.trigger,Actions.cif_unit_cell),$("#cif-2x2x2-cell").on(this.trigger,Actions.cif_2x2x2_cell),$("#cif-1x3x3-cell").on(this.trigger,Actions.cif_1x3x3_cell),$("#engine-glmol").on(this.trigger,Actions.engine_glmol),$("#engine-jmol").on(this.trigger,Actions.engine_jmol),$("#engine-cdw").on(this.trigger,Actions.engine_cdw),$("#jmol-clean").on(this.trigger,Actions.jmol_clean),$("#mep-lucent").on(this.trigger,Actions.mep_lucent),$("#mep-opaque").on(this.trigger,Actions.mep_opaque),$("#vdw-surface").on(this.trigger,Actions.vdw_surface),$("#jmol-charge").on(this.trigger,Actions.jmol_charge),$("#bond-dipoles").on(this.trigger,Actions.bond_dipoles),$("#net-dipole").on(this.trigger,Actions.net_dipole),$("#jmol-minimize").on(this.trigger,Actions.jmol_minimize),$("#measure-distance").on(this.trigger,Actions.measure_distance),$("#measure-angle").on(this.trigger,Actions.measure_angle),$("#measure-torsion").on(this.trigger,Actions.measure_torsion),$("#jmol-render-all").on(this.trigger,Actions.jmol_render_all),$("#jmol-render-normal").on(this.trigger,Actions.jmol_render_normal),$("#jmol-render-minimal").on(this.trigger,Actions.jmol_render_minimal),$("#search").on("submit",Actions.fast_search),$("#pubchem-search").on("click",Actions.pubchem_search),$("#proteins-search").on("click",Actions.proteins_search),$("#crystals-search").on("click",Actions.crystals_search),$("#show-search-results, #menu-show-search-results").on(this.trigger,Actions.show_search_results),$("#hide-search-results, #menu-hide-search-results").on(this.trigger,Actions.hide_search_results),$("#load-more-compounds").on(this.trigger,Actions.load_more_compounds),$("#load-more-proteins").on(this.trigger,Actions.load_more_proteins),$("#load-more-crystals").on(this.trigger,Actions.load_more_crystals),$("#me-clean").on(this.trigger,Actions.clean),$("#resolve").on(this.trigger,Actions.resolve),$("#me-info").on(this.trigger,Actions.about),$("#start-help").on(this.trigger,Actions.help),$("#png-current-spectrum").on(this.trigger,Actions.png_current_spectrum),$("#jcamp-current-spectrum").on(this.trigger,Actions.jcamp_current_spectrum),this.loadDefault&&(Progress.complete(),Progress.hide()),this.executeQuery(),Sketcher.markUpdated(),Request.ChemicalIdentifierResolver.available||Messages.alert("cir_down")
}.bind(this),Detector.webgl?"GLmol":"JSmol")},executeQuery:function(){$.each(this.query,function(a,b){"q"==a?($("#search-input").val(b),MolView.query.search?"fast"==MolView.query.search?Actions.fast_search():"pubchem"==MolView.query.search?Actions.pubchem_search():"proteins"==MolView.query.search&&Actions.proteins_search():Actions.fast_search()):"smiles"==a?Messages.process(function(){Loader.loadSMILES(b,document.title)},"compound"):"cid"==a?Messages.process(function(){Loader.Compounds.loadCID(b,document.title)},"compound"):"pdbid"==a?Messages.process(function(){Loader.Proteins.loadPDBID(b,b.toUpperCase())},"protein"):"codid"==a?Messages.process(function(){Loader.Crystals.loadCODID(b,document.title)},"protein"):"dialog"==a?MolView.showDialog(b):"mode"==a&&("balls"==b&&Actions.model_balls(),"stick"==b&&Actions.model_stick(),"vdw"==b&&Actions.model_vdw(),"wireframe"==b&&Actions.model_wireframe(),"line"==b&&Actions.model_line())})},showDialog:function(a){$("#window-layer").show(),$("#window-layer").scrollTop(0),$("#"+a+"-dialog").show()},hideWindows:function(){$("#window-layer .dialog").hide(),$("#window-layer").hide()},setLayout:function(a){$("#window-sketcher").removeClass("selected"),$("#window-model").removeClass("selected"),$("#window-vsplit").removeClass("selected"),$("#window-hsplit").removeClass("selected"),"sketcher"==a&&$("#window-sketcher").addClass("selected"),"model"==a&&$("#window-model").addClass("selected"),"vsplit"==a&&$("#window-vsplit").addClass("selected"),"hsplit"==a&&$("#window-hsplit").addClass("selected"),$("#content").removeClass("sketcher model vsplit hsplit").addClass(a),this.layout=a,Sketcher.resize(),Model.resize()},makeModelVisible:function(){"sketcher"==this.layout&&MolView.setLayout("both")},search_input_timeout:null,alertEmptyInput:function(){null!=MolView.search_input_timeout&&window.clearTimeout(MolView.search_input_timeout),$("#search-input").addClass("alert"),MolView.search_input_timeout=window.setTimeout(function(){$("#search-input").removeClass("alert")},1e3)}};$(document).on("ready",function(){MolView.init()});
